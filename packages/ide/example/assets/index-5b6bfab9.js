var Oa=Object.defineProperty,Ba=Object.defineProperties;var Na=Object.getOwnPropertyDescriptors;var Mt=Object.getOwnPropertySymbols;var Fa=Object.prototype.hasOwnProperty,Ua=Object.prototype.propertyIsEnumerable;var rt=(s,e,t)=>e in s?Oa(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,F=(s,e)=>{for(var t in e||(e={}))Fa.call(e,t)&&rt(s,t,e[t]);if(Mt)for(var t of Mt(e))Ua.call(e,t)&&rt(s,t,e[t]);return s},Y=(s,e)=>Ba(s,Na(e));var j=(s,e,t)=>(rt(s,typeof e!="symbol"?e+"":e,t),t);var B=(s,e,t)=>new Promise((a,l)=>{var n=i=>{try{r(t.next(i))}catch(d){l(d)}},u=i=>{try{r(t.throw(i))}catch(d){l(d)}},r=i=>i.done?a(i.value):Promise.resolve(i.value).then(n,u);r((t=t.apply(s,e)).next())});import{b as La,u as Ja}from"./vue-router-d4a23505.js";import{_ as $a}from"./monaco-editor-c02ad91d.js";import{y as Ma,E as _e,h as ta,C as zt,W as aa,A as la,Z as na,g as xe,a as ft,t as gt,V as bt,q as De,b as za,D as Ha,c as Wa,i as Ht,u as Ga,_ as qa}from"./index-c431b60a.js";import{H as Ka}from"./vue-fc522384.js";import{Z as Za}from"./mitt-595fde69.js";import{m as Qa,p as sa,q as oa}from"./@vueuse-12aa741e.js";import{D as Ya,e as Xa,f as el,u as ia,B as ra}from"./@element-plus-6f8e8671.js";import{h as oe,w as yt,x as tl,y as _t,z as ua,A as al,B as ll,u as be,b as le,c as kt,d as Vt,q as Tt,o as It,p as At,r as ca,E as we,C as ee,D as z,a as q,F as nl,G as sl,H as Rt,I as Pt,J as Ne,K as ol,f as Ot,v as il,L as rl,M as ul,l as cl,N as dl,O as pl,P as ml,Q as vl,R as hl,k as re,t as pe,S as at,T as lt,U as fl,V as gl,W as bl,X as yl,Y as ze,Z as _l}from"./element-plus-38e0f72a.js";import{I as O,a2 as kl,e as V,m as I,o as c,M as y,a as R,a3 as X,W as g,aj as da,O as h,J as ne,u as o,T as G,S as E,K as Z,a7 as Vl,f as ae,ar as pa,ap as ma,b5 as Ye,i as nt,Z as Oe,c as w,Q,U as W,V as $,ae as M,a9 as st,aJ as jl,H as wl,P as Ce,_ as ke,X as Ie,ah as Xe,aw as Cl,R as Bt,ai as Nt,E as va,h as Sl,af as ha,a0 as qe,w as Ft,ad as Ke,bt as Je,s as ut,j as Wt,n as He,bg as El,be as xl}from"./@vue-a5b69601.js";import"./lodash-es-188fbfb8.js";import"./async-validator-66f3b930.js";import"./@ctrl-86a38320.js";import"./@popperjs-7c8154ca.js";const fa="0.6.22",Gt="Vue",Dl=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeUnmount","unmounted","errorCaptured","renderTracked","renderTriggered","activated","deactivated"],qt=["$el","$emit","$nextTick","$parent","$root","$attrs","$slots","$watch","$props","$options","$forceUpdate"],Tl=["vIf","vShow","vModel","vFor","vBind"],Il=["click","dblclick","mouseenter","mouseleave","mousedown","mouseup","mouseover","contextmenu"],Al=["keydown","keyup","keypress"],Rl=["stop","prevent","capture","self","once","passive"],Pl=["String","Number","Boolean","Array","Object"],Ol=["GET","POST","PUT","PATCH","DELETE","JSONP"];function Re(s,e,t=!1,a=!1){var l;try{const n=['"use strict";',"var __self = arguments[0];"];n.push("return ");let u=(s.value||"").trim();u=u.replace(/this(\W|$)/g,(i,d)=>`__self${d}`),u=n.join(`
`)+u;const r=`with(${t?"{}":"$scope || {}"}) { ${u} }`;return new Function("$scope",r)(e)}catch(n){if(console.error("parseExpression.error",n,s,(l=e==null?void 0:e.__self)!=null?l:e),a)throw n}}function $e(s,e,t=!1,a=!1){var n;const l=Re(s,e,t,a);if(typeof l!="function"&&(console.error("parseFunction.error","not a function",s,(n=e==null?void 0:e.__self)!=null?n:e),a))throw new Error(`"${s.value}" not a function`);return l}function ge(s,e,t=!1){let a=!0;try{s.type==="JSExpression"?Re(s,e,t,!0):$e(s,e,t,!0)}catch(l){a=!1,be.error({title:"代码错误",message:l.message})}return a}const Bl=Object.prototype.toString,Nl=s=>Bl.call(s),ct=s=>Nl(s).slice(8,-1);function me(s){return s&&s.type==="JSExpression"}function ot(s){return typeof s=="object"&&s&&s.type==="JSFunction"}function Fl(s,e){const t={};return Object.keys(s).forEach(a=>{e.includes(a)&&(t[a]=s[a])}),t}function ga(s){return typeof s=="string"?s:JSON.stringify(s)}function ba(s={},e=!1){const t=Object.keys(s);return e?t.map(a=>"."+a):t}function Ul(s=[]){const e=s.find(r=>De(r.name)==="vIf"),t=s.find(r=>De(r.name)==="vFor"),a=s.find(r=>De(r.name)==="vShow"),l=s.find(r=>De(r.name)==="vBind"),n=s.filter(r=>De(r.name)==="vModel"),u=s.filter(r=>!Tl.includes(De(r.name)));return{vIf:e,vFor:t,vShow:a,vModels:n,vBind:l,others:u}}function te(s){return!!(s!=null&&s.__VTJ_BLOCK__)}function dt(s){return!!(s!=null&&s.__VTJ_NODE__)}function Ll(s){return/\.css$/.test(s)}function Jl(s){return/\.js$/.test(s)}function $l(s){return s.map(e=>`<script src="${e}"><\/script>`).join("")}function Ml(s=[]){return s.map(e=>`<link rel="stylesheet" href="${e}" />`).join("")}function zl(s){const{url:e,method:t="GET",settings:a}=s,l=a?Re(a,{}):void 0;return t.toLowerCase()==="jsonp"?n=>na(e,n,l):ta({url:e,method:t,settings:l})}function Hl(s=[]){const e=(t=[])=>{let a=[];for(const l of t)l.isDir?l.children&&l.children.length&&(a=a.concat(e(l.children))):a.push(l);return a};return e(s)}const ya="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAQd0lEQVR4nO2dCXRVxRnHf/clIPsekBgIS1hFdqVoZbGLFNTWWgQ3bLVurRYJcTuntbW22qooKKWl2toWquygIFa01doqmBBWWcomIkhACLIKyXvcnu/eefiSNzd57y4vAfI/553wuPfNzJ3/nW9m/t83M4Yx6iTVGOlAC6AD0Bs4F2gGtFT/lmtNgLpABDgMFAN7gCJgH3AQ2ACsAz5V91RbpFfDguUAg4EewBCgLdAQqJXAb5sD7RyuHVGfpcBy4AOgADjkc/k9obq0kP7AN4CrgK7qrQ8aJrALeAt4Q/3dV7XVULWEtAauBq5ThNSpqoIo7AReBWYA/6mqQlQFId2AW4HRwHmpzjwBSMv5N/BHYAHwRSozTyUhQsS9iohGqcrUI1YDE4GXgROpyDAVhMiIKBe4I0V9QxCQgcCvgdeCzigUcPo/BN4HHjiNyRAMBBYBs4BOQWYUFCFdgIXA80DHgPKoCowE3gHuCirvIAj5AfAmcEUAaVcHZAJTgHlqjuQr/CREJm/PAH8G2pyWVZ0crlbzl8v8TNQvQrLVGP5en9I7XdBV9S0/9qu8fhDSC1isZI6zEaKjTQYe8aM+vSZwqeq8u5+lZMTiYeA5oLaXRLwQMhSYe5b0F4niR8BUL6S4VXsvAWYCGZ6Kf2bi+8oVcDuQ9KzbTQvpqQS4GjKcIVrdU25+mCwhbZWuk+WhsGcLxgEPJvusyRAi84xpNR14UhD9a1QyP0iGkEeBQcGV/YyE1O+zwPnJ/CARSEc1NrBin9kQtftFoHEiT5kIIeLj/s3ZXqsecSHwUCJJVEZIGjAJaFXVT3QG4D7ga5U9RmWEiHI7/GyvSZ8QUkPhhhUlVxEhLZUcUAP/ILFld7slJK9GFgkEuRXEjjkSIh6/O0+fZzyt0EK5tLVwIiSvMltXA0+4yWluoiOkqwrVqUFwqA/ckygholI2SCUZZhjM4/bflOYrn1IwT4AZSW3eSlLpUP4/yxPSKtWtwyyBnPPgioHQtpX93Zd0TVXZEbviddcJQ59OMHwAZDTxL+8EIWFRN5a/tTwh31UxtymBtIrhF8GiBwwWPmDw2oMGg3t5rxghIi0NLugAbcRJUKoIiEUYbhwCrz9k57sgz6BvZ7u1pBBjlPk6hdjIRSHnXeV8ChzmF3DlJfDyWIP653yZ28ZP4dKHTfYdBCPNHRndsuGpmwwGdYNjJ2DiYpMnFtheI8OwTWPnLCh43KBR3S9/u/0z+N4Ek8KNYKQu9PvbKkDEQmwL6QP0S0UJhIxhA2D6PWXJEHTNhN7t7Tc46XQj0KQRzBhrMLwPNKgDLRvDY9cZfFOeLtrywjC0B2XIELTLgNm5Br072603RRgZm00sIcNSsSRAyBjSF6b/xIirEMHRE7D7gEtfZhiG9YGe2fGXLuwY41A1oOhzfRLtW8LMcQbnd0wZKd9UC40shGL+Xhl0zkLGwJ4w816D5g7juKlvwbqPwEhkvVRs2thPcfWFhvb62h02ERZqw+vL4e//1afVuTXMGW/QpV1KSMmIDaGKEtI+GSeKGwgZ/brZZLR08AzMWgY/e8l03TqyW8PXesRf2roH3t3w5aI46UdKwnDnVJNXC/XJiemcPd4gp03gpMhr8tXol+ijDwly7iFk9Opiv3VtmuvvmZsPtzxnWp2wm85cCBnRB5pr9IXFK2F/sXImKBjpcOQY3DTJ5LWV+iQvaGOTkp0Z+Ojr8mjoUJSQnkHlJG9X9xyYO96wOk0dFq6AHzxncvS4XVFJ52FCWh24+qJ4cxU5Ca8WmpZNK39VzOKhIzDmWZO31+nT7t0OZuUaZGYESkrbaOB2SMVmBeIrlwfo0h7mjTfo6ODikrdzzCSTw8eS7zdOIQzd28JXNCs3pO94f6PzGl6jNhQfhOsnmrz3P/09F+XAy7kGGc0CmzzWV2tQLEJaqD7EVwgZHdvA/DyDLpn6lN9aCzc/a/L5YfdkWJ15BIb1soe55TEv3+SYpF9BvySkFO2D6yeZrNyuv2dQV3hpnEHTRvZcJwB0jRIieko9X8kogQ5ZMC/PoJvDss531sMNE032H7QrxDVOQq168F2NuZIh9PyCsn2HE4xzYMduuPZpk3U79Td9vQdMG2vQqF4gpAgPTUPKi+XWWMRByDivpW13ezosZ/lgC9w4yWRvsUcysGWRAZ3UPKMclm6CDTsSD5gVUrbssEnZskd/jwwc/ibqQl3fSZGl4e1DakWQLxAyWjW3Z7v9HIygmIRRT5vs2mtXgBdE9SmZe6RpTJKYq8gJe5ibKEQyWb8NrnnS5KPP9D/6dn948W6DunV8JUVc5i1Dfi3GFDKaNYaX7zUY2Fl/z4ZdMPoZk493eyfDwklo2Bgu7x1/af8ReH1VYuaqPISUNZvhe0+ZfLJff8/Ir8Cff2xwTm3f3AZS0mYhxYwnCBkNG9id3lCH6aWYgJETTDZ97BMZ2Obqki5o+6klq2H7LveDBaMurNhoi427HWSW0RfDCz8ySE/3hRSplcyQ2lXHNaQg9evB9LEGlzvMZiwV9SmTddv8U1Etc2XYc4+QxiTN+cB0sRigLISU/HU2KZ85bFFz46Uw9Q5FijcnV3qUkBZuUzBPQnoaTLnd4CoHnViavDzQ6s0+S9oRaJkBwzXm6qO98M46f/Y6ElLeXwM3PGty4Kj+nluGwiOjDatMcX6X5HCutz6kFAb1gDEO08pPDyj/woYA/Aul8PULIEsjxSxaAcX73c36dRBS3iyAMZNNDjvsfJI7Avp2scvlAVYfohHBE0QELu+lH8KImbr2GdNq8ob7HLSw3sJaemW3NAxzlml0Eq+oA4veh9ummhQfiU+rTi3VWr2ZrXohT0mY0NbB4P1qnsl7+f6TYSEM7VrDEM0AYvUOyN/i/9Zs1tC5Dsx8A/70tv6erOae34JwyNOWdwbscNjyK3eEQe+eAUnXYfttbKFRdhcWmhw/7FIxrgzH4VuD4Iav6u/bVeytA5Hd7UJqj0J3SIf5+SZhTRvrrqSTCzra8rtfkIGEKLvXDIh/G4+VJC6VJAt5hqF9Ydo9BplN4398vNTuuzzm/VlIbRjpDrVg2Qb45Vz9myHu0Hn3++wOVcruAI2y+98N8OF2/82VkHFJT5hRgafzyYWwcpMnEUoq8dOQ2r3TFSy7mgaPzoDHFuhTyGkF8+4z6OqXOzSCNcQuHxwhmP2BaanMFSm7yULI6NvV1uacPJ3P/xMemWladZGMTFMO4m3ZJUV3EAcSg/XwafDT6SYTF+t/Ij7q+fcbdMn2RoqYqzoN4Dua0dWeg7BkjZ8yqU1Gz072C6UzU4KX3oO7nzeJRDz3WzJg3ivV6SAMJA4piGlA3l9MJr+h/5n4qOfeZ9C5rQdSSuGiTtBHI1z+60PYUeRf/2F5OjvaZc52GEnOWQa3TTEt/7wPcx5pIQdCapNhzxBSIibkvmjygsOw8PwsmDXesHwlrtyhJlzV31nZlf7Fg8n4Mpvj0Dkb5uYZlsnVQYIjbplicsyl21mD9SJshNSOzw6iQHIQUkojcPcfTaY5bLTaKxvm5CUfOCA6UcMmcEXf+Gtbimzvox/mSsjIaav6PQfHxOJVth/+8FEPbud4iMHdGfJ7+20h5UQp3PUHk9nL9Pf0aWcHo2W1SoKUsK3sdtJEHr+yHD53G1wXAylL+yw70uR8h70qpJ+6aaLJwSO+kiEQV1pJdGK41M+UpQlLBMmtk00WOsQ9DciBmbkG52YkGDhgwKiB8cqutMgFBfaw24u5EjKyzrXNVG9N5KPg3xtst3PxId/JKFVbn596p1b4mrwKsREhTpq2NfrR4OLOtkOrRdOKSRGJP7OV6Gbx11Zth8Jt3syV5enMgFnjDKv16rB0M4yaYLLvcx/czvGQAwM+JIaQpZ5lMQ2EFIkokbfqPxv19wzpDjPGGTRpXIE7NGJHJLbWDD1fKTD54rB7cyVkNG1im1AnT6fldp5gsmd/IGQIlkUVk+hjFHiZIFYEeYB9B2w/+vJt+hulsl8aa9CgfjwplrKbbo+uyuPIcZi/3B7qurFWklcD8XT+xGBwN/0963fans5Pinz0dMbj1Lg0SsghdTpAIJAH2b3XJuXDT/Q5fKt3DCmxbTUCHVrDZRplV2z6+iSiSmIhZrBeXTsKf5jGyYUavUkEytZPAl0vIkrfv6JfYhv6PwLLUgUObFNv26bd+nuu7AeTbzVID8V43kTZ7QPNNBrSPHHTliTfmVuhp2nwu9sMK4JEB/HnjJQYra2BL96ReeDa6JdYQpaoIXBgkAfbuN1+67Y5SJo3D4b+nWKWoaVLKKeDVLLWpZBYCiP6w/cH6y+LS0HKuGpTQP6cspgZ23/HElKsdhgNFEKK+NdHTzLZ6aCi1a6ltE/DLuqWong1WUJ8dha5JOSkPUHVQRYLSUhpQRBu53gcjV3OhmZsMt2zVzgByIMWrFeklPPGyIx7xRZ7GGu1i3T4wxLKBELvPwwTF6m5h5sCpMGba+wJbCyk1V03yeS9tSlbYyh9R5nxZ5rR4+ex33eqLYQc3h//IJNHiaV9ax00bWBw0oRFhTDur2UXfIqafPQYvFIIoZBhEZg3zSR/o/shqKS9cw98XAz9OthL6wq22v7yd9ekdMHneGBzmbJpzg8ZpXYdTQmsCWEte3Hm3gO2qdKJddbIy1RtOux9PmD1T6XQvb3tSFu+FfbsC2yeoUOhWvFcRjzSEVJXTVQCW8RTHlblnLQru6IRU3Tk5YeieyrNUpV3ekB+eGfcDPyt/FXd/FbGxRNSWTKpYCMBb5t1n8/hPaImyDwpxWTIUUpzdBecBIeZUbGrBoHgcYnJSIYQsWu/CELfqoGliMx2qoaKJLl/qGPjauAfpMf6WUV7wlemkcrOZw7LVmrgAhPVgMkRlRGytWYjTN8gXqHHKkssES/C8zWmyzPCamfwSiN8EiEkorY23VT1z3Xa4qfquL1KkaifbZfapTR1mxadOZiTzLwuGcfn20p7qUHiWKlOcEt4BWKynugp6tiKGlSObUoX3JtMXbkJDXhYEVMDZxSpzUQ3J1tHbkPLZMTwlxpCtNinDu0vcPNjt4SE1XHcf3L5+zMV0jKuTXREpYOX4MsSNfJ6+myt/XKQSfR3YkN63MDr0pawGnkldHrMGYxCdc6KZ4Xcr7VGv1F2M9ColWoKOfR+hF8TZz+P756htprN9zHN6oxSdU7hdZ7WaZaD3wfcS6TUN1SLOZN9KavVxpW/dXO8akXwmxBUWOpDyqauCiD9qkSJImGo187bCUEQEsUSdbz3A3426SrEEhUiJWbqQFDFCJIQgewK8oTacfN36vvpBmnl10s8uCyFD7rsujCgINFDnTl+bex+59UUMtP+vQr40AYkBIFUExKFbFl5gzqLKacqCuCAQ6pveEGZqNQe8VKFhEQhiwwuA66RXVj93JAzCRxTSwJmqWBzX5aJu0VVExILWZ4vCwQuVvY6M9EDfZNERAmABao1vKP6iWpREdWJkFjUUgHfMhjopD79Vb9TW20YWdlChOPK5JSoRflr1NLjfDVfcr8LUoDwed8c3yCzYFmUIB9BM3U6prQi+UjrkY9s4CnXZGdu0dWkD5CwJZFwxO0sw20JLJCFdPIJfKmFJwD/B4g2wB0X86iqAAAAAElFTkSuQmCC",Wl=[{name:"logo",type:"Logo",region:"brand",props:{text:"Tj",icon:ya}},{name:"switcher",type:"Switcher",region:"brand",props:{link:"/"}}],Gl=[{name:"toolbar",type:"Toolbar",region:"toolbar"}],ql=[{name:"actions",type:"Actions",region:"action"}],Kl=[{name:"pages",type:"Pages",region:"apps",order:1,trigger:{icon:"vtj-icon-document",label:"页面",type:"panel"}},{name:"blocks",type:"Blocks",region:"apps",order:2,trigger:{icon:"vtj-icon-components",label:"区块",type:"panel"}},{name:"components",type:"Components",region:"apps",order:3,trigger:{icon:"vtj-icon-block",label:"组件库",type:"panel"},props:{title:"组件库"}},{name:"outline",type:"Outline",region:"apps",order:4,trigger:{icon:"vtj-icon-outline",label:"大纲树",type:"panel"}},{name:"history",type:"History",region:"apps",order:4,trigger:{icon:"vtj-icon-history",label:"历史记录",type:"panel"}},{name:"api",type:"Apis",region:"apps",order:4,trigger:{icon:"vtj-icon-api",label:"Api管理",type:"panel"}},{name:"packages",type:"Dependencies",region:"apps",order:6,trigger:{icon:"vtj-icon-category",label:"依赖管理",type:"panel"}},{name:"about",type:"About",region:"apps",props:{title:"关于",width:"500px",height:"300px"},trigger:{icon:"vtj-icon-info",label:"关于",type:"dialog"}}],Zl=[{package:"vue",version:"latest",library:"Vue",urls:["./libs/vue.global.js"],required:!0,official:!0,enabled:!0},{package:"@vueuse/core",version:"latest",library:"VueUse",urls:["./libs/vueuse.shared.iife.min.js","./libs/vueuse.core.iife.min.js"],required:!1,official:!0,enabled:!0},{package:"element-plus",version:"latest",library:"ElementPlus",urls:["./libs/element-plus.index.css","./libs/element-plus.full.min.js"],assetsUrl:"./libs/element-plus-assets.js",assetsLibrary:"ElementPlusAssets",required:!1,official:!0,enabled:!0},{package:"@element-plus/icons-vue",version:"latest",library:"ElementPlusIconsVue",urls:["./libs/element-plus-icons-vue.js"],required:!1,official:!0,enabled:!0},{package:"@vtj/utils",version:"latest",library:"VtjUtils",urls:["./libs/vtj-utils.js"],required:!1,official:!0,enabled:!0},{package:"@vtj/icons",version:"latest",library:"VtjIcons",urls:["./libs/vtj-icons.css","./libs/vtj-icons.js"],required:!1,official:!0,enabled:!0},{package:"@vtj/ui",version:"latest",library:"VtjUI",urls:["./libs/vtj-ui.css","./libs/vtj-ui.js"],assetsUrl:"./libs/vtj-ui-assets.js",assetsLibrary:"VtjUIAssets",required:!1,official:!0,enabled:!0},{package:"ant-design-vue",version:"latest",library:"antd",urls:["./libs/antd.css","./libs/dayjs/dayjs.min.js","./libs/dayjs/plugin/customParseFormat.js","./libs/dayjs/plugin/weekday.js","./libs/dayjs/plugin/localeData.js","./libs/dayjs/plugin/weekOfYear.js","./libs/dayjs/plugin/weekYear.js","./libs/dayjs/plugin/advancedFormat.js","./libs/dayjs/plugin/quarterOfYear.js","./libs/antd.min.js"],assetsUrl:"./libs/ant-design-vue-assets.js",assetsLibrary:"AntDesignVueAssets",required:!1,official:!0,enabled:!1}],Ql=[{name:"designer",type:"Designer",region:"workspace",disabled:!1,order:0,trigger:{label:"设计视图",type:"tab"}},{name:"schema",type:"Schema",region:"workspace",disabled:!1,order:1,trigger:{label:"Schema",type:"tab",closable:!0}},{name:"docs",type:"Docs",region:"workspace",disabled:!1,order:2,props:{url:"https://element-plus.org/zh-CN/"},trigger:{label:"帮助中心",type:"tab",closable:!0}}],Yl=[{name:"properties",type:"Properties",region:"setting",group:"Node",trigger:{label:"属性",type:"tab"}},{name:"events",type:"Events",region:"setting",group:"Node",trigger:{label:"事件",type:"tab"}},{name:"directives",type:"Directives",region:"setting",group:"Node",trigger:{label:"指令",type:"tab"}},{name:"script",type:"BlockScript",region:"setting",group:"Block",trigger:{label:"设置",type:"tab"}},{name:"dataSources",type:"DataSources",region:"setting",group:"Block",trigger:{label:"数据源",type:"tab"}},{name:"css",type:"Css",region:"setting",group:"Block",trigger:{label:"样式",type:"tab"}},{name:"advanced",type:"Advanced",region:"setting",group:"Block",trigger:{label:"定义",type:"tab"}}],Xl=[{name:"nodePath",type:"NodePath",region:"status",props:{}}],en={activeApp:"pages",widgets:[...Wl,...Gl,...ql,...Kl,...Ql,...Yl,...Xl],dependencies:Zl};function tn(s,e){const t=s.slice(0);return e.forEach(a=>{const l=t.findIndex(n=>n.name===a.name);l>-1?t.splice(l,1,aa(t[l],a)):t.push(a)}),t}function an(s,e){const t=tn(s.widgets||[],(e==null?void 0:e.widgets)||[]);return Object.assign({},s,e||{},{widgets:t})}class _a{}const Kt="Project",pt="File",mt="History",Ve=new Ma({prefix:"__VTJ__",type:"local"});class ka extends _a{createKey(...e){return e.join("_")}getProject(e){return B(this,null,function*(){const t=e.id||_e(),a=this.createKey(Kt,t);return Ve.get(a)||(yield this.createProject(e))})}createProject(e){return B(this,null,function*(){const t=e.id||_e(),a=e.name||"未命名项目",l=this.createKey(Kt,t),n=Y(F({},e),{id:t,name:a});return Ve.save(l,n),n})}updateProject(e){return B(this,null,function*(){if(!e.id)return!1;const t=yield this.getProject(e),a=Object.assign(t,e);return!!this.createProject(a)})}createFile(e){return B(this,null,function*(){const t=e.id||_e(),a=this.createKey(pt,t),l=Y(F({},e),{id:t});return Ve.save(a,l),l})}updateFile(e){return B(this,null,function*(){return e.id?!!this.createFile(e):!1})}getFile(e){return B(this,null,function*(){const t=this.createKey(pt,e);return Ve.get(t)})}removeFile(e){return B(this,null,function*(){const t=this.createKey(pt,e),a=this.createKey(mt,e);return Ve.remove(t),Ve.remove(a),!0})}saveHistory(e){return B(this,null,function*(){const{blockId:t,items:a}=e,l=this.createKey(mt,t);return Ve.save(l,a),!0})}getHistory(e){return B(this,null,function*(){const t=this.createKey(mt,e);return Ve.get(t)||[]})}}const je=ta({url:"/vtj/base.json",method:"post",settings:{type:"json",validSuccess:!0,originResponse:!1,validate:s=>{var e;return((e=s.data)==null?void 0:e.code)===0},showError:s=>{be.error({message:s||"未知错误"})}}});class ln extends _a{getProject(e){return B(this,null,function*(){const t=e.id;return(yield je({type:"getProject",data:t}).catch(a=>null))||(yield this.createProject(e))})}createProject(e){return B(this,null,function*(){const t=e.id,a=e.name||"未命名项目",l=Y(F({},e),{id:t,name:a});return yield je({type:"createProject",data:l}).catch(n=>null),l})}updateProject(e){return B(this,null,function*(){if(!e.id)return!1;const t=yield this.getProject(e),a=Object.assign(t,e);return!!this.createProject(a)})}createFile(e){return B(this,null,function*(){const t=e.id,a=Y(F({},e),{id:t});return yield je({type:"createFile",data:a}),a})}updateFile(e){return B(this,null,function*(){return e.id?!!this.createFile(e):!1})}getFile(e){return B(this,null,function*(){return yield je({type:"getFile",data:e}).catch(t=>null)})}removeFile(e){return B(this,null,function*(){return yield je({type:"removeHistory",data:e}),yield je({type:"removeFile",data:e}),!0})}saveHistory(e){return B(this,null,function*(){const{blockId:t,items:a}=e;return yield je({type:"saveHistory",data:{blockId:t,items:a}}),!0})}getHistory(e){return B(this,null,function*(){return yield je({type:"getHistory",data:e}).catch(t=>[])})}}var nn={name:"zh-cn",el:{colorpicker:{confirm:"确定",clear:"清空"},datepicker:{now:"此刻",today:"今天",cancel:"取消",clear:"清空",confirm:"确定",selectDate:"选择日期",selectTime:"选择时间",startDate:"开始日期",startTime:"开始时间",endDate:"结束日期",endTime:"结束时间",prevYear:"前一年",nextYear:"后一年",prevMonth:"上个月",nextMonth:"下个月",year:"年",month1:"1 月",month2:"2 月",month3:"3 月",month4:"4 月",month5:"5 月",month6:"6 月",month7:"7 月",month8:"8 月",month9:"9 月",month10:"10 月",month11:"11 月",month12:"12 月",weeks:{sun:"日",mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六"},months:{jan:"一月",feb:"二月",mar:"三月",apr:"四月",may:"五月",jun:"六月",jul:"七月",aug:"八月",sep:"九月",oct:"十月",nov:"十一月",dec:"十二月"}},select:{loading:"加载中",noMatch:"无匹配数据",noData:"无数据",placeholder:"请选择"},cascader:{noMatch:"无匹配数据",loading:"加载中",placeholder:"请选择",noData:"暂无数据"},pagination:{goto:"前往",pagesize:"条/页",total:"共 {total} 条",pageClassifier:"页",page:"页",prev:"上一页",next:"下一页",currentPage:"第 {pager} 页",prevPages:"向前 {pager} 页",nextPages:"向后 {pager} 页",deprecationWarning:"你使用了一些已被废弃的用法，请参考 el-pagination 的官方文档"},messagebox:{title:"提示",confirm:"确定",cancel:"取消",error:"输入的数据不合法!"},upload:{deleteTip:"按 delete 键可删除",delete:"删除",preview:"查看图片",continue:"继续上传"},table:{emptyText:"暂无数据",confirmFilter:"筛选",resetFilter:"重置",clearFilter:"全部",sumText:"合计"},tree:{emptyText:"暂无数据"},transfer:{noMatch:"无匹配数据",noData:"无数据",titles:["列表 1","列表 2"],filterPlaceholder:"请输入搜索内容",noCheckedFormat:"共 {total} 项",hasCheckedFormat:"已选 {checked}/{total} 项"},image:{error:"加载失败"},pageHeader:{title:"返回"},popconfirm:{confirmButtonText:"确定",cancelButtonText:"取消"}}};function K(){const s=va($t);return{engine:s,regions:s.skeleton.regions,config:s.config,emitter:s.emitter,project:s.project,assets:s.assets}}function sn(s){const e=V(""),t=I(()=>{const a=e.value.toLowerCase();return!a||!s?[]:s.filter(l=>{var n;return l.name.toLowerCase().includes(a)||((n=l.title)==null?void 0:n.toLowerCase().includes(a))})});return{searchKey:e,searchResult:t}}const on=["onClick"],rn={key:1,class:"vtj-panel__header"},un={class:"vtj-panel__title"},cn={key:1,class:"vtj-panel__subtitle"},dn={key:0,class:"vtj-panel__tools"},pn=["onClick"],mn={key:0,class:"vtj-panel__footer"},fe=O({__name:"Panel",props:{icon:{},title:{},subtitle:{},tools:{},bodyPadding:{type:Boolean,default:!0},back:{type:Boolean}},emits:["tool-click","back"],setup(s,{expose:e,emit:t}){const a=s,l=V(),n=V();function u(i){t("tool-click",i)}function r(){t("back")}return e({panel:l,header:n}),(i,d)=>(c(),w("div",{class:"vtj-panel",ref_key:"panel",ref:l},[R("div",{ref_key:"header",ref:n,class:"vtj-panel__header-wrapper"},[a.back?(c(),w("i",{key:0,onClick:X(r,["stop"]),class:"vtj-panel__back vtj-icon-arrow-left"},null,8,on)):E("",!0),i.title!==null?(c(),w("div",rn,[ne(i.$slots,"title",{},()=>[R("div",un,[i.icon?(c(),w("i",{key:0,class:Q(["vtj-panel__icon",i.icon])},null,2)):E("",!0),G(" "+W(i.title)+" ",1),i.subtitle?(c(),w("span",cn,W(i.subtitle),1)):E("",!0)])]),i.tools&&i.tools.length||i.$slots.tools?(c(),w("div",dn,[(c(!0),w($,null,M(i.tools,p=>(c(),w("i",{key:p.name,class:Q(p.icon),onClick:m=>u(p)},null,10,pn))),128)),ne(i.$slots,"tools")])):E("",!0)])):E("",!0)],512),R("div",{class:Q(["vtj-panel__body",{"is-padding":a.bodyPadding}])},[ne(i.$slots,"default")],2),i.$slots.footer?(c(),w("div",mn,[ne(i.$slots,"footer")])):E("",!0)],512))}}),se=O({__name:"Dialog",props:{modelValue:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},width:{default:"80%"},height:{},top:{default:"40%"},cancel:{type:Boolean,default:!1},submit:{type:Boolean,default:!1},clear:{type:Boolean,default:!1},closable:{type:Boolean,default:!0}},emits:["close","update:modelValue","submit","clear"],setup(s,{expose:e,emit:t}){const a=s,l=kl(),n=V(),u=I(()=>{const v=[...l.tools||[]];return a.closable&&v.push({name:"close",icon:"vtj-icon-close"}),v}),{x:r,y:i}=On(n),d=I(()=>({width:a.width,height:a.height,left:`${r.value}px`,top:`${i.value}px`})),p=v=>{v.name==="close"&&(t("update:modelValue",!1),t("close"))};function m(){t("update:modelValue",!1),t("close")}function f(){t("submit")}function b(){t("clear")}return e({close:m}),(v,_)=>a.modelValue?(c(),y(Vl,{key:0,to:"body"},[R("div",{class:"vtj-dialog__modal",onMousemove:_[0]||(_[0]=X(()=>{},["stop"]))},null,32),g(fe,Z({ref_key:"panelRef",ref:n,onMousemove:_[1]||(_[1]=X(()=>{},["stop"])),class:"vtj-dialog"},v.$attrs,{tools:u.value,style:d.value,draggable:"",onToolClick:p}),da({default:h(()=>[ne(v.$slots,"default")]),_:2},[v.$slots.footer||v.cancel||v.submit||v.clear?{name:"footer",fn:h(()=>[ne(v.$slots,"footer",{},()=>[R("div",null,[ne(v.$slots,"action"),v.clear?(c(),y(o(oe),{key:0,type:"warning",size:"default",class:"vtj-dialog__clear",onClick:b},{default:h(()=>[G(" 清除绑定 ")]),_:1})):E("",!0)]),R("div",null,[v.cancel?(c(),y(o(oe),{key:0,onClick:m,size:"default"},{default:h(()=>[G(" 取消 ")]),_:1})):E("",!0),v.submit?(c(),y(o(oe),{key:1,type:"primary",onClick:f,size:"default"},{default:h(()=>[G(" 确定 ")]),_:1})):E("",!0)])])]),key:"0"}:void 0]),1040,["tools","style"])])):E("",!0)}}),vn=R("div",null,"该组件支持多个插槽，请选择放置到其中一个",-1),hn={class:"vtj-designer__slots"},fn=["onClick"],gn=O({__name:"SlotPicker",props:{slots:{default:()=>[]}},emits:["pick"],setup(s,{emit:e}){const t=s,a=V(!0),l=n=>{e("pick",n)};return(n,u)=>(c(),y(se,{title:"提示",width:"600px",height:"200px",modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=r=>a.value=r)},{default:h(()=>[vn,R("div",hn,[(c(!0),w($,null,M(t.slots,r=>(c(),w("div",{onClick:i=>l(r),class:"vtj-designer__slot"},W(r.name),9,fn))),256))])]),_:1},8,["modelValue"]))}}),bn=(s,e=!0)=>{const{top:t,height:a,width:l,left:n}=s||{};if(a>100&&l>200)return"inner";let u,r;return r=t>30?"top":"bottom",u=e||n<300&&l<300?"left":"right",[u,r].join("-")},yn=s=>{const{rect:e,type:t}=s,{left:a,width:l,top:n,height:u}=e,r={left:a,width:l,top:n,height:u};switch(t){case"left":r.left=0,r.width=0;break;case"right":r.left=r.left+r.width-4,r.width=0;break;case"bottom":r.top=r.top+r.height-4,r.height=0;break;case"top":r.height=0;break}return r},vt=(s,e)=>{if(!e)return null;const{left:t,top:a,width:l,height:n}=s==="dropping"?yn(e):e.rect,u={left:`${t}px`,top:`${a}px`,width:`${l}px`,height:`${n}px`};return Y(F({},e),{style:u,position:bn(e.rect,s!=="selected")})};let We;function he(s){if(We||!s)return We;Oe(()=>{s.dispose()});const e=I(()=>vt("hover",s.hover.value)),t=I(()=>vt("dropping",s.dropping.value)),a=I(()=>vt("selected",s.selected.value)),l=u=>{const{type:r,node:i}=u;if(!i){s.selected.value=null,s.hover.value=null;return}switch(r){case"remove":s.selected.value=null;case"copy":s.setSelected(i);break;case"move":s.setSelected(i);break;case"hover":s.setHover(i);break;case"selected":s.setSelected(i);break}},n=V("pc");return S.on(Sa,u=>{n.value=u}),S.on(Lt,u=>{s.setSelected(u)}),S.on(Jt,u=>{s.setHover(u)}),S.on(Te,u=>{s.hover.value=null,s.selected.value=null}),S.on(Ea,u=>B(this,null,function*(){yield ft(100),s.hover.value=null,u&&a.value&&s.setSelected(a.value.node)})),S.on(J,()=>B(this,null,function*(){yield ft(100),a.value&&s.setSelected(a.value.node)})),We={designer:s,hover:e,dropping:t,selected:a,onAction:l,viewportMode:n},We}function _n(s){return new Promise((e,t)=>{const a=ma(gn,{slots:s,onClose:()=>{a.unmount(),t(void 0)},onPick:l=>{a.unmount(),e(l)}});a.mount(document.createElement("div"))})}function kn(s,e){var u,r,i,d,p;const t={state:(u=s.value)==null?void 0:u.removeState.bind(s.value),computed:(r=s.value)==null?void 0:r.removeComputed.bind(s.value),methods:(i=s.value)==null?void 0:i.removeMethods.bind(s.value),watch:(d=s.value)==null?void 0:d.removeWatch.bind(s.value),lifeCycles:(p=s.value)==null?void 0:p.removeLifeCycles.bind(s.value)},a=V(!1),l=V(Symbol()),n=V();return{list:I(()=>{var m,f;if(e==="watch")return(((m=s.value)==null?void 0:m.watch)||[]).map(b=>({title:b.source.value,model:b}));{const b=(f=s.value)==null?void 0:f[e];return Object.entries(b!=null?b:{}).map(([v,_])=>({title:v,model:{name:v,value:_}}))}}),visible:a,data:n,onAdd:m=>{l.value=Symbol(),n.value=null,a.value=!0},onEdit:m=>{l.value=Symbol(),n.value=F({},m),a.value=!0},onRemove:m=>B(this,null,function*(){if(yield re.confirm("是否确定删除?","提示",{type:"warning"}).catch(()=>!1)){const f=t[e];f&&f(e==="watch"?m:m.name)}}),keyRef:l}}const Vn={block:{type:Object,default:null},data:{type:Object},type:{type:String,default:"state"},title:{type:String,default:""},nameLabel:{type:String,default:""},valueLabel:{type:String,default:""},dataType:{type:String,default:"JSExpression"},defaults:{type:String,default:""}};function jn(s){const e={name:"",value:{type:s.dataType,value:s.defaults}},t={state:s.block.setState.bind(s.block),computed:s.block.setComputed.bind(s.block),methods:s.block.setMethods.bind(s.block),lifeCycles:s.block.setLifeCycles.bind(s.block)},a=V(),l=V(),n=V(),u=I(()=>s.data?`编辑${s.title}`:`新增${s.title}`),r={name:[{required:!0,message:`${s.title}名称为必填项`}]},i=I(()=>!!s.data),d=ke(s.data||xe(e));Ft(()=>{Object.assign(d,s.data||xe(e))});const p=m=>s.data?!1:!!s.block[s.type][m];return{defaultJsData:e,title:u,model:d,formRef:a,dialogRef:l,editorRef:n,rules:r,disabled:i,onSubmit:()=>B(this,null,function*(){if(yield a.value.validate().catch(()=>!1)){if(p(d.name)){be.warning({title:"提示",message:"已存在相同名称，请更换！"});return}const m=n.value.getEditor().getValue(),f=s.block.runtimeContext;f&&ge(Y(F({},d.value),{value:m}),f)&&(d.value.value=m,t[s.type](d.name,d.value),l.value.close())}})}}const wn={block:{type:Object,default:null},data:{type:Object}};function Cn(s){const e={source:{type:"JSFunction",value:"() => { }"},immediate:!1,deep:!1,handler:{type:"JSFunction",value:"() => { }"}},t=V(),a=V(),l=V(),n=V(),u=I(()=>s.data?"编辑 Watch":"新增 Watch"),r=ke(s.data||xe(e));return Ft(()=>{Object.assign(r,s.data||xe(e))}),{title:u,model:r,onSubmit:()=>B(this,null,function*(){const i=s.block.runtimeContext,d=l.value.getEditor().getValue(),p=n.value.getEditor().getValue();i&&ge(Y(F({},r.source),{value:d}),i)&&ge(Y(F({},r.handler),{value:p}),i)&&(r.source.value=d,r.handler.value=p,s.block.setWatch(F({},r)),a.value.close())}),dialogRef:a,sourceRef:l,handlerRef:n,formRef:t}}function Sn(s,e){const{selected:t}=he(),a=I(()=>{var u;return(u=t.value)==null?void 0:u.node}),l=I(()=>{var x;const u=[];if(!s.value)return u;const r=s.value.runtimeContext,i=r==null?void 0:r.__context_refs[(x=a.value)==null?void 0:x.id],d=s.value.runtimeContext===i?[]:Object.keys((i==null?void 0:i.context)||{}).filter(D=>!["context","ref"].includes(D)).map(D=>`this.context.${D}`);d.length&&u.push({title:"上下文",items:d});const p=s.value.inject.map(D=>`this.${D.name}`);p.length&&u.push({title:"注入",items:p});const m=s.value.props.map(D=>typeof D=="string"?`this.$props.${D}`:`this.$props.${D.name}`);m.length&&u.push({title:"属性",items:m});const f=Object.keys(s.value.state).map(D=>`this.state.${D}`);f.length&&u.push({title:"状态",items:f});const b=Object.keys(s.value.computed).map(D=>`this.${D}.value`);b.length&&u.push({title:"计算属性",items:b});const v=Object.keys(s.value.methods).map(D=>`this.${D}`);v.length&&u.push({title:"方法",items:v});const _=Object.keys(s.value.dataSources).map(D=>`this.${D}`);_.length&&u.push({title:"数据源",items:_});const k=Object.keys((r==null?void 0:r.$refs)||{}).map(D=>`this.$refs.${D}`);return k.length&&u.push({title:"refs",items:k}),u}),n=I(()=>{if(!e.value)return l.value;const u=e.value.toLowerCase(),r=[];return l.value.forEach(i=>{const d=i.items.filter(p=>p.toLowerCase().includes(u));d.length&&r.push({title:i.title,items:d})}),r});return{options:l,searchResult:n}}function En(s,e){const t=[{name:"InputSetter",label:"文本"},{name:"ExpressionSetter",label:"表达式"}],a=V();ae(s,i=>B(this,null,function*(){i?a.value=(yield e.getBlockDescription(i.from))||void 0:a.value=void 0}),{immediate:!0});const l=I(()=>!s.value||!dt(s.value)?[]:[{name:"key",setters:t,value:s.value.getPropValue("key")},{name:"ref",setters:t,value:s.value.getPropValue("ref")},{name:"class",label:"class",setters:t,value:s.value.getPropValue("class")},{name:"style",label:"样式",setters:[{name:"JSONSetter",label:"JSON"},{name:"ExpressionSetter",label:"表达式"}],value:s.value.getPropValue("style")},{name:"children",label:"文本",title:"如设置组件文本，将清空子组件",setters:t,value:Array.isArray(s.value.children)?"":s.value.children}]),n=I(()=>{if(!s.value||!dt(s.value))return[];const i=a.value||e.componentMap[s.value.name]||e.elementsMap[s.value.name];return i?(i.props||[]).map(d=>{var p;return Y(F({},d),{value:(p=s.value.getPropValue(d.name))!=null?p:d.defaultValue})}):[]}),u=i=>l.value.some(d=>d.name===i)||n.value.some(d=>d.name===i),r=I(()=>!s.value||!dt(s.value)?[]:Object.keys(s.value.props).filter(i=>!u(i)).map(i=>({name:i,setters:"InputSetter",value:s.value.getPropValue(i)})));return{commonProps:l,componentProps:n,onChange:(i,d)=>{i==="children"?s.value.setChildren(d):s.value.setProp(i,d)},customProps:r,addCustom:i=>{i&&s.value.setProp(i,"")},isExist:u,removeProp:i=>{s.value.removeProp(i)},blockDescription:a}}function xn(s,e){const t=V();ae(s,u=>B(this,null,function*(){u?t.value=(yield e.getBlockDescription(u.from))||void 0:t.value=void 0}),{immediate:!0});const a=I(()=>{var r;if(te(s.value))return[];const u=((r=s.value)==null?void 0:r.events)||{};return Il.map(i=>({name:i,event:u[i]}))}),l=I(()=>{var r;if(te(s.value))return[];const u=((r=s.value)==null?void 0:r.events)||{};return Al.map(i=>({name:i,event:u[i]}))}),n=I(()=>{var r,i,d;if(te(s.value))return[];const u=((r=s.value)==null?void 0:r.events)||{};return(((i=t.value)==null?void 0:i.events)||((d=e.componentMap[s.value.name])==null?void 0:d.events)||[]).map(p=>{const m=typeof p=="string"?p:p.name;return{name:m,event:u[m]}})});return{mouseEventList:a,keyboardEventList:l,componentEventList:n}}class Fe{constructor(e,t,a){j(this,"isUnset",!1);this.name=e,this.value=t,this.defaultValue=a,this.setValue(t)}setValue(e){this.value=e,this.isUnset=this.value===this.defaultValue}getValue(){var e;return(e=this.value)!=null?e:this.defaultValue}static toDsl(e={}){return Object.entries(e).reduce((t,[a,l])=>(l.isUnset||(t[a]=l.getValue()),t),{})}static parse(e={}){return Object.entries(e).reduce((t,[a,l])=>(t[a]=new Fe(a,l),t),{})}}class Pe{constructor(e){j(this,"id");j(this,"name","");j(this,"arg");j(this,"modifiers");j(this,"value");j(this,"iterator");this.id=e.id||_e(),this.update(e)}update(e){const{name:t,arg:a,modifiers:l,value:n,iterator:u}=e;this.name=t,this.arg=a,this.modifiers=l,this.value=n,this.iterator=u}static parse(e=[]){return e.map(t=>new Pe(t))}static toDsl(e=[]){return e.map(t=>{const{name:a,arg:l,modifiers:n,value:u,iterator:r,id:i}=t;return{id:i,name:a,arg:l,modifiers:n,value:u,iterator:r}})}}class Ue{constructor(e,t){j(this,"handler");j(this,"modifiers",{});this.name=e;const{handler:a}=t;this.handler=a,this.update(t)}update(e){const{handler:t,modifiers:a={}}=e;this.handler=t,this.modifiers=a}static toDsl(e){return Object.entries(e).reduce((t,[a,l])=>{const{handler:n,modifiers:u}=l;return t[a]={handler:n,modifiers:u},t},{})}static parse(e={}){return Object.entries(e).reduce((t,[a,l])=>(t[a]=new Ue(a,l),t),{})}}const Ee=class Ee{constructor(e,t=null){j(this,"__VTJ_NODE__",!0);j(this,"id");j(this,"name");j(this,"from");j(this,"invisible",!1);j(this,"props",{});j(this,"children","");j(this,"slot");j(this,"directives",[]);j(this,"events",{});j(this,"disposed",!1);j(this,"root",null);j(this,"lock",!1);this.schema=e,this.parent=t;const{id:a,name:l,from:n=""}=e;this.id=a||_e(),this.name=l,this.from=n,t&&(this.root=te(t)?t:t.root),this.update(e,!0),Ee.nodes[this.id]=this}update(e,t=!1){Object.assign(this.schema,e);const{children:a,slot:l,props:n,directives:u,events:r}=e;this.invisible=!!e.invisible,this.setChildren(a,t),this.setSlot(l,t),this.props=Fe.parse(n),this.directives=Pe.parse(u),this.events=Ue.parse(r)}dispose(){const{children:e,disposed:t}=this;t||(Array.isArray(e)&&e.forEach(a=>a.dispose()),this.parent&&this.parent.removeChild(this),this.parent=null,this.root=null,this.disposed=!0,delete Ee.nodes[this.id])}toDsl(){const{id:e,name:t,from:a,invisible:l,slot:n,children:u,props:r,directives:i,events:d}=this,p=Array.isArray(u)?u.filter(m=>!m.invisible).map(m=>m.toDsl()):u;return Y(F({},this.schema),{id:e,name:t,from:a,invisible:l,slot:n,children:p,props:Fe.toDsl(r),directives:Pe.toDsl(i),events:Ue.toDsl(d)})}setChildren(e="",t=!1){const{disposed:a}=this;a||(Array.isArray(e)?this.children=e.map(l=>new Ee(l,this)):this.children=e,t||S.emit(J,this))}setSlot(e,t=!1){this.slot=typeof e=="string"?{name:e,params:[]}:e,t||S.emit(J,this)}setProp(e,t){const a=this.props[e];a?a.setValue(t):this.props[e]=new Fe(e,t),S.emit(J,this)}removeProp(e){delete this.props[e],S.emit(J,this)}getPropValue(e){const t=this.props[e];if(t)return t.getValue()}setEvent(e,t){const a=this.events[e];a?a.update(t):this.events[e]=new Ue(e,t),S.emit(J,this)}removeEvent(e){delete this.events[e],S.emit(J,this)}setDirective(e){const t=this.directives.findIndex(a=>a.id===e.id);t>=0?this.directives.splice(t,1,e):this.directives.push(e),S.emit(J,this)}removeDirective(e){const t=this.directives.findIndex(a=>a.id===e.id);t>=0&&this.directives.splice(t,1),S.emit(J,this)}appendChild(e){const{children:t,disposed:a}=this;a||(e.parent=this,e.root=this.root,Array.isArray(t)?t.push(e):this.children=[e],S.emit(J,this))}insertChild(e,t=0){const{children:a,disposed:l}=this;l||(e.parent=this,e.root=this.root,Array.isArray(a)?a.splice(t,0,e):this.children=[e],S.emit(J,this))}removeChild(e){const{children:t,disposed:a}=this;if(a||!Array.isArray(t))return;const l=t.findIndex(n=>n===e);e.parent=null,e.root=null,t.splice(l,1),S.emit(J,this)}insertAfter(e){if(!this.parent)return;const t=this.parent.children;if(Array.isArray(t)){e.parent=this.parent,e.root=this.root;const a=t.indexOf(this);t.splice(a+1,0,e),S.emit(J,this.parent)}}insertBefore(e){if(!this.parent)return;const t=this.parent.children;if(Array.isArray(t)){e.parent=this.parent,e.root=this.root;const a=t.indexOf(this);t.splice(a,0,e),S.emit(J,this.parent)}}moveNext(){const e=this.parent;if(!e)return;const t=e.children;if(Array.isArray(t)){const a=t.indexOf(this);a>-1&&a<t.length-1&&(t.splice(a,1),t.splice(a+1,0,this),S.emit(J,e))}}movePrev(){const e=this.parent;if(!e)return;const t=e.children;if(Array.isArray(t)){const a=t.indexOf(this);a>0&&(t.splice(a,1),t.splice(a-1,0,this),S.emit(J,e))}}copy(){if(!this.parent)return;const e=this.toDsl();delete e.id;const t=new Ee(e);return this.insertAfter(t),t}};j(Ee,"nodes",{});let Me=Ee;const Zt=["name","title","inject","state","lifeCycles","methods","computed","watch","css","props","emits","slots","transform","dataSources"];class ht{constructor(e){j(this,"__VTJ_BLOCK__",!0);j(this,"id");j(this,"name","");j(this,"title","");j(this,"inject",[]);j(this,"state",{});j(this,"lifeCycles",{});j(this,"methods",{});j(this,"computed",{});j(this,"watch",[]);j(this,"css","");j(this,"props",[]);j(this,"emits",[]);j(this,"slots",[]);j(this,"transform",{});j(this,"dataSources",{});j(this,"children",[]);j(this,"lock",!1);j(this,"invisible",!1);j(this,"disposed",!1);j(this,"parent",null);j(this,"root",null);j(this,"runtimeContext");const{id:t}=e;this.id=t||_e(),this.init(e)}init(e){for(const a of Zt){const l=e[a];l&&(this[a]=l)}const{children:t=[]}=e;this.children=t.map(a=>new Me(a,this))}dispose(){this.children.map(e=>e.dispose()),this.runtimeContext=void 0,this.disposed=!0}toDsl(){const{__VTJ_BLOCK__:e,id:t,children:a}=this;return Y(F({},Zt.reduce((l,n)=>(l[n]=this[n],l),{})),{__VTJ_BLOCK__:e,id:t,children:a.map(l=>l.toDsl())})}appendChild(e,t,a){t?a==="left"||a==="top"?t.insertBefore(e):a==="right"||a==="bottom"?t.insertAfter(e):t.appendChild(e):(e.parent=this,e.root=this,this.children.push(e),S.emit(J,this))}removeChild(e){if(e.parent===this){const t=this.children.findIndex(a=>a.id===e.id||a===e);t>-1&&(e.parent=null,e.root=null,this.children.splice(t,1),S.emit(J,this))}else e.parent&&e.parent.removeChild(e)}allowDrop(e,t,a){return B(this,null,function*(){if(te(t))return!0;const l=a.componentMap,n=(yield a.getBlockDescription(t.from))||l[t.name];if(!n||!e)return!0;const{parentIncludes:u=!0,name:r}=e,{childIncludes:i=!0}=n,d=u===!0||Array.isArray(u)&&u.includes(t.name),p=i===!0||Array.isArray(i)&&i.includes(r);return d&&p})}move(e,t,a){this.removeChild(e),te(t)?t.appendChild(e):this.appendChild(e,t,a)}setState(e,t){this.state[e]=t,S.emit(J,this)}removeState(e){delete this.state[e],S.emit(J,this)}setComputed(e,t){this.computed[e]=t,S.emit(J,this)}removeComputed(e){delete this.computed[e],S.emit(J,this)}setMethods(e,t){this.methods[e]=t,S.emit(J,this)}removeMethods(e){delete this.methods[e],S.emit(J,this)}setLifeCycles(e,t){this.lifeCycles[e]=t,S.emit(J,this)}removeLifeCycles(e){delete this.lifeCycles[e],S.emit(J,this)}setWatch(e){e.id=e.id||_e();const t=this.watch.findIndex(a=>a.id&&a.id===e.id||a===e);t>-1?this.watch.splice(t,1,e):this.watch.push(e),S.emit(J,this)}removeWatch(e){const t=this.watch.findIndex(a=>a.id&&a.id===e.id||a===e);t>-1&&(this.watch.splice(t,1),S.emit(J,this))}setCss(e){this.css=e,S.emit(J,this)}setProp(e){const t=this.props.findIndex(a=>typeof a=="string"?a===e.name:a.name===e.name);t>-1?this.props.splice(t,1,e):this.props.push(e),S.emit(J,this)}removeProp(e){const t=this.props.findIndex(a=>typeof a=="string"?a===e.name:a.name===e.name);t>-1&&(this.props.splice(t,1),S.emit(J,this))}setEmit(e){const t=this.emits.findIndex(a=>a===e);t>-1?this.emits.splice(t,1,e):this.emits.push(e),S.emit(J,this)}removeEmit(e){const t=this.emits.findIndex(a=>a===e);t>-1&&(this.emits.splice(t,1),S.emit(J,this))}setSlot(e){const t=this.slots.findIndex(a=>a===e);t>-1?this.slots.splice(t,1,e):this.slots.push(e),S.emit(J,this)}removeSlot(e){const t=this.slots.findIndex(a=>a===e);t>-1&&(this.slots.splice(t,1),S.emit(J,this))}setInject(e){const t=this.inject.findIndex(a=>a.name===e.name);t>-1?this.inject.splice(t,1,e):this.inject.push(e),S.emit(J,this)}removeInject(e){const t=this.inject.findIndex(a=>a.name===e.name);t>-1&&(this.inject.splice(t,1),S.emit(J,this))}setDataSource(e){this.dataSources[e.name]=e,S.emit(J,this)}removeDataSource(e){delete this.dataSources[e],S.emit(J,this)}}class Dn{constructor(e,t=[]){j(this,"__VTJ_PROJECT__",!0);j(this,"id","");j(this,"name","");j(this,"description","");j(this,"homepageId","");j(this,"dependencies",V([]));j(this,"pages",V([]));j(this,"blocks",V([]));j(this,"apis",V([]));j(this,"current",V(null));this.source=t,this.load(e)}load(e){const{id:t,description:a="",name:l="",homepageId:n="",dependencies:u=[],pages:r=[],blocks:i=[],apis:d=[]}=e||{};this.id=t||_e(),this.description=a,this.name=l,this.homepageId=n,this.dependencies.value=this.mergeDeps(u,this.source),this.pages.value=r,this.blocks.value=i,this.apis.value=d}update(e){const t=this.toDsl();Object.assign(t,e),this.load(t),S.emit(ve,t)}activeFile(e){this.current.value=e?new ht(e):null,S.emit(Ti,this.current.value)}mergeDeps(e,t){const a=e.filter(n=>!!n.official),l=e.filter(n=>!n.official);return t.map(n=>{const u=a.find(r=>r.package===n.package);return Object.assign(n,u||{})}).concat(l)}setDeps(e){const t=this.dependencies.value,a=t.findIndex(l=>l.package===e.package);a>-1?t.splice(a,1,F(F({},t[a]),e)):t.push(st(e)),S.emit(ve,this.toDsl())}removeDeps(e){const t=this.dependencies.value,a=t.findIndex(l=>l.package===e.package);a>-1&&(t.splice(a,1),S.emit(ve,this.toDsl()))}toDsl(){const{id:e,description:t,name:a,homepageId:l,dependencies:n,pages:u,blocks:r,apis:i,__VTJ_PROJECT__:d}=this;return{__VTJ_PROJECT__:d,__VTJ_VERSION__:fa,__VTJ_DATE__:Date.now().toString(),id:e,description:t,name:a,homepageId:l,dependencies:o(n),pages:o(u),blocks:o(r),apis:o(i)}}findPage(e){const t=(a,l=[])=>{for(const n of l){if(n.id===a)return n;if(n.children&&n.children.length){const u=t(a,n.children);if(u)return u}}};return t(e,this.pages.value)}getPages(){return Hl(this.pages.value)}getHomePage(){return this.getPages().find(e=>!!e.home)}clearHomePage(){this.getPages().forEach(e=>{e.home=!1})}addPage(e,t){const{name:a,title:l,isDir:n,home:u}=e,r=new ht({name:a,title:l}),i=r.toDsl();if(e.id=i.id,u&&(this.clearHomePage(),e.home=!0),n&&(e.children=[]),t){const d=this.findPage(t);d&&(d.children?d.children.push(e):d.children=[e])}else this.pages.value.push(e);return n||S.emit(Qe,i),S.emit(ve,this.toDsl()),r}updatePage(e,t){if(e.id){const a=this.findPage(e.id);a&&(Object.assign(a,e),a.home&&(this.clearHomePage(),a.home=!0),t&&(t.name=a.name,t.title=a.title,S.emit(jt,t)),S.emit(ve,this.toDsl()))}}copyPage(e,t,a){var d;const l=_e(),n=Y(F({},e),{id:l}),u=Y(F({},t),{id:l}),r=a?((d=this.findPage(a))==null?void 0:d.children)||[]:this.pages.value,i=r.findIndex(p=>p.id===e.id);r.splice(i,0,n),S.emit(Qe,u),S.emit(ve,this.toDsl())}removePage(e){var a;const t=(l,n)=>{const u=n.findIndex(r=>r.id===l);if(u>=0){n.splice(u,1);return}for(const r of n)if(r.children&&r.children.length)return t(l,r.children)};t(e,this.pages.value),((a=this.current.value)==null?void 0:a.id)===e&&(this.current.value=null),S.emit(wt,e),S.emit(ve,this.toDsl())}addBlock(e){const t=new ht(e),a=t.toDsl(),{id:l,name:n,title:u}=a,r={id:l,name:n,title:u};return this.blocks.value.push(r),S.emit(Qe,a),S.emit(ve,this.toDsl()),t}updateBlock(e,t){const{id:a}=e;Object.assign(t,e);const l=this.blocks.value,n=l.findIndex(u=>u.id===a);n>-1&&(l.splice(n,1,e),S.emit(jt,t),S.emit(ve,this.toDsl()))}removeBlock(e){var l;const t=this.blocks.value,a=t.findIndex(n=>n.id===e);a>-1&&(((l=this.current.value)==null?void 0:l.id)===e&&this.activeFile(null),t.splice(a,1),S.emit(wt,e),S.emit(ve,this.toDsl()))}findBlock(e){return this.blocks.value.find(t=>t.id===e)}existBlockName(e){return this.blocks.value.some(t=>t.name===e.name&&t.id!==e.id)}getFile(e){return this.findBlock(e)||this.findPage(e)}isPage(e){return typeof(e==null?void 0:e.isDir)=="boolean"}setApi(e){const t=this.apis.value,a=t.findIndex(l=>l.name===e.name);a>-1?t.splice(a,1,e):t.push(e),S.emit(ve,this.toDsl())}removeApi(e){const t=this.apis.value,a=t.findIndex(l=>l.name===e);a>-1&&(t.splice(a,1),S.emit(ve,this.toDsl()))}}class Tn{constructor(e){j(this,"index",-1);j(this,"list",[]);j(this,"max");j(this,"blockId");const{history:t,max:a=50}=e;this.blockId=t.blockId,this.max=a,this.refresh(t.items||[])}refresh(e){this.index=-1,this.list=pa(e)}go(){const{index:e,list:t}=this;if(e<0)return;--this.index;const a=t[this.index];a&&(S.emit(Ai,a),S.emit(Ae,a))}back(){const{index:e,list:t}=this;if(e>=t.length-1)return;e<0&&(this.index=0),++this.index;const a=t[this.index];a&&(S.emit(Ri,a),S.emit(Ae,a))}push(e){const{max:t,list:a,blockId:l}=this,n={id:_e(),title:new Date().toLocaleString(),block:xe(e)};a.unshift(n),a.length>t&&(this.list=a.splice(t)),this.index=-1,S.emit(Pi,{blockId:l,item:n}),S.emit(et,this.toDsl())}load(e){const t=this.list.findIndex(a=>a.id===e);t>=0&&(this.index=t,S.emit(Ae,this.list[t]))}remove(e){const t=this.list.findIndex(n=>n.id===e),{list:a,blockId:l}=this;if(t>-1){const n=a.splice(t,1);t===this.index?this.index=-1:this.index>=a.length&&(this.index=a.length-1),S.emit(Oi,{blockId:l,item:n[0]}),S.emit(et,this.toDsl())}}toDsl(){const{blockId:e,list:t}=this;return{blockId:e,items:st(t)}}}const In=(s,e)=>new Pe({name:s,value:void 0,iterator:e}),An=(s="modelValue")=>new Pe({name:"vModel",value:void 0,arg:s});function Rn(s){if(!s)return[];const{props:e=[],events:t=[]}=s;if(e.length&&t.length){const a=t.filter(l=>(typeof l=="string"?l:l.name).startsWith("update:")).map(l=>l=typeof l=="string"?l:l.name);return a.length?e.filter(l=>a.some(n=>n.includes(l.name))):[]}return[]}function Pn(s,e){const t=m=>I(()=>s.value&&(s.value.directives||[]).find(f=>f.name===m)||In(m)),a=I(()=>Rn(e.value)),l=()=>I(()=>a.value.map(m=>(s.value.directives||[]).find(f=>f.name==="vModel"&&f.arg==m.name)||An(m.name))),n=t("vIf"),u=t("vShow"),r=t("vBind"),i=t("vFor"),d=l(),p={vIf:n,vShow:u,vBind:r,vFor:i};return{directives:p,vIf:n,vShow:u,vBind:r,vFor:i,vModels:d,onValueChange:(m,f)=>{const b=p[m];f?(b.value.value=f,s.value.setDirective(b.value)):(b.value.value=void 0,s.value.removeDirective(b.value))},onForChange:(m,f)=>{if(m==="value"){f?(i.value.value=f,s.value.setDirective(i.value)):s.value.removeDirective(i.value);return}(m==="item"||m==="index")&&(i.value.iterator=Y(F({},i.value.iterator),{[m]:f||void 0}),s.value.setDirective(i.value))},onModelChange:(m,f)=>{const b=parseInt(m),v=d.value[b];v&&(f?(v.value=f,s.value.setDirective(v)):(v.value=void 0,s.value.removeDirective(v)))}}}function On(s){const e=V(),t=V(),a=V(),l=V(0),n=V(0),u=()=>{const{innerWidth:i,innerHeight:d}=window,{left:p=0,top:m=0,width:f=0,height:b=0}=e.value,v=Math.max((i-f)/2,0),_=Math.max((d-b)/2,0);return{x:v,y:_}},r=i=>{const{innerWidth:d,innerHeight:p}=window,{width:m=0,height:f=0}=t.value.getBoundingClientRect();l.value=Math.max(0,i.x),i.x>d-m&&(l.value=Math.min(i.x,d-m)),n.value=Math.max(0,i.y),i.y>p-f&&(n.value=Math.min(i.y,p-f))};return ae(s,i=>{const d=i==null?void 0:i.panel;if(d){t.value=d,a.value=i==null?void 0:i.header,e.value=d.getBoundingClientRect();const p=u();l.value=p.x,n.value=p.y,Qa(t,{initialValue:u(),handle:a,onMove:m=>{r(m)}})}}),{x:l,y:n}}const Se=O({name:"WidgetRenderer",props:{name:String,type:[String,Object],props:Object,disabled:Boolean,extendProps:Object,order:Number,visible:{type:Boolean,default:!0}},setup(s,{slots:e}){const t=va($t),a=V(s.visible),l=I(()=>s.type&&(t!=null&&t.skeleton)?t==null?void 0:t.skeleton.getComponent(s.type):null);return ae(()=>s.visible,n=>{n&&(a.value=n)},{immediate:!0}),nt(()=>{const n=t==null?void 0:t.skeleton;if(s.name&&n){const u=Sl();n.widgetInstances[s.name]=u==null?void 0:u.refs[s.name]}}),Oe(()=>{const n=t==null?void 0:t.skeleton;s.name&&n&&delete n.widgetInstances[s.name]}),()=>l.value&&!s.disabled&&a.value?ha(l.value,F({ref:s.name,name:s.name,extendProps:s.extendProps,order:s.order,style:{display:s.visible?"":"none"}},s.props)):null}}),Qt=O({__name:"InputSetter",setup(s){return(e,t)=>(c(),y(o(q),Z({clearable:""},e.$attrs),null,16))}}),Yt=O({__name:"SelectSetter",props:{options:{default:()=>[]}},setup(s){const e=s;return(t,a)=>(c(),y(o(at),Xe(Nt(t.$attrs)),{default:h(()=>[(c(!0),w($,null,M(e.options,l=>(c(),y(o(lt),Z({key:l.label},l),null,16))),128))]),_:1},16))}}),Bn="{{",Nn="}}",Fn=O({__name:"ExpressionSetter",props:{modelValue:{default:()=>({type:"JSExpression",value:""})}},emits:["change"],setup(s,{emit:e}){const t=s,{project:a}=K(),l=r=>{var d;const i=(d=a.current.value)==null?void 0:d.runtimeContext;return ge(r,i)},n=V(t.modelValue.value);ae(()=>t.modelValue.value,r=>{n.value=r});const u=r=>{const i={type:"JSExpression",value:r};l(i)&&e("change",i)};return(r,i)=>(c(),y(o(q),{class:"vtj-expression-setter",modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=d=>n.value=d),onChange:u},{prefix:h(()=>[G(W(Bn))]),suffix:h(()=>[G(W(Nn))]),_:1},8,["modelValue"]))}}),de=jl(()=>$a(()=>import("./Editor-c713e86f-05baa21d.js"),["./Editor-c713e86f-05baa21d.js","./monaco-editor-c02ad91d.js","./monaco-editor-9aafa995.css","./@vue-a5b69601.js"],import.meta.url)),Un=R("i",{class:"vtj-icon-more"},null,-1),Ln={key:0,class:"vtj-tabs__check"},Ut=O({__name:"Tabs",props:{items:{default:()=>[]},modelValue:{},more:{},stretch:{type:Boolean},checkable:{type:Boolean}},emits:["update:modelValue","more","tab-remove"],setup(s,{emit:e}){var u,r;const t=s,a=V((r=t.modelValue||((u=t.items[0])==null?void 0:u.name))!=null?r:"");ae(a,()=>{e("update:modelValue",a.value)}),ae(()=>t.modelValue,i=>{a.value=i});const l=i=>{e("more",i)},n=i=>{e("tab-remove",i)};return(i,d)=>(c(),y(fe,Z({class:"vtj-tabs"},i.$attrs),{title:h(()=>[g(o(kt),{type:"card",modelValue:a.value,"onUpdate:modelValue":d[0]||(d[0]=p=>a.value=p),onTabRemove:n,stretch:t.stretch},{default:h(()=>[(c(!0),w($,null,M(t.items,p=>(c(),y(o(Vt),{key:p.name,label:p.label,name:p.name,closable:p.closable,lazy:""},null,8,["label","name","closable"]))),128))]),_:1},8,["modelValue","stretch"])]),tools:h(()=>[t.more?(c(),y(o(Tt),{key:0,"hide-on-click":!1,size:"small",placement:"bottom-end",onCommand:l},{dropdown:h(()=>[g(o(It),null,{default:h(()=>[(c(!0),w($,null,M(t.more,p=>(c(),y(o(At),{key:p.name,command:p},{default:h(()=>[t.checkable?(c(),w("span",Ln,[R("i",{class:Q(`${p.checked?"vtj-icon-check":"none"}`)},null,2)])):E("",!0),G(" "+W(p.label),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:h(()=>[Un]),_:1})):E("",!0)]),default:h(()=>[ne(i.$slots,"default")]),_:3},16))}}),Xt=O({__name:"Icon",props:{icon:{},label:{},active:{type:Boolean,default:!1},open:{type:Boolean,default:!1}},emits:["click"],setup(s,{emit:e}){const t=s,a=I(()=>({"is-active":t.active,"is-open":t.open})),l=()=>{e("click")};return(n,u)=>(c(),y(o(ca),{effect:"dark",placement:"right",content:n.label,"show-after":600},{default:h(()=>[R("div",{class:Q(["vtj-icon",a.value]),onClick:l},[R("i",{class:Q(n.icon)},null,2)],2)]),_:1},8,["content"]))}}),ie=O({__name:"SubPanel",setup(s){return(e,t)=>(c(),y(fe,Z({class:"vtj-sub-panel"},e.$attrs),da({default:h(()=>[ne(e.$slots,"default")]),_:2},[e.$slots.footer?{name:"footer",fn:h(()=>[ne(e.$slots,"footer")]),key:"0"}:void 0]),1040))}}),Jn=["onClick"],$n={class:"vtj-data-item__title"},Mn={class:"vtj-data-item__action"},zn=["onClick"],Hn=["onClick"],Wn={key:0,class:"vtj-data-item__body"},ue=O({__name:"DataItem",props:{title:{default:""},content:{default:""},editable:{type:Boolean,default:!1},removable:{type:Boolean,default:!1},active:{type:Boolean,default:!1},collapsible:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},collapsed:{type:Boolean,default:!1},background:{type:Boolean,default:!0}},emits:["click","remove","edit"],setup(s,{emit:e}){const t=s,a=V(t.collapsed),l=()=>{e("edit")},n=()=>{e("remove")},u=()=>{t.clickable?e("click"):r()},r=()=>{t.collapsible&&(a.value=!a.value)};return(i,d)=>(c(),w("div",{class:Q(["vtj-data-item",{"is-current":t.active}])},[R("div",{class:Q(["vtj-data-item__header",{"is-pointer":t.clickable||t.collapsible,"is-bg":t.background}]),onClick:u},[t.collapsible?(c(),w("i",{key:0,class:Q(["vtj-icon-greater arrow",{open:!a.value}]),onClick:X(r,["stop"])},null,10,Jn)):E("",!0),R("div",$n,[ne(i.$slots,"title",{},()=>[G(W(t.title),1)])]),R("div",Mn,[ne(i.$slots,"action"),t.editable?(c(),w("i",{key:0,class:"vtj-icon-edit",title:"编辑",onClick:X(l,["stop"])},null,8,zn)):E("",!0),t.removable?(c(),w("i",{key:1,class:"vtj-icon-remove",title:"删除",onClick:X(n,["stop"])},null,8,Hn)):E("",!0)])],2),t.content||i.$slots.default?Ce((c(),w("div",Wn,[ne(i.$slots,"default",{},()=>[G(W(t.content),1)])],512)),[[Ie,!a.value]]):E("",!0)],2))}}),Gn={class:"vtj-context-viewer"},qn=["onClick"],Kn=O({__name:"ContextViewer",emits:["pick"],setup(s,{emit:e}){const{copy:t}=oa({}),{project:a}=K(),l=I(()=>{var m;return(m=a.current.value)==null?void 0:m.runtimeContext}),n=["$provider","$apis","$components","context"],u=m=>{const f=m.value,b=ct(f);return b==="Object"||b==="Module"?Object.keys(f||{}).length===0:b==="Array"?f.length===0:!0},r=(m,f="this")=>typeof m=="object"?Array.isArray(m)?m.map((b,v)=>{const _=`[${v}]`;return{label:_,value:b,type:ct(b),path:`${f}${_}`}}):Object.entries(m).map(([b,v])=>({label:b,value:v,type:ct(v),path:`${f}.${b}`})).filter(b=>!b.label.startsWith("__")&&!n.includes(b.label)):[],i=(m,f)=>{if(m.level===0)f(r(l.value));else{const b=st(m.data.value);f(r(b,m.data.path))}},d=m=>{t(m.path),pe.success({message:"已经复制到粘贴板"})},p=m=>{e("pick",m.path)};return(m,f)=>(c(),w("div",Gn,[l.value?(c(),y(o(Rt),{key:0,lazy:"",load:i,"expand-on-click-node":!1,props:{isLeaf:u}},{default:h(({data:b})=>[g(o(ue),{title:b.label,clickable:"",onClick:v=>p(b)},{action:h(()=>[R("i",{class:"vtj-icon-copy",title:"复制",onClick:X(v=>d(b),["stop"])},null,8,qn)]),_:2},1032,["title","onClick"])]),_:1},8,["props"])):E("",!0)]))}}),Zn={key:0,class:"vtj-binder__common"},Qn=["onClick"],Yn={class:"vtj-binder__footer"},it=O({__name:"Binder",props:{clearable:{type:Boolean,default:!0}},emits:["submit","cancel","remove","pick"],setup(s,{expose:e,emit:t}){const a=s,l=[{name:"common",label:"常用"},{name:"viewer",label:"高级"}],n=V("common"),{project:u}=K(),r=V(""),{searchResult:i}=Sn(u.current,r),{copy:d}=oa({}),p=V(),m=()=>{t("submit")},f=()=>{t("cancel"),p.value.close()},b=()=>{t("remove")},v=k=>{t("pick",k)},_=k=>{d(k),pe.success({message:"已经复制到粘贴板"})};return e({close:()=>{p.value.close()}}),(k,x)=>(c(),y(se,{ref_key:"dialogRef",ref:p,"body-padding":!1,width:"1000px",height:"600px"},{default:h(()=>[g(o(yt),{class:"vtj-binder"},{default:h(()=>[g(o(_t),null,{default:h(()=>[g(Ut,{items:l,modelValue:n.value,"onUpdate:modelValue":x[1]||(x[1]=D=>n.value=D)},{default:h(()=>[n.value==="common"?(c(),w("div",Zn,[g(o(q),{modelValue:r.value,"onUpdate:modelValue":x[0]||(x[0]=D=>r.value=D),size:"small",clearable:"","prefix-icon":o(ia),placeholder:"筛选可用项"},null,8,["modelValue","prefix-icon"]),(c(!0),w($,null,M(o(i),D=>(c(),w("div",null,[g(o(Ot),{"border-style":"dotted"},{default:h(()=>[G(W(D.title),1)]),_:2},1024),(c(!0),w($,null,M(D.items,U=>(c(),y(ue,{clickable:"",title:U,onClick:A=>v(U)},{action:h(()=>[R("i",{class:"vtj-icon-copy",title:"复制",onClick:X(A=>_(U),["stop"])},null,8,Qn)]),_:2},1032,["title","onClick"]))),256))]))),256)),o(i).length?E("",!0):(c(),y(o(le),{key:0}))])):E("",!0),n.value==="viewer"?(c(),y(Kn,{key:1,onPick:v})):E("",!0)]),_:1},8,["modelValue"])]),_:1}),g(o(ua),null,{default:h(()=>[g(fe,{title:null},{footer:h(()=>[R("div",Yn,[R("span",null,[a.clearable?(c(),y(o(oe),{key:0,size:"default",type:"warning",onClick:b},{default:h(()=>[G(" 移除绑定 ")]),_:1})):E("",!0)]),R("span",null,[g(o(oe),{size:"default",onClick:f},{default:h(()=>[G("取消")]),_:1}),g(o(oe),{size:"default",type:"primary",onClick:m},{default:h(()=>[G(" 确定 ")]),_:1})])])]),default:h(()=>[ne(k.$slots,"default")]),_:3})]),_:3})]),_:3})]),_:3},512))}}),Xn=O({__name:"VarBinder",props:{value:{default:""},defaults:{default:""},type:{default:"JSExpression"}},emits:["submit"],setup(s,{emit:e}){const t=s,{project:a}=K(),l=V(t.value||t.defaults),n=I(()=>`绑定内容 [ ${t.type} ]`),u=V(),r=V(),i=m=>{var b;const f=(b=a.current.value)==null?void 0:b.runtimeContext;return ge({value:m,type:t.type},f)},d=()=>{const m=u.value.getEditor().getValue().trim();m?i(m)&&(e("submit",{type:t.type,value:m}),r.value.close()):be.warning({message:"请输入绑定内容"})},p=m=>{var f;(f=u.value)!=null&&f.getEditor()&&(l.value=m)};return(m,f)=>(c(),y(it,{ref_key:"binderRef",ref:r,title:"变量绑定",onSubmit:d,onPick:p},{default:h(()=>[g(o(ee),{class:"vtj-var-binder","label-position":"top"},{default:h(()=>[g(o(z),{label:n.value},{default:h(()=>[g(o(de),{ref_key:"editorRef",ref:u,"model-value":l.value,width:"100%",height:"100%",dark:""},null,8,["model-value"])]),_:1},8,["label"])]),_:1})]),_:1},512))}}),es=O({__name:"EventBinder",props:{name:{},event:{},node:{}},emits:["submit","remove"],setup(s,{emit:e}){var b,v,_;const t=s,{assets:a,project:l}=K(),n=V(),u=V(),r=V(Object.keys(((b=t.event)==null?void 0:b.modifiers)||{}));I(()=>{var D;const k=(D=t.node)==null?void 0:D.name;if(!k)return[];const x=a.componentMap[k];if(x&&x.events){const U=x.events.find(A=>A===t.name||A.name===t.name);if(U&&U.params)return U.params||[]}return[]});const i=V(((_=(v=t.event)==null?void 0:v.handler)==null?void 0:_.value)||`() => {\r
\r
}`),d=k=>{var D;const x=(D=l.current.value)==null?void 0:D.runtimeContext;return ge({value:k,type:"JSFunction"},x)},p=()=>{const k=n.value.getEditor().getValue().trim();if(k){if(d(k)){const x={handler:{type:"JSFunction",value:k},modifiers:r.value.reduce((D,U)=>(D[U]=!0,D),{})};e("submit",x),u.value.close()}}else be.warning({message:"请输入绑定内容"})},m=k=>{var x;(x=n.value)!=null&&x.getEditor()&&(i.value=k)},f=()=>{e("remove",t.name)};return(k,x)=>(c(),y(it,{ref_key:"binderRef",ref:u,title:"事件绑定",subtitle:t.name,onSubmit:p,onPick:m,onRemove:f},{default:h(()=>[g(o(ee),{class:"vtj-event-binder","label-position":"top"},{default:h(()=>[g(o(z),{label:"事件修饰符"},{default:h(()=>[g(o(pl),{modelValue:r.value,"onUpdate:modelValue":x[0]||(x[0]=D=>r.value=D)},{default:h(()=>[(c(!0),w($,null,M(o(Rl),D=>(c(),y(o(ml),{key:D,label:D},null,8,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),g(o(z),{label:"事件处理函数"},{default:h(()=>[g(o(de),{ref_key:"editorRef",ref:n,width:"100%",height:"360px",dark:"","model-value":i.value},null,8,["model-value"])]),_:1})]),_:1})]),_:1},8,["subtitle"]))}}),ts=["draggable","onDragstart","onClick","title"],as=["src"],ls={key:1,class:"vtj-components__name"},ns={key:2,class:"vtj-components__footer"},ss=["onClick"],os=["onClick"],Ze=O({__name:"ComponentList",props:{list:{default:()=>[]},span:{default:6},editable:{type:Boolean},removable:{type:Boolean},active:{},type:{}},emits:["edit","remove","click"],setup(s,{emit:e}){const t=s;function a(i,d){return B(this,null,function*(){t.type==="Schema"&&(i.from={type:"Schema",id:i.id}),S.emit(Et,i)})}function l(){S.emit(xt)}function n(i){e("edit",i)}function u(i){e("remove",i)}function r(i){e("click",i)}return(i,d)=>t.list.length?(c(),y(o(hl),{key:0,class:"vtj-components__box",gutter:10},{default:h(()=>[(c(!0),w($,null,M(t.list,p=>(c(),y(o(vl),{span:t.span},{default:h(()=>[R("div",{class:Q(["vtj-components__item",{"is-active":t.active&&t.active(p)}]),draggable:!(t.active&&t.active(p)),onDragstart:m=>a(p),onDragend:l,onClick:m=>r(p),title:p.name},[p.icon?(c(),w("img",{key:0,src:p.icon,alt:""},null,8,as)):(c(),w("span",ls,W(p.name),1)),R("span",null,W(p.title),1),t.editable||t.removable?(c(),w("div",ns,[t.editable?(c(),w("i",{key:0,onClick:X(m=>n(p),["stop"]),class:"vtj-icon-edit"},null,8,ss)):E("",!0),t.removable?(c(),w("i",{key:1,onClick:X(m=>u(p),["stop"]),class:"vtj-icon-remove"},null,8,os)):E("",!0)])):E("",!0)],42,ts)]),_:2},1032,["span"]))),256))]),_:1})):(c(),y(o(le),{key:1,description:"暂无数据","image-size":60}))}}),is={key:0,class:"vtj-list-panel__search"},rs=R("i",{class:"vtj-icon-search"},null,-1),Va=O({__name:"ListPanel",props:{search:{type:[Boolean,Object],default:!1},tabs:{default:void 0},columnWidth:{default:100}},emits:["search-change"],setup(s,{emit:e}){var r,i;const t=s,a=V(null),l=V(6),n=V("");ae(n,()=>{e("search-change",n.value)});const u=V((i=(r=t.tabs)==null?void 0:r[0])==null?void 0:i.name);return sa(a,d=>{const p=d[0],{width:m}=p.contentRect,f=Math.min(Math.floor(m/120),24);l.value=Math.floor(24/f)}),(d,p)=>(c(),y(fe,{class:"vtj-list-panel",ref_key:"panel",ref:a},{default:h(()=>[t.search?(c(),w("div",is,[g(o(q),Z({size:"small"},d.search,{modelValue:n.value,"onUpdate:modelValue":p[0]||(p[0]=m=>n.value=m),clearable:""}),{prefix:h(()=>[rs]),_:1},16,["modelValue"])])):E("",!0),t.search&&n.value?(c(),y(o(kt),{key:1},{default:h(()=>[g(o(Vt),{label:"搜索结果"},{default:h(()=>[ne(d.$slots,"search",{search:n.value,span:l.value})]),_:3})]),_:3})):E("",!0),Ce(g(o(kt),{modelValue:u.value,"onUpdate:modelValue":p[1]||(p[1]=m=>u.value=m),class:"vtj-list-panel__tabs"},{default:h(()=>[(c(!0),w($,null,M(t.tabs,m=>(c(),y(o(Vt),{key:m.name,label:m.label,name:m.name,lazy:""},{default:h(()=>[ne(d.$slots,"tab",{tab:m,span:l.value},()=>[m.component?(c(),y(Bt(m.component),Z({key:0,tab:m.name,currentTab:u.value,search:n.value,span:l.value},m.props),null,16,["tab","currentTab","search","span"])):E("",!0)])]),_:2},1032,["label","name"]))),128))]),_:3},8,["modelValue"]),[[Ie,t.tabs&&!n.value]]),ne(d.$slots,"default",{currentTab:u.value,search:n.value,span:l.value})]),_:3},512))}}),us=O({__name:"JSONSetter",props:{modelValue:{type:[Boolean,String,Number,null,Array,Object],default:void 0}},emits:["change"],setup(s,{emit:e}){const t=s,a=V(),l=V(typeof t.modelValue=="object"?JSON.stringify(t.modelValue,null,2):void 0),n=I(()=>!!l.value),u=V(!1),r=m=>{let f=!0;try{if(typeof JSON.parse(m)!="object")throw new Error(`"${m}" is not a JSON`)}catch(b){f=!1,be.error({title:"代码错误",message:(b==null?void 0:b.message)||b})}return f},i=()=>{var f;const m=(f=a.value)==null?void 0:f.getEditor();if(m){const b=m.getValue();r(b)&&(l.value=b,e("change",JSON.parse(b)),u.value=!1)}},d=()=>{l.value="",e("change",void 0),u.value=!1},p=()=>{u.value=!0};return(m,f)=>(c(),w("div",{class:Q(["vtj-json-setter",{"is-active":n.value}])},[g(o(q),Z({readonly:"",onFocus:p,"model-value":"JSON","suffix-icon":o(ra)},m.$attrs),null,16,["suffix-icon"]),u.value?(c(),y(o(se),{key:0,modelValue:u.value,"onUpdate:modelValue":f[0]||(f[0]=b=>u.value=b),title:"JSON",width:"1000px",height:"600px",cancel:"",submit:"",clear:"",onSubmit:i,onClear:d},{default:h(()=>[g(o(de),{ref_key:"codeEditor",ref:a,height:"100%",lang:"json",dark:"","model-value":l.value},null,8,["model-value"])]),_:1},8,["modelValue"])):E("",!0)],2))}}),cs=O({__name:"FunctionSetter",props:{modelValue:{default:()=>({type:"JSFunction",value:""})}},emits:["change"],setup(s,{emit:e}){const t=s,a=V(),l=V(t.modelValue.value),n=V(!1),u=I(()=>!!l.value),r=()=>{var m;const p=(m=a.value)==null?void 0:m.getEditor();if(p){const f=p.getValue(),b={type:"JSFunction",value:f};ge(b,{})&&(l.value=f,e("change",b),n.value=!1)}},i=()=>{l.value="",e("change",void 0),n.value=!1},d=()=>{n.value=!0};return(p,m)=>(c(),w("div",{class:Q(["vtj-function-setter",{"is-active":u.value}])},[g(o(q),Z({readonly:"",onFocus:d,"model-value":"JSFunction","suffix-icon":o(ra)},p.$attrs),null,16,["suffix-icon"]),n.value?(c(),y(o(se),{key:0,modelValue:n.value,"onUpdate:modelValue":m[0]||(m[0]=f=>n.value=f),title:"JSFunction",width:"1000px",height:"600px",cancel:"",submit:"",clear:"",onSubmit:r,onClear:i},{default:h(()=>[g(o(de),{ref_key:"codeEditor",ref:a,height:"100%","model-value":l.value,dark:""},null,8,["model-value"])]),_:1},8,["modelValue"])):E("",!0)],2))}}),ds=O({__name:"BooleanSetter",setup(s){return(e,t)=>(c(),y(o(we),Z(e.$attrs,{"model-value":!!e.$attrs.modelValue}),null,16,["model-value"]))}}),ps=O({__name:"ColorSetter",setup(s){return(e,t)=>(c(),y(o(bl),Xe(Nt(e.$attrs)),null,16))}}),ms=O({__name:"NumberSetter",props:{modelValue:{}},emits:["change"],setup(s,{emit:e}){const t=s,a=I(()=>me(t.modelValue)?void 0:Number(t.modelValue||0)),l=n=>{e("change",n)};return(n,u)=>(c(),y(o(yl),Z({class:"vtj-number-setter","controls-position":"right","model-value":a.value},n.$attrs,{onChange:l}),null,16,["model-value"]))}}),vs={class:"vtj-icon-setter"},hs={class:"vtj-icon-setter__content"},fs={class:"vtj-icon-setter__list"},ja=O({__name:"IconSetter",props:{modelValue:{default:""}},emits:["change","update:modelValue"],setup(s,{emit:e}){const t=s,a=V(!1),l=V(t.modelValue),n=V(""),u=I(()=>bt[t.modelValue]||t.modelValue),r=I(()=>{const f=Object.entries(bt);return n.value?f.filter(b=>b[0].toLowerCase().includes(n.value)):f}),i=f=>{l.value=f},d=()=>{e("change",l.value),e("update:modelValue",l.value),a.value=!1},p=()=>{l.value="",e("change",""),e("update:modelValue",""),a.value=!1},m=()=>{a.value=!0};return(f,b)=>(c(),w("div",vs,[g(o(q),{size:"small",readonly:"",placeholder:"请选择图标","model-value":t.modelValue,"suffix-icon":o(el),onFocus:m},{prepend:h(()=>[g(o(gt),{icon:u.value},null,8,["icon"])]),_:1},8,["model-value","suffix-icon"]),a.value?(c(),y(o(se),{key:0,title:"图标选择器",width:"1000px",height:"600px",cancel:"",submit:"",clear:"",modelValue:a.value,"onUpdate:modelValue":b[1]||(b[1]=v=>a.value=v),onSubmit:d,onClear:p},{default:h(()=>[R("div",hs,[g(o(q),{size:"small","prefix-icon":o(ia),clearable:"",modelValue:n.value,"onUpdate:modelValue":b[0]||(b[0]=v=>n.value=v),placeholder:"请输入查询关键字"},null,8,["prefix-icon","modelValue"]),R("div",fs,[(c(!0),w($,null,M(r.value,v=>(c(),y(o(gt),{icon:v[1],onClick:_=>i(v[0]),class:Q({"is-active":l.value===v[0]})},null,8,["icon","onClick","class"]))),256)),r.value.length===0?(c(),y(o(le),{key:0})):E("",!0)])])]),_:1},8,["modelValue"])):E("",!0)]))}}),ea={StringSetter:Qt,InputSetter:Qt,SelectSetter:Yt,OptionSetter:Yt,ExpressionSetter:Fn,JSONSetter:us,FunctionSetter:cs,BooleanSetter:ds,ColorSetter:ps,NumberSetter:ms,IconSetter:ja},wa={string:["InputSetter","SelectSetter"],number:["NumberSetter"],boolean:["BooleanSetter"],object:["JSONSetter"],function:["FunctionSetter"],array:["JSONSetter"],JSFunction:["FunctionSetter"],JSExpression:["ExpressionSetter"]},gs={key:1},bs={class:"vtj-setter__content"},ys={key:0,class:"vtj-setter__input"},_s={class:"vtj-setter__action"},ks=R("i",{class:"vtj-icon-switch",title:"切换设置器"},null,-1),Vs={key:0,class:"vtj-icon-check"},js={key:1,class:"vtj-icon-placeholder"},ws="{{",Cs="}}",Ss=O({__name:"SetterView",props:{name:{},label:{default:""},title:{},setters:{},variable:{type:Boolean,default:!0},value:{},options:{default:()=>[]},defaultSetter:{},removable:{type:Boolean}},emits:["change","remove"],setup(s,{emit:e}){const t=s,a=V(!1),l=V(""),n=V(t.setters.find(k=>k.name===t.defaultSetter)||t.setters[0]),u=V(t.value),r=I(()=>!!me(u.value)),i={[n.value.name]:u.value},d=k=>{var x;i[n.value.name]=u.value,n.value=k,u.value=(x=i[k.name])!=null?x:void 0,p(u.value)};ae(()=>t.value,()=>{u.value=t.value}),ae(()=>t.defaultSetter,()=>{n.value=t.setters.find(k=>k.name===t.defaultSetter)||t.setters[0]});const p=k=>{e("change",k)},m=()=>{e("remove",t.name)},f=()=>{a.value=!0,l.value=me(u.value)?u.value.value:""},b=()=>{a.value=!1,l.value=""},v=k=>{i[n.value.name]=u.value,u.value=k,e("change",k),b()},_=()=>{b(),u.value=void 0,e("change","")};return(k,x)=>(c(),y(o(z),{class:"vtj-setter",size:"small","label-positon":"left"},{label:h(()=>[t.title?(c(),y(o(ca),{key:0,placement:"top-start",content:t.title},{default:h(()=>[G(W(t.label||t.name),1)]),_:1},8,["content"])):(c(),w("span",gs,W(t.label||t.name),1))]),default:h(()=>[R("div",bs,[n.value?(c(),w("div",ys,[r.value?E("",!0):(c(),y(Bt(n.value.component),Z({key:0},n.value.props,{options:t.options,modelValue:u.value,"onUpdate:modelValue":x[0]||(x[0]=D=>u.value=D),onChange:p,disabled:r.value}),null,16,["options","modelValue","disabled"])),r.value?(c(),y(o(q),{key:1,class:"vtj-expression-setter",disabled:"","model-value":"JSExpression"},{prefix:h(()=>[G(W(ws))]),suffix:h(()=>[G(W(Cs))]),_:1})):E("",!0)])):E("",!0),R("div",_s,[t.variable?(c(),w("i",{key:0,onClick:f,class:Q(["vtj-icon-vars",{"is-active":r.value}]),title:"绑定变量"},null,2)):E("",!0),t.setters.length>1?(c(),y(o(Tt),{key:1,disabled:r.value,size:"small","popper-class":"vtj-setter-switch",onCommand:d},{dropdown:h(()=>[g(o(It),null,{default:h(()=>[(c(!0),w($,null,M(t.setters,D=>(c(),y(o(At),{command:D,key:D.name},{default:h(()=>[D.name==n.value.name?(c(),w("i",Vs)):(c(),w("i",js)),G(" "+W(D.label),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:h(()=>[ks]),_:1},8,["disabled"])):E("",!0),t.removable?(c(),w("i",{key:2,onClick:m,class:"vtj-icon-remove",title:"删除"})):E("",!0)])]),a.value?(c(),y(Xn,{key:0,type:"JSExpression",value:l.value,modelValue:a.value,"onUpdate:modelValue":x[1]||(x[1]=D=>a.value=D),onSubmit:v,onRemove:_},null,8,["value","modelValue"])):E("",!0)]),_:1}))}}),ye=O({name:"SetterRenderer",props:{name:String,label:String,title:String,value:{type:[String,Object,Array,Number,Boolean],default:void 0},setters:{type:[String,Object,Array],required:!0,default(){return[]}},options:{type:Array,default(){return[]}},variable:{type:Boolean,default:!0},removable:{type:Boolean,default:!1}},computed:{computedSetters(){return(Array.isArray(this.setters)?this.setters:[this.setters]).map(s=>{let e;if(typeof s=="string")return e=this.getComopnent(s),{component:Ye(e),name:s,label:s,props:{}};{const t=s;return e=t.component||this.getComopnent(t.name),{component:Ye(e),name:t.name,label:t.label||t.name,props:t.props}}})},computedOptions(){return(this.options||[]).map(s=>typeof s=="string"?{label:s,value:s}:s)},defaultSetter(){var l,n;const{value:s,computedSetters:e}=this;let t=typeof s;t==="object"&&(Array.isArray(s)?t="array":me(s)?t="JSExpression":ot(s)&&(t="JSFunction"));const a=wa[t]||[];return a.length?(l=e.find(u=>a.includes(u.name))||e[0])==null?void 0:l.name:(n=e[0])==null?void 0:n.name}},render(){const{name:s,label:e,title:t,value:a,computedSetters:l,computedOptions:n,variable:u,changeValue:r,defaultSetter:i,removable:d,onRemove:p}=this;return ha(Ss,{name:s,label:e,title:t,setters:l,defaultSetter:i,variable:u,value:a,removable:d,options:n,onChange:r,onRemove:p})},emits:["change","remove"],methods:{getComopnent(s){return typeof s=="string"?ea[s]||ea.InputSetter:s},changeValue(s){this.$emit("change",this.name,s)},onRemove(s){this.$emit("remove",s)}}}),Es={class:"vtj-action"},xs=O({__name:"action",setup(s){const{regions:e}=K(),t=I(()=>e.value.action);return(a,l)=>(c(),w("div",Es,[(c(!0),w($,null,M(t.value,n=>(c(),y(o(Se),Z({key:n.name},F({},n)),null,16))),128))]))}}),Ds=(s,e)=>{const t=s.__vccOpts||s;for(const[a,l]of e)t[a]=l;return t},Ts={};function Is(s,e){return c(),w("div",null,"Empty")}const As=Ds(Ts,[["render",Is]]),Rs=["title","src"],Ps={key:1},Os=O({__name:"Logo",props:{icon:{},text:{default:"Vtj"},link:{}},setup(s,{expose:e}){const t=s,a=()=>{t.link&&(location.href=t.link)};return e({props:t}),(l,n)=>(c(),w("div",{class:"vtj-logo",onClick:a},[t.icon?(c(),w("img",{key:0,title:t.text,class:"vtj-logo__icon",src:t.icon},null,8,Rs)):(c(),w("span",Ps,W(t.text),1))]))}}),Bs=R("div",null,"多个资源可换行输入",-1),Ns=O({__name:"Dependencies",setup(s){const{project:e}=K(),t=[{name:"add",icon:"vtj-icon-plus"}],a={package:{required:!0,message:"包名不能为空"},version:{required:!0,message:"版本不能为空"},library:{required:!0,message:"导出变量名称不能为空"},urls:{required:!0,message:"资源URL不能为空"}},l=V(),n=V(),u=V(!1),r=V(!1),i=I(()=>e.dependencies.value),d=v=>{e.setDeps(v)},p=()=>{u.value=!0,r.value=!1,l.value={package:"",version:"",library:"",urls:"",assetsUrl:"",assetsLibrary:""}},m=v=>{u.value=!0,r.value=!0,l.value={package:v.package,version:v.version,library:v.library,urls:v.urls.join(`
`),assetsUrl:v.assetsUrl||"",assetsLibrary:v.assetsLibrary||""}},f=v=>{re.confirm("确定删除该依赖项？","提示",{type:"warning"}).then(()=>{e.removeDeps(v)})},b=()=>{n.value.validate(v=>{var T,C;if(!v)return;const{version:_,library:k,urls:x,assetsUrl:D,assetsLibrary:U}=l.value;if(!((T=l.value)!=null&&T.package))return;const A={package:(C=l.value)==null?void 0:C.package,version:_,library:k,urls:x.trim().split(`
`),assetsUrl:D,assetsLibrary:U};e.dependencies.value.find(N=>N.package===A.package)&&!r.value?pe.warning({message:"已存在相同名称的依赖包"}):(e.setDeps(st(A)),u.value=!1)})};return(v,_)=>(c(),y(fe,{class:"vtj-deps",title:"依赖管理",tools:t,onToolClick:p},{default:h(()=>[(c(!0),w($,null,M(i.value,k=>(c(),y(ue,{key:k.package,removable:!k.official,editable:!k.official,class:Q({"vtj-deps__disabled":!k.enabled}),onEdit:x=>m(k),onRemove:x=>f(k)},{action:h(()=>[!k.required&&k.official?(c(),y(o(we),{key:0,size:"small",modelValue:k.enabled,"onUpdate:modelValue":x=>k.enabled=x,onChange:x=>d(k)},null,8,["modelValue","onUpdate:modelValue","onChange"])):E("",!0)]),title:h(()=>[G(W(k.package)+"@"+W(k.version),1)]),_:2},1032,["removable","editable","class","onEdit","onRemove"]))),128)),u.value?(c(),y(se,{key:0,modelValue:u.value,"onUpdate:modelValue":_[6]||(_[6]=k=>u.value=k),title:`${r.value?"编辑":"新增"}依赖`,width:"1000px",height:"500px",submit:"",cancel:"",onSubmit:b},{default:h(()=>[l.value?(c(),y(o(ee),{key:0,ref_key:"form",ref:n,size:"small","label-width":"80px",model:l.value,rules:a},{default:h(()=>[g(o(z),{label:"npm包名",prop:"package"},{default:h(()=>[g(o(q),{modelValue:l.value.package,"onUpdate:modelValue":_[0]||(_[0]=k=>l.value.package=k),modelModifiers:{trim:!0},readonly:r.value,disabled:r.value},null,8,["modelValue","readonly","disabled"])]),_:1}),g(o(z),{label:"版本号",prop:"version"},{default:h(()=>[g(o(q),{modelValue:l.value.version,"onUpdate:modelValue":_[1]||(_[1]=k=>l.value.version=k),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),g(o(z),{label:"导出名称",prop:"library"},{default:h(()=>[g(o(q),{modelValue:l.value.library,"onUpdate:modelValue":_[2]||(_[2]=k=>l.value.library=k),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),g(o(z),{label:"资源URL",prop:"urls"},{default:h(()=>[g(o(q),{type:"textarea",rows:5,modelValue:l.value.urls,"onUpdate:modelValue":_[3]||(_[3]=k=>l.value.urls=k)},null,8,["modelValue"]),Bs]),_:1}),g(o(z),{label:"资产URL",prop:"assetsUrl"},{default:h(()=>[g(o(q),{modelValue:l.value.assetsUrl,"onUpdate:modelValue":_[4]||(_[4]=k=>l.value.assetsUrl=k),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),g(o(z),{label:"资产名称",prop:"assetsLibrary"},{default:h(()=>[g(o(q),{modelValue:l.value.assetsLibrary,"onUpdate:modelValue":_[5]||(_[5]=k=>l.value.assetsLibrary=k),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])):E("",!0)]),_:1},8,["modelValue","title"])):E("",!0)]),_:1}))}}),Fs=O({__name:"Viewport",props:{mode:{default:"pc"},width:{},height:{}},setup(s){const e=s,t={width:390,height:844},a={width:1180,height:820},l=I(()=>[`is-${e.mode}`]),n=I(()=>{if(e.mode==="pc")return 1;const r=e.mode==="mobile"?t:a,{width:i,height:d}=r,p=i>0?(e.width||0)/i:1,m=d>0?(e.height||0)/d:1;return Math.min(p,m)}),u=I(()=>{if(e.mode==="pc")return{};const r=e.mode==="mobile"?t:a,{width:i,height:d}=r;return{width:`${i}px`,height:`${d}px`,left:"50%",top:"50%",transform:`translate(-50%, -50%) scale(${n.value})`}});return(r,i)=>(c(),w("div",{class:Q(["vtj-viewport",l.value]),style:qe(u.value)},[ne(r.$slots,"default")],6))}}),Us={class:"vtj-actions__layers"},Ls=R("i",{class:"vtj-icon-layers"},null,-1),Js={key:0,class:"vtj-actions__tools"},$s=O({__name:"Actions",props:{position:{default:"left-top"},node:{},title:{default:""},path:{default:()=>[]}},emits:["action"],setup(s,{emit:e}){const t=s,a=I(()=>te(t.node)),l=I(()=>t.path);function n(f){return te(f)?"Block":"Node"}function u(){if(t.node.lock){pe.warning({message:"该节点已被锁定，不能删除"});return}re.confirm("确定删除吗？","提示",{type:"warning"}).then(()=>{t.node.dispose(),He(()=>{e("action",{type:"remove"})})})}function r(){t.node.moveNext(),He(()=>{e("action",{type:"move",next:!0,node:t.node})})}function i(){t.node.movePrev(),He(()=>{e("action",{type:"move",prev:!0,node:t.node})})}function d(){const f=t.node.copy();He(()=>{e("action",{type:"copy",node:f})})}function p(f){e("action",{type:"hover",node:f})}function m(f){e("action",{type:"selected",node:f})}return(f,b)=>(c(),w("div",{class:Q(["vtj-actions",[`is-${t.position}`]])},[R("div",Us,[g(o(Tt),{size:"small",onCommand:m},{dropdown:h(()=>[l.value&&l.value.length?(c(),y(o(It),{key:0},{default:h(()=>[(c(!0),w($,null,M(l.value,v=>(c(),y(o(At),{key:v.id,command:v,onMouseenter:_=>p(v)},{default:h(()=>[G(W(v.name)+" ",1),R("i",{class:Q(`is-${n(v)}`)},W(n(v)),3)]),_:2},1032,["command","onMouseenter"]))),128))]),_:1})):E("",!0)]),default:h(()=>[R("div",null,[Ls,G(W(t.title),1)])]),_:1})]),a.value?E("",!0):(c(),w("div",Js,[R("i",{class:"vtj-icon-arrow-up",title:"向前移动",onClick:i}),R("i",{class:"vtj-icon-arrow-down",title:"向后移动",onClick:r}),R("i",{onClick:d,class:"vtj-icon-copy",title:"复制"}),R("i",{onClick:u,class:"vtj-icon-remove",title:"删除"})]))],2))}}),Ms={key:1,class:"vtj-designer__placeholder"},zs=O({__name:"Designer",setup(s,{expose:e}){const{engine:t}=K(),a=V(),l=V(),n=V({width:0,height:0});sa(l,x=>{const D=x[0];n.value=D.contentRect});const u=new pr(t,a,_n),{hover:r,dropping:i,selected:d,onAction:p,viewportMode:m}=he(u),f=t.project.current,b=I(()=>{var x;return((x=f.value)==null?void 0:x.children.length)===0}),v=I(()=>{var x;return te((x=r.value)==null?void 0:x.node)}),_=I(()=>{var x;return te((x=d.value)==null?void 0:x.node)}),k=I(()=>{var U;const{width:x=0,height:D=0}=((U=d.value)==null?void 0:U.rect)||{};return x>0||D>0});return e({designer:u,selected:d}),(x,D)=>(c(),w("div",{ref_key:"container",ref:l,class:"vtj-designer"},[Ce(g(Fs,{mode:o(m),width:n.value.width,height:n.value.height},{default:h(()=>[R("iframe",{ref_key:"iframe",ref:a,frameborder:"0"},null,512),o(i)?(c(),w("div",{key:0,class:Q(["vtj-designer__dropping","is-inner"]),style:qe(o(i).style)},null,4)):E("",!0),o(r)?(c(),w("div",{key:1,class:"vtj-designer__hover",style:qe(o(r).style)},[Ce(R("span",{class:Q(["vtj-designer__hover-title",`is-${o(r).position}`])},[G(W(o(r).node.name)+": ",1),R("i",null,W(o(r).node.id),1)],2),[[Ie,!v.value]])],4)):E("",!0),o(d)?Ce((c(),w("div",{key:2,class:"vtj-designer__selected",style:qe(o(d).style)},[_.value?E("",!0):(c(),y($s,{key:0,title:o(d).node.name,node:o(d).node,path:o(d).path,position:o(d).position,onAction:o(p)},null,8,["title","node","path","position","onAction"]))],4)),[[Ie,k.value]]):E("",!0)]),_:1},8,["mode","width","height"]),[[Ie,o(f)]]),o(f)?E("",!0):(c(),y(o(le),{key:0,description:"请在文档管理器新建或打开文件"})),b.value?(c(),w("div",Ms," 您可以拖拽组件放置到这里 ")):E("",!0)],512))}}),Hs=O({__name:"Components",setup(s){const e={placeholder:"搜索组件"},{engine:t}=K(),{componentGroups:a,components:l}=t.assets||{},n=I(()=>{const f={};return a&&a.forEach(b=>{f[b.name]=b}),f}),u=I(()=>a?a.map(f=>{var b;return{label:`${f.label} (${f.count})`,name:f.name,disabled:!((b=f.children)!=null&&b.length)}}):[]),r=(f=[])=>f.map((b,v)=>v),i=ke({});Ft(()=>{const f=u.value.reduce((b,v)=>(b[v.name]=r(n.value[v.name].children),b),{});Object.assign(i,f)});const{searchKey:d,searchResult:p}=sn(l),m=f=>{d.value=f};return(f,b)=>(c(),y(Va,{class:"vtj-components",title:"组件库",search:e,tabs:u.value,onSearchChange:m},{search:h(({span:v})=>[g(Ze,{list:o(p),span:v},null,8,["list","span"])]),tab:h(({tab:v,span:_})=>{var k,x;return[n.value[v.name].components?(c(),y(Ze,{key:0,list:n.value[v.name].components,span:_},null,8,["list","span"])):E("",!0),(k=n.value[v.name].children)!=null&&k.length?(c(),y(o(nl),{key:1,modelValue:i[v.name],"onUpdate:modelValue":D=>i[v.name]=D},{default:h(()=>[(c(!0),w($,null,M(n.value[v.name].children,(D,U)=>(c(),y(o(sl),{key:D.name,title:`${D.label} (${D.count})`,name:U},{default:h(()=>[g(Ze,{list:D.components,span:_},null,8,["list","span"])]),_:2},1032,["title","name"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):E("",!0),!n.value[v.name].components&&((x=n.value[v.name].children)==null?void 0:x.length)===0?(c(),y(o(le),{key:2,description:"暂无数据"})):E("",!0)]}),default:h(()=>[!o(a)||o(a).length===0?(c(),y(o(le),{key:0,description:"暂无数据"})):E("",!0)]),_:1},8,["tabs"]))}}),Ws=["onClick"],Gs=["onClick"],qs={class:"vtj-pages__name"},Ks={key:0,class:"vtj-pages__home"},Zs=O({__name:"Pages",setup(s){const{project:e,engine:t}=K(),a=[{name:"add",icon:"vtj-icon-plus"}],l={name:[{required:!0,message:"名称为必填项"}],title:[{required:!0,message:"标题为必填项"}]},n=I(()=>e.pages.value),u=T=>{var C;return T===((C=e.current.value)==null?void 0:C.id)},r={id:"",name:"",title:"",isDir:!1,icon:"",mask:!0,home:!1,hidden:!1},i=V(),d=V(!1),p=V(),m=V(),f=T=>B(this,null,function*(){if(T.isDir)return;const C=T.id,N=yield t.service.getFile(C);e.activeFile(N)}),b=()=>{m.value=void 0,i.value=F({},r),d.value=!0},v=T=>{m.value=T.id,i.value=F({},r),d.value=!0},_=T=>{i.value=F({},T),d.value=!0},k=(T,C)=>B(this,null,function*(){var H;const N=T.id,P=(H=C.parent)==null?void 0:H.data.id,L=yield t.service.getFile(N);e.copyPage(T,L,P)}),x=T=>B(this,null,function*(){if(T.id){if(T.children&&T.children.length>0){pe.warning({message:"该目录有子页面文件，不能删除。"});return}(yield re.confirm("确定删除？","提示",{type:"warning"}).catch(C=>!1))&&e.removePage(T.id)}}),D=()=>B(this,null,function*(){if(yield p.value.validate().catch(T=>!1)){if(i.value.id){const T=i.value.isDir?void 0:yield t.service.getFile(i.value.id);e.updatePage(i.value,T)}else{const T=e.addPage(i.value,m.value);!e.current.value&&!i.value.isDir&&e.activeFile(T.toDsl())}d.value=!1}}),U=(T,C,N)=>N==="inner"?!!C.data.isDir:!0,A=()=>{e.update({pages:n.value})};return(T,C)=>(c(),y(o(fe),{title:"页面管理",tools:a,onToolClick:b},{default:h(()=>[n.value.length===0?(c(),y(o(le),{key:0,description:"您还没创建文件"})):E("",!0),n.value.length?(c(),y(o(Rt),{key:1,"node-key":"id","default-expand-all":!0,data:n.value,draggable:"","allow-drop":U,onNodeDrop:A,class:"vtj-pages-items"},{default:h(({node:N,data:P})=>[g(o(ue),{title:P.title,active:u(P.id),onClick:L=>f(P),onEdit:L=>_(P),onRemove:L=>x(P),clickable:!P.isDir,editable:"",removable:""},{action:h(()=>[P.isDir?(c(),w("i",{key:0,onClick:X(L=>v(P),["stop"]),class:"vtj-icon-plus",title:"新增"},null,8,Ws)):E("",!0),P.isDir?E("",!0):(c(),w("i",{key:1,onClick:X(L=>k(P,N),["stop"]),class:"vtj-icon-copy",title:"复制"},null,8,Gs))]),title:h(()=>[g(o(gt),{icon:o(bt)[P.icon]||P.icon},null,8,["icon"]),G(" "+W(P.title)+" ",1),R("i",qs,W(P.name),1),P.home?(c(),w("span",Ks,"首页 ")):E("",!0)]),_:2},1032,["title","active","onClick","onEdit","onRemove","clickable"])]),_:1},8,["data"])):E("",!0),d.value?(c(),y(o(se),{key:2,modelValue:d.value,"onUpdate:modelValue":C[7]||(C[7]=N=>d.value=N),width:"600px",title:i.value.id?"修改页面":"新增页面",submit:"",cancel:"",onSubmit:D},{default:h(()=>[g(o(ee),{ref_key:"formRef",ref:p,model:i.value,rules:l,size:"small","label-position":"right","label-width":"80px"},{default:h(()=>[g(o(z),{label:"类型",prop:"isDir"},{default:h(()=>[g(o(Pt),{modelValue:i.value.isDir,"onUpdate:modelValue":C[0]||(C[0]=N=>i.value.isDir=N),disabled:!!i.value.id},{default:h(()=>[g(o(Ne),{label:!1},{default:h(()=>[G("页面")]),_:1}),g(o(Ne),{label:!0},{default:h(()=>[G("目录")]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),g(o(z),{label:"标题描述",prop:"title"},{default:h(()=>[g(o(q),{modelValue:i.value.title,"onUpdate:modelValue":C[1]||(C[1]=N=>i.value.title=N)},null,8,["modelValue"])]),_:1}),g(o(z),{label:"名称编码",prop:"name"},{default:h(()=>[g(o(q),{modelValue:i.value.name,"onUpdate:modelValue":C[2]||(C[2]=N=>i.value.name=N)},null,8,["modelValue"])]),_:1}),g(o(z),{label:"菜单图标",prop:"icon"},{default:h(()=>[g(ja,{modelValue:i.value.icon,"onUpdate:modelValue":C[3]||(C[3]=N=>i.value.icon=N)},null,8,["modelValue"])]),_:1}),i.value.isDir?E("",!0):(c(),y(o(z),{key:0,label:"包含母版",prop:"mask"},{default:h(()=>[g(o(we),{modelValue:i.value.mask,"onUpdate:modelValue":C[4]||(C[4]=N=>i.value.mask=N)},null,8,["modelValue"])]),_:1})),i.value.isDir?E("",!0):(c(),y(o(z),{key:1,label:"站点首页",prop:"mask"},{default:h(()=>[g(o(we),{modelValue:i.value.home,"onUpdate:modelValue":C[5]||(C[5]=N=>i.value.home=N)},null,8,["modelValue"])]),_:1})),i.value.isDir?E("",!0):(c(),y(o(z),{key:2,label:"隐藏菜单",prop:"mask"},{default:h(()=>[g(o(we),{modelValue:i.value.hidden,"onUpdate:modelValue":C[6]||(C[6]=N=>i.value.hidden=N)},null,8,["modelValue"])]),_:1}))]),_:1},8,["model"])]),_:1},8,["modelValue","title"])):E("",!0)]),_:1}))}}),Qs=O({__name:"Blocks",setup(s){const{project:e,engine:t}=K(),a=[{name:"add",icon:"vtj-icon-plus"}],l={id:"",name:"",title:""},n={name:[{required:!0,message:"请输入组件名称",trigger:"blur"}],title:[{required:!0,message:"请输入标题备注",trigger:"blur"}]},u=V(),r=V(),i=I(()=>e.blocks.value),d=V(!1),p=k=>{var x;return k.id===((x=e.current.value)==null?void 0:x.id)},m=()=>{r.value=F({},l),d.value=!0},f=()=>B(this,null,function*(){if(yield u.value.validate().catch(k=>!1)){if(e.existBlockName(r.value)){pe.warning({message:"已存在相同名称的区块，请更换名称"});return}if(r.value.id){const k=yield t.service.getFile(r.value.id);e.updateBlock(r.value,k)}else e.addBlock(r.value);d.value=!1}}),b=k=>{r.value=k,d.value=!0},v=k=>B(this,null,function*(){(yield re.confirm("确定删除？","提示",{type:"warning"}))&&e.removeBlock(k.id)}),_=k=>B(this,null,function*(){const x=k.id,D=yield t.service.getFile(x);e.activeFile(D)});return(k,x)=>(c(),y(o(Va),{title:"区块管理",tools:a,onToolClick:m},{default:h(({span:D})=>[g(o(Ze),{list:i.value,span:D,active:p,type:"Schema",editable:"",removable:"",onEdit:b,onRemove:v,onClick:_},null,8,["list","span"]),d.value?(c(),y(o(se),{key:0,modelValue:d.value,"onUpdate:modelValue":x[2]||(x[2]=U=>d.value=U),title:r.value.id?"修改":"新增",width:"500px",submit:"",cancel:"",onSubmit:f},{default:h(()=>[g(o(ee),{ref_key:"formRef",ref:u,size:"small",model:r.value,rules:n},{default:h(()=>[g(o(z),{label:"组件名称",prop:"name"},{default:h(()=>[g(o(q),{modelValue:r.value.name,"onUpdate:modelValue":x[0]||(x[0]=U=>r.value.name=U)},null,8,["modelValue"])]),_:1}),g(o(z),{label:"标题备注",prop:"title"},{default:h(()=>[g(o(q),{modelValue:r.value.title,"onUpdate:modelValue":x[1]||(x[1]=U=>r.value.title=U)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])):E("",!0)]),_:1}))}}),Ys=R("i",{class:"vtj-icon-pc"},null,-1),Xs=R("i",{class:"vtj-icon-phone"},null,-1),eo=R("i",{class:"vtj-icon-pad"},null,-1),to=R("i",{class:"vtj-icon-undo"},null,-1),ao=R("i",{class:"vtj-icon-redo"},null,-1),lo=O({__name:"Toolbar",setup(s){const{engine:e}=K(),t=V("pc"),a=I(()=>{const{index:i=0,list:d=[]}=e.simulator.history.value||{};return i<d.length-1}),l=I(()=>{const{index:i=0,list:d=[]}=e.simulator.history.value||{};return i>0}),n=()=>{var i;(i=e.simulator.history.value)==null||i.back()},u=()=>{var i;(i=e.simulator.history.value)==null||i.go()},r=i=>{S.emit(Sa,i)};return(i,d)=>(c(),w("div",null,[g(o(Pt),{size:"small",modelValue:t.value,"onUpdate:modelValue":d[0]||(d[0]=p=>t.value=p),onChange:r},{default:h(()=>[g(o(Ne),{label:"pc"},{default:h(()=>[Ys]),_:1}),g(o(Ne),{label:"mobile"},{default:h(()=>[Xs]),_:1}),g(o(Ne),{label:"pad"},{default:h(()=>[eo]),_:1})]),_:1},8,["modelValue"]),E("",!0),g(o(ol),null,{default:h(()=>[g(o(oe),{type:"default",size:"small",onClick:n,disabled:!a.value},{default:h(()=>[to]),_:1},8,["disabled"]),g(o(oe),{type:"default",size:"small",onClick:u,disabled:!l.value},{default:h(()=>[ao]),_:1},8,["disabled"])]),_:1})]))}}),no={key:0,class:"vtj-outline__actions"},so=["onClick"],oo=["onClick"],io=["onClick"],ro=["onClick"],uo=["onClick"],co=["onClick"],po={class:"vtj-outline__status"},mo={key:0,class:"vtj-icon-invisible",title:"不可见"},vo={key:1,class:"vtj-icon-lock",title:"已锁定"},ho=O({__name:"Outline",setup(s){const{engine:e,project:t,assets:a}=K(),l=I(()=>{var A;return(A=e.skeleton.widgetInstances.designer)==null?void 0:A.designer}),n=I(()=>{var A,T;return(T=(A=l.value.selected)==null?void 0:A.value)==null?void 0:T.node.id}),u=A=>A.root===null,r=V([]);function i(A){return te(A)?"Block":A.slot&&A.slot.name?`#${A.slot.name}`:"Node"}function d(A){const T=[];return A.forEach(C=>{const N={id:C.id,label:C.name,nodeType:i(C),node:C,children:[]};Array.isArray(C.children)&&(N.children=d(C.children)),T.push(N)}),T}function p(){r.value=t.current.value?d([t.current.value]):[]}ae(t.current,p,{immediate:!0}),S.on(J,p),Oe(()=>{S.off(J,p)});const m=(A,T,C)=>B(this,null,function*(){const N=A.data,P=T.data.node,L=t.current.value;if(!L||!l.value||!P)return;const H=N.node;H.slot=yield l.value.getDropSlot(C==="inner"?P:P.parent);const ce={before:"left",after:"right"}[C]||"inner";L.move(H,P,ce),S.emit(Te,H)}),f=A=>{const T=A.data;return te(T.node)||T.node.lock?!1:T.node.name!=="template"},b=(A,T,C)=>{const N=A.data,P=T.data;if(P.node.lock||te(P.node)&&["prev","next"].includes(C))return!1;const L=t.current.value;if(!L)return!1;const H=a.componentMap[N.node.name];if(C==="inner")return L.allowDrop(H,P.node,a);{const ce=P.node.parent;return ce&&L.allowDrop(H,ce,a)}},v=(A,T)=>{A.invisible=T,S.emit(J,A),S.emit(Te,A)},_=(A,T)=>{A.lock=T,S.emit(J,A),S.emit(Te,A)},k=A=>{const T=A==null?void 0:A.node;!T||T.invisible||S.emit(Lt,T)},x=A=>{var N,P,L;const T=(N=A.target)==null?void 0:N.__vueParentComponent;if(!T)return;const C=(L=(P=T.ctx)==null?void 0:P.node)==null?void 0:L.data;C&&(C.node.invisible||S.emit(Jt,C.node))},D=A=>{A.copy(),S.emit(Te,A)},U=A=>{re.confirm("确定删除吗？","提示",{type:"warning"}).then(()=>{A.dispose(),S.emit(Te,A)})};return(A,T)=>(c(),y(fe,{title:"大纲树",class:"vtj-outline"},{default:h(()=>[g(o(Rt),{data:r.value,"node-key":"id","default-expand-all":"",draggable:"","empty-text":"请新建或打开文件","current-node-key":n.value,"highlight-current":!0,"expand-on-click-node":!1,"allow-drop":b,"allow-drag":f,onCurrentChange:k,onNodeDrop:m,onMouseover:x},{default:h(({data:C})=>[(c(),w("div",{key:C.node.id,class:"vtj-outline__item"},[R("span",null,[G(W(C.label)+": ",1),R("i",{class:Q(`is-${C.nodeType}`)},W(C.nodeType),3)]),u(C.node)?E("",!0):(c(),w("span",no,[C.node.lock?E("",!0):(c(),w("i",{key:0,onClick:X(N=>_(C.node,!0),["stop"]),class:"vtj-icon-lock",title:"锁定"},null,8,so)),C.node.lock?(c(),w("i",{key:1,onClick:X(N=>_(C.node,!1),["stop"]),class:"vtj-icon-unlock",title:"解锁"},null,8,oo)):E("",!0),!C.node.invisible&&!C.node.lock?(c(),w("i",{key:2,onClick:X(N=>v(C.node,!0),["stop"]),class:"vtj-icon-invisible",title:"设置隐藏"},null,8,io)):E("",!0),C.node.invisible&&!C.node.lock?(c(),w("i",{key:3,onClick:X(N=>v(C.node,!1),["stop"]),class:"vtj-icon-visible",title:"设置显示"},null,8,ro)):E("",!0),C.node.root!==C.node&&!C.node.lock?(c(),w("i",{key:4,onClick:N=>D(C.node),class:"vtj-icon-copy",title:"复制"},null,8,uo)):E("",!0),C.node.root!==C.node&&!C.node.lock?(c(),w("i",{key:5,onClick:X(N=>U(C.node),["stop"]),class:"vtj-icon-remove",title:"删除"},null,8,co)):E("",!0)])),R("span",po,[C.node.invisible?(c(),w("i",mo)):E("",!0),C.node.lock?(c(),w("i",vo)):E("",!0)])]))]),_:1},8,["data","current-node-key"])]),_:1}))}}),fo={class:"vtj-setting-panel"},go=O({__name:"Properties",setup(s){const{assets:e}=K(),{selected:t}=he(),a=I(()=>{var D;return(D=t.value)==null?void 0:D.node}),{commonProps:l,componentProps:n,onChange:u,isExist:r,addCustom:i,customProps:d,removeProp:p}=En(a,e),m=[{name:"add",icon:"vtj-icon-plus"}],f={name:[{required:!0,message:"熟悉名称为必填项"}]},b=ke({name:""}),v=V(!1),_=D=>{v.value=!0,b.name=""},k=()=>{const D=Object.keys(a.value.props);b.name&&!r(b.name)&&!D.includes(b.name)?(i(b.name),v.value=!1):be.warning({message:"已存在该属性名称"})},x=D=>B(this,null,function*(){(yield re.confirm("确定删除?","提示",{type:"warning"}).catch(U=>!1))&&p(D)});return(D,U)=>(c(),w("div",fo,[g(o(ie),{title:"通用属性"},{default:h(()=>[g(o(ee),{size:"small","label-width":"100px",onKeydown:U[0]||(U[0]=Ke(X(()=>{},["prevent","stop"]),["enter"]))},{default:h(()=>[(c(!0),w($,null,M(o(l),A=>(c(),y(o(ye),Z({key:`${A.name}_${a.value.id}`},A,{onChange:o(u)}),null,16,["onChange"]))),128))]),_:1})]),_:1}),o(n).length?(c(),y(o(ie),{key:0,title:"组件属性"},{default:h(()=>[g(o(ee),{size:"small","label-width":"100px",onKeydown:U[1]||(U[1]=Ke(X(()=>{},["prevent","stop"]),["enter"]))},{default:h(()=>[(c(!0),w($,null,M(o(n),A=>(c(),y(o(ye),Z({key:`${A.name}_${a.value.id}`},A,{onChange:o(u)}),null,16,["onChange"]))),128))]),_:1})]),_:1})):E("",!0),g(o(ie),{title:"自定义属性",tools:m,onToolClick:_},{default:h(()=>[g(o(ee),{size:"small","label-width":"100px",onKeydown:U[2]||(U[2]=Ke(X(()=>{},["prevent","stop"]),["enter"]))},{default:h(()=>[(c(!0),w($,null,M(o(d),A=>(c(),y(o(ye),Z({key:`${A.name}_${a.value.id}`},A,{removable:"",onChange:o(u),onRemove:x}),null,16,["onChange"]))),128))]),_:1})]),_:1}),g(o(se),{modelValue:v.value,"onUpdate:modelValue":U[4]||(U[4]=A=>v.value=A),title:"新增属性",width:"400px",submit:"",cancel:"",onSubmit:k},{default:h(()=>[g(o(ee),{ref:"formRef",size:"small",rules:f,model:b},{default:h(()=>[g(o(z),{label:"属性名称",prop:"name"},{default:h(()=>[g(o(q),{modelValue:b.name,"onUpdate:modelValue":U[3]||(U[3]=A=>b.name=A)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]))}}),bo={class:"vtj-setting-panel vtj-events"},yo=O({__name:"Events",setup(s){const{assets:e}=K(),{selected:t}=he(),a=I(()=>{var b;return(b=t.value)==null?void 0:b.node}),{mouseEventList:l,keyboardEventList:n,componentEventList:u}=xn(a,e),r=V(!1),i=V(),d=V(Symbol()),p=b=>{d.value=Symbol(),i.value=b,r.value=!0},m=b=>{i.value&&a.value.setEvent(i.value.name,b)},f=b=>B(this,null,function*(){(yield re.confirm("确定删除事件绑定？","提示",{type:"warning"}).catch(v=>!1))&&(a.value.removeEvent(b),i.value=null,r.value=!1)});return(b,v)=>(c(),w("div",bo,[g(o(ie),{title:"组件事件"},{default:h(()=>[(c(!0),w($,null,M(o(u),_=>(c(),y(o(ue),{title:_.name,active:!!_.event,removable:!!_.event,background:!1,editable:"",clickable:"",onClick:k=>p(_),onEdit:k=>p(_),onRemove:k=>f(_.name)},null,8,["title","active","removable","onClick","onEdit","onRemove"]))),256)),o(u).length===0?(c(),y(o(le),{key:0,"image-size":50,description:"该组件无自带事件"})):E("",!0)]),_:1}),g(o(ie),{title:"鼠标事件"},{default:h(()=>[(c(!0),w($,null,M(o(l),_=>(c(),y(o(ue),{title:_.name,active:!!_.event,removable:!!_.event,background:!1,editable:"",clickable:"",onClick:k=>p(_),onEdit:k=>p(_),onRemove:k=>f(_.name)},null,8,["title","active","removable","onClick","onEdit","onRemove"]))),256))]),_:1}),g(o(ie),{title:"键盘事件"},{default:h(()=>[(c(!0),w($,null,M(o(n),_=>(c(),y(o(ue),{title:_.name,active:!!_.event,removable:!!_.event,background:!1,editable:"",clickable:"",onClick:k=>p(_),onEdit:k=>p(_),onRemove:k=>f(_.name)},null,8,["title","active","removable","onClick","onEdit","onRemove"]))),256))]),_:1}),i.value?(c(),y(o(es),Z({key:d.value,modelValue:r.value,"onUpdate:modelValue":v[0]||(v[0]=_=>r.value=_),node:a.value},i.value,{onSubmit:m,onRemove:f}),null,16,["modelValue","node"])):E("",!0)]))}}),_o=O({__name:"JSDataDialog",props:Vn,setup(s){const e=s,{title:t,model:a,formRef:l,dialogRef:n,editorRef:u,rules:r,onSubmit:i,disabled:d}=jn(e),p=m=>{a.value.value=m};return(m,f)=>(c(),y(o(it),Z({ref_key:"dialogRef",ref:n,title:o(t),width:"1000px",height:"600px",clearable:!1},m.$attrs,{onSubmit:o(i),onPick:p}),{default:h(()=>[g(o(ee),{ref_key:"formRef",ref:l,size:"small","label-position":"top",model:o(a),rules:o(r)},{default:h(()=>[g(o(z),{label:e.nameLabel,prop:"name"},{default:h(()=>[m.type==="lifeCycles"?(c(),y(o(at),{key:0,modelValue:o(a).name,"onUpdate:modelValue":f[0]||(f[0]=b=>o(a).name=b),disabled:o(d)},{default:h(()=>[(c(!0),w($,null,M(o(Dl),b=>(c(),y(o(lt),{label:b,value:b},null,8,["label","value"]))),256))]),_:1},8,["modelValue","disabled"])):(c(),y(o(q),{key:1,modelValue:o(a).name,"onUpdate:modelValue":f[1]||(f[1]=b=>o(a).name=b),disabled:o(d)},null,8,["modelValue","disabled"]))]),_:1},8,["label"]),g(o(z),{label:e.valueLabel},{default:h(()=>[g(o(de),{ref_key:"editorRef",ref:u,border:!0,height:"380px",width:"100%",dark:"","model-value":o(a).value.value},null,8,["model-value"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},16,["title","onSubmit"]))}}),ko=O({__name:"WatchDataDialog",props:wn,setup(s){const e=s,{title:t,model:a,onSubmit:l,dialogRef:n,sourceRef:u,handlerRef:r,formRef:i}=Cn(e),d=p=>{a.handler.value=p};return(p,m)=>(c(),y(o(it),Z({ref_key:"dialogRef",ref:n,title:o(t),width:"1000px",height:"600px",clearable:!1},p.$attrs,{onSubmit:o(l),onPick:d}),{default:h(()=>[g(o(ee),{ref_key:"formRef",ref:i,size:"small","label-position":"top"},{default:h(()=>[g(o(z),{label:"侦听源 [ JSFunction ]",prop:"source"},{default:h(()=>[g(o(de),{ref_key:"sourceRef",ref:u,border:!0,height:"100px",width:"100%",dark:"","model-value":o(a).source.value},null,8,["model-value"])]),_:1}),g(o(z),{label:"deep",prop:"deep"},{default:h(()=>[g(o(we),{modelValue:o(a).deep,"onUpdate:modelValue":m[0]||(m[0]=f=>o(a).deep=f)},null,8,["modelValue"])]),_:1}),g(o(z),{label:"immediate",prop:"immediate"},{default:h(()=>[g(o(we),{modelValue:o(a).immediate,"onUpdate:modelValue":m[1]||(m[1]=f=>o(a).immediate=f)},null,8,["modelValue"])]),_:1}),g(o(z),{label:"处理函数 [ JSFunction ]",prop:"handler"},{default:h(()=>[g(o(de),{ref_key:"handlerRef",ref:r,border:!0,height:"180px",width:"100%",dark:"","model-value":o(a).handler.value},null,8,["model-value"])]),_:1})]),_:1},512)]),_:1},16,["title","onSubmit"]))}}),Be=O({__name:"BlockScriptGroup",props:{block:{},type:{},dataType:{},title:{},nameLabel:{},valueLabel:{},defaults:{}},setup(s){const e=s,t=I(()=>e.block),a=[{name:"add",icon:"vtj-icon-plus"}],{data:l,list:n,onAdd:u,onEdit:r,onRemove:i,visible:d,keyRef:p}=kn(t,e.type);return(m,f)=>(c(),y(o(ie),{title:e.title,tools:a,onToolClick:o(u)},{default:h(()=>[g(o(ee),{size:"small","label-width":"100px",onKeydown:f[0]||(f[0]=Ke(X(()=>{},["prevent","stop"]),["enter"]))},{default:h(()=>[(c(!0),w($,null,M(o(n),b=>(c(),y(o(ue),{title:b.title,background:!1,editable:"",clickable:"",removable:"",onClick:v=>o(r)(b.model),onEdit:v=>o(r)(b.model),onRemove:v=>o(i)(b.model)},null,8,["title","onClick","onEdit","onRemove"]))),256)),o(n).length?E("",!0):(c(),y(o(le),{key:0,"image-size":40}))]),_:1}),o(d)&&e.type!=="watch"?(c(),y(_o,{key:o(p),block:t.value,data:o(l),title:e.title,type:e.type,nameLabel:e.nameLabel,valueLabel:e.valueLabel,dataType:e.dataType,defaults:e.defaults,modelValue:o(d),"onUpdate:modelValue":f[1]||(f[1]=b=>Wt(d)?d.value=b:null)},null,8,["block","data","title","type","nameLabel","valueLabel","dataType","defaults","modelValue"])):E("",!0),o(d)&&e.type==="watch"?(c(),y(ko,{key:o(p),block:t.value,data:o(l),modelValue:o(d),"onUpdate:modelValue":f[2]||(f[2]=b=>Wt(d)?d.value=b:null)},null,8,["block","data","modelValue"])):E("",!0)]),_:1},8,["title","onToolClick"]))}}),Vo={class:"vtj-setting-panel"},jo=O({__name:"BlockScript",setup(s){const{selected:e}=he(),t=I(()=>{var a;return(a=e.value)==null?void 0:a.node});return(a,l)=>(c(),w("div",Vo,[g(Be,{title:"状态数据",type:"state",block:t.value,nameLabel:"状态数据名称",valueLabel:"状态初始值 [ JSExpression ]","data-type":"JSExpression",defaults:"null"},null,8,["block"]),g(Be,{title:"计算属性",type:"computed",block:t.value,nameLabel:"计算属性名称",valueLabel:"计算函数 [ JSFunction ]","data-type":"JSFunction",defaults:"() => { }"},null,8,["block"]),g(Be,{title:"组件方法",type:"methods",block:t.value,nameLabel:"方法名称",valueLabel:"方法函数 [ JSFunction ]","data-type":"JSFunction",defaults:"() => { }"},null,8,["block"]),g(Be,{title:"生命周期",type:"lifeCycles",block:t.value,nameLabel:"名称",valueLabel:"函数 [ JSFunction ]","data-type":"JSFunction",defaults:"() => { }"},null,8,["block"]),g(Be,{title:"Watch",type:"watch","data-type":"JSFunction",block:t.value},null,8,["block"])]))}}),wo=O({__name:"Css",setup(s){const{selected:e}=he(),t=I(()=>{var u;return(u=e.value)==null?void 0:u.node}),a=[{name:"save",icon:"vtj-icon-np-save"}],l=V(),n=(u=!1)=>{var i;const r=(i=l.value)==null?void 0:i.getEditor().getValue();r!==t.value.css&&(t.value.setCss(r),u&&pe.success({message:"保存成功"}))};return(u,r)=>(c(),y(o(fe),{class:"vtj-setting-css",title:null,"body-padding":!1},{default:h(()=>[t.value?(c(),y(o(ie),{key:0,title:"CSS",tools:a,onToolClick:r[0]||(r[0]=i=>n(!0))},{default:h(()=>[g(o(de),{ref_key:"editorRef",ref:l,height:"100%",lang:"css",dark:"","model-value":t.value.css,onBlur:n},null,8,["model-value"])]),_:1})):E("",!0)]),_:1}))}}),Co={class:"vtj-schema"},So=O({__name:"Schema",setup(s){const{project:e,emitter:t}=K(),a=V(""),l=V(),n=[{name:"save",icon:"vtj-icon-np-save"}],u=()=>{e.current.value?a.value=JSON.stringify(e.current.value.toDsl(),null,2):a.value=""},r=()=>B(this,null,function*(){if(!e.current.value)return;const i=l.value.getEditor().getValue();if(i){if(!(yield re.confirm("手动修改DSL有风险，可能导致页面无法加载，请确认您的操作无误。","提示",{type:"warning"}).catch(d=>!1)))return;try{const d=JSON.parse(i);e.activeFile(d),t.emit(J,e.current.value),pe.success({message:"修改成功"})}catch(d){be.warning({message:d.message,title:"代码错误"})}}});return t.on(J,u),ae(e.current,u),nt(()=>{u()}),Oe(()=>{t.off(J,u)}),(i,d)=>(c(),w("div",Co,[g(o(ie),{class:"vtj-schema__panel",subtitle:"手动修改DSL有风险，可能导致页面无法加载，请确认您的操作无误。","body-padding":!1,tools:n,onToolClick:r},{default:h(()=>[g(o(de),{ref_key:"editorRef",ref:l,height:"100%",lang:"json",dark:"","model-value":a.value},null,8,["model-value"])]),_:1})]))}}),Eo=R("i",{class:"vtj-icon-refresh"},null,-1),xo=R("i",{class:"vtj-icon-setting"},null,-1),Do=R("i",{class:"vtj-icon-outline"},null,-1),To=O({__name:"Actions",props:{coder:{type:Boolean,default:!1},copy:{type:Boolean,default:!1}},setup(s){const e=s,{project:t,engine:a,emitter:l}=K(),n=V(!1),u=V(!1),r=()=>{var v;if(t.current.value){const{designer:_}=he();_.selected.value=null,(v=a.simulator.renderer)==null||v.render(t.current.value)}else pe.warning({message:"请先打开文件"})},i=()=>{var _;const v=(_=t.current.value)==null?void 0:_.id;if(v){const k=t.getFile(v);l.emit(xa,k)}else pe.warning({message:"请先打开文件"})},d=()=>{if(t.current.value){const{designer:v}=he();v.setSelected(t.current.value);const _=Je(a.skeleton.regionInstances.setting);_&&_.change(0)}else pe.warning({message:"请先打开文件"})},p=()=>{t.current.value?Je(a.skeleton.regionInstances.apps).setCurrentWidget("outline"):pe.warning({message:"请先打开文件"})},m=()=>{l.emit(Ta,n)},f=()=>{l.emit(Ia,u)},b=()=>{const v=t.getHomePage();if(!v){pe.warning({message:"请先设置项目首页"});return}l.emit(Da,v)};return(v,_)=>(c(),w("div",null,[g(o(oe),{onClick:r,type:"default",size:"small",title:"刷新"},{default:h(()=>[Eo]),_:1}),g(o(oe),{type:"default",size:"small",title:"页面设置",onClick:d},{default:h(()=>[xo]),_:1}),g(o(oe),{type:"default",size:"small",title:"页面大纲树",onClick:p},{default:h(()=>[Do]),_:1}),g(o(Ot),{direction:"vertical"}),g(o(oe),{type:"primary",size:"small",icon:o(Ya),onClick:b},{default:h(()=>[G(" 浏览 ")]),_:1},8,["icon"]),g(o(oe),{type:"success",size:"small",onClick:i},{default:h(()=>[G("预览")]),_:1}),e.coder?(c(),y(o(oe),{key:0,type:"warning",size:"small",onClick:m,loading:n.value},{default:h(()=>[G(" 出码 ")]),_:1},8,["loading"])):E("",!0),e.copy?(c(),y(o(oe),{key:1,type:"danger",size:"small",onClick:f,loading:u.value},{default:h(()=>[G(" 复制 ")]),_:1},8,["loading"])):E("",!0)]))}}),Io={class:"vtj-setting-panel vtj-directives"},Ao=O({__name:"Directives",setup(s){const{assets:e}=K(),{selected:t}=he(),a=I(()=>{var v;return(v=t.value)==null?void 0:v.node}),l=I(()=>e.componentMap[a.value.name]),n=v=>v.arg?typeof v.arg=="string"?v.arg:Re(v.arg,{}):"modelValue",{vIf:u,vShow:r,vBind:i,vFor:d,vModels:p,onValueChange:m,onForChange:f,onModelChange:b}=Pn(a,l);return(v,_)=>(c(),w("div",Io,[g(o(ie),{title:"内置指令"},{default:h(()=>[g(o(ee),{"label-width":"80px"},{default:h(()=>[g(o(ye),{name:"vIf",label:"v-if",setters:"ExpressionSetter",value:o(u).value,onChange:o(m)},null,8,["value","onChange"]),g(o(ye),{name:"vShow",label:"v-show",value:o(r).value,setters:"ExpressionSetter",onChange:o(m)},null,8,["value","onChange"]),g(o(ye),{name:"vBind",label:"v-bind",setters:"ExpressionSetter",value:o(i).value,onChange:o(m)},null,8,["value","onChange"])]),_:1})]),_:1}),g(o(ie),{title:"循环"},{default:h(()=>[g(o(ee),{"label-width":"80px"},{default:h(()=>{var k,x;return[g(o(ye),{name:"value",label:"循环数据",setters:"ExpressionSetter",value:o(d).value,onChange:o(f)},null,8,["value","onChange"]),g(o(ye),{name:"item",label:"迭代变量名",setters:{name:"InputSetter",props:{placeholder:"item"}},value:(k=o(d).iterator)==null?void 0:k.item,onChange:o(f)},null,8,["value","onChange"]),g(o(ye),{name:"index",label:"索引变量名",setters:{name:"InputSetter",props:{placeholder:"index"}},value:(x=o(d).iterator)==null?void 0:x.index,onChange:o(f)},null,8,["value","onChange"])]}),_:1})]),_:1}),o(p).length?(c(),y(o(ie),{key:0,title:"双向绑定"},{default:h(()=>[(c(!0),w($,null,M(o(p),(k,x)=>(c(),y(o(ue),{title:`v-model: ${n(k)}`},{default:h(()=>[g(o(ee),{"label-width":"80px"},{default:h(()=>[g(o(ye),{name:x.toString(),label:"绑定变量",value:k.value,setters:"ExpressionSetter",onChange:o(b)},null,8,["name","value","onChange"])]),_:2},1024)]),_:2},1032,["title"]))),256))]),_:1})):E("",!0)]))}}),Ro=O({__name:"BlockDefineProps",props:{formData:{},block:{}},setup(s){const e=s,t=I(()=>e.formData?"编辑属性":"新增属性"),a={name:[{required:!0,message:"属性名称为必填项"}]},l=V(),n=V(),u=V(),r=ke(e.formData||{name:"",type:"",required:!1,default:{type:"JSExpression",value:""}}),i=()=>B(this,null,function*(){if(yield l.value.validate().catch(d=>!1)){const d=u.value.getEditor().getValue();r.default.value=d,ge(r.default,{})&&(e.block.setProp(Je(r)),n.value.close())}});return(d,p)=>(c(),y(o(se),{ref_key:"dialogRef",ref:n,title:t.value,width:"1000px",height:"600px",submit:"",cancel:"",onSubmit:i},{default:h(()=>[g(o(ee),{ref_key:"formRef",ref:l,model:r,rules:a,size:"small","label-position":"top",class:"vtj-block-props__form"},{default:h(()=>[g(o(z),{label:"属性名称",prop:"name"},{default:h(()=>[g(o(q),{modelValue:r.name,"onUpdate:modelValue":p[0]||(p[0]=m=>r.name=m),disabled:!!e.formData},null,8,["modelValue","disabled"])]),_:1}),g(o(z),{label:"数据类型",prop:"type"},{default:h(()=>[g(o(at),{modelValue:r.type,"onUpdate:modelValue":p[1]||(p[1]=m=>r.type=m),multiple:""},{default:h(()=>[(c(!0),w($,null,M(o(Pl),m=>(c(),y(o(lt),{value:m,label:m},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1}),g(o(z),{label:"是否必须",prop:"required"},{default:h(()=>[g(o(we),{modelValue:r.required,"onUpdate:modelValue":p[2]||(p[2]=m=>r.required=m)},null,8,["modelValue"])]),_:1}),g(o(z),{label:"默认值 [ JSExpression ]",prop:"default"},{default:h(()=>[g(o(de),{ref_key:"editorRef",ref:u,height:"250px","model-value":r.default.value||"",border:"",dark:""},null,8,["model-value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"]))}}),Po=O({__name:"BlockDefineEmits",props:{block:{},formData:{}},setup(s){const e=s,t=ke(e.formData||{name:""}),a={name:[{required:!0,message:"事件名称为必填项"}]},l=V(),n=V(),u=()=>B(this,null,function*(){(yield n.value.validate().catch(r=>!1))&&(e.block.setEmit(t.name),l.value.close())});return(r,i)=>(c(),y(o(se),{ref_key:"dialogRef",ref:l,title:"新增事件",width:"400px",height:"150px",submit:"",cancel:"",onSubmit:u},{default:h(()=>[g(o(ee),{ref_key:"formRef",ref:n,model:t,rules:a,size:"small"},{default:h(()=>[g(o(z),{label:"事件名称",prop:"name"},{default:h(()=>[g(o(q),{modelValue:t.name,"onUpdate:modelValue":i[0]||(i[0]=d=>t.name=d)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},512))}}),Oo=O({__name:"BlockDefineSlots",props:{block:{},formData:{}},setup(s){const e=s,t=ke(e.formData||{name:""}),a={name:[{required:!0,message:"插槽名称为必填项"}]},l=V(),n=V(),u=()=>B(this,null,function*(){(yield n.value.validate().catch(r=>!1))&&(e.block.setSlot(t.name),l.value.close())});return(r,i)=>(c(),y(o(se),{ref_key:"dialogRef",ref:l,title:"新增插槽",width:"400px",height:"150px",submit:"",cancel:"",onSubmit:u},{default:h(()=>[g(o(ee),{ref_key:"formRef",ref:n,model:t,rules:a,size:"small"},{default:h(()=>[g(o(z),{label:"插槽名称",prop:"name"},{default:h(()=>[g(o(q),{modelValue:t.name,"onUpdate:modelValue":i[0]||(i[0]=d=>t.name=d)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},512))}}),Bo=O({__name:"BlockInject",props:{block:{},formData:{}},setup(s){const e=s,t=I(()=>e.formData?"编辑注入":"新增注入"),a=ke(e.formData||{name:"",from:"",default:{type:"JSExpression",value:""}}),l={name:[{required:!0,message:"注入名称为必填项"}]},n=V(),u=V(),r=V(),i=()=>B(this,null,function*(){if(yield r.value.validate().catch(d=>!1)){const d=u.value.getEditor().getValue();a.default.value=d,ge(a.default,{})&&(e.block.setInject(Je(a)),n.value.close())}});return(d,p)=>(c(),y(o(se),{ref_key:"dialogRef",ref:n,title:t.value,width:"1000px",height:"600px",submit:"",cancel:"",onSubmit:i},{default:h(()=>[g(o(ee),{ref_key:"formRef",ref:r,model:a,rules:l,size:"small","label-position":"top"},{default:h(()=>[g(o(z),{label:"注入名称",prop:"name"},{default:h(()=>[g(o(q),{modelValue:a.name,"onUpdate:modelValue":p[0]||(p[0]=m=>a.name=m),disabled:!!e.formData},null,8,["modelValue","disabled"])]),_:1}),g(o(z),{label:"来源名称",prop:"from"},{default:h(()=>[typeof a.from=="string"?(c(),y(o(q),{key:0,modelValue:a.from,"onUpdate:modelValue":p[1]||(p[1]=m=>a.from=m)},null,8,["modelValue"])):E("",!0)]),_:1}),g(o(z),{label:"默认值",prop:"from"},{default:h(()=>[g(o(de),{ref_key:"editorRef",ref:u,"model-value":a.default.value||"",dark:"",border:"",height:"300px"},null,8,["model-value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"]))}}),No={key:0,class:"vtj-setting-panel vtj-advanced"},Fo=O({__name:"Advanced",setup(s){const{selected:e}=he(),t=I(()=>{var L;const P=(L=e.value)==null?void 0:L.node;return te(P)?P:null}),a=[{name:"add",icon:"vtj-icon-plus"}],l=I(()=>{var P;return t.value?(P=t.value.props)==null?void 0:P.map(L=>typeof L=="string"?{name:L,required:!1,type:void 0,default:{type:"JSExpression",value:""}}:F({default:{type:"JSExpression",value:""},required:!1,type:void 0},L)):[]}),n=I(()=>{var P;return((P=t.value)==null?void 0:P.emits)||[]}),u=I(()=>{var P;return((P=t.value)==null?void 0:P.slots)||[]}),r=I(()=>{var P;return t.value?(P=t.value.inject)==null?void 0:P.map(L=>F({from:"",default:{type:"JSExpression",value:""}},L)):[]}),i=V(!1),d=V(),p=V(!1),m=V(!1),f=V(),b=V(),v=()=>{d.value=void 0,i.value=!0},_=P=>{d.value=P,i.value=!0},k=P=>B(this,null,function*(){var L;(yield re.confirm("确定删除","提示",{type:"warning"}).catch(H=>!1))&&((L=t.value)==null||L.removeProp(P))}),x=()=>{p.value=!0},D=P=>B(this,null,function*(){var L;(yield re.confirm("确定删除","提示",{type:"warning"}).catch(H=>!1))&&((L=t.value)==null||L.removeEmit(P))}),U=()=>{m.value=!0},A=P=>B(this,null,function*(){var L;(yield re.confirm("确定删除","提示",{type:"warning"}).catch(H=>!1))&&((L=t.value)==null||L.removeSlot(P))}),T=()=>{b.value=void 0,f.value=!0},C=P=>B(this,null,function*(){var L;(yield re.confirm("确定删除","提示",{type:"warning"}).catch(H=>!1))&&((L=t.value)==null||L.removeInject(P))}),N=P=>B(this,null,function*(){b.value=P,f.value=!0});return(P,L)=>t.value?(c(),w("div",No,[g(o(ie),{title:"属性",tools:a,onToolClick:v},{default:h(()=>[(c(!0),w($,null,M(l.value,H=>(c(),y(o(ue),{title:H.name,editable:"",removable:"",clickable:"",onRemove:ce=>k(H),onClick:ce=>_(H),onEdit:ce=>_(H)},null,8,["title","onRemove","onClick","onEdit"]))),256)),l.value.length===0?(c(),y(o(le),{key:0,"image-size":50})):E("",!0),i.value?(c(),y(Ro,{key:1,block:t.value,"form-data":d.value,modelValue:i.value,"onUpdate:modelValue":L[0]||(L[0]=H=>i.value=H)},null,8,["block","form-data","modelValue"])):E("",!0)]),_:1}),g(o(ie),{title:"事件",tools:a,onToolClick:x},{default:h(()=>[(c(!0),w($,null,M(n.value,H=>(c(),y(o(ue),{title:H,removable:"",onRemove:ce=>D(H)},null,8,["title","onRemove"]))),256)),n.value.length===0?(c(),y(o(le),{key:0,"image-size":50})):E("",!0),p.value?(c(),y(Po,{key:1,modelValue:p.value,"onUpdate:modelValue":L[1]||(L[1]=H=>p.value=H),block:t.value},null,8,["modelValue","block"])):E("",!0)]),_:1}),g(o(ie),{title:"插槽",tools:a,onToolClick:U},{default:h(()=>[(c(!0),w($,null,M(u.value,H=>(c(),y(o(ue),{title:H,removable:"",onRemove:ce=>A(H)},null,8,["title","onRemove"]))),256)),u.value.length===0?(c(),y(o(le),{key:0,"image-size":50})):E("",!0),m.value?(c(),y(Oo,{key:1,modelValue:m.value,"onUpdate:modelValue":L[2]||(L[2]=H=>m.value=H),block:t.value},null,8,["modelValue","block"])):E("",!0)]),_:1}),g(o(ie),{title:"注入",tools:a,onToolClick:T},{default:h(()=>[(c(!0),w($,null,M(r.value,H=>(c(),y(o(ue),{title:H.name,editable:"",removable:"",clickable:"",onRemove:ce=>C(H),onClick:ce=>N(H),onEdit:ce=>N(H)},null,8,["title","onRemove","onClick","onEdit"]))),256)),r.value.length===0?(c(),y(o(le),{key:0,"image-size":50})):E("",!0),f.value?(c(),y(Bo,{key:1,modelValue:f.value,"onUpdate:modelValue":L[3]||(L[3]=H=>f.value=H),"form-data":b.value,block:t.value},null,8,["modelValue","form-data","block"])):E("",!0)]),_:1})])):E("",!0)}}),Uo={class:"vtj-switcher"},Lo=R("i",{class:"vtj-icon-back vtj-switcher__back"},null,-1),Jo={key:1},$o=O({__name:"Switcher",props:{link:{}},setup(s){const e=s,{project:t}=K(),a=I(()=>{var n;return(n=t.current.value)==null?void 0:n.title}),l=()=>{e.link&&(location.href=e.link)};return(n,u)=>(c(),w("div",Uo,[g(o(oe),{size:"small",round:"",onClick:l},{default:h(()=>[Lo,R("span",null,W(o(t).name),1),a.value?(c(),y(o(Ot),{key:0,direction:"vertical"})):E("",!0),a.value?(c(),w("span",Jo,W(a.value),1)):E("",!0)]),_:1})]))}}),Mo=["src"],zo=O({__name:"Docs",props:{url:{default:"https://element-plus.org/zh-CN/"}},setup(s){const e=s,t=V();let a=null;nt(()=>{var n;a||(a=il.service({target:(n=t.value)==null?void 0:n.$el}))}),Oe(()=>{a.close(),a=null});const l=()=>{a.close()};return(n,u)=>(c(),y(fe,{ref_key:"panel",ref:t,title:null,class:"vtj-docs","body-padding":!1},{default:h(()=>[R("iframe",{ref:"frame",src:e.url,onLoad:l},null,40,Mo)]),_:1},512))}}),Ho=O({__name:"ApiDialogForm",props:{model:{},project:{}},setup(s){const e=s,t={name:"",title:"",url:"",method:"GET",settings:{type:"JSExpression",value:""}},a=V(xe(e.model||F({},t))),l=V(),n=V(),u=V(),r={name:[{required:!0,message:"接口名称为必填项"}],title:[{required:!0,message:"标题描述为必填项"}],url:[{required:!0,message:"请求地址为必填项"}]},i=I(()=>e.model?"编辑Api":"新增Api"),d=()=>B(this,null,function*(){if(yield l.value.validate().catch(p=>!1)){const p=n.value.getEditor().getValue();a.value.settings.value=p,ge(a.value.settings,{})&&(e.project.setApi(a.value),u.value.close())}});return(p,m)=>(c(),y(o(se),{ref_key:"dialogRef",ref:u,width:"1000px",height:"600px",title:i.value,submit:"",cancel:"",onSubmit:d},{default:h(()=>[g(o(ee),{ref_key:"formRef",ref:l,size:"small",model:a.value,rules:r,"label-position":"top"},{default:h(()=>[g(o(z),{label:"接口名称",prop:"name"},{default:h(()=>[g(o(q),{modelValue:a.value.name,"onUpdate:modelValue":m[0]||(m[0]=f=>a.value.name=f),disabled:!!e.model},null,8,["modelValue","disabled"])]),_:1}),g(o(z),{label:"标题描述",prop:"title"},{default:h(()=>[g(o(q),{modelValue:a.value.title,"onUpdate:modelValue":m[1]||(m[1]=f=>a.value.title=f)},null,8,["modelValue"])]),_:1}),g(o(z),{label:"接口地址",prop:"url"},{default:h(()=>[g(o(q),{modelValue:a.value.url,"onUpdate:modelValue":m[2]||(m[2]=f=>a.value.url=f)},null,8,["modelValue"])]),_:1}),g(o(z),{label:"请求类型",prop:"method"},{default:h(()=>[g(o(Pt),{modelValue:a.value.method,"onUpdate:modelValue":m[3]||(m[3]=f=>a.value.method=f)},{default:h(()=>[(c(!0),w($,null,M(o(Ol),f=>(c(),y(o(fl),{label:f},null,8,["label"]))),256))]),_:1},8,["modelValue"])]),_:1}),g(o(z),{label:"请求配置 [ JSExpression ]",prop:"settings"},{default:h(()=>{var f;return[g(o(de),{ref_key:"editorRef",ref:n,"model-value":(f=a.value.settings)==null?void 0:f.value,border:"",dark:"",height:"180px"},null,8,["model-value"])]}),_:1})]),_:1},8,["model"])]),_:1},8,["title"]))}}),Wo={class:"vtj-apis__name"},Go=O({__name:"Apis",setup(s){const{project:e}=K(),t=[{name:"add",icon:"vtj-icon-plus"}],a=I(()=>e.apis.value),l=V(),n=V(!1),u=()=>{l.value=void 0,n.value=!0},r=d=>{l.value=d,n.value=!0},i=d=>B(this,null,function*(){(yield re.confirm("确定删除?","提示",{type:"warning"}).catch(p=>!1))&&e.removeApi(d.name)});return(d,p)=>(c(),y(o(fe),{class:"vtj-apis",title:"Api管理",tools:t,onToolClick:u},{default:h(()=>[a.value.length?E("",!0):(c(),y(o(le),{key:0,"image-size":50})),(c(!0),w($,null,M(a.value,m=>(c(),y(o(ue),{editable:"",removable:"",clickable:"",onClick:f=>r(m),onEdit:f=>r(m),onRemove:f=>i(m)},{title:h(()=>[G(W(m.title)+" ",1),R("i",Wo,W(m.name),1)]),_:2},1032,["onClick","onEdit","onRemove"]))),256)),n.value?(c(),y(Ho,{key:1,modelValue:n.value,"onUpdate:modelValue":p[0]||(p[0]=m=>n.value=m),model:l.value,project:o(e)},null,8,["modelValue","model","project"])):E("",!0)]),_:1}))}}),qo={class:"vtj-data-source-from__label-name"},Ko=O({__name:"ApiDataSourceForm",props:{model:{},block:{}},setup(s){const e=s,{project:t}=K(),a={type:"api",detail:"",name:"",title:"",transform:{type:"JSFunction",value:""},test:{type:"JSFunction",value:""}},l=V(xe(e.model||F({},a))),n=I(()=>t.apis.value),u={name:[{required:!0,message:"调用名称为必填项"}],title:[{required:!0,message:"备注描述为必填项"}],detail:[{required:!0,message:"选择引用api"}]},r=I(()=>e.model?"编辑数据源":"新增数据源"),i=V(),d=V(),p=V(),m=V(),f=V(!1),b=V(!1),v=V(""),_=A=>{const T=n.value.find(C=>C.name===A);T&&(l.value.name=T.name,l.value.title=T.title,l.value.test.value=`() => this.${T.name}()`)},k=(A,T)=>{const C=(...N)=>B(this,null,function*(){var H,ce;const P=yield((H=T.runtimeContext)==null?void 0:H.$apis[A.detail]).apply(this,N),L=(ce=A.transform)!=null&&ce.value?$e(A.transform,{}):A.transform;return L?L(P):P});return{[A.name]:C}},x=()=>B(this,null,function*(){if(yield i.value.validate().catch(A=>!1)){const A=d.value.getEditor().getValue();l.value.transform.value=A;const T=p.value.getEditor().getValue();return l.value.test.value=T,(!A||ge(l.value.transform,e.block.runtimeContext))&&ge(l.value.test,F(F({},e.block.runtimeContext),k(l.value,e.block)))}return!1}),D=()=>B(this,null,function*(){(yield x())&&(e.block.setDataSource(l.value),m.value.close())}),U=()=>B(this,null,function*(){if(yield x()){if(!l.value.test.value){be.warning({message:"无测试用例",title:"提示"});return}const A=k(l.value,e.block);b.value=!0,v.value="";try{const T=yield $e(l.value.test,A)().catch(C=>C);v.value=typeof T=="object"?JSON.stringify(T,null,2):"",f.value=!0}catch(T){be.warning({message:T.message,title:"运行错误"})}b.value=!1}});return(A,T)=>(c(),y(o(se),{ref_key:"dialogRef",ref:m,class:"vtj-data-source-from",title:r.value,width:"1000px",height:"600px",submit:"",cancel:"",onSubmit:D},{action:h(()=>[g(o(oe),{size:"default",type:"warning",onClick:U,loading:b.value},{default:h(()=>[G(" 运行测试用例 ")]),_:1},8,["loading"])]),default:h(()=>[g(o(ee),{ref_key:"formRef",ref:i,size:"small","label-position":"right","label-width":"80px",model:l.value,rules:u},{default:h(()=>[g(o(z),{label:"Api",prop:"detail"},{default:h(()=>[g(o(at),{modelValue:l.value.detail,"onUpdate:modelValue":T[0]||(T[0]=C=>l.value.detail=C),onChange:_,disabled:!!e.model},{default:h(()=>[(c(!0),w($,null,M(n.value,C=>(c(),y(o(lt),{label:C.title,value:C.name},{default:h(()=>[G(W(C.title)+" ",1),R("i",qo,W(C.name),1)]),_:2},1032,["label","value"]))),256))]),_:1},8,["modelValue","disabled"])]),_:1}),g(o(z),{label:"调用名称",prop:"name"},{default:h(()=>[g(o(q),{modelValue:l.value.name,"onUpdate:modelValue":T[1]||(T[1]=C=>l.value.name=C),disabled:!!e.model},null,8,["modelValue","disabled"])]),_:1}),g(o(z),{label:"备注描述",prop:"title"},{default:h(()=>[g(o(q),{modelValue:l.value.title,"onUpdate:modelValue":T[2]||(T[2]=C=>l.value.title=C)},null,8,["modelValue"])]),_:1}),g(o(z),{label:"转换函数",prop:"transform"},{default:h(()=>[g(o(de),{ref_key:"transformRef",ref:d,border:"",dark:"",height:"200px","model-value":l.value.transform.value},null,8,["model-value"])]),_:1}),g(o(z),{label:"测试用例"},{default:h(()=>[g(o(de),{ref_key:"testRef",ref:p,border:"",dark:"",height:"120px","model-value":l.value.test.value},null,8,["model-value"])]),_:1})]),_:1},8,["model"]),g(o(gl),{modelValue:f.value,"onUpdate:modelValue":T[3]||(T[3]=C=>f.value=C),title:"测试用例运行结果",direction:"btt","append-to-body":"",size:"80%"},{default:h(()=>[g(o(de),{"model-value":v.value,border:"",dark:"",height:"100%",lang:"json"},null,8,["model-value"])]),_:1},8,["modelValue"])]),_:1},8,["title"]))}}),Zo={class:"vtj-data-sources__subtitle"},Qo=O({__name:"DataSources",setup(s){const{selected:e}=he(),t=I(()=>{var p;return(p=e.value)==null?void 0:p.node}),a=I(()=>{var p;return Object.values(((p=t.value)==null?void 0:p.dataSources)||{}).filter(m=>m.type==="api")}),l=[{name:"add",icon:"vtj-icon-plus"}],n=V(),u=V(),r=()=>{u.value=void 0,n.value=!0},i=p=>{u.value=p,n.value=!0},d=p=>B(this,null,function*(){(yield re.confirm("确定删除？","提示",{type:"warning"}).catch(m=>!1))&&t.value.removeDataSource(p.name)});return(p,m)=>(c(),y(o(fe),{class:"vtj-data-sources",title:null,"body-padding":!1},{default:h(()=>[g(o(ie),{title:"Api",tools:l,onToolClick:r},{default:h(()=>[a.value.length===0?(c(),y(o(le),{key:0,"image-size":50})):E("",!0),(c(!0),w($,null,M(a.value,f=>(c(),y(o(ue),{editable:"",removable:"",clickable:"",onClick:b=>i(f),onEdit:b=>i(f),onRemove:b=>d(f)},{title:h(()=>[G(W(f.title)+" ",1),R("i",Zo,W(f.name),1)]),_:2},1032,["onClick","onEdit","onRemove"]))),256))]),_:1}),n.value?(c(),y(Ko,{key:0,modelValue:n.value,"onUpdate:modelValue":m[0]||(m[0]=f=>n.value=f),model:u.value,block:t.value},null,8,["modelValue","model","block"])):E("",!0)]),_:1}))}}),Yo=O({__name:"History",setup(s){const{engine:e}=K(),t=I(()=>{var u;return((u=e.simulator.history.value)==null?void 0:u.list)||[]}),a=I(()=>`(共 ${t.value.length} 条)`),l=u=>B(this,null,function*(){var r;(yield re.confirm("确定删除?","提示",{type:"warning"}).catch(i=>!1))&&((r=e.simulator.history.value)==null||r.remove(u.id))}),n=u=>{var r;(r=e.simulator.history.value)==null||r.load(u.id)};return(u,r)=>(c(),y(o(fe),{title:"历史记录",subtitle:a.value,class:"vtj-histroy"},{default:h(()=>[t.value.length===0?(c(),y(o(le),{key:0,"image-size":50})):E("",!0),(c(!0),w($,null,M(t.value,(i,d)=>{var p;return c(),y(o(ue),{title:i.title,active:((p=o(e).simulator.history.value)==null?void 0:p.index)===d,onRemove:m=>l(i),onClick:m=>n(i),removable:"",clickable:""},null,8,["title","active","onRemove","onClick"])}),256))]),_:1},8,["subtitle"]))}}),Xo=O({__name:"NodePath",setup(s){const{selected:e}=he(),t=I(()=>{var n;return(((n=e.value)==null?void 0:n.path)||[]).slice(0).reverse()}),a=n=>{S.emit(Lt,n)},l=n=>{S.emit(Jt,n)};return(n,u)=>o(e)?(c(),y(o(ul),{key:0,class:"vtj-nodepath","separator-icon":o(Xa)},{default:h(()=>[(c(!0),w($,null,M(t.value,r=>(c(),y(o(rl),{onClick:i=>a(r),onMouseover:i=>l(r)},{default:h(()=>[G(W(r.name),1)]),_:2},1032,["onClick","onMouseover"]))),256))]),_:1},8,["separator-icon"])):E("",!0)}}),ei={class:"vtj-about"},ti={class:"vtj-about__logo"},ai=["src"],li=R("div",{class:"vtj-about__name"},[R("h3",null,"VTJEngine")],-1),ni={class:"vtj-about__footer"},si=O({__name:"About",setup(s){return(e,t)=>(c(),w("div",ei,[R("div",ti,[g(o(cl),{value:o(fa)},{default:h(()=>[R("img",{src:o(ya)},null,8,ai)]),_:1},8,["value"])]),li,R("div",ni,[g(o(dl),{href:"http://vtj.pro",type:"primary",target:"_blank"},{default:h(()=>[G(" http://vtj.pro ")]),_:1})])]))}}),Le={Empty:As,Logo:Os,Dependencies:Ns,Designer:zs,Components:Hs,Pages:Zs,Blocks:Qs,Toolbar:lo,Outline:ho,Properties:go,Events:yo,BlockScript:jo,Css:wo,Schema:So,Actions:To,Directives:Ao,Advanced:Fo,Switcher:$o,Docs:zo,Apis:Go,DataSources:Qo,History:Yo,NodePath:Xo,About:si},oi={class:"vtj-apps"},ii={class:"vtj-apps__header"},ri={class:"vtj-apps__top"},ui={class:"vtj-apps__bottom"},ci={class:"vtj-apps__panels"},di=O({__name:"apps",setup(s,{expose:e}){const{regions:t,config:a}=K(),l=I(()=>t.value.apps),n=V(null),u=V(null),r=V(),i=V(),d=I(()=>l.value.filter(v=>{var _;return!v.disabled&&((_=v.trigger)==null?void 0:_.type)==="panel"})),p=I(()=>l.value.filter(v=>{var _;return!v.disabled&&((_=v.trigger)==null?void 0:_.type)!=="panel"}));function m(v){const _=l.value.find(k=>k.name===v);_&&(n.value=_,u.value=_)}const f=v=>{n.value=v,u.value=u.value===v?null:v},b=v=>{var _,k,x;if(((_=v.trigger)==null?void 0:_.type)==="link"){window.open((k=v.props)==null?void 0:k.url);return}((x=v.trigger)==null?void 0:x.type)==="dialog"&&(r.value=Ye(Le[v.type]||Le.Empty),i.value=Y(F(F({},v.trigger),v.props),{visible:!0}))};return ae(u,v=>{S.emit(Ca,!!v)}),a.activeApp&&m(a.activeApp),e({setCurrentWidget:m}),(v,_)=>(c(),w("div",oi,[R("div",ii,[R("div",ri,[(c(!0),w($,null,M(d.value,k=>{var x,D;return c(),y(Xt,{key:`trigger-${k.name}`,icon:(x=k.trigger)==null?void 0:x.icon,label:(D=k.trigger)==null?void 0:D.label,active:n.value===k,open:u.value===k,onClick:U=>f(k)},null,8,["icon","label","active","open","onClick"])}),128))]),R("div",ui,[(c(!0),w($,null,M(p.value,k=>{var x,D;return c(),y(Xt,{key:`trigger-${k.name}`,icon:(x=k.trigger)==null?void 0:x.icon,label:(D=k.trigger)==null?void 0:D.label,onClick:U=>b(k)},null,8,["icon","label","onClick"])}),128))])]),Ce(R("div",ci,[(c(!0),w($,null,M(d.value,k=>(c(),y(Cl,{key:k.name},[n.value===k?(c(),y(o(Se),Xe(Z({key:0},F({},k))),null,16)):E("",!0)],1024))),128))],512),[[Ie,!!u.value]]),r.value?(c(),y(se,Z({key:0},i.value,{modelValue:i.value.visible,"onUpdate:modelValue":_[0]||(_[0]=k=>i.value.visible=k)}),{default:h(()=>[(c(),y(Bt(r.value),Xe(Nt(i.value)),null,16))]),_:1},16,["modelValue"])):E("",!0)]))}}),pi={class:"vtj-brand"},mi=O({__name:"brand",setup(s){const{regions:e}=K(),t=I(()=>e.value.brand);return(a,l)=>(c(),w("div",pi,[(c(!0),w($,null,M(t.value,n=>(c(),y(o(Se),Z({key:n.name},F({},n)),null,16))),128))]))}}),vi={key:0,class:"vtj-setting"},hi={key:0,class:"vtj-setting__header"},fi={class:"vtj-setting__path"},gi=R("i",{class:"vtj-icon-layers"},null,-1),bi=R("i",{class:"vtj-icon-help"},null,-1),yi=O({__name:"setting",setup(s,{expose:e}){var f;const{engine:t,regions:a}=K(),{selected:l}=he(),{setting:n}=a.value||{},u=I(()=>{var b;return te((b=l.value)==null?void 0:b.node)?"Block":"Node"}),r=I(()=>n.filter(b=>!b.disabled&&b.group===u.value).map(b=>{var v;return{name:b.name,label:((v=b.trigger)==null?void 0:v.label)||b.name,closable:!1}})),i=V((f=r.value[0])==null?void 0:f.name);ae(l,(b,v)=>{(b==null?void 0:b.node.id)!==(v==null?void 0:v.node.id)&&d(0)});const d=(b=0)=>{var v;i.value=(v=r.value[b])==null?void 0:v.name};e({currentTab:i,tabs:r,change:d});const p=I(()=>{var v,_;const b=(v=l.value)==null?void 0:v.node;return b?(_=t.assets.componentMap[b.name])==null?void 0:_.doc:null}),m=()=>{if(p.value){const b=Je(t.skeleton.regionInstances.workspace);b&&b.openTab("docs",{url:p.value})}};return(b,v)=>o(l)&&o(l).node?(c(),w("div",vi,[u.value==="Node"?(c(),w("div",hi,[R("div",fi,[gi,R("span",null,[G(W(o(l).node.name.fileName||o(l).node.name)+": ",1),R("i",null,W(o(l).node.id),1)])]),p.value?(c(),w("div",{key:0,class:"vtj-setting__doc",onClick:m},[bi,G(" 帮助 ")])):E("",!0)])):E("",!0),o(l).node.lock?E("",!0):(c(),y(Ut,{key:1,class:"vtj-setting__tabs",items:r.value,modelValue:i.value,"onUpdate:modelValue":v[0]||(v[0]=_=>i.value=_),stretch:"","body-padding":!1},{default:h(()=>[(c(!0),w($,null,M(o(n),_=>(c(),y(o(Se),Z({key:_.name},F({},_),{visible:_.name===i.value}),null,16,["visible"]))),128))]),_:1},8,["items","modelValue"])),o(l).node.lock?(c(),y(o(le),{key:2,"image-size":1,description:"组件已被锁定，不能更改设置。"})):E("",!0)])):(c(),y(o(le),{key:1,description:"请在左侧画布选中节点"}))}}),_i={class:"vtj-status"},ki={class:"vtj-status__left"},Vi={class:"vtj-status__right"},ji=O({__name:"status",setup(s){const{regions:e}=K(),t=I(()=>e.value.status),a=I(()=>t.value.filter(n=>!n.disabled&&!n.trigger)),l=I(()=>t.value.filter(n=>!n.disabled&&!!n.trigger));return(n,u)=>(c(),w("div",_i,[R("div",ki,[(c(!0),w($,null,M(a.value,r=>(c(),y(o(Se),Z({key:r.name},F({},r)),null,16))),128))]),R("div",Vi,[(c(!0),w($,null,M(l.value,r=>(c(),y(o(Se),Z({key:r.name},F({},r)),null,16))),128))])]))}}),wi={class:"vtj-toolbar"},Ci=O({__name:"toolbar",setup(s){const{regions:e}=K(),t=I(()=>e.value.toolbar);return(a,l)=>(c(),w("div",wi,[(c(!0),w($,null,M(t.value,n=>(c(),y(o(Se),Z({key:n.name},F({},n)),null,16))),128))]))}}),Si=O({__name:"workspace",setup(s,{expose:e}){var b;const{regions:t,emitter:a}=K(),l=I(()=>t.value.workspace),n=l.value.filter(v=>v.name==="designer").map(v=>{var _;return{name:v.name,label:((_=v.trigger)==null?void 0:_.label)||v.name}}),u=V(l.value.filter(v=>!v.disabled&&v.name!=="designer").map(v=>{var _;return{name:v.name,label:((_=v.trigger)==null?void 0:_.label)||v.name,checked:!1,closable:!0}})),r=I(()=>{const v=u.value.filter(_=>!!_.checked);return v.unshift(n[0]),v}),i=V((b=r.value[0])==null?void 0:b.name);ae(i,v=>{a.emit(Ea,v==="designer")});const d=v=>{const _=u.value.find(k=>k.name===v);_&&(_.checked=!1),v===i.value&&(i.value=r.value[0].name)},p=V({}),m=(v,_)=>{const k=u.value.find(x=>x.name===v);k&&(p.value[v]=_,k.checked=!0),i.value=v},f=v=>{v.checked=!v.checked,v.checked?i.value=v.name:i.value===v.name&&(i.value="designer")};return e({openTab:m}),(v,_)=>(c(),y(o(Ut),{class:"vtj-workspace",items:r.value,modelValue:i.value,"onUpdate:modelValue":_[0]||(_[0]=k=>i.value=k),more:u.value,onTabRemove:d,onMore:f,checkable:""},{default:h(()=>[(c(!0),w($,null,M(l.value,k=>(c(),y(o(Se),Z({key:k.name},F(F({},k),p.value[k.name]),{visible:k.name===i.value}),null,16,["visible"]))),128))]),_:1},8,["items","modelValue","more"]))}}),Ei=O({__name:"App",props:{engine:{}},setup(s,{expose:e}){const t=s,a=V(),l=V(),n=V(),u=V(),r=V(),i=V(),d=V();V(),V();const p=V(!1),m=V(!0);t.engine.skeleton.regionInstances={brand:a,toolbar:l,action:n,status:u,setting:r,workspace:i,apps:d};const f={dirs:["e"],maxWidth:600},b={dirs:["w"],maxWidth:600};function v(_){p.value=_}return S.on(Ca,_=>{v(!_)}),wl($t,t.engine),e({setLeftCollapsed:v,showSetting:m}),(_,k)=>(c(),y(o(ll),{locale:o(nn)},{default:h(()=>[g(o(yt),{class:"vtj-layout"},{default:h(()=>[g(o(tl),{class:"vtj-layout__header",height:"36px"},{default:h(()=>[g(o(mi),{ref_key:"brand",ref:a},null,512),g(o(Ci),{ref_key:"toolbar",ref:l},null,512),g(o(xs),{ref_key:"action",ref:n},null,512)]),_:1}),g(o(yt),{class:"vtj-layout__wrapper"},{default:h(()=>[Ce((c(),y(o(_t),{width:"400px",class:Q(["vtj-layout__left",{"is-collapsed":p.value}])},{default:h(()=>[g(o(di),{ref_key:"apps",ref:d},null,512)]),_:1},8,["class"])),[[o(zt),f]]),g(o(ua),{class:"vtj-layout__main"},{default:h(()=>[g(o(Si),{ref_key:"workspace",ref:i},null,512)]),_:1}),m.value?Ce((c(),y(o(_t),{key:0,width:"350px",class:"vtj-layout__right"},{default:h(()=>[g(o(yi),{ref_key:"setting",ref:r},null,512)]),_:1})),[[o(zt),b]]):E("",!0)]),_:1}),g(o(al),{class:"vtj-layout__footer",height:"20px"},{default:h(()=>[g(o(ji),{ref_key:"status",ref:u},null,512)]),_:1})]),_:1})]),_:1},8,["locale"]))}}),xi=["brand","toolbar","action","status","apps","workspace","setting"];class Di{constructor(e){j(this,"widgets");j(this,"widgetInstances",{});j(this,"regions");j(this,"regionInstances",{});this.widgets=ke(e),this.regions=I(()=>xi.reduce((t,a)=>(t[a]=this.getWidgets(a),t),{}))}load(e){e.forEach(t=>{this.add(t)})}get(e){return this.widgets.find(t=>t.name===e)}set(e,t){const a=this.get(e);a&&aa(a,t)}add(e){this.get(e.name)?this.set(e.name,e):this.widgets.push(e)}remove(e){const t=this.widgets.findIndex(a=>a.name===e);if(t>=0){const a=this.widgets[t];a.disabled=!0,this.widgets.splice(t,1)}}getComponent(e){return e?la(e)?Le[e]||Le.Empty:e:Le.Empty}getWidgets(e){return this.widgets.filter(t=>t.region===e).sort((t,a)=>(t.order||0)-(a.order||0))}dispose(){this.widgetInstances={},this.regionInstances={}}}const S=Za(),Ca="EVENT_SKELETON_LEFT_COLLAPSED_CHANGE",ve="EVENT_PROJECT_UPDATE",Ti="EVENT_PROJECT_ACTIVE_FILE",Qe="EVENT_FILE_CREATE",jt="EVENT_FILE_UPDATE",wt="EVENT_FILE_REMOVE",Ct="EVENT_ASSETS_LOADED",Ii="EVENT_SIMULATOR_OPEN",St="EVENT_SIMULATOR_READY",Et="EVENT_COMPONENETS_DRAG_START",xt="EVENT_COMPONENETS_DRAG_END",J="EVENT_NODE_CHANGE",Sa="EVENT_VIEWPORT_MODE_CHANGE",Lt="EVENT_OUTLINE_SELECTED",Jt="EVENT_OUTLINE_HOVER",Te="EVENT_OUTLINE_CHANGE",Ea="EVENT_DESIGNER_ACTIVE_CHANGE",xa="EVENT_ACTION_PREVIEW",Da="EVENT_ACTION_HOME",Ta="EVENT_ACTION_CODER",Ia="EVENT_ACTION_COPY",Ai="EVENT_HISTORY_GO",Ri="EVENT_HISTORY_BACK",Ae="EVENT_HISTORY_CHANGE",Pi="EVENT_HISTORY_PUSH",Oi="EVENT_HISTORY_REMOVE",et="EVENT_HISTORY_SAVE",Bi=[{id:"elements",category:"特殊元素"},{id:"components",category:"内置组件"}],Aa=[{name:"component",title:"动态组件",categoryId:"elements",doc:"https://cn.vuejs.org/api/built-in-special-elements.html#component",props:[{name:"is",label:"组件名",setters:"InputSetter"}],snippet:{children:"组件文本内容示例",props:{is:"div"}}},{name:"slot",title:"插槽",categoryId:"elements",doc:"https://cn.vuejs.org/api/built-in-special-elements.html#slot",props:[{name:"name",label:"名称",defaultValue:"default",setters:"InputSetter"}],snippet:{children:"插槽默认内容"}}],Ge=[...Aa,{name:"Transition",title:"过渡效果",categoryId:"components",package:"vue",doc:"https://cn.vuejs.org/api/built-in-components.html#transition",props:[{name:"name",label:"名称",defaultValue:"",title:"用于自动生成过渡 CSS class 名",setters:"InputSetter"},{name:"css",label:"应用CSS",defaultValue:!0,title:"是否应用 CSS 过渡 class",setters:"BooleanSetter"},{name:"type",label:"事件类型",defaultValue:void 0,title:"指定要等待的过渡事件类型来确定过渡结束的时间，默认情况下会自动检测持续时间较长的类型",setters:"SelectSetter",options:["transition","animation"]},{name:"duration",label:"持续时间",defaultValue:void 0,title:"显式指定过渡的持续时间",setters:["NumberSetter","JSONSetter"]},{name:"mode",label:"时序",defaultValue:"default",title:"控制离开/进入过渡的时序。",setters:"SelectSetter",options:["in-out","out-in","default"]},{name:"appear",label:"使用过渡",defaultValue:!1,title:"是否对初始渲染使用过渡",setters:"BooleanSetter"},{name:"enterFromClass",label:"enterFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"enterActiveClass",label:"enterActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"enterToClass",label:"enterToClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearFromClass",label:"appearFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearActiveClass",label:"appearActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearToClass",label:"appearToClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveFromClass",label:"leaveFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveActiveClass",label:"leaveActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveToClass",label:"leaveToClass",defaultValue:void 0,setters:"InputSetter"}],events:["before-enter","before-leave","enter","leave","appear","after-enter","after-leave","after-appear","enter-cancelled","leave-cancelled","ppear-cancelled"],snippet:{children:"Transition"}},{name:"TransitionGroup",title:"过渡效果组",package:"vue",categoryId:"components",doc:"https://cn.vuejs.org/api/built-in-components.html#transitiongroup",props:[{name:"name",label:"名称",defaultValue:"",title:"用于自动生成过渡 CSS class 名",setters:"InputSetter"},{name:"tag",label:"标签名",defaultValue:void 0,title:"如果未定义，则渲染为片段 (fragment)",setters:"InputSetter"},{name:"moveClass",label:"moveClass",defaultValue:void 0,title:"用于自定义过渡期间被应用的 CSS class。",setters:"InputSetter"},{name:"css",label:"应用CSS",defaultValue:!0,title:"是否应用 CSS 过渡 class",setters:"BooleanSetter"},{name:"type",label:"事件类型",defaultValue:void 0,title:"指定要等待的过渡事件类型来确定过渡结束的时间，默认情况下会自动检测持续时间较长的类型",setters:"SelectSetter",options:["transition","animation"]},{name:"duration",label:"持续时间",defaultValue:void 0,title:"显式指定过渡的持续时间",setters:["NumberSetter","JSONSetter"]},{name:"appear",label:"使用过渡",defaultValue:!1,title:"是否对初始渲染使用过渡",setters:"BooleanSetter"},{name:"enterFromClass",label:"enterFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"enterActiveClass",label:"enterActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"enterToClass",label:"enterToClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearFromClass",label:"appearFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearActiveClass",label:"appearActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearToClass",label:"appearToClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveFromClass",label:"leaveFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveActiveClass",label:"leaveActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveToClass",label:"leaveToClass",defaultValue:void 0,setters:"InputSetter"}],events:["before-enter","before-leave","enter","leave","appear","after-enter","after-leave","after-appear","enter-cancelled","leave-cancelled","ppear-cancelled"],snippet:{children:"TransitionGroup"}},{name:"KeepAlive",title:"缓存切换组件",package:"vue",categoryId:"components",doc:"https://cn.vuejs.org/api/built-in-components.html#keepalive",props:[{name:"include",label:"匹配包含",title:"如果指定，则只有与 `include` 名称, 匹配的组件才会被缓存。",setters:["InputSetter","JSONSetter"]},{name:"exclude",label:"匹配排除",title:"任何名称与 `exclude` 匹配的组件都不会被缓存。",setters:["InputSetter","JSONSetter"]},{name:"max",label:"最大缓存数",title:"最多可以缓存多少组件实例。",setters:["InputSetter"]}]},{name:"Teleport",title:"传送组件",package:"vue",categoryId:"components",doc:"https://cn.vuejs.org/api/built-in-components.html#teleport",props:[{name:"to",label:"目标容器",title:"指定目标容器,可以是选择器或实际元素",setters:["InputSetter"]},{name:"disabled",label:"目标容器",title:"当值为 `true` 时，内容将保留在其原始位置, 而不是移动到目标容器中, 可以动态更改",setters:["BooleanSetter"]}]},{name:"Suspense",title:"异步依赖",package:"vue",categoryId:"components",doc:"https://cn.vuejs.org/api/built-in-components.html#suspense",props:[{name:"timeout",label:"timeout",setters:["InputSetter"]}]}];class Ni{constructor(e,t){j(this,"unwatch");j(this,"packages",[]);j(this,"elements",[...Aa]);j(this,"elementsMap",{});j(this,"components",[...Ge]);j(this,"componentMap",{});j(this,"componentGroups",[]);j(this,"isReady",!1);this.service=e,this.project=t,t&&(this.unwatch=ae(t.dependencies,a=>this.load(a),{deep:!0})),this.elementsMap=this.parseMap(this.elements,!1)}clear(){this.components=[...Ge],this.componentMap={},this.componentGroups=[]}getCateoryComponents(e,t){const a=t.filter(l=>l.categoryId===e.id&&l.hidden!==!0);return{name:e.id,label:e.category,count:a.length,components:a}}parseGroups(e){const t=[];for(let a of e){const{categories:l,components:n,label:u,name:r,library:i,names:d}=a;if(!l||!n)continue;const p=l.map(b=>this.getCateoryComponents(b,n)),m=p.reduce((b,v)=>v.count+b,0),f={name:a.name,label:u||r,library:i,names:d,count:m,children:p};t.push(f)}return t}parseMap(e,t=!0){const a={};if(t)for(const l of e)l.package&&(a[l.name]=l);else for(const l of e)a[l.name]=l;return a}load(e){return B(this,null,function*(){this.packages=e,this.isReady=!1;const t=e.filter(r=>!!r.assetsUrl&&r.enabled);this.clear();const a=[{name:"vue",label:"内置",names:Ge.map(r=>r.name),library:"Vue",components:Ge,categories:Bi}];for(const r of t){const i=yield na(r.assetsUrl,{},{name:r.assetsLibrary,script:!0}).catch(d=>null);i&&(i.name=i.name||r.assetsLibrary,i.library=r.library,i.names=(i.components||[]).map(d=>d.name),a.push(i),this.components=this.components.concat(i.components||[]))}a.sort((r,i)=>(r.order||0)-(i.order||0)),this.componentGroups=this.parseGroups(a),this.componentMap=this.parseMap(this.components),this.isReady=!0,S.emit(Ct);const{components:l,componentGroups:n,componentMap:u}=this;return{components:l,componentGroups:n,componentMap:u}})}getBlockDescription(e){return B(this,null,function*(){if(!e||typeof e=="string")return null;const t=e.type==="Schema"?e.id:null;if(!t)return null;const a=yield this.service.getFile(t);if(!a)return null;const{id:l,name:n,slots:u,props:r,emits:i}=a,d=p=>{const m=Array.isArray(p)?p:[p];let f=[];for(const b of m)f=f.concat(wa[b.toLowerCase()]||[]);return f};return{id:l,name:n,childIncludes:u!=null&&u.length?void 0:!1,props:(r||[]).map(p=>typeof p=="string"?{name:p}:{name:p.name,type:p.type,setters:d(p.type)}),events:i,slots:u}})}dispose(){this.clear(),this.unwatch&&this.unwatch()}}function Fi(s,e,t){const{value:a,iterator:l}=s,{item:n="item",index:u="index"}=l||{};let r=t.__parseExpression(a)||[];return Number.isInteger(r)&&(r=new Array(r).fill(!0).map((i,d)=>d+1)),Array.isArray(r)?r.map((i,d)=>e(t.__clone({[n]:i,[u]:d}))):(console.warn("[vForRender]:",`${a==null?void 0:a.value} is not a Arrary`),[])}function Ui(s,e){return!!e.__parseExpression(s.value)}function Li(s,e){return e.__parseExpression(s.value)?{}:{display:"none"}}function Ji(s,e,t){var r;const a={type:"JSFunction",value:(r=e.value)!=null&&r.value?`(v) => {
        ${e.value.value} = v;
      }`:"(v) => {}"},l=t.__parseFunction(a),n=ba(e.modifiers),u=me(e.arg)?t.__parseExpression(e.arg):e.arg||"modelValue";return{modelValue:t.__parseExpression(e.value),[`onUpdate:${u}`]:n.length&&l?s.withModifiers(l,n):l}}function $i(s="default"){return typeof s=="string"?{name:s,params:[]}:F({params:[]},s)}function Mi(s,e){const{props:t}=s,a=(t==null?void 0:t.name)||"default";return{name:me(a)?e.__parseExpression(a):a,params:[]}}function zi(s){const e={default:{params:[],nodes:[]}};for(const t of s){const a=$i(t.slot),l=a.name;e[l]?(e[l].nodes.push(t),e[l].params=e[l].params.concat(a.params)):e[l]={nodes:[t],params:a.params}}return e}function Hi(s,e,t,a){if(!e)return null;if(la(e))return{default:()=>e};if(me(e))return{default:()=>ga(t.__parseExpression(e))};if(Array.isArray(e)){const l=zi(e),n=u=>!u||!a?{}:a!=null&&a.id&&Object.keys(u).length?{[`scope_${a.id}`]:u}:{};return Object.entries(l).reduce((u,[r,{nodes:i,params:d}])=>(u[r]=p=>{const m=d.length?Fl(p!=null?p:{},d):n(p);return i.map(f=>tt(s,f,t.__clone(m)))},u),{})}}function Wi(s,e,t){const a=Object.keys(e||{}).reduce((l,n)=>{let u=e[n];return me(u)?u=t.__parseExpression(u):ot(u)&&(u=t.__parseFunction(u)),l[n]=u,l},{});return a.ref=t.__ref(s,a.ref),a}function Gi(s,e,t){const a=["passive","capture","once"],l={capture:"Capture",once:"Once",passive:"OnceCapture"};return Object.keys(e||{}).reduce((n,u)=>{const r=e[u],i=ba(r.modifiers),d=i.find(f=>a.includes(f)),p="on"+za(u)+(d&&l[d]||""),m=t.__parseFunction(r.handler);return m&&(n[p]=s.withModifiers(m,i)),n},{})}function qi(s,e,t,a){var r;const{children:l}=e,n=Mi(e,a),u=(r=a.$slots)==null?void 0:r[n.name];return u?u(t):l?typeof l=="string"?s.createTextVNode(l):me(l)?s.createTextVNode(ga(a.__parseExpression(l))):Array.isArray(l)?l.map(i=>tt(s,i,a)):null:null}function Ki(s,e){return e?me(e)?s.__parseExpression(e):e:"div"}function tt(s,e,t){if(!e||!e.name||e.invisible)return null;const{id:a=null,directives:l=[]}=e,{vIf:n,vFor:u,vShow:r,vModels:i,vBind:d}=Ul(l);if(n&&!Ui(n,t))return null;const p=m=>{var x,D,U,A;const f=m.$components,b=(()=>{var C;if(e.name==="component")return Ki(m,e.props.is);if(e.name==="slot")return e.name;const T=m.__loader(s,e.name,e.from);return typeof T=="string"&&(C=f[T])!=null?C:T})(),v=Wi(a,(x=e.props)!=null?x:{},m),_=Gi(s,(D=e.events)!=null?D:{},m);if(e.name==="slot")return qi(s,e,v,m);d&&Object.assign(v,m.__parseExpression(d.value)),r&&(v.style=Object.assign((U=v.style)!=null?U:{},Li(r,m))),i.forEach(T=>{Object.assign(v,Ji(s,T,m))});const k=Hi(s,(A=e.children)!=null?A:[],m,e);return s.createVNode(b,F(F({},v),_),k)};return u?Fi(u,p,t):p(t)}const Zi=(s,e,t="")=>e;function Ra(s){const{getFile:e,options:t}=s;return(a,l,n)=>!n||typeof n=="string"?l:n.type==="Schema"?a.defineAsyncComponent(()=>B(this,null,function*(){const u=yield e(n.id);return u?Pa(Y(F({},t),{Vue:a,dsl:u,loader:Ra(s)})):null})):l}var Dt=(s=>(s.RUNTIME="runtime",s.DESIGN="design",s.RAW="raw",s.VNODE="vnode",s))(Dt||{});class Qi{constructor(e){j(this,"__id",null);j(this,"__name","");j(this,"__mode");j(this,"__dsl",null);j(this,"__instance",null);j(this,"__context_refs",{});j(this,"__loader",Zi);j(this,"__proto__",null);j(this,"props",{});j(this,"state",{});j(this,"context",{});j(this,"refs",{});j(this,"$refs",{});j(this,"$el",null);j(this,"$emit",null);j(this,"$nextTick",null);j(this,"$parent",null);j(this,"$root",null);j(this,"$attrs",null);j(this,"$slots",null);j(this,"$watch",null);j(this,"$options",null);j(this,"$forceUpdate",null);j(this,"$components",{});j(this,"$libs",{});j(this,"$apis",{});j(this,"__transform",{});const{mode:t="runtime",dsl:a,loader:l,attrs:n}=e;this.__mode=t,a&&(this.__id=a.id||null,this.__name=a.name,this.__dsl=a,t==="runtime"&&(this.__transform=a.transform||{})),l&&(this.__loader=l),n&&Object.assign(this,n)}setup(e={},t=Ka){const a=t.getCurrentInstance();if(!a)return;this.__instance=a.proxy;const l=a.appContext.config.globalProperties;Object.assign(this,l),Object.assign(this,e||{}),this.__proxy(),t.onMounted(()=>{this.__proxy()}),t.onUnmounted(()=>{this.__cleanup()})}__clone(e={}){const t=F(F({},this.context),e),a=Y(F({},t),{context:t});return a.context.__proto__=this.context,a.__proto__=this,a}__parseFunction(e){var t;if(e)if(this.__mode==="runtime"){const{id:a,type:l}=e,n=a&&(t=this.__transform[a])!=null?t:e.value;return $e({type:l,value:n},this)}else return $e(e,this)}__parseExpression(e){var t;if(e)if(this.__mode==="runtime"){const{id:a,type:l}=e,n=a&&(t=this.__transform[a])!=null?t:e.value;return Re({type:l,value:n},this)}else return Re(e,this)}__proxy(){this.__instance&&qt.forEach(e=>{var t;this[e]=(t=this.__instance)==null?void 0:t[e]})}__cleanup(){qt.forEach(e=>{this[e]=null})}__ref(e=null,t){if(this.__mode!=="vnode")return e&&e!==this.__id&&(this.__context_refs[e]=this),a=>{let l=(a==null?void 0:a.$vtjEl)||(a==null?void 0:a.$el)||a;if(!l){typeof t=="string"&&(delete this.$refs[t],e&&delete this.refs[e]);return}if(l.nodeType===3&&l.nextSibling&&(l=l.nextSibling),l.__vtj__=e,this.__mode==="design"&&(l.__context__=this),e&&(this.refs[e]=a),typeof t=="function")t(a);else if(t){const n=this.$refs[t];if(n){const u=new Set([].concat(n,a));this.$refs[t]=Array.from(u)}else this.$refs[t]=a}return a}}}const Yi=["Transition","TransitionGroup","KeepAlive","Teleport","Suspense"],Xi={String,Number,Boolean,Array,Object};function er(s,e,t){return s.reactive(Object.keys(e||{}).reduce((a,l)=>{let n=e[l];return me(n)?n=t.__parseExpression(n):ot(n)&&(n=t.__parseFunction(n)),a[l]=n,a},{}))}function tr(s,e){return Object.entries(s!=null?s:{}).reduce((t,[a,l])=>(t[a]=e.__parseFunction(l),t),{})}function ar(s,e=[],t){e.forEach(a=>{s.watch(t.__parseExpression(a.source),t.__parseFunction(a.handler),{deep:a.deep,immediate:a.immediate})})}function lr(s,e,t){return Object.entries(e!=null?e:{}).reduce((a,[l,n])=>(a[l]=s.computed(t.__parseFunction(n)),a),{})}function nr(s=[],e){const t=a=>a?(Array.isArray(a)?a:[a]).map(l=>Xi[l]):void 0;return s.map(a=>typeof a=="string"?{name:a}:{name:a.name,type:a.type,required:a.required,default:me(a.default)?e.__parseExpression(a.default):a.default}).reduce((a,l)=>(a[l.name]={type:t(l.type),required:l.required,default:l.default},a),{})}function sr(s,e){return Object.entries(s!=null?s:{}).reduce((t,[a,l])=>(t[a]=e.__parseFunction(l),t),{})}function or(s,e=[],t){return e.reduce((a,l)=>{var d;const{name:n,from:u}=l||{};l.default;const r=me(u)?t.__parseExpression(u)||n:u!=null?u:n,i=me(l.default)?t.__parseExpression(l.default):(d=l.default)!=null?d:null;return a[n]=s.inject(r,i),a},{})}function ir(s,e,t){return Object.keys(e).reduce((a,l)=>{const n=e[l],u=t.$apis[n.detail],r=ot(n.transform)?n.transform.value?t.__parseFunction(n.transform):void 0:n.transform;return a[l]=(...i)=>B(this,null,function*(){const d=yield u.apply(t,i);return r?r(d):d}),a},{})}function rr(s,e,t){const a=s.CSSStyleSheet;if(a.prototype.replaceSync){const l=new a;l.id=e,l.replaceSync(t);const n=s.document,u=n.adoptedStyleSheets,r=Array.from(u).filter(i=>i.id!==e);n.adoptedStyleSheets=[...r,l]}else{const l=s.document;let n=l.getElementById(e);n?n.innerHTML=t:(n=l.createElement("style"),n.id=e,n.innerHTML=t,l.head.appendChild(n))}}function Pa(s){var m,f,b;const{Vue:e,block:t,components:a={},libs:l={},apis:n={},loader:u}=s,r=t?Dt.DESIGN:Dt.RUNTIME,i=e.computed(()=>s.dsl),d=Yi.reduce((v,_)=>(v[_]=e[_],v),{}),p=new Qi({mode:r,dsl:i.value,loader:u,attrs:{$components:F(F({},d),a),$libs:l,$apis:n}});return i.value.id&&rr(s.window||window,i.value.id,i.value.css||""),e.defineComponent(F({name:i.value.name,props:F({},nr((m=i.value.props)!=null?m:[],p)),setup(v){var A,T,C,N;p.props=v,p.state=er(e,(A=i.value.state)!=null?A:{},p);const _=lr(e,(T=i.value.computed)!=null?T:{},p),k=sr((C=i.value.methods)!=null?C:{},p),x=or(e,i.value.inject,p),D=ir(e,i.value.dataSources||{},p),U=F(F(F(F({},x),_),k),D);return p.setup(U,e),ar(e,(N=i.value.watch)!=null?N:[],p),t&&t.id===p.__id&&(t.runtimeContext=p),e.onUnmounted(()=>{t&&t.id===p.__id&&(t.runtimeContext=void 0)}),{vtj:p}},emits:[...(f=i.value.emits)!=null?f:[]],expose:["vtj"],render(){if(!i.value.children)return null;const v=i.value.children||[];return v.length===1?tt(e,v[0],p):v.map(_=>tt(e,_,p))}},tr((b=i.value.lifeCycles)!=null?b:{},p)))}class ur{constructor(e,t,a){j(this,"app",null);j(this,"dsl",null);j(this,"onNodeChangeProxy");this.env=e,this.service=t,this.history=a,this.onNodeChangeProxy=this.onNodeChange.bind(this)}install(e={},t={}){const a=Object.values(e);this.app&&(Object.assign(this.app.config.globalProperties,t),this.app.config.errorHandler=(l,n,u)=>{const r=`[ ${n==null?void 0:n.$options.name}] ${(l==null?void 0:l.message)||l||"未知错误"}`;console.error({err:l,instance:n,info:u}),be.error({title:"运行错误",message:r})},a.forEach(l=>{var n;(typeof l=="function"||l.install)&&((n=this.app)==null||n.use(l))}))}render(e){this.app&&this.dispose();const{Vue:t,container:a,components:l,libs:n,apis:u,window:r,globals:i}=this.env,d=document.createElement("div");d.id="app",a.appendChild(d);const p=Ra({getFile:this.service.getFile.bind(this.service),options:{Vue:t,block:e,components:l,libs:n,apis:u,window:r}});this.dsl=t.reactive(e.toDsl());const m=Pa({Vue:t,dsl:this.dsl,block:e,components:l,libs:n,apis:u,window:r,loader:p});this.app=t.createApp(m),this.install(n,i),this.app.mount(d),S.on(J,this.onNodeChangeProxy)}onNodeChange(e){if(te(e))this.render(e);else if(this.dsl){const t=e.toDsl();this.updateChild(t,this.dsl)}this.dsl&&this.history.value&&this.history.value.push(this.dsl)}updateChild(e,t){const a=t.children||[];if(Array.isArray(a))for(let l=0;l<a.length;l++){const n=a[l];if(n.id===e.id){a.splice(l,1,e);return}else this.updateChild(e,n)}}dispose(){if(this.app){this.app.unmount();const e=this.app._container;e&&e.parentNode&&(e.parentNode.removeChild(e),this.app._container=null),this.app=null}this.dsl=null,S.off(J,this.onNodeChangeProxy)}}class cr{constructor(e){j(this,"unwatches",[]);j(this,"iframe",null);j(this,"contentWindow",null);j(this,"project");j(this,"renderer",null);j(this,"assets");j(this,"service");j(this,"globals");j(this,"history",V(null));j(this,"isReady",!1);const{project:t,assets:a,service:l,globals:n}=e;this.project=t,this.assets=a,this.service=l,this.globals=n,S.on(Ct,()=>this.open()),S.on(et,u=>this.service.saveHistory(u)),S.on(Ae,u=>{var i;const r=t.current.value;r&&(r.init(u.block),(i=this.renderer)==null||i.render(r))}),this.unwatches.push(ae(t.current,u=>B(this,null,function*(){var r,i;u?(yield this.loadHistory(u),(r=this.renderer)==null||r.render(u)):(this.history.value=null,(i=this.renderer)==null||i.dispose())})))}loadHistory(e){return B(this,null,function*(){const t=yield this.service.getHistory(e.id);this.history.value=new Tn({history:{blockId:e.id,items:t}})})}init(e){ae(e,t=>{t&&(this.iframe=t,this.assets.isReady&&this.open())})}open(){if(!this.iframe)return;this.isReady=!1,this.contentWindow=this.iframe.contentWindow,this.contentWindow.__simulator__=this;const e=this.contentWindow.document;S.emit(Ii,e);const{scripts:t,css:a}=this.parseDependencies();e.open(),e.write(`
     <!DOCTYPE html>
     <html lang="zh-CN">
       <head>
       <meta charset="utf-8">
       <meta name="viewport"
             content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0,viewport-fit=cover"/>
         <style>
            html, body, #app {
              background: #fff;
              padding: 0;
              margin: 0;
              min-height: 100vh;
              width: 100%;
              height: 100%;
              font-size:12px;
            }
         </style>
         ${Ml(a)}
         ${$l(t)}
       </head>
       <body> 
       </body>
       <script>
       __simulator__.ready();
     <\/script> 
     </html>
    `),e.close()}parseDependencies(){const e=this.project.dependencies.value.filter(l=>l.enabled),t=[],a=[];return e.forEach(({urls:l})=>{l==null||l.forEach(n=>{Jl(n)&&t.push(n),Ll(n)&&a.push(n)})}),{scripts:t,css:a}}parseApis(){return this.project.apis.value.reduce((e,t)=>(e[t.name]=zl(t),e),{})}createEnv(){const{contentWindow:e,assets:t,globals:a}=this,l=this.project.dependencies.value,n=t.componentGroups,u={window:e,Vue:null,libs:{},components:{},apis:this.parseApis(),container:e==null?void 0:e.document.body,globals:a};return l.filter(r=>!!r.enabled).forEach(({library:r})=>{var d;const i=e[r];i&&(u.libs[r]=i,r===Gt&&(u[Gt]=i),(((d=n.find(p=>p.library===r))==null?void 0:d.names)||[]).forEach(p=>{var f;const m=t.componentMap[p];m?u.components[p]=m.parent?(f=i[m.parent])==null?void 0:f[m.alias||p]:i[m.alias||p]:u.components[p]=i[p]}))}),u}ready(){var a,l;this.isReady=!0,(a=this.renderer)==null||a.dispose(),this.renderer=null;const e=this.project.current.value,t=this.createEnv();this.renderer=new ur(t,this.service,this.history),e&&this.renderer.render(e),S.emit(St,(l=this.contentWindow)==null?void 0:l.document)}dispose(){var e;(e=this.renderer)==null||e.dispose(),this.contentWindow=null,this.iframe=null,this.renderer=null,this.history.value=null,this.unwatches.forEach(t=>t()),S.off(Ct),S.off(et),S.off(Ae)}}const $t=Symbol("VtjEngine");class dr{constructor(e,t={}){j(this,"config");j(this,"skeleton");j(this,"app");j(this,"service");j(this,"emitter",S);j(this,"project");j(this,"assets");j(this,"simulator");const{config:a={},service:l=new ka,project:n,globals:u={}}=t;this.service=l,this.config=an(en,a),this.skeleton=new Di(this.config.widgets||[]),this.project=pa(new Dn(n,this.config.dependencies)),this.assets=new Ni(this.service,this.project),this.simulator=new cr({project:this.project,assets:this.assets,service:this.service,globals:u}),this.app=ma(Ei,{engine:Ye(this)}),this.bindListeners(),this.loadProject(this.project.toDsl()),nt(()=>{var r;this.app.mount((r=o(e))!=null?r:document.body)}),Oe(()=>{this.dispose()})}loadProject(e){return B(this,null,function*(){const{service:t,project:a}=this,l=yield t.getProject(e||{name:"未命名项目"});a.load(l)})}bindListeners(){const{emitter:e,service:t}=this;e.on(ve,a=>t.updateProject(a)),e.on(Qe,a=>t.createFile(a)),e.on(jt,a=>t.updateFile(a)),e.on(wt,a=>t.removeFile(a)),e.on(J,()=>{const a=this.project.current.value;a&&t.updateFile(a.toDsl())})}dispose(){this.emitter.all.clear(),this.skeleton.dispose(),this.assets.dispose(),this.simulator.dispose(),this.app.unmount()}}class pr{constructor(e,t,a){j(this,"draggingComponent",null);j(this,"document",null);j(this,"proxied",{});j(this,"hover",ut(null));j(this,"dropping",ut(null));j(this,"selected",ut(null));this.engine=e,this.iframe=t,this.slotPicker=a,e.simulator.init(t),S.on(St,l=>{this.bindEvents(l)}),S.on(Et,l=>{this.draggingComponent=l}),S.on(xt,()=>{this.draggingComponent=null}),S.on(Ae,()=>{this.selected.value=null,this.hover.value=null}),ae(e.project.current,()=>{this.selected.value=null,this.hover.value=null})}dispose(){this.engine.simulator.dispose(),S.off(St),S.off(Et),S.off(xt),this.document&&(this.unbindEvents(this.document),this.document=null)}getNodeByElement(e){var a;const t=(a=e.__vtj__)!=null?a:"";return Me.nodes[t]||null}getElementByNode(e){return!this.document||!e?null:te(e)?this.document.body:Array.from(this.document.querySelectorAll("*")).find(t=>t.__vtj__===e.id)}getDropType(e,t,a){const{left:l,top:n,width:u,height:r}=e;return t>=l&&t<=l+u*.2?"left":t>=l+u*.8&&t<=l+u?"right":a>=n&&a<=n+r*.2?"top":a>=n+r*.8&&a<=n+r?"bottom":"inner"}getElementAndNode(e){const{engine:t,document:a}=this,l=e.composedPath(),n=this.findVtjElement(l)||(a==null?void 0:a.body),u=n?this.getNodeByElement(n)||t.project.current.value:null;return{el:n,node:u,path:l}}onDragOver(e){const{el:t,node:a}=this.getElementAndNode(e);if(a&&t&&this.allowDrop(a)){e.preventDefault();const l=t.getBoundingClientRect();this.dropping.value={el:t,node:a,rect:l,type:this.getDropType(l,e.clientX,e.clientY),path:[]}}else this.dropping.value=null}onMouseOver(e){const{el:t,node:a}=this.getElementAndNode(e);if(t&&a){const l=t.getBoundingClientRect();this.hover.value={el:t,node:a,rect:l,type:"inner",path:[]}}}onLeave(e){this.hover.value=null,this.dropping.value=null}createNodeDsl(e){const{name:t,snippet:a={},from:l}=e;return Y(F({},a),{name:t,from:l||e.package})}getDropSlot(e){return B(this,null,function*(){var i;if(!e)return;const{engine:t,slotPicker:a}=this,l=t.assets.componentMap,n=(yield t.assets.getBlockDescription(e.from))||l[e.name];if(!(n!=null&&n.slots))return;const u=((n==null?void 0:n.slots)||["default"]).map(d=>typeof d=="string"?{name:d,params:[]}:{name:d.name,params:d.params||[]});if(u.length===0)return;if(u.length===1)return u[0];const r=yield a(u).catch(d=>{});if(!(r&&r.name==="default"&&(!r.params||((i=r.params)==null?void 0:i.length)===0)))return r})}onDrop(e){return B(this,null,function*(){e.preventDefault();const{engine:t,draggingComponent:a,dropping:l}=this,n=t.project.current.value;if(!n||!a||!l.value)return;const{el:u,node:r}=this.getElementAndNode(e);if(!u||!r||!this.allowDrop(r))return;const i=this.createNodeDsl(a),d=new Me(i),p=l.value.type;d.slot=yield this.getDropSlot(p==="inner"?r:r.parent),te(r)?n.appendChild(d):n.appendChild(d,r,p)})}onSelected(e){const{el:t,node:a,path:l}=this.getElementAndNode(e);if(t&&a){const n=t.getBoundingClientRect();this.selected.value={el:t,node:a,rect:n,path:this.getNodePath(l),type:this.getDropType(n,e.clientX,e.clientY)}}}onViewChange(){this.updateRect()}updateRect(){const e=o(this.selected),t=o(this.hover);if(e){const a=e.el.getBoundingClientRect();this.selected.value=Y(F({},e),{rect:a})}if(t){const a=t.el.getBoundingClientRect();this.hover.value=Y(F({},t),{rect:a})}}getNodePath(e){const t=e.filter(l=>this.isVtjElement(l)&&this.isCurrentContext(l)).map(l=>this.getNodeByElement(l)),a=this.engine.project.current.value;return a&&t.push(a),t}isVtjElement(e){return!!e.__vtj__}isCurrentContext(e){var l,n;const t=(l=this.engine.project.current.value)==null?void 0:l.id,a=(n=e.__context__)==null?void 0:n.__id;return t===a}findVtjElement(e){return e.find(t=>this.isVtjElement(t)&&this.isCurrentContext(t))}bind(e,t){let a=this.proxied[t];return a||(a=e.bind(this),this.proxied[t]=a),a}bindEvents(e){this.document&&this.unbindEvents(this.document);const t=this.engine.simulator.contentWindow;e.addEventListener("mouseover",this.bind(this.onMouseOver,"onMouseOver")),e.addEventListener("mouseleave",this.bind(this.onLeave,"onLeave")),e.addEventListener("dragover",this.bind(this.onDragOver,"onDragOver")),e.addEventListener("dragleave",this.bind(this.onLeave,"onLeave")),e.addEventListener("drop",this.bind(this.onDrop,"onDrop")),e.addEventListener("click",this.bind(this.onSelected,"onSelected")),e.addEventListener("scroll",this.bind(this.onViewChange,"onViewChange")),t==null||t.addEventListener("resize",this.bind(this.onViewChange,"onViewChange")),this.document=e}unbindEvents(e){const t=this.engine.simulator.contentWindow;e.removeEventListener("mouseover",this.bind(this.onMouseOver,"onMouseOver")),e.removeEventListener("mouseleave",this.bind(this.onLeave,"onLeave")),e.removeEventListener("dragover",this.bind(this.onDragOver,"onDragOver")),e.removeEventListener("dragleave",this.bind(this.onLeave,"onLeave")),e.removeEventListener("drop",this.bind(this.onDrop,"onDrop")),e.removeEventListener("click",this.bind(this.onSelected,"onSelected")),e.removeEventListener("scroll",this.bind(this.onViewChange,"onViewChange")),t==null||t.removeEventListener("resize",this.bind(this.onViewChange,"onViewChange")),this.document=null}allowDrop(e){const{draggingComponent:t,engine:a}=this;if(!t)return!0;const l=a.project.current.value;return l&&l.allowDrop(t,e,a.assets)}setHover(e){const t=this.getElementByNode(e);if(!t)return;const a=t.getBoundingClientRect();this.hover.value={el:t,node:e,rect:a,type:"inner",path:[]}}setSelected(e){if(!this.document)return;const t=this.getElementByNode(e)||this.document.createElement("span"),a=t.getBoundingClientRect();this.selected.value={el:t,node:e,rect:a,path:this.findPathByNode(e),type:"inner"}}findPathByNode(e){const t=[e];if(te(e))return t;let a=e;for(;a.parent&&a.parent!==a;)a=a.parent,a!==e&&t.unshift(a);return t.reverse()}}const mr=s=>(El("data-v-c00ef9a7"),s=s(),xl(),s),vr={class:"vtj-ide"},hr={class:"file-list"},fr={key:1},gr=mr(()=>R("div",{class:"error-tip"}," 错误日志已保存. 这可能是系统的bug。您可以把日志提交给作者协助解决。 ",-1)),br=O({__name:"index",setup(s){const t=V(!1),a=V(!1),l=V([]),n=V(null),u=V(!1),r=V(),i=Ha(),{project:d,raw:p=!1,service:m="storage",debug:f}=(i==null?void 0:i.options)||{},{id:b="ide",name:v="IDE",base:_=location.pathname,mode:k="hash",page:x="/page",preview:D="/preview",home:U="/"}=d||{},A=()=>`${_}${k==="hash"?"#":""}${U}`,T=new dr(r,{service:m==="file"?new ln:new ka,config:{widgets:[{name:"switcher",props:{link:A()}},{name:"actions",props:{coder:!0,copy:!1}}]},project:{id:b,name:v},globals:{$route:La(),$router:Ja()}});return T.emitter.on(xa,C=>{const N=k==="hash"?"#":"";let P="";Wa(C)?P=p?`${_}${N}${D}/${C.id}`:`${_}${N}${x}/${C.id}`:P=`${_}${N}${D}/${C.id}`,window.open(P)}),T.emitter.on(Da,C=>{const P=`${_}${k==="hash"?"#":""}${U}`;window.open(P)}),T.emitter.on(Ta,C=>B(this,null,function*(){if(m==="storage"||!p){C.value=!1,t.value=!0;return}a.value=!0,u.value=!0,l.value=[],n.value=null;const N=T.project.toDsl(),P=T.assets.componentMap,L=T.assets.packages;l.value=yield Ht({type:"projectCoder",data:{debug:f,project:N,assets:{componentMap:P,packages:L}}}).catch(H=>(n.value=H.data,console.log(H),[])),u.value=!1})),T.emitter.on(Ia,C=>B(this,null,function*(){C.value=!0,yield Ht({type:"copyProject"}),C.value=!1,yield Ga(b),pe.success({message:"复制项目样例完成, 正在重置设置器"}),yield ft(2e3),location.reload()})),(C,N)=>(c(),w("div",vr,[R("div",{ref_key:"container",ref:r,class:"container"},null,512),g(o(se),{modelValue:t.value,"onUpdate:modelValue":N[0]||(N[0]=P=>t.value=P),title:"温馨提示",width:"500px",height:"180px"},{default:h(()=>[g(o(ze),{title:"当前设计器是非源码模式，不支持出码功能",type:"warning",closable:!1,description:"可以使用以下命令下载完整版本体验"}),g(o(ze),{class:"npm-command",closable:!1,type:"info",title:"npm create vtj@latest -- -t web"})]),_:1},8,["modelValue"]),g(o(se),{modelValue:a.value,"onUpdate:modelValue":N[1]||(N[1]=P=>a.value=P),title:"出码结果",width:"800px",height:"400px"},{default:h(()=>[g(o(_l),{rows:3,animated:"",loading:u.value},{default:h(()=>[n.value?E("",!0):(c(),y(o(ze),{key:0,closable:!1,type:"success",title:`输出文件数: ${l.value.length}`},null,8,["title"])),R("div",hr,[(c(!0),w($,null,M(l.value,P=>(c(),w("div",null,W(P),1))),256))]),n.value?(c(),w("div",fr,[g(o(ze),{closable:!1,type:"error",title:"出码失败",description:n.value.msg},null,8,["description"]),gr])):E("",!0)]),_:1},8,["loading"])]),_:1},8,["modelValue"])]))}});const Rr=qa(br,[["__scopeId","data-v-c00ef9a7"]]);export{Rr as default};
