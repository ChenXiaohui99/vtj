var Oa=Object.defineProperty,Ba=Object.defineProperties;var Na=Object.getOwnPropertyDescriptors;var Mt=Object.getOwnPropertySymbols;var Fa=Object.prototype.hasOwnProperty,Ua=Object.prototype.propertyIsEnumerable;var it=(n,e,t)=>e in n?Oa(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,U=(n,e)=>{for(var t in e||(e={}))Fa.call(e,t)&&it(n,t,e[t]);if(Mt)for(var t of Mt(e))Ua.call(e,t)&&it(n,t,e[t]);return n},Y=(n,e)=>Ba(n,Na(e));var j=(n,e,t)=>(it(n,typeof e!="symbol"?e+"":e,t),t);var N=(n,e,t)=>new Promise((a,l)=>{var s=r=>{try{u(t.next(r))}catch(c){l(c)}},i=r=>{try{u(t.throw(r))}catch(c){l(c)}},u=r=>r.done?a(r.value):Promise.resolve(r.value).then(s,i);u((t=t.apply(n,e)).next())});import{b as La,u as Ja}from"./vue-router-ae4b6bc5.js";import{_ as Ma}from"./monaco-editor-c02ad91d.js";import{y as $a,E as _e,h as ea,$ as $t,W as ta,A as aa,Z as la,g as xe,C as ht,a as ft,V as gt,q as De,b as za,D as Ha,c as Wa,i as zt,u as Ga,_ as qa}from"./index-a68c34ce.js";import{H as Ka}from"./vue-cf4704c5.js";import{Z as Za}from"./mitt-595fde69.js";import{A as Qa,C as na,D as sa}from"./@vueuse-94002c77.js";import{D as Ya,f as Xa,e as el,u as oa,B as ia}from"./@element-plus-2d29260d.js";import{w as oe,x as bt,y as tl,z as yt,A as ra,B as al,C as ll,D as be,F as le,G as _t,H as kt,I as At,J as It,K as Tt,L as ua,M as we,N as ee,O as z,P as q,Q as nl,R as sl,S as Rt,T as Pt,U as Ne,V as ol,W as Ot,X as il,Y as rl,Z as ul,_ as cl,$ as dl,a0 as pl,a1 as ml,a2 as vl,a3 as hl,a4 as re,a5 as ve,a6 as tt,a7 as at,a8 as fl,a9 as gl,aa as bl,ab as yl,t as _l,ac as ze,ad as kl}from"./element-plus-c2fe9826.js";import{d as B,a4 as Vl,r as k,y as T,o as d,W as _,e as R,a5 as X,c as b,ae as ca,X as h,S as ne,u as o,a0 as G,$ as S,U as K,a8 as jl,p as ae,ak as da,ai as pa,b5 as Ye,m as lt,a3 as Oe,b as w,Z as Q,a1 as W,F as M,af as $,am as nt,A as wl,Y as Ce,a as ke,a2 as Ie,ac as Vt,aw as Cl,_ as Bt,ad as ma,i as va,g as El,h as ha,a6 as qe,w as Nt,ag as Ke,bt as Je,s as rt,aJ as Sl,q as Ht,n as He,bg as xl,be as Dl}from"./@vue-5541be01.js";import"./echarts-49a0d1a7.js";import"./tslib-91fede61.js";import"./zrender-de217655.js";import"./lodash-es-593c6505.js";import"./@ctrl-03fa0c70.js";import"./@popperjs-7c8154ca.js";import"./async-validator-66f3b930.js";const fa="0.6.24",Wt="Vue",Al=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeUnmount","unmounted","errorCaptured","renderTracked","renderTriggered","activated","deactivated"],Gt=["$el","$emit","$nextTick","$parent","$root","$attrs","$slots","$watch","$props","$options","$forceUpdate"],Il=["vIf","vShow","vModel","vFor","vBind"],Tl=["click","dblclick","mouseenter","mouseleave","mousedown","mouseup","mouseover","contextmenu"],Rl=["keydown","keyup","keypress"],Pl=["stop","prevent","capture","self","once","passive"],Ol=["String","Number","Boolean","Array","Object"],Bl=["GET","POST","PUT","PATCH","DELETE","JSONP"];function Re(n,e,t=!1,a=!1){var l;try{const s=['"use strict";',"var __self = arguments[0];"];s.push("return ");let i=(n.value||"").trim();i=i.replace(/this(\W|$)/g,(r,c)=>`__self${c}`),i=s.join(`
`)+i;const u=`with(${t?"{}":"$scope || {}"}) { ${i} }`;return new Function("$scope",u)(e)}catch(s){if(console.error("parseExpression.error",s,n,(l=e==null?void 0:e.__self)!=null?l:e),a)throw s}}function Me(n,e,t=!1,a=!1){var s;const l=Re(n,e,t,a);if(typeof l!="function"&&(console.error("parseFunction.error","not a function",n,(s=e==null?void 0:e.__self)!=null?s:e),a))throw new Error(`"${n.value}" not a function`);return l}function ge(n,e,t=!1){let a=!0;try{n.type==="JSExpression"?Re(n,e,t,!0):Me(n,e,t,!0)}catch(l){a=!1,be.error({title:"代码错误",message:l.message})}return a}const Nl=Object.prototype.toString,Fl=n=>Nl.call(n),ut=n=>Fl(n).slice(8,-1);function pe(n){return n&&n.type==="JSExpression"}function st(n){return typeof n=="object"&&n&&n.type==="JSFunction"}function Ul(n,e){const t={};return Object.keys(n).forEach(a=>{e.includes(a)&&(t[a]=n[a])}),t}function ga(n){return typeof n=="string"?n:JSON.stringify(n)}function ba(n={},e=!1){const t=Object.keys(n);return e?t.map(a=>"."+a):t}function Ll(n=[]){const e=n.find(u=>De(u.name)==="vIf"),t=n.find(u=>De(u.name)==="vFor"),a=n.find(u=>De(u.name)==="vShow"),l=n.find(u=>De(u.name)==="vBind"),s=n.filter(u=>De(u.name)==="vModel"),i=n.filter(u=>!Il.includes(De(u.name)));return{vIf:e,vFor:t,vShow:a,vModels:s,vBind:l,others:i}}function te(n){return!!(n!=null&&n.__VTJ_BLOCK__)}function ct(n){return!!(n!=null&&n.__VTJ_NODE__)}function Jl(n){return/\.css$/.test(n)}function Ml(n){return/\.js$/.test(n)}function $l(n){return n.map(e=>`<script src="${e}"><\/script>`).join("")}function zl(n=[]){return n.map(e=>`<link rel="stylesheet" href="${e}" />`).join("")}function Hl(n){const{url:e,method:t="GET",settings:a}=n,l=a?Re(a,{}):void 0;return t.toLowerCase()==="jsonp"?s=>la(e,s,l):ea({url:e,method:t,settings:l})}function Wl(n=[]){const e=(t=[])=>{let a=[];for(const l of t)l.isDir?l.children&&l.children.length&&(a=a.concat(e(l.children))):a.push(l);return a};return e(n)}const ya="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAQd0lEQVR4nO2dCXRVxRnHf/clIPsekBgIS1hFdqVoZbGLFNTWWgQ3bLVurRYJcTuntbW22qooKKWl2toWquygIFa01doqmBBWWcomIkhACLIKyXvcnu/eefiSNzd57y4vAfI/553wuPfNzJ3/nW9m/t83M4Yx6iTVGOlAC6AD0Bs4F2gGtFT/lmtNgLpABDgMFAN7gCJgH3AQ2ACsAz5V91RbpFfDguUAg4EewBCgLdAQqJXAb5sD7RyuHVGfpcBy4AOgADjkc/k9obq0kP7AN4CrgK7qrQ8aJrALeAt4Q/3dV7XVULWEtAauBq5ThNSpqoIo7AReBWYA/6mqQlQFId2AW4HRwHmpzjwBSMv5N/BHYAHwRSozTyUhQsS9iohGqcrUI1YDE4GXgROpyDAVhMiIKBe4I0V9QxCQgcCvgdeCzigUcPo/BN4HHjiNyRAMBBYBs4BOQWYUFCFdgIXA80DHgPKoCowE3gHuCirvIAj5AfAmcEUAaVcHZAJTgHlqjuQr/CREJm/PAH8G2pyWVZ0crlbzl8v8TNQvQrLVGP5en9I7XdBV9S0/9qu8fhDSC1isZI6zEaKjTQYe8aM+vSZwqeq8u5+lZMTiYeA5oLaXRLwQMhSYe5b0F4niR8BUL6S4VXsvAWYCGZ6Kf2bi+8oVcDuQ9KzbTQvpqQS4GjKcIVrdU25+mCwhbZWuk+WhsGcLxgEPJvusyRAi84xpNR14UhD9a1QyP0iGkEeBQcGV/YyE1O+zwPnJ/CARSEc1NrBin9kQtftFoHEiT5kIIeLj/s3ZXqsecSHwUCJJVEZIGjAJaFXVT3QG4D7ga5U9RmWEiHI7/GyvSZ8QUkPhhhUlVxEhLZUcUAP/ILFld7slJK9GFgkEuRXEjjkSIh6/O0+fZzyt0EK5tLVwIiSvMltXA0+4yWluoiOkqwrVqUFwqA/ckygholI2SCUZZhjM4/bflOYrn1IwT4AZSW3eSlLpUP4/yxPSKtWtwyyBnPPgioHQtpX93Zd0TVXZEbviddcJQ59OMHwAZDTxL+8EIWFRN5a/tTwh31UxtymBtIrhF8GiBwwWPmDw2oMGg3t5rxghIi0NLugAbcRJUKoIiEUYbhwCrz9k57sgz6BvZ7u1pBBjlPk6hdjIRSHnXeV8ChzmF3DlJfDyWIP653yZ28ZP4dKHTfYdBCPNHRndsuGpmwwGdYNjJ2DiYpMnFtheI8OwTWPnLCh43KBR3S9/u/0z+N4Ek8KNYKQu9PvbKkDEQmwL6QP0S0UJhIxhA2D6PWXJEHTNhN7t7Tc46XQj0KQRzBhrMLwPNKgDLRvDY9cZfFOeLtrywjC0B2XIELTLgNm5Br072603RRgZm00sIcNSsSRAyBjSF6b/xIirEMHRE7D7gEtfZhiG9YGe2fGXLuwY41A1oOhzfRLtW8LMcQbnd0wZKd9UC40shGL+Xhl0zkLGwJ4w816D5g7juKlvwbqPwEhkvVRs2thPcfWFhvb62h02ERZqw+vL4e//1afVuTXMGW/QpV1KSMmIDaGKEtI+GSeKGwgZ/brZZLR08AzMWgY/e8l03TqyW8PXesRf2roH3t3w5aI46UdKwnDnVJNXC/XJiemcPd4gp03gpMhr8tXol+ijDwly7iFk9Opiv3VtmuvvmZsPtzxnWp2wm85cCBnRB5pr9IXFK2F/sXImKBjpcOQY3DTJ5LWV+iQvaGOTkp0Z+Ojr8mjoUJSQnkHlJG9X9xyYO96wOk0dFq6AHzxncvS4XVFJ52FCWh24+qJ4cxU5Ca8WmpZNK39VzOKhIzDmWZO31+nT7t0OZuUaZGYESkrbaOB2SMVmBeIrlwfo0h7mjTfo6ODikrdzzCSTw8eS7zdOIQzd28JXNCs3pO94f6PzGl6jNhQfhOsnmrz3P/09F+XAy7kGGc0CmzzWV2tQLEJaqD7EVwgZHdvA/DyDLpn6lN9aCzc/a/L5YfdkWJ15BIb1soe55TEv3+SYpF9BvySkFO2D6yeZrNyuv2dQV3hpnEHTRvZcJwB0jRIieko9X8kogQ5ZMC/PoJvDss531sMNE032H7QrxDVOQq168F2NuZIh9PyCsn2HE4xzYMduuPZpk3U79Td9vQdMG2vQqF4gpAgPTUPKi+XWWMRByDivpW13ezosZ/lgC9w4yWRvsUcysGWRAZ3UPKMclm6CDTsSD5gVUrbssEnZskd/jwwc/ibqQl3fSZGl4e1DakWQLxAyWjW3Z7v9HIygmIRRT5vs2mtXgBdE9SmZe6RpTJKYq8gJe5ibKEQyWb8NrnnS5KPP9D/6dn948W6DunV8JUVc5i1Dfi3GFDKaNYaX7zUY2Fl/z4ZdMPoZk493eyfDwklo2Bgu7x1/af8ReH1VYuaqPISUNZvhe0+ZfLJff8/Ir8Cff2xwTm3f3AZS0mYhxYwnCBkNG9id3lCH6aWYgJETTDZ97BMZ2Obqki5o+6klq2H7LveDBaMurNhoi427HWSW0RfDCz8ySE/3hRSplcyQ2lXHNaQg9evB9LEGlzvMZiwV9SmTddv8U1Etc2XYc4+QxiTN+cB0sRigLISU/HU2KZ85bFFz46Uw9Q5FijcnV3qUkBZuUzBPQnoaTLnd4CoHnViavDzQ6s0+S9oRaJkBwzXm6qO98M46f/Y6ElLeXwM3PGty4Kj+nluGwiOjDatMcX6X5HCutz6kFAb1gDEO08pPDyj/woYA/Aul8PULIEsjxSxaAcX73c36dRBS3iyAMZNNDjvsfJI7Avp2scvlAVYfohHBE0QELu+lH8KImbr2GdNq8ob7HLSw3sJaemW3NAxzlml0Eq+oA4veh9ummhQfiU+rTi3VWr2ZrXohT0mY0NbB4P1qnsl7+f6TYSEM7VrDEM0AYvUOyN/i/9Zs1tC5Dsx8A/70tv6erOae34JwyNOWdwbscNjyK3eEQe+eAUnXYfttbKFRdhcWmhw/7FIxrgzH4VuD4Iav6u/bVeytA5Hd7UJqj0J3SIf5+SZhTRvrrqSTCzra8rtfkIGEKLvXDIh/G4+VJC6VJAt5hqF9Ydo9BplN4398vNTuuzzm/VlIbRjpDrVg2Qb45Vz9myHu0Hn3++wOVcruAI2y+98N8OF2/82VkHFJT5hRgafzyYWwcpMnEUoq8dOQ2r3TFSy7mgaPzoDHFuhTyGkF8+4z6OqXOzSCNcQuHxwhmP2BaanMFSm7yULI6NvV1uacPJ3P/xMemWladZGMTFMO4m3ZJUV3EAcSg/XwafDT6SYTF+t/Ij7q+fcbdMn2RoqYqzoN4Dua0dWeg7BkjZ8yqU1Gz072C6UzU4KX3oO7nzeJRDz3WzJg3ivV6SAMJA4piGlA3l9MJr+h/5n4qOfeZ9C5rQdSSuGiTtBHI1z+60PYUeRf/2F5OjvaZc52GEnOWQa3TTEt/7wPcx5pIQdCapNhzxBSIibkvmjygsOw8PwsmDXesHwlrtyhJlzV31nZlf7Fg8n4Mpvj0Dkb5uYZlsnVQYIjbplicsyl21mD9SJshNSOzw6iQHIQUkojcPcfTaY5bLTaKxvm5CUfOCA6UcMmcEXf+Gtbimzvox/mSsjIaav6PQfHxOJVth/+8FEPbud4iMHdGfJ7+20h5UQp3PUHk9nL9Pf0aWcHo2W1SoKUsK3sdtJEHr+yHD53G1wXAylL+yw70uR8h70qpJ+6aaLJwSO+kiEQV1pJdGK41M+UpQlLBMmtk00WOsQ9DciBmbkG52YkGDhgwKiB8cqutMgFBfaw24u5EjKyzrXNVG9N5KPg3xtst3PxId/JKFVbn596p1b4mrwKsREhTpq2NfrR4OLOtkOrRdOKSRGJP7OV6Gbx11Zth8Jt3syV5enMgFnjDKv16rB0M4yaYLLvcx/czvGQAwM+JIaQpZ5lMQ2EFIkokbfqPxv19wzpDjPGGTRpXIE7NGJHJLbWDD1fKTD54rB7cyVkNG1im1AnT6fldp5gsmd/IGQIlkUVk+hjFHiZIFYEeYB9B2w/+vJt+hulsl8aa9CgfjwplrKbbo+uyuPIcZi/3B7qurFWklcD8XT+xGBwN/0963fans5Pinz0dMbj1Lg0SsghdTpAIJAH2b3XJuXDT/Q5fKt3DCmxbTUCHVrDZRplV2z6+iSiSmIhZrBeXTsKf5jGyYUavUkEytZPAl0vIkrfv6JfYhv6PwLLUgUObFNv26bd+nuu7AeTbzVID8V43kTZ7QPNNBrSPHHTliTfmVuhp2nwu9sMK4JEB/HnjJQYra2BL96ReeDa6JdYQpaoIXBgkAfbuN1+67Y5SJo3D4b+nWKWoaVLKKeDVLLWpZBYCiP6w/cH6y+LS0HKuGpTQP6cspgZ23/HElKsdhgNFEKK+NdHTzLZ6aCi1a6ltE/DLuqWong1WUJ8dha5JOSkPUHVQRYLSUhpQRBu53gcjV3OhmZsMt2zVzgByIMWrFeklPPGyIx7xRZ7GGu1i3T4wxLKBELvPwwTF6m5h5sCpMGba+wJbCyk1V03yeS9tSlbYyh9R5nxZ5rR4+ex33eqLYQc3h//IJNHiaV9ax00bWBw0oRFhTDur2UXfIqafPQYvFIIoZBhEZg3zSR/o/shqKS9cw98XAz9OthL6wq22v7yd9ekdMHneGBzmbJpzg8ZpXYdTQmsCWEte3Hm3gO2qdKJddbIy1RtOux9PmD1T6XQvb3tSFu+FfbsC2yeoUOhWvFcRjzSEVJXTVQCW8RTHlblnLQru6IRU3Tk5YeieyrNUpV3ekB+eGfcDPyt/FXd/FbGxRNSWTKpYCMBb5t1n8/hPaImyDwpxWTIUUpzdBecBIeZUbGrBoHgcYnJSIYQsWu/CELfqoGliMx2qoaKJLl/qGPjauAfpMf6WUV7wlemkcrOZw7LVmrgAhPVgMkRlRGytWYjTN8gXqHHKkssES/C8zWmyzPCamfwSiN8EiEkorY23VT1z3Xa4qfquL1KkaifbZfapTR1mxadOZiTzLwuGcfn20p7qUHiWKlOcEt4BWKynugp6tiKGlSObUoX3JtMXbkJDXhYEVMDZxSpzUQ3J1tHbkPLZMTwlxpCtNinDu0vcPNjt4SE1XHcf3L5+zMV0jKuTXREpYOX4MsSNfJ6+myt/XKQSfR3YkN63MDr0pawGnkldHrMGYxCdc6KZ4Xcr7VGv1F2M9ColWoKOfR+hF8TZz+P756htprN9zHN6oxSdU7hdZ7WaZaD3wfcS6TUN1SLOZN9KavVxpW/dXO8akXwmxBUWOpDyqauCiD9qkSJImGo187bCUEQEsUSdbz3A3426SrEEhUiJWbqQFDFCJIQgewK8oTacfN36vvpBmnl10s8uCyFD7rsujCgINFDnTl+bex+59UUMtP+vQr40AYkBIFUExKFbFl5gzqLKacqCuCAQ6pveEGZqNQe8VKFhEQhiwwuA66RXVj93JAzCRxTSwJmqWBzX5aJu0VVExILWZ4vCwQuVvY6M9EDfZNERAmABao1vKP6iWpREdWJkFjUUgHfMhjopD79Vb9TW20YWdlChOPK5JSoRflr1NLjfDVfcr8LUoDwed8c3yCzYFmUIB9BM3U6prQi+UjrkY9s4CnXZGdu0dWkD5CwJZFwxO0sw20JLJCFdPIJfKmFJwD/B4g2wB0X86iqAAAAAElFTkSuQmCC",Gl=[{name:"logo",type:"Logo",region:"brand",props:{text:"Tj",icon:ya}},{name:"switcher",type:"Switcher",region:"brand",props:{link:"/"}}],ql=[{name:"toolbar",type:"Toolbar",region:"toolbar"}],Kl=[{name:"actions",type:"Actions",region:"action"}],Zl=[{name:"pages",type:"Pages",region:"apps",order:1,trigger:{icon:"vtj-icon-document",label:"页面",type:"panel"}},{name:"blocks",type:"Blocks",region:"apps",order:2,trigger:{icon:"vtj-icon-components",label:"区块",type:"panel"}},{name:"components",type:"Components",region:"apps",order:3,trigger:{icon:"vtj-icon-block",label:"组件库",type:"panel"},props:{title:"组件库"}},{name:"outline",type:"Outline",region:"apps",order:4,trigger:{icon:"vtj-icon-outline",label:"大纲树",type:"panel"}},{name:"history",type:"History",region:"apps",order:4,trigger:{icon:"vtj-icon-history",label:"历史记录",type:"panel"}},{name:"api",type:"Apis",region:"apps",order:4,trigger:{icon:"vtj-icon-api",label:"Api管理",type:"panel"}},{name:"packages",type:"Dependencies",region:"apps",order:6,trigger:{icon:"vtj-icon-category",label:"依赖管理",type:"panel"}},{name:"about",type:"About",region:"apps",props:{title:"关于",width:"500px",height:"300px"},trigger:{icon:"vtj-icon-info",label:"关于",type:"dialog"}}],Ql=[{package:"vue",version:"latest",library:"Vue",urls:["./libs/vue.global.js"],required:!0,official:!0,enabled:!0},{package:"@vueuse/core",version:"latest",library:"VueUse",urls:["./libs/vueuse.shared.iife.min.js","./libs/vueuse.core.iife.min.js"],required:!1,official:!0,enabled:!0},{package:"element-plus",version:"latest",library:"ElementPlus",urls:["./libs/element-plus.index.css","./libs/element-plus.full.min.js"],assetsUrl:"./libs/element-plus-assets.js",assetsLibrary:"ElementPlusAssets",required:!1,official:!0,enabled:!0},{package:"@element-plus/icons-vue",version:"latest",library:"ElementPlusIconsVue",urls:["./libs/element-plus-icons-vue.js"],required:!1,official:!0,enabled:!0},{package:"echarts",version:"latest",library:"echarts",urls:["./libs/echarts.min.js"],required:!1,official:!0,enabled:!0},{package:"@vtj/utils",version:"latest",library:"VtjUtils",urls:["./libs/vtj-utils.js"],required:!1,official:!0,enabled:!0},{package:"@vtj/icons",version:"latest",library:"VtjIcons",urls:["./libs/vtj-icons.css","./libs/vtj-icons.js"],required:!1,official:!0,enabled:!0},{package:"@vtj/ui",version:"latest",library:"VtjUI",urls:["./libs/vtj-ui.css","./libs/vtj-ui.js"],assetsUrl:"./libs/vtj-ui-assets.js",assetsLibrary:"VtjUIAssets",required:!1,official:!0,enabled:!0},{package:"ant-design-vue",version:"latest",library:"antd",urls:["./libs/antd.css","./libs/dayjs/dayjs.min.js","./libs/dayjs/plugin/customParseFormat.js","./libs/dayjs/plugin/weekday.js","./libs/dayjs/plugin/localeData.js","./libs/dayjs/plugin/weekOfYear.js","./libs/dayjs/plugin/weekYear.js","./libs/dayjs/plugin/advancedFormat.js","./libs/dayjs/plugin/quarterOfYear.js","./libs/antd.min.js"],assetsUrl:"./libs/ant-design-vue-assets.js",assetsLibrary:"AntDesignVueAssets",required:!1,official:!0,enabled:!0}],Yl=[{name:"designer",type:"Designer",region:"workspace",disabled:!1,order:0,trigger:{label:"设计视图",type:"tab"}},{name:"schema",type:"Schema",region:"workspace",disabled:!1,order:1,trigger:{label:"Schema",type:"tab",closable:!0}},{name:"docs",type:"Docs",region:"workspace",disabled:!1,order:2,props:{url:"https://element-plus.org/zh-CN/"},trigger:{label:"帮助中心",type:"tab",closable:!0}}],Xl=[{name:"properties",type:"Properties",region:"setting",group:"Node",trigger:{label:"属性",type:"tab"}},{name:"events",type:"Events",region:"setting",group:"Node",trigger:{label:"事件",type:"tab"}},{name:"directives",type:"Directives",region:"setting",group:"Node",trigger:{label:"指令",type:"tab"}},{name:"script",type:"BlockScript",region:"setting",group:"Block",trigger:{label:"设置",type:"tab"}},{name:"dataSources",type:"DataSources",region:"setting",group:"Block",trigger:{label:"数据源",type:"tab"}},{name:"css",type:"Css",region:"setting",group:"Block",trigger:{label:"样式",type:"tab"}},{name:"advanced",type:"Advanced",region:"setting",group:"Block",trigger:{label:"定义",type:"tab"}}],en=[{name:"nodePath",type:"NodePath",region:"status",props:{}}],tn={activeApp:"pages",widgets:[...Gl,...ql,...Kl,...Zl,...Yl,...Xl,...en],dependencies:Ql};function an(n,e){const t=n.slice(0);return e.forEach(a=>{const l=t.findIndex(s=>s.name===a.name);l>-1?t.splice(l,1,ta(t[l],a)):t.push(a)}),t}function ln(n,e){const t=an(n.widgets||[],(e==null?void 0:e.widgets)||[]);return Object.assign({},n,e||{},{widgets:t})}class _a{}const qt="Project",dt="File",pt="History",Ve=new $a({prefix:"__VTJ__",type:"local"});class ka extends _a{createKey(...e){return e.join("_")}getProject(e){return N(this,null,function*(){const t=e.id||_e(),a=this.createKey(qt,t);return Ve.get(a)||(yield this.createProject(e))})}createProject(e){return N(this,null,function*(){const t=e.id||_e(),a=e.name||"未命名项目",l=this.createKey(qt,t),s=Y(U({},e),{id:t,name:a});return Ve.save(l,s),s})}updateProject(e){return N(this,null,function*(){if(!e.id)return!1;const t=yield this.getProject(e),a=Object.assign(t,e);return!!this.createProject(a)})}createFile(e){return N(this,null,function*(){const t=e.id||_e(),a=this.createKey(dt,t),l=Y(U({},e),{id:t});return Ve.save(a,l),l})}updateFile(e){return N(this,null,function*(){return e.id?!!this.createFile(e):!1})}getFile(e){return N(this,null,function*(){const t=this.createKey(dt,e);return Ve.get(t)})}removeFile(e){return N(this,null,function*(){const t=this.createKey(dt,e),a=this.createKey(pt,e);return Ve.remove(t),Ve.remove(a),!0})}saveHistory(e){return N(this,null,function*(){const{blockId:t,items:a}=e,l=this.createKey(pt,t);return Ve.save(l,a),!0})}getHistory(e){return N(this,null,function*(){const t=this.createKey(pt,e);return Ve.get(t)||[]})}}const je=ea({url:"/vtj/base.json",method:"post",settings:{type:"json",validSuccess:!0,originResponse:!1,validate:n=>{var e;return((e=n.data)==null?void 0:e.code)===0},showError:n=>{be.error({message:n||"未知错误"})}}});class nn extends _a{getProject(e){return N(this,null,function*(){const t=e.id;return(yield je({type:"getProject",data:t}).catch(a=>null))||(yield this.createProject(e))})}createProject(e){return N(this,null,function*(){const t=e.id,a=e.name||"未命名项目",l=Y(U({},e),{id:t,name:a});return yield je({type:"createProject",data:l}).catch(s=>null),l})}updateProject(e){return N(this,null,function*(){if(!e.id)return!1;const t=yield this.getProject(e),a=Object.assign(t,e);return!!this.createProject(a)})}createFile(e){return N(this,null,function*(){const t=e.id,a=Y(U({},e),{id:t});return yield je({type:"createFile",data:a}),a})}updateFile(e){return N(this,null,function*(){return e.id?!!this.createFile(e):!1})}getFile(e){return N(this,null,function*(){return yield je({type:"getFile",data:e}).catch(t=>null)})}removeFile(e){return N(this,null,function*(){return yield je({type:"removeHistory",data:e}),yield je({type:"removeFile",data:e}),!0})}saveHistory(e){return N(this,null,function*(){const{blockId:t,items:a}=e;return yield je({type:"saveHistory",data:{blockId:t,items:a}}),!0})}getHistory(e){return N(this,null,function*(){return yield je({type:"getHistory",data:e}).catch(t=>[])})}}var sn={name:"zh-cn",el:{colorpicker:{confirm:"确定",clear:"清空"},datepicker:{now:"此刻",today:"今天",cancel:"取消",clear:"清空",confirm:"确定",selectDate:"选择日期",selectTime:"选择时间",startDate:"开始日期",startTime:"开始时间",endDate:"结束日期",endTime:"结束时间",prevYear:"前一年",nextYear:"后一年",prevMonth:"上个月",nextMonth:"下个月",year:"年",month1:"1 月",month2:"2 月",month3:"3 月",month4:"4 月",month5:"5 月",month6:"6 月",month7:"7 月",month8:"8 月",month9:"9 月",month10:"10 月",month11:"11 月",month12:"12 月",weeks:{sun:"日",mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六"},months:{jan:"一月",feb:"二月",mar:"三月",apr:"四月",may:"五月",jun:"六月",jul:"七月",aug:"八月",sep:"九月",oct:"十月",nov:"十一月",dec:"十二月"}},select:{loading:"加载中",noMatch:"无匹配数据",noData:"无数据",placeholder:"请选择"},cascader:{noMatch:"无匹配数据",loading:"加载中",placeholder:"请选择",noData:"暂无数据"},pagination:{goto:"前往",pagesize:"条/页",total:"共 {total} 条",pageClassifier:"页",page:"页",prev:"上一页",next:"下一页",currentPage:"第 {pager} 页",prevPages:"向前 {pager} 页",nextPages:"向后 {pager} 页",deprecationWarning:"你使用了一些已被废弃的用法，请参考 el-pagination 的官方文档"},messagebox:{title:"提示",confirm:"确定",cancel:"取消",error:"输入的数据不合法!"},upload:{deleteTip:"按 delete 键可删除",delete:"删除",preview:"查看图片",continue:"继续上传"},table:{emptyText:"暂无数据",confirmFilter:"筛选",resetFilter:"重置",clearFilter:"全部",sumText:"合计"},tree:{emptyText:"暂无数据"},transfer:{noMatch:"无匹配数据",noData:"无数据",titles:["列表 1","列表 2"],filterPlaceholder:"请输入搜索内容",noCheckedFormat:"共 {total} 项",hasCheckedFormat:"已选 {checked}/{total} 项"},image:{error:"加载失败"},pageHeader:{title:"返回"},popconfirm:{confirmButtonText:"确定",cancelButtonText:"取消"}}};function Z(){const n=va(Jt);return{engine:n,regions:n.skeleton.regions,config:n.config,emitter:n.emitter,project:n.project,assets:n.assets}}function on(n){const e=k(""),t=T(()=>{const a=e.value.toLowerCase();return!a||!n?[]:n.filter(l=>{var s;return l.name.toLowerCase().includes(a)||((s=l.title)==null?void 0:s.toLowerCase().includes(a))})});return{searchKey:e,searchResult:t}}const rn=["onClick"],un={key:1,class:"vtj-panel__header"},cn={class:"vtj-panel__title"},dn={key:1,class:"vtj-panel__subtitle"},pn={key:0,class:"vtj-panel__tools"},mn=["onClick"],vn={key:0,class:"vtj-panel__footer"},fe=B({__name:"Panel",props:{icon:{},title:{},subtitle:{},tools:{},bodyPadding:{type:Boolean,default:!0},back:{type:Boolean}},emits:["tool-click","back"],setup(n,{expose:e,emit:t}){const a=n,l=k(),s=k(),i=t;function u(c){i("tool-click",c)}function r(){i("back")}return e({panel:l,header:s}),(c,v)=>(d(),w("div",{class:"vtj-panel",ref_key:"panel",ref:l},[R("div",{ref_key:"header",ref:s,class:"vtj-panel__header-wrapper"},[a.back?(d(),w("i",{key:0,onClick:X(r,["stop"]),class:"vtj-panel__back vtj-icon-arrow-left"},null,8,rn)):S("",!0),c.title!==null?(d(),w("div",un,[ne(c.$slots,"title",{},()=>[R("div",cn,[c.icon?(d(),w("i",{key:0,class:Q(["vtj-panel__icon",c.icon])},null,2)):S("",!0),G(" "+W(c.title)+" ",1),c.subtitle?(d(),w("span",dn,W(c.subtitle),1)):S("",!0)])]),c.tools&&c.tools.length||c.$slots.tools?(d(),w("div",pn,[(d(!0),w(M,null,$(c.tools,m=>(d(),w("i",{key:m.name,class:Q(m.icon),onClick:f=>u(m)},null,10,mn))),128)),ne(c.$slots,"tools")])):S("",!0)])):S("",!0)],512),R("div",{class:Q(["vtj-panel__body",{"is-padding":a.bodyPadding}])},[ne(c.$slots,"default")],2),c.$slots.footer?(d(),w("div",vn,[ne(c.$slots,"footer")])):S("",!0)],512))}}),se=B({__name:"Dialog",props:{modelValue:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},width:{default:"80%"},height:{},top:{default:"40%"},cancel:{type:Boolean,default:!1},submit:{type:Boolean,default:!1},clear:{type:Boolean,default:!1},closable:{type:Boolean,default:!0}},emits:["close","update:modelValue","submit","clear"],setup(n,{expose:e,emit:t}){const a=Vl(),l=n,s=k(),i=T(()=>{const y=[...a.tools||[]];return l.closable&&y.push({name:"close",icon:"vtj-icon-close"}),y}),u=t,{x:r,y:c}=Bn(s),v=T(()=>({width:l.width,height:l.height,left:`${r.value}px`,top:`${c.value}px`})),m=y=>{y.name==="close"&&(u("update:modelValue",!1),u("close"))};function f(){u("update:modelValue",!1),u("close")}function g(){u("submit")}function p(){u("clear")}return e({close:f}),(y,V)=>l.modelValue?(d(),_(jl,{key:0,to:"body"},[R("div",{class:"vtj-dialog__modal",onMousemove:V[0]||(V[0]=X(()=>{},["stop"]))},null,32),b(fe,K({ref_key:"panelRef",ref:s,onMousemove:V[1]||(V[1]=X(()=>{},["stop"])),class:"vtj-dialog"},y.$attrs,{tools:i.value,style:v.value,draggable:"",onToolClick:m}),ca({default:h(()=>[ne(y.$slots,"default")]),_:2},[y.$slots.footer||y.cancel||y.submit||y.clear?{name:"footer",fn:h(()=>[ne(y.$slots,"footer",{},()=>[R("div",null,[ne(y.$slots,"action"),y.clear?(d(),_(o(oe),{key:0,type:"warning",size:"default",class:"vtj-dialog__clear",onClick:p},{default:h(()=>[G(" 清除绑定 ")]),_:1})):S("",!0)]),R("div",null,[y.cancel?(d(),_(o(oe),{key:0,onClick:f,size:"default"},{default:h(()=>[G(" 取消 ")]),_:1})):S("",!0),y.submit?(d(),_(o(oe),{key:1,type:"primary",onClick:g,size:"default"},{default:h(()=>[G(" 确定 ")]),_:1})):S("",!0)])])]),key:"0"}:void 0]),1040,["tools","style"])])):S("",!0)}}),hn=R("div",null,"该组件支持多个插槽，请选择放置到其中一个",-1),fn={class:"vtj-designer__slots"},gn=["onClick"],bn=B({__name:"SlotPicker",props:{slots:{default:()=>[]}},emits:["pick"],setup(n,{emit:e}){const t=n,a=k(!0),l=e,s=i=>{l("pick",i)};return(i,u)=>(d(),_(se,{title:"提示",width:"600px",height:"200px",modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=r=>a.value=r)},{default:h(()=>[hn,R("div",fn,[(d(!0),w(M,null,$(t.slots,r=>(d(),w("div",{onClick:c=>s(r),class:"vtj-designer__slot"},W(r.name),9,gn))),256))])]),_:1},8,["modelValue"]))}}),yn=(n,e=!0)=>{const{top:t,height:a,width:l,left:s}=n||{};if(a>100&&l>200)return"inner";let i,u;return u=t>30?"top":"bottom",i=e||s<300&&l<300?"left":"right",[i,u].join("-")},_n=n=>{const{rect:e,type:t}=n,{left:a,width:l,top:s,height:i}=e,u={left:a,width:l,top:s,height:i};switch(t){case"left":u.left=0,u.width=0;break;case"right":u.left=u.left+u.width-4,u.width=0;break;case"bottom":u.top=u.top+u.height-4,u.height=0;break;case"top":u.height=0;break}return u},mt=(n,e)=>{if(!e)return null;const{left:t,top:a,width:l,height:s}=n==="dropping"?_n(e):e.rect,i={left:`${t}px`,top:`${a}px`,width:`${l}px`,height:`${s}px`};return Y(U({},e),{style:i,position:yn(e.rect,n!=="selected")})};let We;function he(n){if(We||!n)return We;Oe(()=>{n.dispose()});const e=T(()=>mt("hover",n.hover.value)),t=T(()=>mt("dropping",n.dropping.value)),a=T(()=>mt("selected",n.selected.value)),l=i=>{const{type:u,node:r}=i;if(!r){n.selected.value=null,n.hover.value=null;return}switch(u){case"remove":n.selected.value=null;case"copy":n.setSelected(r);break;case"move":n.setSelected(r);break;case"hover":n.setHover(r);break;case"selected":n.setSelected(r);break}},s=k("pc");return E.on(Ea,i=>{s.value=i}),E.on(Ut,i=>{n.setSelected(i)}),E.on(Lt,i=>{n.setHover(i)}),E.on(Ae,i=>{n.hover.value=null,n.selected.value=null}),E.on(Sa,i=>N(this,null,function*(){yield ht(100),n.hover.value=null,i&&a.value&&n.setSelected(a.value.node)})),E.on(J,()=>N(this,null,function*(){yield ht(100),a.value&&n.setSelected(a.value.node)})),We={designer:n,hover:e,dropping:t,selected:a,onAction:l,viewportMode:s},We}function kn(n){return new Promise((e,t)=>{const a=pa(bn,{slots:n,onClose:()=>{a.unmount(),t(void 0)},onPick:l=>{a.unmount(),e(l)}});a.mount(document.createElement("div"))})}function Vn(n,e){var i,u,r,c,v;const t={state:(i=n.value)==null?void 0:i.removeState.bind(n.value),computed:(u=n.value)==null?void 0:u.removeComputed.bind(n.value),methods:(r=n.value)==null?void 0:r.removeMethods.bind(n.value),watch:(c=n.value)==null?void 0:c.removeWatch.bind(n.value),lifeCycles:(v=n.value)==null?void 0:v.removeLifeCycles.bind(n.value)},a=k(!1),l=k(Symbol()),s=k();return{list:T(()=>{var m,f;if(e==="watch")return(((m=n.value)==null?void 0:m.watch)||[]).map(g=>({title:g.source.value,model:g}));{const g=(f=n.value)==null?void 0:f[e];return Object.entries(g!=null?g:{}).map(([p,y])=>({title:p,model:{name:p,value:y}}))}}),visible:a,data:s,onAdd:m=>{l.value=Symbol(),s.value=null,a.value=!0},onEdit:m=>{l.value=Symbol(),s.value=U({},m),a.value=!0},onRemove:m=>N(this,null,function*(){if(yield re.confirm("是否确定删除?","提示",{type:"warning"}).catch(()=>!1)){const f=t[e];f&&f(e==="watch"?m:m.name)}}),keyRef:l}}const jn={block:{type:Object,default:null},data:{type:Object},type:{type:String,default:"state"},title:{type:String,default:""},nameLabel:{type:String,default:""},valueLabel:{type:String,default:""},dataType:{type:String,default:"JSExpression"},defaults:{type:String,default:""}};function wn(n){const e={name:"",value:{type:n.dataType,value:n.defaults}},t={state:n.block.setState.bind(n.block),computed:n.block.setComputed.bind(n.block),methods:n.block.setMethods.bind(n.block),lifeCycles:n.block.setLifeCycles.bind(n.block)},a=k(),l=k(),s=k(),i=T(()=>n.data?`编辑${n.title}`:`新增${n.title}`),u={name:[{required:!0,message:`${n.title}名称为必填项`}]},r=T(()=>!!n.data),c=ke(n.data||xe(e));Nt(()=>{Object.assign(c,n.data||xe(e))});const v=m=>n.data?!1:!!n.block[n.type][m];return{defaultJsData:e,title:i,model:c,formRef:a,dialogRef:l,editorRef:s,rules:u,disabled:r,onSubmit:()=>N(this,null,function*(){if(yield a.value.validate().catch(()=>!1)){if(v(c.name)){be.warning({title:"提示",message:"已存在相同名称，请更换！"});return}const m=s.value.getEditor().getValue(),f=n.block.runtimeContext;f&&ge(Y(U({},c.value),{value:m}),f)&&(c.value.value=m,t[n.type](c.name,c.value),l.value.close())}})}}const Cn={block:{type:Object,default:null},data:{type:Object}};function En(n){const e={source:{type:"JSFunction",value:"() => { }"},immediate:!1,deep:!1,handler:{type:"JSFunction",value:"() => { }"}},t=k(),a=k(),l=k(),s=k(),i=T(()=>n.data?"编辑 Watch":"新增 Watch"),u=ke(n.data||xe(e));return Nt(()=>{Object.assign(u,n.data||xe(e))}),{title:i,model:u,onSubmit:()=>N(this,null,function*(){const r=n.block.runtimeContext,c=l.value.getEditor().getValue(),v=s.value.getEditor().getValue();r&&ge(Y(U({},u.source),{value:c}),r)&&ge(Y(U({},u.handler),{value:v}),r)&&(u.source.value=c,u.handler.value=v,n.block.setWatch(U({},u)),a.value.close())}),dialogRef:a,sourceRef:l,handlerRef:s,formRef:t}}function Sn(n,e){const{selected:t}=he(),a=T(()=>{var i;return(i=t.value)==null?void 0:i.node}),l=T(()=>{var x;const i=[];if(!n.value)return i;const u=n.value.runtimeContext,r=u==null?void 0:u.__context_refs[(x=a.value)==null?void 0:x.id],c=n.value.runtimeContext===r?[]:Object.keys((r==null?void 0:r.context)||{}).filter(A=>!["context","ref"].includes(A)).map(A=>`this.context.${A}`);c.length&&i.push({title:"上下文",items:c});const v=n.value.inject.map(A=>`this.${A.name}`);v.length&&i.push({title:"注入",items:v});const m=n.value.props.map(A=>typeof A=="string"?`this.$props.${A}`:`this.$props.${A.name}`);m.length&&i.push({title:"属性",items:m});const f=Object.keys(n.value.state).map(A=>`this.state.${A}`);f.length&&i.push({title:"状态",items:f});const g=Object.keys(n.value.computed).map(A=>`this.${A}.value`);g.length&&i.push({title:"计算属性",items:g});const p=Object.keys(n.value.methods).map(A=>`this.${A}`);p.length&&i.push({title:"方法",items:p});const y=Object.keys(n.value.dataSources).map(A=>`this.${A}`);y.length&&i.push({title:"数据源",items:y});const V=Object.keys((u==null?void 0:u.$refs)||{}).map(A=>`this.$refs.${A}`);return V.length&&i.push({title:"refs",items:V}),i}),s=T(()=>{if(!e.value)return l.value;const i=e.value.toLowerCase(),u=[];return l.value.forEach(r=>{const c=r.items.filter(v=>v.toLowerCase().includes(i));c.length&&u.push({title:r.title,items:c})}),u});return{options:l,searchResult:s}}function xn(n,e){const t=[{name:"InputSetter",label:"文本"},{name:"ExpressionSetter",label:"表达式"}],a=k();ae(n,r=>N(this,null,function*(){r?a.value=(yield e.getBlockDescription(r.from))||void 0:a.value=void 0}),{immediate:!0});const l=T(()=>!n.value||!ct(n.value)?[]:[{name:"key",setters:t,value:n.value.getPropValue("key")},{name:"ref",setters:t,value:n.value.getPropValue("ref")},{name:"class",label:"class",setters:t,value:n.value.getPropValue("class")},{name:"style",label:"样式",setters:[{name:"JSONSetter",label:"JSON"},{name:"ExpressionSetter",label:"表达式"}],value:n.value.getPropValue("style")},{name:"children",label:"文本",title:"如设置组件文本，将清空子组件",setters:t,value:Array.isArray(n.value.children)?"":n.value.children}]),s=T(()=>{if(!n.value||!ct(n.value))return[];const r=a.value||e.componentMap[n.value.name]||e.elementsMap[n.value.name];return r?(r.props||[]).map(c=>{var v;return Y(U({},c),{value:(v=n.value.getPropValue(c.name))!=null?v:c.defaultValue})}):[]}),i=r=>l.value.some(c=>c.name===r)||s.value.some(c=>c.name===r),u=T(()=>!n.value||!ct(n.value)?[]:Object.keys(n.value.props).filter(r=>!i(r)).map(r=>({name:r,setters:"InputSetter",value:n.value.getPropValue(r)})));return{commonProps:l,componentProps:s,onChange:(r,c)=>{r==="children"?n.value.setChildren(c):n.value.setProp(r,c)},customProps:u,addCustom:r=>{r&&n.value.setProp(r,"")},isExist:i,removeProp:r=>{n.value.removeProp(r)},blockDescription:a}}function Dn(n,e){const t=k();ae(n,i=>N(this,null,function*(){i?t.value=(yield e.getBlockDescription(i.from))||void 0:t.value=void 0}),{immediate:!0});const a=T(()=>{var u;if(te(n.value))return[];const i=((u=n.value)==null?void 0:u.events)||{};return Tl.map(r=>({name:r,event:i[r]}))}),l=T(()=>{var u;if(te(n.value))return[];const i=((u=n.value)==null?void 0:u.events)||{};return Rl.map(r=>({name:r,event:i[r]}))}),s=T(()=>{var u,r,c;if(te(n.value))return[];const i=((u=n.value)==null?void 0:u.events)||{};return(((r=t.value)==null?void 0:r.events)||((c=e.componentMap[n.value.name])==null?void 0:c.events)||[]).map(v=>{const m=typeof v=="string"?v:v.name;return{name:m,event:i[m]}})});return{mouseEventList:a,keyboardEventList:l,componentEventList:s}}class Fe{constructor(e,t,a){j(this,"isUnset",!1);this.name=e,this.value=t,this.defaultValue=a,this.setValue(t)}setValue(e){this.value=e,this.isUnset=this.value===this.defaultValue}getValue(){var e;return(e=this.value)!=null?e:this.defaultValue}static toDsl(e={}){return Object.entries(e).reduce((t,[a,l])=>(l.isUnset||(t[a]=l.getValue()),t),{})}static parse(e={}){return Object.entries(e).reduce((t,[a,l])=>(t[a]=new Fe(a,l),t),{})}}class Pe{constructor(e){j(this,"id");j(this,"name","");j(this,"arg");j(this,"modifiers");j(this,"value");j(this,"iterator");this.id=e.id||_e(),this.update(e)}update(e){const{name:t,arg:a,modifiers:l,value:s,iterator:i}=e;this.name=t,this.arg=a,this.modifiers=l,this.value=s,this.iterator=i}static parse(e=[]){return e.map(t=>new Pe(t))}static toDsl(e=[]){return e.map(t=>{const{name:a,arg:l,modifiers:s,value:i,iterator:u,id:r}=t;return{id:r,name:a,arg:l,modifiers:s,value:i,iterator:u}})}}class Ue{constructor(e,t){j(this,"handler");j(this,"modifiers",{});this.name=e;const{handler:a}=t;this.handler=a,this.update(t)}update(e){const{handler:t,modifiers:a={}}=e;this.handler=t,this.modifiers=a}static toDsl(e){return Object.entries(e).reduce((t,[a,l])=>{const{handler:s,modifiers:i}=l;return t[a]={handler:s,modifiers:i},t},{})}static parse(e={}){return Object.entries(e).reduce((t,[a,l])=>(t[a]=new Ue(a,l),t),{})}}const Se=class Se{constructor(e,t=null){j(this,"__VTJ_NODE__",!0);j(this,"id");j(this,"name");j(this,"from");j(this,"invisible",!1);j(this,"props",{});j(this,"children","");j(this,"slot");j(this,"directives",[]);j(this,"events",{});j(this,"disposed",!1);j(this,"root",null);j(this,"lock",!1);this.schema=e,this.parent=t;const{id:a,name:l,from:s=""}=e;this.id=a||_e(),this.name=l,this.from=s,t&&(this.root=te(t)?t:t.root),this.update(e,!0),Se.nodes[this.id]=this}update(e,t=!1){Object.assign(this.schema,e);const{children:a,slot:l,props:s,directives:i,events:u}=e;this.invisible=!!e.invisible,this.setChildren(a,t),this.setSlot(l,t),this.props=Fe.parse(s),this.directives=Pe.parse(i),this.events=Ue.parse(u)}dispose(){const{children:e,disposed:t}=this;t||(Array.isArray(e)&&e.forEach(a=>a.dispose()),this.parent&&this.parent.removeChild(this),this.parent=null,this.root=null,this.disposed=!0,delete Se.nodes[this.id])}toDsl(){const{id:e,name:t,from:a,invisible:l,slot:s,children:i,props:u,directives:r,events:c}=this,v=Array.isArray(i)?i.filter(m=>!m.invisible).map(m=>m.toDsl()):i;return Y(U({},this.schema),{id:e,name:t,from:a,invisible:l,slot:s,children:v,props:Fe.toDsl(u),directives:Pe.toDsl(r),events:Ue.toDsl(c)})}setChildren(e="",t=!1){const{disposed:a}=this;a||(Array.isArray(e)?this.children=e.map(l=>new Se(l,this)):this.children=e,t||E.emit(J,this))}setSlot(e,t=!1){this.slot=typeof e=="string"?{name:e,params:[]}:e,t||E.emit(J,this)}setProp(e,t){const a=this.props[e];a?a.setValue(t):this.props[e]=new Fe(e,t),E.emit(J,this)}removeProp(e){delete this.props[e],E.emit(J,this)}getPropValue(e){const t=this.props[e];if(t)return t.getValue()}setEvent(e,t){const a=this.events[e];a?a.update(t):this.events[e]=new Ue(e,t),E.emit(J,this)}removeEvent(e){delete this.events[e],E.emit(J,this)}setDirective(e){const t=this.directives.findIndex(a=>a.id===e.id);t>=0?this.directives.splice(t,1,e):this.directives.push(e),E.emit(J,this)}removeDirective(e){const t=this.directives.findIndex(a=>a.id===e.id);t>=0&&this.directives.splice(t,1),E.emit(J,this)}appendChild(e){const{children:t,disposed:a}=this;a||(e.parent=this,e.root=this.root,Array.isArray(t)?t.push(e):this.children=[e],E.emit(J,this))}insertChild(e,t=0){const{children:a,disposed:l}=this;l||(e.parent=this,e.root=this.root,Array.isArray(a)?a.splice(t,0,e):this.children=[e],E.emit(J,this))}removeChild(e){const{children:t,disposed:a}=this;if(a||!Array.isArray(t))return;const l=t.findIndex(s=>s===e);e.parent=null,e.root=null,t.splice(l,1),E.emit(J,this)}insertAfter(e){if(!this.parent)return;const t=this.parent.children;if(Array.isArray(t)){e.parent=this.parent,e.root=this.root;const a=t.indexOf(this);t.splice(a+1,0,e),E.emit(J,this.parent)}}insertBefore(e){if(!this.parent)return;const t=this.parent.children;if(Array.isArray(t)){e.parent=this.parent,e.root=this.root;const a=t.indexOf(this);t.splice(a,0,e),E.emit(J,this.parent)}}moveNext(){const e=this.parent;if(!e)return;const t=e.children;if(Array.isArray(t)){const a=t.indexOf(this);a>-1&&a<t.length-1&&(t.splice(a,1),t.splice(a+1,0,this),E.emit(J,e))}}movePrev(){const e=this.parent;if(!e)return;const t=e.children;if(Array.isArray(t)){const a=t.indexOf(this);a>0&&(t.splice(a,1),t.splice(a-1,0,this),E.emit(J,e))}}copy(){if(!this.parent)return;const e=this.toDsl();delete e.id;const t=new Se(e);return this.insertAfter(t),t}};j(Se,"nodes",{});let $e=Se;const Kt=["name","title","inject","state","lifeCycles","methods","computed","watch","css","props","emits","slots","transform","dataSources"];class vt{constructor(e){j(this,"__VTJ_BLOCK__",!0);j(this,"id");j(this,"name","");j(this,"title","");j(this,"inject",[]);j(this,"state",{});j(this,"lifeCycles",{});j(this,"methods",{});j(this,"computed",{});j(this,"watch",[]);j(this,"css","");j(this,"props",[]);j(this,"emits",[]);j(this,"slots",[]);j(this,"transform",{});j(this,"dataSources",{});j(this,"children",[]);j(this,"lock",!1);j(this,"invisible",!1);j(this,"disposed",!1);j(this,"parent",null);j(this,"root",null);j(this,"runtimeContext");const{id:t}=e;this.id=t||_e(),this.init(e)}init(e){for(const a of Kt){const l=e[a];l&&(this[a]=l)}const{children:t=[]}=e;this.children=t.map(a=>new $e(a,this))}dispose(){this.children.map(e=>e.dispose()),this.runtimeContext=void 0,this.disposed=!0}toDsl(){const{__VTJ_BLOCK__:e,id:t,children:a}=this;return Y(U({},Kt.reduce((l,s)=>(l[s]=this[s],l),{})),{__VTJ_BLOCK__:e,id:t,children:a.map(l=>l.toDsl())})}appendChild(e,t,a){t?a==="left"||a==="top"?t.insertBefore(e):a==="right"||a==="bottom"?t.insertAfter(e):t.appendChild(e):(e.parent=this,e.root=this,this.children.push(e),E.emit(J,this))}removeChild(e){if(e.parent===this){const t=this.children.findIndex(a=>a.id===e.id||a===e);t>-1&&(e.parent=null,e.root=null,this.children.splice(t,1),E.emit(J,this))}else e.parent&&e.parent.removeChild(e)}allowDrop(e,t,a){return N(this,null,function*(){if(te(t))return!0;const l=a.componentMap,s=(yield a.getBlockDescription(t.from))||l[t.name];if(!s||!e)return!0;const{parentIncludes:i=!0,name:u}=e,{childIncludes:r=!0}=s,c=i===!0||Array.isArray(i)&&i.includes(t.name),v=r===!0||Array.isArray(r)&&r.includes(u);return c&&v})}move(e,t,a){this.removeChild(e),te(t)?t.appendChild(e):this.appendChild(e,t,a)}setState(e,t){this.state[e]=t,E.emit(J,this)}removeState(e){delete this.state[e],E.emit(J,this)}setComputed(e,t){this.computed[e]=t,E.emit(J,this)}removeComputed(e){delete this.computed[e],E.emit(J,this)}setMethods(e,t){this.methods[e]=t,E.emit(J,this)}removeMethods(e){delete this.methods[e],E.emit(J,this)}setLifeCycles(e,t){this.lifeCycles[e]=t,E.emit(J,this)}removeLifeCycles(e){delete this.lifeCycles[e],E.emit(J,this)}setWatch(e){e.id=e.id||_e();const t=this.watch.findIndex(a=>a.id&&a.id===e.id||a===e);t>-1?this.watch.splice(t,1,e):this.watch.push(e),E.emit(J,this)}removeWatch(e){const t=this.watch.findIndex(a=>a.id&&a.id===e.id||a===e);t>-1&&(this.watch.splice(t,1),E.emit(J,this))}setCss(e){this.css=e,E.emit(J,this)}setProp(e){const t=this.props.findIndex(a=>typeof a=="string"?a===e.name:a.name===e.name);t>-1?this.props.splice(t,1,e):this.props.push(e),E.emit(J,this)}removeProp(e){const t=this.props.findIndex(a=>typeof a=="string"?a===e.name:a.name===e.name);t>-1&&(this.props.splice(t,1),E.emit(J,this))}setEmit(e){const t=this.emits.findIndex(a=>a===e);t>-1?this.emits.splice(t,1,e):this.emits.push(e),E.emit(J,this)}removeEmit(e){const t=this.emits.findIndex(a=>a===e);t>-1&&(this.emits.splice(t,1),E.emit(J,this))}setSlot(e){const t=this.slots.findIndex(a=>a===e);t>-1?this.slots.splice(t,1,e):this.slots.push(e),E.emit(J,this)}removeSlot(e){const t=this.slots.findIndex(a=>a===e);t>-1&&(this.slots.splice(t,1),E.emit(J,this))}setInject(e){const t=this.inject.findIndex(a=>a.name===e.name);t>-1?this.inject.splice(t,1,e):this.inject.push(e),E.emit(J,this)}removeInject(e){const t=this.inject.findIndex(a=>a.name===e.name);t>-1&&(this.inject.splice(t,1),E.emit(J,this))}setDataSource(e){this.dataSources[e.name]=e,E.emit(J,this)}removeDataSource(e){delete this.dataSources[e],E.emit(J,this)}}class An{constructor(e,t=[]){j(this,"__VTJ_PROJECT__",!0);j(this,"id","");j(this,"name","");j(this,"description","");j(this,"homepageId","");j(this,"dependencies",k([]));j(this,"pages",k([]));j(this,"blocks",k([]));j(this,"apis",k([]));j(this,"current",k(null));this.source=t,this.load(e)}load(e){const{id:t,description:a="",name:l="",homepageId:s="",dependencies:i=[],pages:u=[],blocks:r=[],apis:c=[]}=e||{};this.id=t||_e(),this.description=a,this.name=l,this.homepageId=s,this.dependencies.value=this.mergeDeps(i,this.source),this.pages.value=u,this.blocks.value=r,this.apis.value=c}update(e){const t=this.toDsl();Object.assign(t,e),this.load(t),E.emit(me,t)}activeFile(e){this.current.value=e?new vt(e):null,E.emit(Ii,this.current.value)}mergeDeps(e,t){const a=e.filter(s=>!!s.official),l=e.filter(s=>!s.official);return t.map(s=>{const i=a.find(u=>u.package===s.package);return Object.assign(s,i||{})}).concat(l)}setDeps(e){const t=this.dependencies.value,a=t.findIndex(l=>l.package===e.package);a>-1?t.splice(a,1,U(U({},t[a]),e)):t.push(nt(e)),E.emit(me,this.toDsl())}removeDeps(e){const t=this.dependencies.value,a=t.findIndex(l=>l.package===e.package);a>-1&&(t.splice(a,1),E.emit(me,this.toDsl()))}toDsl(){const{id:e,description:t,name:a,homepageId:l,dependencies:s,pages:i,blocks:u,apis:r,__VTJ_PROJECT__:c}=this;return{__VTJ_PROJECT__:c,__VTJ_VERSION__:fa,__VTJ_DATE__:Date.now().toString(),id:e,description:t,name:a,homepageId:l,dependencies:o(s),pages:o(i),blocks:o(u),apis:o(r)}}findPage(e){const t=(a,l=[])=>{for(const s of l){if(s.id===a)return s;if(s.children&&s.children.length){const i=t(a,s.children);if(i)return i}}};return t(e,this.pages.value)}getPages(){return Wl(this.pages.value)}getHomePage(){return this.getPages().find(e=>!!e.home)}clearHomePage(){this.getPages().forEach(e=>{e.home=!1})}addPage(e,t){const{name:a,title:l,isDir:s,home:i}=e,u=new vt({name:a,title:l}),r=u.toDsl();if(e.id=r.id,i&&(this.clearHomePage(),e.home=!0),s&&(e.children=[]),t){const c=this.findPage(t);c&&(c.children?c.children.push(e):c.children=[e])}else this.pages.value.push(e);return s||E.emit(Qe,r),E.emit(me,this.toDsl()),u}updatePage(e,t){if(e.id){const a=this.findPage(e.id);a&&(Object.assign(a,e),a.home&&(this.clearHomePage(),a.home=!0),t&&(t.name=a.name,t.title=a.title,E.emit(jt,t)),E.emit(me,this.toDsl()))}}copyPage(e,t,a){var c;const l=_e(),s=Y(U({},e),{id:l}),i=Y(U({},t),{id:l}),u=a?((c=this.findPage(a))==null?void 0:c.children)||[]:this.pages.value,r=u.findIndex(v=>v.id===e.id);u.splice(r,0,s),E.emit(Qe,i),E.emit(me,this.toDsl())}removePage(e){var a;const t=(l,s)=>{const i=s.findIndex(u=>u.id===l);if(i>=0){s.splice(i,1);return}for(const u of s)if(u.children&&u.children.length)return t(l,u.children)};t(e,this.pages.value),((a=this.current.value)==null?void 0:a.id)===e&&(this.current.value=null),E.emit(wt,e),E.emit(me,this.toDsl())}addBlock(e){const t=new vt(e),a=t.toDsl(),{id:l,name:s,title:i}=a,u={id:l,name:s,title:i};return this.blocks.value.push(u),E.emit(Qe,a),E.emit(me,this.toDsl()),t}updateBlock(e,t){const{id:a}=e;Object.assign(t,e);const l=this.blocks.value,s=l.findIndex(i=>i.id===a);s>-1&&(l.splice(s,1,e),E.emit(jt,t),E.emit(me,this.toDsl()))}removeBlock(e){var l;const t=this.blocks.value,a=t.findIndex(s=>s.id===e);a>-1&&(((l=this.current.value)==null?void 0:l.id)===e&&this.activeFile(null),t.splice(a,1),E.emit(wt,e),E.emit(me,this.toDsl()))}findBlock(e){return this.blocks.value.find(t=>t.id===e)}existBlockName(e){return this.blocks.value.some(t=>t.name===e.name&&t.id!==e.id)}getFile(e){return this.findBlock(e)||this.findPage(e)}isPage(e){return typeof(e==null?void 0:e.isDir)=="boolean"}setApi(e){const t=this.apis.value,a=t.findIndex(l=>l.name===e.name);a>-1?t.splice(a,1,e):t.push(e),E.emit(me,this.toDsl())}removeApi(e){const t=this.apis.value,a=t.findIndex(l=>l.name===e);a>-1&&(t.splice(a,1),E.emit(me,this.toDsl()))}}class In{constructor(e){j(this,"index",-1);j(this,"list",[]);j(this,"max");j(this,"blockId");const{history:t,max:a=50}=e;this.blockId=t.blockId,this.max=a,this.refresh(t.items||[])}refresh(e){this.index=-1,this.list=da(e)}go(){const{index:e,list:t}=this;if(e<0)return;--this.index;const a=t[this.index];a&&(E.emit(Ri,a),E.emit(Te,a))}back(){const{index:e,list:t}=this;if(e>=t.length-1)return;e<0&&(this.index=0),++this.index;const a=t[this.index];a&&(E.emit(Pi,a),E.emit(Te,a))}push(e){const{max:t,list:a,blockId:l}=this,s={id:_e(),title:new Date().toLocaleString(),block:xe(e)};a.unshift(s),a.length>t&&(this.list=a.splice(t)),this.index=-1,E.emit(Oi,{blockId:l,item:s}),E.emit(Xe,this.toDsl())}load(e){const t=this.list.findIndex(a=>a.id===e);t>=0&&(this.index=t,E.emit(Te,this.list[t]))}remove(e){const t=this.list.findIndex(s=>s.id===e),{list:a,blockId:l}=this;if(t>-1){const s=a.splice(t,1);t===this.index?this.index=-1:this.index>=a.length&&(this.index=a.length-1),E.emit(Bi,{blockId:l,item:s[0]}),E.emit(Xe,this.toDsl())}}toDsl(){const{blockId:e,list:t}=this;return{blockId:e,items:nt(t)}}}const Tn=(n,e)=>new Pe({name:n,value:void 0,iterator:e}),Rn=(n="modelValue")=>new Pe({name:"vModel",value:void 0,arg:n});function Pn(n){if(!n)return[];const{props:e=[],events:t=[]}=n;if(e.length&&t.length){const a=t.filter(l=>(typeof l=="string"?l:l.name).startsWith("update:")).map(l=>l=typeof l=="string"?l:l.name);return a.length?e.filter(l=>a.some(s=>s.includes(l.name))):[]}return[]}function On(n,e){const t=m=>T(()=>n.value&&(n.value.directives||[]).find(f=>f.name===m)||Tn(m)),a=T(()=>Pn(e.value)),l=()=>T(()=>a.value.map(m=>(n.value.directives||[]).find(f=>f.name==="vModel"&&f.arg==m.name)||Rn(m.name))),s=t("vIf"),i=t("vShow"),u=t("vBind"),r=t("vFor"),c=l(),v={vIf:s,vShow:i,vBind:u,vFor:r};return{directives:v,vIf:s,vShow:i,vBind:u,vFor:r,vModels:c,onValueChange:(m,f)=>{const g=v[m];f?(g.value.value=f,n.value.setDirective(g.value)):(g.value.value=void 0,n.value.removeDirective(g.value))},onForChange:(m,f)=>{if(m==="value"){f?(r.value.value=f,n.value.setDirective(r.value)):n.value.removeDirective(r.value);return}(m==="item"||m==="index")&&(r.value.iterator=Y(U({},r.value.iterator),{[m]:f||void 0}),n.value.setDirective(r.value))},onModelChange:(m,f)=>{const g=parseInt(m),p=c.value[g];p&&(f?(p.value=f,n.value.setDirective(p)):(p.value=void 0,n.value.removeDirective(p)))}}}function Bn(n){const e=k(),t=k(),a=k(),l=k(0),s=k(0),i=()=>{const{innerWidth:r,innerHeight:c}=window,{left:v=0,top:m=0,width:f=0,height:g=0}=e.value,p=Math.max((r-f)/2,0),y=Math.max((c-g)/2,0);return{x:p,y}},u=r=>{const{innerWidth:c,innerHeight:v}=window,{width:m=0,height:f=0}=t.value.getBoundingClientRect();l.value=Math.max(0,r.x),r.x>c-m&&(l.value=Math.min(r.x,c-m)),s.value=Math.max(0,r.y),r.y>v-f&&(s.value=Math.min(r.y,v-f))};return ae(n,r=>{const c=r==null?void 0:r.panel;if(c){t.value=c,a.value=r==null?void 0:r.header,e.value=c.getBoundingClientRect();const v=i();l.value=v.x,s.value=v.y,Qa(t,{initialValue:i(),handle:a,onMove:m=>{u(m)}})}}),{x:l,y:s}}const Ee=B({name:"WidgetRenderer",props:{name:String,type:[String,Object],props:Object,disabled:Boolean,extendProps:Object,order:Number,visible:{type:Boolean,default:!0}},setup(n,{slots:e}){const t=va(Jt),a=k(n.visible),l=T(()=>n.type&&(t!=null&&t.skeleton)?t==null?void 0:t.skeleton.getComponent(n.type):null);return ae(()=>n.visible,s=>{s&&(a.value=s)},{immediate:!0}),lt(()=>{const s=t==null?void 0:t.skeleton;if(n.name&&s){const i=El();s.widgetInstances[n.name]=i==null?void 0:i.refs[n.name]}}),Oe(()=>{const s=t==null?void 0:t.skeleton;n.name&&s&&delete s.widgetInstances[n.name]}),()=>l.value&&!n.disabled&&a.value?ha(l.value,U({ref:n.name,name:n.name,extendProps:n.extendProps,order:n.order,style:{display:n.visible?"":"none"}},n.props)):null}}),Zt=B({__name:"InputSetter",setup(n){return(e,t)=>(d(),_(o(q),K({clearable:""},e.$attrs),null,16))}}),Qt=B({__name:"SelectSetter",props:{options:{default:()=>[]}},setup(n){const e=n;return(t,a)=>(d(),_(o(tt),K({clearable:""},t.$attrs),{default:h(()=>[(d(!0),w(M,null,$(e.options,l=>(d(),_(o(at),K({key:l.label},l),null,16))),128))]),_:1},16))}}),Nn="{{",Fn="}}",Un=B({__name:"ExpressionSetter",props:{modelValue:{default:()=>({type:"JSExpression",value:""})}},emits:["change"],setup(n,{emit:e}){const{project:t}=Z(),a=n,l=e,s=r=>{var v;const c=(v=t.current.value)==null?void 0:v.runtimeContext;return ge(r,c)},i=k(a.modelValue.value);ae(()=>a.modelValue.value,r=>{i.value=r});const u=r=>{const c={type:"JSExpression",value:r};s(c)&&l("change",c)};return(r,c)=>(d(),_(o(q),{class:"vtj-expression-setter",modelValue:i.value,"onUpdate:modelValue":c[0]||(c[0]=v=>i.value=v),onChange:u},{prefix:h(()=>[G(W(Nn))]),suffix:h(()=>[G(W(Fn))]),_:1},8,["modelValue"]))}}),de=Sl(()=>Ma(()=>import("./Editor-664f8976-23856ad3.js"),["./Editor-664f8976-23856ad3.js","./monaco-editor-c02ad91d.js","./monaco-editor-9aafa995.css","./@vue-5541be01.js"],import.meta.url)),Ln=R("i",{class:"vtj-icon-more"},null,-1),Jn={key:0,class:"vtj-tabs__check"},Ft=B({__name:"Tabs",props:{items:{default:()=>[]},modelValue:{},more:{},stretch:{type:Boolean},checkable:{type:Boolean}},emits:["update:modelValue","more","tab-remove"],setup(n,{emit:e}){var u,r;const t=n,a=k((r=t.modelValue||((u=t.items[0])==null?void 0:u.name))!=null?r:""),l=e;ae(a,()=>{l("update:modelValue",a.value)}),ae(()=>t.modelValue,c=>{a.value=c});const s=c=>{l("more",c)},i=c=>{l("tab-remove",c)};return(c,v)=>(d(),_(fe,K({class:"vtj-tabs"},c.$attrs),{title:h(()=>[b(o(_t),{type:"card",modelValue:a.value,"onUpdate:modelValue":v[0]||(v[0]=m=>a.value=m),onTabRemove:i,stretch:t.stretch},{default:h(()=>[(d(!0),w(M,null,$(t.items,m=>(d(),_(o(kt),{key:m.name,label:m.label,name:m.name,closable:m.closable,lazy:""},null,8,["label","name","closable"]))),128))]),_:1},8,["modelValue","stretch"])]),tools:h(()=>[t.more?(d(),_(o(At),{key:0,"hide-on-click":!1,size:"small",placement:"bottom-end",onCommand:s},{dropdown:h(()=>[b(o(It),null,{default:h(()=>[(d(!0),w(M,null,$(t.more,m=>(d(),_(o(Tt),{key:m.name,command:m},{default:h(()=>[t.checkable?(d(),w("span",Jn,[R("i",{class:Q(`${m.checked?"vtj-icon-check":"none"}`)},null,2)])):S("",!0),G(" "+W(m.label),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:h(()=>[Ln]),_:1})):S("",!0)]),default:h(()=>[ne(c.$slots,"default")]),_:3},16))}}),Yt=B({__name:"Icon",props:{icon:{},label:{},active:{type:Boolean,default:!1},open:{type:Boolean,default:!1}},emits:["click"],setup(n,{emit:e}){const t=n,a=e,l=T(()=>({"is-active":t.active,"is-open":t.open})),s=()=>{a("click")};return(i,u)=>(d(),_(o(ua),{effect:"dark",placement:"right",content:i.label,"show-after":600},{default:h(()=>[R("div",{class:Q(["vtj-icon",l.value]),onClick:s},[R("i",{class:Q(i.icon)},null,2)],2)]),_:1},8,["content"]))}}),ie=B({__name:"SubPanel",setup(n){return(e,t)=>(d(),_(fe,K({class:"vtj-sub-panel"},e.$attrs),ca({default:h(()=>[ne(e.$slots,"default")]),_:2},[e.$slots.footer?{name:"footer",fn:h(()=>[ne(e.$slots,"footer")]),key:"0"}:void 0]),1040))}}),Mn=["onClick"],$n={class:"vtj-data-item__title"},zn={class:"vtj-data-item__action"},Hn=["onClick"],Wn=["onClick"],Gn={key:0,class:"vtj-data-item__body"},ue=B({__name:"DataItem",props:{title:{default:""},content:{default:""},editable:{type:Boolean,default:!1},removable:{type:Boolean,default:!1},active:{type:Boolean,default:!1},collapsible:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},collapsed:{type:Boolean,default:!1},background:{type:Boolean,default:!0}},emits:["click","remove","edit"],setup(n,{emit:e}){const t=n,a=e,l=k(t.collapsed),s=()=>{a("edit")},i=()=>{a("remove")},u=()=>{t.clickable?a("click"):r()},r=()=>{t.collapsible&&(l.value=!l.value)};return(c,v)=>(d(),w("div",{class:Q(["vtj-data-item",{"is-current":t.active}])},[R("div",{class:Q(["vtj-data-item__header",{"is-pointer":t.clickable||t.collapsible,"is-bg":t.background}]),onClick:u},[t.collapsible?(d(),w("i",{key:0,class:Q(["vtj-icon-greater arrow",{open:!l.value}]),onClick:X(r,["stop"])},null,10,Mn)):S("",!0),R("div",$n,[ne(c.$slots,"title",{},()=>[G(W(t.title),1)])]),R("div",zn,[ne(c.$slots,"action"),t.editable?(d(),w("i",{key:0,class:"vtj-icon-edit",title:"编辑",onClick:X(s,["stop"])},null,8,Hn)):S("",!0),t.removable?(d(),w("i",{key:1,class:"vtj-icon-remove",title:"删除",onClick:X(i,["stop"])},null,8,Wn)):S("",!0)])],2),t.content||c.$slots.default?Ce((d(),w("div",Gn,[ne(c.$slots,"default",{},()=>[G(W(t.content),1)])],512)),[[Ie,!l.value]]):S("",!0)],2))}}),qn={class:"vtj-context-viewer"},Kn=["onClick"],Zn=B({__name:"ContextViewer",emits:["pick"],setup(n,{emit:e}){const t=e,{copy:a}=sa({}),{project:l}=Z(),s=T(()=>{var f;return(f=l.current.value)==null?void 0:f.runtimeContext}),i=["$provider","$apis","$components","context"],u=f=>{const g=f.value,p=ut(g);return p==="Object"||p==="Module"?Object.keys(g||{}).length===0:p==="Array"?g.length===0:!0},r=(f,g="this")=>typeof f=="object"?Array.isArray(f)?f.map((p,y)=>{const V=`[${y}]`;return{label:V,value:p,type:ut(p),path:`${g}${V}`}}):Object.entries(f).map(([p,y])=>({label:p,value:y,type:ut(y),path:`${g}.${p}`})).filter(p=>!p.label.startsWith("__")&&!i.includes(p.label)):[],c=(f,g)=>{if(f.level===0)g(r(s.value));else{const p=nt(f.data.value);g(r(p,f.data.path))}},v=f=>{a(f.path),ve.success({message:"已经复制到粘贴板"})},m=f=>{t("pick",f.path)};return(f,g)=>(d(),w("div",qn,[s.value?(d(),_(o(Rt),{key:0,lazy:"",load:c,"expand-on-click-node":!1,props:{isLeaf:u}},{default:h(({data:p})=>[b(o(ue),{title:p.label,clickable:"",onClick:y=>m(p)},{action:h(()=>[R("i",{class:"vtj-icon-copy",title:"复制",onClick:X(y=>v(p),["stop"])},null,8,Kn)]),_:2},1032,["title","onClick"])]),_:1},8,["props"])):S("",!0)]))}}),Qn={key:0,class:"vtj-binder__common"},Yn=["onClick"],Xn={class:"vtj-binder__footer"},ot=B({__name:"Binder",props:{clearable:{type:Boolean,default:!0}},emits:["submit","cancel","remove","pick"],setup(n,{expose:e,emit:t}){const a=n,l=t,s=[{name:"common",label:"常用"},{name:"viewer",label:"高级"}],i=k("common"),{project:u}=Z(),r=k(""),{searchResult:c}=Sn(u.current,r),{copy:v}=sa({}),m=k(),f=()=>{l("submit")},g=()=>{l("cancel"),m.value.close()},p=()=>{l("remove")},y=x=>{l("pick",x)},V=x=>{v(x),ve.success({message:"已经复制到粘贴板"})};return e({close:()=>{m.value.close()}}),(x,A)=>(d(),_(se,{ref_key:"dialogRef",ref:m,"body-padding":!1,width:"1000px",height:"600px"},{default:h(()=>[b(o(bt),{class:"vtj-binder"},{default:h(()=>[b(o(yt),null,{default:h(()=>[b(Ft,{items:s,modelValue:i.value,"onUpdate:modelValue":A[1]||(A[1]=O=>i.value=O)},{default:h(()=>[i.value==="common"?(d(),w("div",Qn,[b(o(q),{modelValue:r.value,"onUpdate:modelValue":A[0]||(A[0]=O=>r.value=O),size:"small",clearable:"","prefix-icon":o(oa),placeholder:"筛选可用项"},null,8,["modelValue","prefix-icon"]),(d(!0),w(M,null,$(o(c),O=>(d(),w("div",null,[b(o(Ot),{"border-style":"dotted"},{default:h(()=>[G(W(O.title),1)]),_:2},1024),(d(!0),w(M,null,$(O.items,I=>(d(),_(ue,{clickable:"",title:I,onClick:D=>y(I)},{action:h(()=>[R("i",{class:"vtj-icon-copy",title:"复制",onClick:X(D=>V(I),["stop"])},null,8,Yn)]),_:2},1032,["title","onClick"]))),256))]))),256)),o(c).length?S("",!0):(d(),_(o(le),{key:0}))])):S("",!0),i.value==="viewer"?(d(),_(Zn,{key:1,onPick:y})):S("",!0)]),_:1},8,["modelValue"])]),_:1}),b(o(ra),null,{default:h(()=>[b(fe,{title:null},{footer:h(()=>[R("div",Xn,[R("span",null,[a.clearable?(d(),_(o(oe),{key:0,size:"default",type:"warning",onClick:p},{default:h(()=>[G(" 移除绑定 ")]),_:1})):S("",!0)]),R("span",null,[b(o(oe),{size:"default",onClick:g},{default:h(()=>[G("取消")]),_:1}),b(o(oe),{size:"default",type:"primary",onClick:f},{default:h(()=>[G(" 确定 ")]),_:1})])])]),default:h(()=>[ne(x.$slots,"default")]),_:3})]),_:3})]),_:3})]),_:3},512))}}),es=B({__name:"VarBinder",props:{value:{default:""},defaults:{default:""},type:{default:"JSExpression"}},emits:["submit"],setup(n,{emit:e}){const t=n,a=e,{project:l}=Z(),s=k(t.value||t.defaults),i=T(()=>`绑定内容 [ ${t.type} ]`),u=k(),r=k(),c=f=>{var p;const g=(p=l.current.value)==null?void 0:p.runtimeContext;return ge({value:f,type:t.type},g)},v=()=>{const f=u.value.getEditor().getValue().trim();f?c(f)&&(a("submit",{type:t.type,value:f}),r.value.close()):be.warning({message:"请输入绑定内容"})},m=f=>{var g;(g=u.value)!=null&&g.getEditor()&&(s.value=f)};return(f,g)=>(d(),_(ot,{ref_key:"binderRef",ref:r,title:"变量绑定",onSubmit:v,onPick:m},{default:h(()=>[b(o(ee),{class:"vtj-var-binder","label-position":"top"},{default:h(()=>[b(o(z),{label:i.value},{default:h(()=>[b(o(de),{ref_key:"editorRef",ref:u,"model-value":s.value,width:"100%",height:"100%",dark:""},null,8,["model-value"])]),_:1},8,["label"])]),_:1})]),_:1},512))}}),ts=B({__name:"EventBinder",props:{name:{},event:{},node:{}},emits:["submit","remove"],setup(n,{emit:e}){var p,y,V;const{assets:t,project:a}=Z(),l=n,s=e,i=k(),u=k(),r=k(Object.keys(((p=l.event)==null?void 0:p.modifiers)||{}));T(()=>{var O;const x=(O=l.node)==null?void 0:O.name;if(!x)return[];const A=t.componentMap[x];if(A&&A.events){const I=A.events.find(D=>D===l.name||D.name===l.name);if(I&&I.params)return I.params||[]}return[]});const c=k(((V=(y=l.event)==null?void 0:y.handler)==null?void 0:V.value)||`() => {\r
\r
}`),v=x=>{var O;const A=(O=a.current.value)==null?void 0:O.runtimeContext;return ge({value:x,type:"JSFunction"},A)},m=()=>{const x=i.value.getEditor().getValue().trim();if(x){if(v(x)){const A={handler:{type:"JSFunction",value:x},modifiers:r.value.reduce((O,I)=>(O[I]=!0,O),{})};s("submit",A),u.value.close()}}else be.warning({message:"请输入绑定内容"})},f=x=>{var A;(A=i.value)!=null&&A.getEditor()&&(c.value=x)},g=()=>{s("remove",l.name)};return(x,A)=>(d(),_(ot,{ref_key:"binderRef",ref:u,title:"事件绑定",subtitle:l.name,onSubmit:m,onPick:f,onRemove:g},{default:h(()=>[b(o(ee),{class:"vtj-event-binder","label-position":"top"},{default:h(()=>[b(o(z),{label:"事件修饰符"},{default:h(()=>[b(o(pl),{modelValue:r.value,"onUpdate:modelValue":A[0]||(A[0]=O=>r.value=O)},{default:h(()=>[(d(!0),w(M,null,$(o(Pl),O=>(d(),_(o(ml),{key:O,label:O},null,8,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),b(o(z),{label:"事件处理函数"},{default:h(()=>[b(o(de),{ref_key:"editorRef",ref:i,width:"100%",height:"360px",dark:"","model-value":c.value},null,8,["model-value"])]),_:1})]),_:1})]),_:1},8,["subtitle"]))}}),as=["draggable","onDragstart","onClick","title"],ls=["src"],ns={key:1,class:"vtj-components__name"},ss={key:2,class:"vtj-components__footer"},os=["onClick"],is=["onClick"],Ze=B({__name:"ComponentList",props:{list:{default:()=>[]},span:{default:6},editable:{type:Boolean},removable:{type:Boolean},active:{},type:{}},emits:["edit","remove","click"],setup(n,{emit:e}){const t=n,a=e;function l(c,v){return N(this,null,function*(){t.type==="Schema"&&(c.from={type:"Schema",id:c.id}),E.emit(St,c)})}function s(){E.emit(xt)}function i(c){a("edit",c)}function u(c){a("remove",c)}function r(c){a("click",c)}return(c,v)=>t.list.length?(d(),_(o(hl),{key:0,class:"vtj-components__box",gutter:10},{default:h(()=>[(d(!0),w(M,null,$(t.list,m=>(d(),_(o(vl),{span:t.span},{default:h(()=>[R("div",{class:Q(["vtj-components__item",{"is-active":t.active&&t.active(m)}]),draggable:!(t.active&&t.active(m)),onDragstart:f=>l(m),onDragend:s,onClick:f=>r(m),title:m.name},[m.icon?(d(),w("img",{key:0,src:m.icon,alt:""},null,8,ls)):(d(),w("span",ns,W(m.name),1)),R("span",null,W(m.title),1),t.editable||t.removable?(d(),w("div",ss,[t.editable?(d(),w("i",{key:0,onClick:X(f=>i(m),["stop"]),class:"vtj-icon-edit"},null,8,os)):S("",!0),t.removable?(d(),w("i",{key:1,onClick:X(f=>u(m),["stop"]),class:"vtj-icon-remove"},null,8,is)):S("",!0)])):S("",!0)],42,as)]),_:2},1032,["span"]))),256))]),_:1})):(d(),_(o(le),{key:1,description:"暂无数据","image-size":60}))}}),rs={key:0,class:"vtj-list-panel__search"},us=R("i",{class:"vtj-icon-search"},null,-1),Va=B({__name:"ListPanel",props:{search:{type:[Boolean,Object],default:!1},tabs:{default:void 0},columnWidth:{default:100}},emits:["search-change"],setup(n,{emit:e}){var c,v;const t=n,a=k(null),l=k(6),s=e,i=k(""),u=T(()=>typeof t.search=="boolean"?{}:t.search);ae(i,()=>{s("search-change",i.value)});const r=k((v=(c=t.tabs)==null?void 0:c[0])==null?void 0:v.name);return na(a,m=>{const f=m[0],{width:g}=f.contentRect,p=Math.min(Math.floor(g/120),24);l.value=Math.floor(24/p)}),(m,f)=>(d(),_(fe,{class:"vtj-list-panel",ref_key:"panel",ref:a},{default:h(()=>[t.search?(d(),w("div",rs,[b(o(q),K({size:"small"},u.value,{modelValue:i.value,"onUpdate:modelValue":f[0]||(f[0]=g=>i.value=g),clearable:""}),{prefix:h(()=>[us]),_:1},16,["modelValue"])])):S("",!0),t.search&&i.value?(d(),_(o(_t),{key:1},{default:h(()=>[b(o(kt),{label:"搜索结果"},{default:h(()=>[ne(m.$slots,"search",{search:i.value,span:l.value})]),_:3})]),_:3})):S("",!0),Ce(b(o(_t),{modelValue:r.value,"onUpdate:modelValue":f[1]||(f[1]=g=>r.value=g),class:"vtj-list-panel__tabs"},{default:h(()=>[(d(!0),w(M,null,$(t.tabs,g=>(d(),_(o(kt),{key:g.name,label:g.label,name:g.name,lazy:""},{default:h(()=>[ne(m.$slots,"tab",{tab:g,span:l.value},()=>[g.component?(d(),_(Bt(g.component),K({key:0,tab:g.name,currentTab:r.value,search:i.value,span:l.value},g.props),null,16,["tab","currentTab","search","span"])):S("",!0)])]),_:2},1032,["label","name"]))),128))]),_:3},8,["modelValue"]),[[Ie,t.tabs&&!i.value]]),ne(m.$slots,"default",{currentTab:r.value,search:i.value,span:l.value})]),_:3},512))}}),cs=B({__name:"JSONSetter",props:{modelValue:{type:[Boolean,String,Number,null,Array,Object],default:void 0}},emits:["change"],setup(n,{emit:e}){const t=n,a=k(),l=k(typeof t.modelValue=="object"?JSON.stringify(t.modelValue,null,2):void 0),s=T(()=>!!l.value),i=k(!1),u=e,r=f=>{let g=!0;try{if(typeof JSON.parse(f)!="object")throw new Error(`"${f}" is not a JSON`)}catch(p){g=!1,be.error({title:"代码错误",message:(p==null?void 0:p.message)||p})}return g},c=()=>{var g;const f=(g=a.value)==null?void 0:g.getEditor();if(f){const p=f.getValue();r(p)&&(l.value=p,u("change",JSON.parse(p)),i.value=!1)}},v=()=>{l.value="",u("change",void 0),i.value=!1},m=()=>{i.value=!0};return(f,g)=>(d(),w("div",{class:Q(["vtj-json-setter",{"is-active":s.value}])},[b(o(q),K({readonly:"",onFocus:m,"model-value":"JSON","suffix-icon":o(ia)},f.$attrs),null,16,["suffix-icon"]),i.value?(d(),_(o(se),{key:0,modelValue:i.value,"onUpdate:modelValue":g[0]||(g[0]=p=>i.value=p),title:"JSON",width:"1000px",height:"600px",cancel:"",submit:"",clear:"",onSubmit:c,onClear:v},{default:h(()=>[b(o(de),{ref_key:"codeEditor",ref:a,height:"100%",lang:"json",dark:"","model-value":l.value},null,8,["model-value"])]),_:1},8,["modelValue"])):S("",!0)],2))}}),ds=B({__name:"FunctionSetter",props:{modelValue:{default:()=>({type:"JSFunction",value:""})}},emits:["change"],setup(n,{emit:e}){const t=n,a=k(),l=k(t.modelValue.value),s=k(!1),i=T(()=>!!l.value),u=e,r=()=>{var f;const m=(f=a.value)==null?void 0:f.getEditor();if(m){const g=m.getValue(),p={type:"JSFunction",value:g};ge(p,{})&&(l.value=g,u("change",p),s.value=!1)}},c=()=>{l.value="",u("change",void 0),s.value=!1},v=()=>{s.value=!0};return(m,f)=>(d(),w("div",{class:Q(["vtj-function-setter",{"is-active":i.value}])},[b(o(q),K({readonly:"",onFocus:v,"model-value":"JSFunction","suffix-icon":o(ia)},m.$attrs),null,16,["suffix-icon"]),s.value?(d(),_(o(se),{key:0,modelValue:s.value,"onUpdate:modelValue":f[0]||(f[0]=g=>s.value=g),title:"JSFunction",width:"1000px",height:"600px",cancel:"",submit:"",clear:"",onSubmit:r,onClear:c},{default:h(()=>[b(o(de),{ref_key:"codeEditor",ref:a,height:"100%","model-value":l.value,dark:""},null,8,["model-value"])]),_:1},8,["modelValue"])):S("",!0)],2))}}),ps=B({__name:"BooleanSetter",setup(n){return(e,t)=>(d(),_(o(we),K(e.$attrs,{"model-value":!!e.$attrs.modelValue}),null,16,["model-value"]))}}),ms=B({__name:"ColorSetter",setup(n){return(e,t)=>(d(),_(o(bl),Vt(ma(e.$attrs)),null,16))}}),vs=B({__name:"NumberSetter",props:{modelValue:{}},emits:["change"],setup(n,{emit:e}){const t=n,a=e,l=T(()=>pe(t.modelValue)?void 0:Number(t.modelValue||0)),s=i=>{a("change",i)};return(i,u)=>(d(),_(o(yl),K({class:"vtj-number-setter","controls-position":"right","model-value":l.value},i.$attrs,{onChange:s}),null,16,["model-value"]))}}),hs={class:"vtj-icon-setter"},fs={class:"vtj-icon-setter__content"},gs={class:"vtj-icon-setter__list"},ja=B({__name:"IconSetter",props:{modelValue:{default:""}},emits:["change","update:modelValue"],setup(n,{emit:e}){const t=n,a=e,l=k(!1),s=k(t.modelValue),i=k(""),u=T(()=>gt[t.modelValue]||t.modelValue),r=T(()=>{const g=Object.entries(gt);return i.value?g.filter(p=>p[0].toLowerCase().includes(i.value)):g}),c=g=>{s.value=g},v=()=>{a("change",s.value),a("update:modelValue",s.value),l.value=!1},m=()=>{s.value="",a("change",""),a("update:modelValue",""),l.value=!1},f=()=>{l.value=!0};return(g,p)=>(d(),w("div",hs,[b(o(q),{size:"small",readonly:"",placeholder:"请选择图标","model-value":t.modelValue,"suffix-icon":o(el),onFocus:f},{prepend:h(()=>[b(o(ft),{icon:u.value},null,8,["icon"])]),_:1},8,["model-value","suffix-icon"]),l.value?(d(),_(o(se),{key:0,title:"图标选择器",width:"1000px",height:"600px",cancel:"",submit:"",clear:"",modelValue:l.value,"onUpdate:modelValue":p[1]||(p[1]=y=>l.value=y),onSubmit:v,onClear:m},{default:h(()=>[R("div",fs,[b(o(q),{size:"small","prefix-icon":o(oa),clearable:"",modelValue:i.value,"onUpdate:modelValue":p[0]||(p[0]=y=>i.value=y),placeholder:"请输入查询关键字"},null,8,["prefix-icon","modelValue"]),R("div",gs,[(d(!0),w(M,null,$(r.value,y=>(d(),_(o(ft),{icon:y[1],onClick:V=>c(y[0]),class:Q({"is-active":s.value===y[0]})},null,8,["icon","onClick","class"]))),256)),r.value.length===0?(d(),_(o(le),{key:0})):S("",!0)])])]),_:1},8,["modelValue"])):S("",!0)]))}}),Xt={StringSetter:Zt,InputSetter:Zt,SelectSetter:Qt,OptionSetter:Qt,ExpressionSetter:Un,JSONSetter:cs,FunctionSetter:ds,BooleanSetter:ps,ColorSetter:ms,NumberSetter:vs,IconSetter:ja},wa={string:["InputSetter","SelectSetter"],number:["NumberSetter"],boolean:["BooleanSetter"],object:["JSONSetter"],function:["FunctionSetter"],array:["JSONSetter"],JSFunction:["FunctionSetter"],JSExpression:["ExpressionSetter"]},bs={key:1},ys={class:"vtj-setter__content"},_s={key:0,class:"vtj-setter__input"},ks={class:"vtj-setter__action"},Vs=R("i",{class:"vtj-icon-switch",title:"切换设置器"},null,-1),js={key:0,class:"vtj-icon-check"},ws={key:1,class:"vtj-icon-placeholder"},Cs="{{",Es="}}",Ss=B({__name:"SetterView",props:{name:{},label:{default:""},title:{},setters:{},variable:{type:Boolean,default:!0},value:{},options:{default:()=>[]},defaultSetter:{},removable:{type:Boolean}},emits:["change","remove"],setup(n,{emit:e}){const t=n,a=e,l=k(!1),s=k(""),i=k(t.setters.find(x=>x.name===t.defaultSetter)||t.setters[0]),u=k(t.value),r=T(()=>!!pe(u.value)),c={[i.value.name]:u.value},v=x=>{var A;c[i.value.name]=u.value,i.value=x,u.value=(A=c[x.name])!=null?A:void 0,m(u.value)};ae(()=>t.value,()=>{u.value=t.value}),ae(()=>t.defaultSetter,()=>{i.value=t.setters.find(x=>x.name===t.defaultSetter)||t.setters[0]});const m=x=>{a("change",x)},f=()=>{a("remove",t.name)},g=()=>{l.value=!0,s.value=pe(u.value)?u.value.value:""},p=()=>{l.value=!1,s.value=""},y=x=>{c[i.value.name]=u.value,u.value=x,a("change",x),p()},V=()=>{p(),u.value=void 0,a("change","")};return(x,A)=>(d(),_(o(z),{class:"vtj-setter",size:"small","label-positon":"left"},{label:h(()=>[t.title?(d(),_(o(ua),{key:0,placement:"top-start",content:t.title},{default:h(()=>[G(W(t.label||t.name),1)]),_:1},8,["content"])):(d(),w("span",bs,W(t.label||t.name),1))]),default:h(()=>[R("div",ys,[i.value?(d(),w("div",_s,[r.value?S("",!0):(d(),_(Bt(i.value.component),K({key:0},i.value.props,{options:t.options,modelValue:u.value,"onUpdate:modelValue":A[0]||(A[0]=O=>u.value=O),onChange:m,disabled:r.value}),null,16,["options","modelValue","disabled"])),r.value?(d(),_(o(q),{key:1,class:"vtj-expression-setter",disabled:"","model-value":"JSExpression"},{prefix:h(()=>[G(W(Cs))]),suffix:h(()=>[G(W(Es))]),_:1})):S("",!0)])):S("",!0),R("div",ks,[t.variable?(d(),w("i",{key:0,onClick:g,class:Q(["vtj-icon-vars",{"is-active":r.value}]),title:"绑定变量"},null,2)):S("",!0),t.setters.length>1?(d(),_(o(At),{key:1,disabled:r.value,size:"small","popper-class":"vtj-setter-switch",onCommand:v},{dropdown:h(()=>[b(o(It),null,{default:h(()=>[(d(!0),w(M,null,$(t.setters,O=>(d(),_(o(Tt),{command:O,key:O.name},{default:h(()=>[O.name==i.value.name?(d(),w("i",js)):(d(),w("i",ws)),G(" "+W(O.label),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:h(()=>[Vs]),_:1},8,["disabled"])):S("",!0),t.removable?(d(),w("i",{key:2,onClick:f,class:"vtj-icon-remove",title:"删除"})):S("",!0)])]),l.value?(d(),_(es,{key:0,type:"JSExpression",value:s.value,modelValue:l.value,"onUpdate:modelValue":A[1]||(A[1]=O=>l.value=O),onSubmit:y,onRemove:V},null,8,["value","modelValue"])):S("",!0)]),_:1}))}}),ye=B({name:"SetterRenderer",props:{name:String,label:String,title:String,value:{type:[String,Object,Array,Number,Boolean],default:void 0},setters:{type:[String,Object,Array],required:!0,default(){return[]}},options:{type:Array,default(){return[]}},variable:{type:Boolean,default:!0},removable:{type:Boolean,default:!1}},computed:{computedSetters(){return(Array.isArray(this.setters)?this.setters:[this.setters]).map(n=>{let e;if(typeof n=="string")return e=this.getComopnent(n),{component:Ye(e),name:n,label:n,props:{}};{const t=n;return e=t.component||this.getComopnent(t.name),{component:Ye(e),name:t.name,label:t.label||t.name,props:t.props}}})},computedOptions(){return(this.options||[]).map(n=>typeof n=="string"?{label:n,value:n}:n)},defaultSetter(){var l,s;const{value:n,computedSetters:e}=this;let t=typeof n;t==="object"&&(Array.isArray(n)?t="array":pe(n)?t="JSExpression":st(n)&&(t="JSFunction"));const a=wa[t]||[];return a.length?(l=e.find(i=>a.includes(i.name))||e[0])==null?void 0:l.name:(s=e[0])==null?void 0:s.name}},render(){const{name:n,label:e,title:t,value:a,computedSetters:l,computedOptions:s,variable:i,changeValue:u,defaultSetter:r,removable:c,onRemove:v}=this;return ha(Ss,{name:n,label:e,title:t,setters:l,defaultSetter:r,variable:i,value:a,removable:c,options:s,onChange:u,onRemove:v})},emits:["change","remove"],methods:{getComopnent(n){return typeof n=="string"?Xt[n]||Xt.InputSetter:n},changeValue(n){this.$emit("change",this.name,n)},onRemove(n){this.$emit("remove",n)}}}),xs={class:"vtj-action"},Ds=B({__name:"action",setup(n){const{regions:e}=Z(),t=T(()=>e.value.action);return(a,l)=>(d(),w("div",xs,[(d(!0),w(M,null,$(t.value,s=>(d(),_(o(Ee),K({key:s.name},U({},s)),null,16))),128))]))}}),As=(n,e)=>{const t=n.__vccOpts||n;for(const[a,l]of e)t[a]=l;return t},Is={};function Ts(n,e){return d(),w("div",null,"Empty")}const Rs=As(Is,[["render",Ts]]),Ps=["title","src"],Os={key:1},Bs=B({__name:"Logo",props:{icon:{},text:{default:"Vtj"},link:{}},setup(n,{expose:e}){const t=n,a=()=>{t.link&&(location.href=t.link)};return e({props:t}),(l,s)=>(d(),w("div",{class:"vtj-logo",onClick:a},[t.icon?(d(),w("img",{key:0,title:t.text,class:"vtj-logo__icon",src:t.icon},null,8,Ps)):(d(),w("span",Os,W(t.text),1))]))}}),Ns=R("div",null,"多个资源可换行输入",-1),Fs=B({__name:"Dependencies",setup(n){const{project:e}=Z(),t=[{name:"add",icon:"vtj-icon-plus"}],a={package:{required:!0,message:"包名不能为空"},version:{required:!0,message:"版本不能为空"},library:{required:!0,message:"导出变量名称不能为空"},urls:{required:!0,message:"资源URL不能为空"}},l=k(),s=k(),i=k(!1),u=k(!1),r=T(()=>e.dependencies.value),c=p=>{e.setDeps(p)},v=()=>{i.value=!0,u.value=!1,l.value={package:"",version:"",library:"",urls:"",assetsUrl:"",assetsLibrary:""}},m=p=>{i.value=!0,u.value=!0,l.value={package:p.package,version:p.version,library:p.library,urls:p.urls.join(`
`),assetsUrl:p.assetsUrl||"",assetsLibrary:p.assetsLibrary||""}},f=p=>{re.confirm("确定删除该依赖项？","提示",{type:"warning"}).then(()=>{e.removeDeps(p)})},g=()=>{s.value.validate(p=>{var D,C;if(!p)return;const{version:y,library:V,urls:x,assetsUrl:A,assetsLibrary:O}=l.value;if(!((D=l.value)!=null&&D.package))return;const I={package:(C=l.value)==null?void 0:C.package,version:y,library:V,urls:x.trim().split(`
`),assetsUrl:A,assetsLibrary:O};e.dependencies.value.find(F=>F.package===I.package)&&!u.value?ve.warning({message:"已存在相同名称的依赖包"}):(e.setDeps(nt(I)),i.value=!1)})};return(p,y)=>(d(),_(fe,{class:"vtj-deps",title:"依赖管理",tools:t,onToolClick:v},{default:h(()=>[(d(!0),w(M,null,$(r.value,V=>(d(),_(ue,{key:V.package,removable:!V.official,editable:!V.official,class:Q({"vtj-deps__disabled":!V.enabled}),onEdit:x=>m(V),onRemove:x=>f(V)},{action:h(()=>[!V.required&&V.official?(d(),_(o(we),{key:0,size:"small",modelValue:V.enabled,"onUpdate:modelValue":x=>V.enabled=x,onChange:x=>c(V)},null,8,["modelValue","onUpdate:modelValue","onChange"])):S("",!0)]),title:h(()=>[G(W(V.package)+"@"+W(V.version),1)]),_:2},1032,["removable","editable","class","onEdit","onRemove"]))),128)),i.value?(d(),_(se,{key:0,modelValue:i.value,"onUpdate:modelValue":y[6]||(y[6]=V=>i.value=V),title:`${u.value?"编辑":"新增"}依赖`,width:"1000px",height:"500px",submit:"",cancel:"",onSubmit:g},{default:h(()=>[l.value?(d(),_(o(ee),{key:0,ref_key:"form",ref:s,size:"small","label-width":"80px",model:l.value,rules:a},{default:h(()=>[b(o(z),{label:"npm包名",prop:"package"},{default:h(()=>[b(o(q),{modelValue:l.value.package,"onUpdate:modelValue":y[0]||(y[0]=V=>l.value.package=V),modelModifiers:{trim:!0},readonly:u.value,disabled:u.value},null,8,["modelValue","readonly","disabled"])]),_:1}),b(o(z),{label:"版本号",prop:"version"},{default:h(()=>[b(o(q),{modelValue:l.value.version,"onUpdate:modelValue":y[1]||(y[1]=V=>l.value.version=V),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),b(o(z),{label:"导出名称",prop:"library"},{default:h(()=>[b(o(q),{modelValue:l.value.library,"onUpdate:modelValue":y[2]||(y[2]=V=>l.value.library=V),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),b(o(z),{label:"资源URL",prop:"urls"},{default:h(()=>[b(o(q),{type:"textarea",rows:5,modelValue:l.value.urls,"onUpdate:modelValue":y[3]||(y[3]=V=>l.value.urls=V)},null,8,["modelValue"]),Ns]),_:1}),b(o(z),{label:"资产URL",prop:"assetsUrl"},{default:h(()=>[b(o(q),{modelValue:l.value.assetsUrl,"onUpdate:modelValue":y[4]||(y[4]=V=>l.value.assetsUrl=V),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),b(o(z),{label:"资产名称",prop:"assetsLibrary"},{default:h(()=>[b(o(q),{modelValue:l.value.assetsLibrary,"onUpdate:modelValue":y[5]||(y[5]=V=>l.value.assetsLibrary=V),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])):S("",!0)]),_:1},8,["modelValue","title"])):S("",!0)]),_:1}))}}),Us=B({__name:"Viewport",props:{mode:{default:"pc"},width:{},height:{}},setup(n){const e=n,t={width:390,height:844},a={width:1180,height:820},l=T(()=>[`is-${e.mode}`]),s=T(()=>{if(e.mode==="pc")return 1;const u=e.mode==="mobile"?t:a,{width:r,height:c}=u,v=r>0?(e.width||0)/r:1,m=c>0?(e.height||0)/c:1;return Math.min(v,m)}),i=T(()=>{if(e.mode==="pc")return{};const u=e.mode==="mobile"?t:a,{width:r,height:c}=u;return{width:`${r}px`,height:`${c}px`,left:"50%",top:"50%",transform:`translate(-50%, -50%) scale(${s.value})`}});return(u,r)=>(d(),w("div",{class:Q(["vtj-viewport",l.value]),style:qe(i.value)},[ne(u.$slots,"default")],6))}}),Ls={class:"vtj-actions__layers"},Js=R("i",{class:"vtj-icon-layers"},null,-1),Ms={key:0,class:"vtj-actions__tools"},$s=B({__name:"Actions",props:{position:{default:"left-top"},node:{},title:{default:""},path:{default:()=>[]}},emits:["action"],setup(n,{emit:e}){const t=n,a=e,l=T(()=>te(t.node)),s=T(()=>t.path);function i(g){return te(g)?"Block":"Node"}function u(){if(t.node.lock){ve.warning({message:"该节点已被锁定，不能删除"});return}re.confirm("确定删除吗？","提示",{type:"warning"}).then(()=>{t.node.dispose(),He(()=>{a("action",{type:"remove"})})})}function r(){t.node.moveNext(),He(()=>{a("action",{type:"move",next:!0,node:t.node})})}function c(){t.node.movePrev(),He(()=>{a("action",{type:"move",prev:!0,node:t.node})})}function v(){const g=t.node.copy();He(()=>{a("action",{type:"copy",node:g})})}function m(g){a("action",{type:"hover",node:g})}function f(g){a("action",{type:"selected",node:g})}return(g,p)=>(d(),w("div",{class:Q(["vtj-actions",[`is-${t.position}`]])},[R("div",Ls,[b(o(At),{size:"small",onCommand:f},{dropdown:h(()=>[s.value&&s.value.length?(d(),_(o(It),{key:0},{default:h(()=>[(d(!0),w(M,null,$(s.value,y=>(d(),_(o(Tt),{key:y.id,command:y,onMouseenter:V=>m(y)},{default:h(()=>[G(W(y.name)+" ",1),R("i",{class:Q(`is-${i(y)}`)},W(i(y)),3)]),_:2},1032,["command","onMouseenter"]))),128))]),_:1})):S("",!0)]),default:h(()=>[R("div",null,[Js,G(W(t.title),1)])]),_:1})]),l.value?S("",!0):(d(),w("div",Ms,[R("i",{class:"vtj-icon-arrow-up",title:"向前移动",onClick:c}),R("i",{class:"vtj-icon-arrow-down",title:"向后移动",onClick:r}),R("i",{onClick:v,class:"vtj-icon-copy",title:"复制"}),R("i",{onClick:u,class:"vtj-icon-remove",title:"删除"})]))],2))}}),zs={key:1,class:"vtj-designer__placeholder"},Hs=B({__name:"Designer",setup(n,{expose:e}){const{engine:t}=Z(),a=k(),l=k(),s=k({width:0,height:0});na(l,x=>{const A=x[0];s.value=A.contentRect});const i=new mr(t,a,kn),{hover:u,dropping:r,selected:c,onAction:v,viewportMode:m}=he(i),f=t.project.current,g=T(()=>{var x;return((x=f.value)==null?void 0:x.children.length)===0}),p=T(()=>{var x;return te((x=u.value)==null?void 0:x.node)}),y=T(()=>{var x;return te((x=c.value)==null?void 0:x.node)}),V=T(()=>{var O;const{width:x=0,height:A=0}=((O=c.value)==null?void 0:O.rect)||{};return x>0||A>0});return e({designer:i,selected:c}),(x,A)=>(d(),w("div",{ref_key:"container",ref:l,class:"vtj-designer"},[Ce(b(Us,{mode:o(m),width:s.value.width,height:s.value.height},{default:h(()=>[R("iframe",{ref_key:"iframe",ref:a,frameborder:"0"},null,512),o(r)?(d(),w("div",{key:0,class:Q(["vtj-designer__dropping","is-inner"]),style:qe(o(r).style)},null,4)):S("",!0),o(u)?(d(),w("div",{key:1,class:"vtj-designer__hover",style:qe(o(u).style)},[Ce(R("span",{class:Q(["vtj-designer__hover-title",`is-${o(u).position}`])},[G(W(o(u).node.name)+": ",1),R("i",null,W(o(u).node.id),1)],2),[[Ie,!p.value]])],4)):S("",!0),o(c)?Ce((d(),w("div",{key:2,class:"vtj-designer__selected",style:qe(o(c).style)},[y.value?S("",!0):(d(),_($s,{key:0,title:o(c).node.name,node:o(c).node,path:o(c).path,position:o(c).position,onAction:o(v)},null,8,["title","node","path","position","onAction"]))],4)),[[Ie,V.value]]):S("",!0)]),_:1},8,["mode","width","height"]),[[Ie,o(f)]]),o(f)?S("",!0):(d(),_(o(le),{key:0,description:"请在文档管理器新建或打开文件"})),g.value?(d(),w("div",zs," 您可以拖拽组件放置到这里 ")):S("",!0)],512))}}),Ws=B({__name:"Components",setup(n){const e={placeholder:"搜索组件"},{engine:t}=Z(),{componentGroups:a,components:l}=t.assets||{},s=T(()=>{const f={};return a&&a.forEach(g=>{f[g.name]=g}),f}),i=T(()=>a?a.map(f=>{var g;return{label:`${f.label} (${f.count})`,name:f.name,disabled:!((g=f.children)!=null&&g.length)}}):[]),u=(f=[])=>f.map((g,p)=>p),r=ke({});Nt(()=>{const f=i.value.reduce((g,p)=>(g[p.name]=u(s.value[p.name].children),g),{});Object.assign(r,f)});const{searchKey:c,searchResult:v}=on(l),m=f=>{c.value=f};return(f,g)=>(d(),_(Va,{class:"vtj-components",title:"组件库",search:e,tabs:i.value,onSearchChange:m},{search:h(({span:p})=>[b(Ze,{list:o(v),span:p},null,8,["list","span"])]),tab:h(({tab:p,span:y})=>{var V,x;return[s.value[p.name].components?(d(),_(Ze,{key:0,list:s.value[p.name].components,span:y},null,8,["list","span"])):S("",!0),(V=s.value[p.name].children)!=null&&V.length?(d(),_(o(nl),{key:1,modelValue:r[p.name],"onUpdate:modelValue":A=>r[p.name]=A},{default:h(()=>[(d(!0),w(M,null,$(s.value[p.name].children,(A,O)=>(d(),_(o(sl),{key:A.name,title:`${A.label} (${A.count})`,name:O},{default:h(()=>[b(Ze,{list:A.components,span:y},null,8,["list","span"])]),_:2},1032,["title","name"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):S("",!0),!s.value[p.name].components&&((x=s.value[p.name].children)==null?void 0:x.length)===0?(d(),_(o(le),{key:2,description:"暂无数据"})):S("",!0)]}),default:h(()=>[!o(a)||o(a).length===0?(d(),_(o(le),{key:0,description:"暂无数据"})):S("",!0)]),_:1},8,["tabs"]))}}),Gs=["onClick"],qs=["onClick"],Ks={class:"vtj-pages__name"},Zs={key:0,class:"vtj-pages__home"},Qs=B({__name:"Pages",setup(n){const{project:e,engine:t}=Z(),a=[{name:"add",icon:"vtj-icon-plus"}],l={name:[{required:!0,message:"名称为必填项"}],title:[{required:!0,message:"标题为必填项"}]},s=T(()=>e.pages.value),i=D=>{var C;return D===((C=e.current.value)==null?void 0:C.id)},u={id:"",name:"",title:"",isDir:!1,icon:"",mask:!0,home:!1,hidden:!1},r=k(),c=k(!1),v=k(),m=k(),f=D=>N(this,null,function*(){if(D.isDir)return;const C=D.id,F=yield t.service.getFile(C);e.activeFile(F)}),g=()=>{m.value=void 0,r.value=U({},u),c.value=!0},p=D=>{m.value=D.id,r.value=U({},u),c.value=!0},y=D=>{r.value=U({},D),c.value=!0},V=(D,C)=>N(this,null,function*(){var H;const F=D.id,P=(H=C.parent)==null?void 0:H.data.id,L=yield t.service.getFile(F);e.copyPage(D,L,P)}),x=D=>N(this,null,function*(){if(D.id){if(D.children&&D.children.length>0){ve.warning({message:"该目录有子页面文件，不能删除。"});return}(yield re.confirm("确定删除？","提示",{type:"warning"}).catch(C=>!1))&&e.removePage(D.id)}}),A=()=>N(this,null,function*(){if(yield v.value.validate().catch(D=>!1)){if(r.value.id){const D=r.value.isDir?void 0:yield t.service.getFile(r.value.id);e.updatePage(r.value,D)}else{const D=e.addPage(r.value,m.value);!e.current.value&&!r.value.isDir&&e.activeFile(D.toDsl())}c.value=!1}}),O=(D,C,F)=>F==="inner"?!!C.data.isDir:!0,I=()=>{e.update({pages:s.value})};return(D,C)=>(d(),_(o(fe),{title:"页面管理",tools:a,onToolClick:g},{default:h(()=>[s.value.length===0?(d(),_(o(le),{key:0,description:"您还没创建文件"})):S("",!0),s.value.length?(d(),_(o(Rt),{key:1,"node-key":"id","default-expand-all":!0,data:s.value,draggable:"","allow-drop":O,onNodeDrop:I,class:"vtj-pages-items"},{default:h(({node:F,data:P})=>[b(o(ue),{title:P.title,active:i(P.id),onClick:L=>f(P),onEdit:L=>y(P),onRemove:L=>x(P),clickable:!P.isDir,editable:"",removable:""},{action:h(()=>[P.isDir?(d(),w("i",{key:0,onClick:X(L=>p(P),["stop"]),class:"vtj-icon-plus",title:"新增"},null,8,Gs)):S("",!0),P.isDir?S("",!0):(d(),w("i",{key:1,onClick:X(L=>V(P,F),["stop"]),class:"vtj-icon-copy",title:"复制"},null,8,qs))]),title:h(()=>[b(o(ft),{icon:o(gt)[P.icon]||P.icon},null,8,["icon"]),G(" "+W(P.title)+" ",1),R("i",Ks,W(P.name),1),P.home?(d(),w("span",Zs,"首页 ")):S("",!0)]),_:2},1032,["title","active","onClick","onEdit","onRemove","clickable"])]),_:1},8,["data"])):S("",!0),c.value?(d(),_(o(se),{key:2,modelValue:c.value,"onUpdate:modelValue":C[7]||(C[7]=F=>c.value=F),width:"600px",title:r.value.id?"修改页面":"新增页面",submit:"",cancel:"",onSubmit:A},{default:h(()=>[b(o(ee),{ref_key:"formRef",ref:v,model:r.value,rules:l,size:"small","label-position":"right","label-width":"80px"},{default:h(()=>[b(o(z),{label:"类型",prop:"isDir"},{default:h(()=>[b(o(Pt),{modelValue:r.value.isDir,"onUpdate:modelValue":C[0]||(C[0]=F=>r.value.isDir=F),disabled:!!r.value.id},{default:h(()=>[b(o(Ne),{label:!1},{default:h(()=>[G("页面")]),_:1}),b(o(Ne),{label:!0},{default:h(()=>[G("目录")]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),b(o(z),{label:"标题描述",prop:"title"},{default:h(()=>[b(o(q),{modelValue:r.value.title,"onUpdate:modelValue":C[1]||(C[1]=F=>r.value.title=F)},null,8,["modelValue"])]),_:1}),b(o(z),{label:"名称编码",prop:"name"},{default:h(()=>[b(o(q),{modelValue:r.value.name,"onUpdate:modelValue":C[2]||(C[2]=F=>r.value.name=F)},null,8,["modelValue"])]),_:1}),b(o(z),{label:"菜单图标",prop:"icon"},{default:h(()=>[b(ja,{modelValue:r.value.icon,"onUpdate:modelValue":C[3]||(C[3]=F=>r.value.icon=F)},null,8,["modelValue"])]),_:1}),r.value.isDir?S("",!0):(d(),_(o(z),{key:0,label:"包含母版",prop:"mask"},{default:h(()=>[b(o(we),{modelValue:r.value.mask,"onUpdate:modelValue":C[4]||(C[4]=F=>r.value.mask=F)},null,8,["modelValue"])]),_:1})),r.value.isDir?S("",!0):(d(),_(o(z),{key:1,label:"站点首页",prop:"mask"},{default:h(()=>[b(o(we),{modelValue:r.value.home,"onUpdate:modelValue":C[5]||(C[5]=F=>r.value.home=F)},null,8,["modelValue"])]),_:1})),r.value.isDir?S("",!0):(d(),_(o(z),{key:2,label:"隐藏菜单",prop:"mask"},{default:h(()=>[b(o(we),{modelValue:r.value.hidden,"onUpdate:modelValue":C[6]||(C[6]=F=>r.value.hidden=F)},null,8,["modelValue"])]),_:1}))]),_:1},8,["model"])]),_:1},8,["modelValue","title"])):S("",!0)]),_:1}))}}),Ys=B({__name:"Blocks",setup(n){const{project:e,engine:t}=Z(),a=[{name:"add",icon:"vtj-icon-plus"}],l={id:"",name:"",title:""},s={name:[{required:!0,message:"请输入组件名称",trigger:"blur"}],title:[{required:!0,message:"请输入标题备注",trigger:"blur"}]},i=k(),u=k(),r=T(()=>e.blocks.value),c=k(!1),v=V=>{var x;return V.id===((x=e.current.value)==null?void 0:x.id)},m=()=>{u.value=U({},l),c.value=!0},f=()=>N(this,null,function*(){if(yield i.value.validate().catch(V=>!1)){if(e.existBlockName(u.value)){ve.warning({message:"已存在相同名称的区块，请更换名称"});return}if(u.value.id){const V=yield t.service.getFile(u.value.id);e.updateBlock(u.value,V)}else e.addBlock(u.value);c.value=!1}}),g=V=>{u.value=V,c.value=!0},p=V=>N(this,null,function*(){(yield re.confirm("确定删除？","提示",{type:"warning"}))&&e.removeBlock(V.id)}),y=V=>N(this,null,function*(){const x=V.id,A=yield t.service.getFile(x);e.activeFile(A)});return(V,x)=>(d(),_(o(Va),{title:"区块管理",tools:a,onToolClick:m},{default:h(({span:A})=>[b(o(Ze),{list:r.value,span:A,active:v,type:"Schema",editable:"",removable:"",onEdit:g,onRemove:p,onClick:y},null,8,["list","span"]),c.value?(d(),_(o(se),{key:0,modelValue:c.value,"onUpdate:modelValue":x[2]||(x[2]=O=>c.value=O),title:u.value.id?"修改":"新增",width:"500px",submit:"",cancel:"",onSubmit:f},{default:h(()=>[b(o(ee),{ref_key:"formRef",ref:i,size:"small",model:u.value,rules:s},{default:h(()=>[b(o(z),{label:"组件名称",prop:"name"},{default:h(()=>[b(o(q),{modelValue:u.value.name,"onUpdate:modelValue":x[0]||(x[0]=O=>u.value.name=O)},null,8,["modelValue"])]),_:1}),b(o(z),{label:"标题备注",prop:"title"},{default:h(()=>[b(o(q),{modelValue:u.value.title,"onUpdate:modelValue":x[1]||(x[1]=O=>u.value.title=O)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])):S("",!0)]),_:1}))}}),Xs=R("i",{class:"vtj-icon-pc"},null,-1),eo=R("i",{class:"vtj-icon-phone"},null,-1),to=R("i",{class:"vtj-icon-pad"},null,-1),ao=R("i",{class:"vtj-icon-undo"},null,-1),lo=R("i",{class:"vtj-icon-redo"},null,-1),no=B({__name:"Toolbar",setup(n){const{engine:e}=Z(),t=k("pc"),a=T(()=>{const{index:r=0,list:c=[]}=e.simulator.history.value||{};return r<c.length-1}),l=T(()=>{const{index:r=0,list:c=[]}=e.simulator.history.value||{};return r>0}),s=()=>{var r;(r=e.simulator.history.value)==null||r.back()},i=()=>{var r;(r=e.simulator.history.value)==null||r.go()},u=r=>{E.emit(Ea,r)};return(r,c)=>(d(),w("div",null,[b(o(Pt),{size:"small",modelValue:t.value,"onUpdate:modelValue":c[0]||(c[0]=v=>t.value=v),onChange:u},{default:h(()=>[b(o(Ne),{label:"pc"},{default:h(()=>[Xs]),_:1}),b(o(Ne),{label:"mobile"},{default:h(()=>[eo]),_:1}),b(o(Ne),{label:"pad"},{default:h(()=>[to]),_:1})]),_:1},8,["modelValue"]),S("",!0),b(o(ol),null,{default:h(()=>[b(o(oe),{type:"default",size:"small",onClick:s,disabled:!a.value},{default:h(()=>[ao]),_:1},8,["disabled"]),b(o(oe),{type:"default",size:"small",onClick:i,disabled:!l.value},{default:h(()=>[lo]),_:1},8,["disabled"])]),_:1})]))}}),so={key:0,class:"vtj-outline__actions"},oo=["onClick"],io=["onClick"],ro=["onClick"],uo=["onClick"],co=["onClick"],po=["onClick"],mo={class:"vtj-outline__status"},vo={key:0,class:"vtj-icon-invisible",title:"不可见"},ho={key:1,class:"vtj-icon-lock",title:"已锁定"},fo=B({__name:"Outline",setup(n){const{engine:e,project:t,assets:a}=Z(),l=T(()=>{var I;return(I=e.skeleton.widgetInstances.designer)==null?void 0:I.designer}),s=T(()=>{var I,D;return(D=(I=l.value.selected)==null?void 0:I.value)==null?void 0:D.node.id}),i=I=>I.root===null,u=k([]);function r(I){return te(I)?"Block":I.slot&&I.slot.name?`#${I.slot.name}`:"Node"}function c(I){const D=[];return I.forEach(C=>{const F={id:C.id,label:C.name,nodeType:r(C),node:C,children:[]};Array.isArray(C.children)&&(F.children=c(C.children)),D.push(F)}),D}function v(){u.value=t.current.value?c([t.current.value]):[]}ae(t.current,v,{immediate:!0}),E.on(J,v),Oe(()=>{E.off(J,v)});const m=(I,D,C)=>N(this,null,function*(){const F=I.data,P=D.data.node,L=t.current.value;if(!L||!l.value||!P)return;const H=F.node;H.slot=yield l.value.getDropSlot(C==="inner"?P:P.parent);const ce={before:"left",after:"right"}[C]||"inner";L.move(H,P,ce),E.emit(Ae,H)}),f=I=>{const D=I.data;return te(D.node)||D.node.lock?!1:D.node.name!=="template"},g=(I,D,C)=>{const F=I.data,P=D.data;if(P.node.lock||te(P.node)&&["prev","next"].includes(C))return!1;const L=t.current.value;if(!L)return!1;const H=a.componentMap[F.node.name];if(C==="inner")return L.allowDrop(H,P.node,a);{const ce=P.node.parent;return ce&&L.allowDrop(H,ce,a)}},p=(I,D)=>{I.invisible=D,E.emit(J,I),E.emit(Ae,I)},y=(I,D)=>{I.lock=D,E.emit(J,I),E.emit(Ae,I)},V=I=>{const D=I==null?void 0:I.node;!D||D.invisible||E.emit(Ut,D)},x=I=>{var F,P,L;const D=(F=I.target)==null?void 0:F.__vueParentComponent;if(!D)return;const C=(L=(P=D.ctx)==null?void 0:P.node)==null?void 0:L.data;C&&(C.node.invisible||E.emit(Lt,C.node))},A=I=>{I.copy(),E.emit(Ae,I)},O=I=>{re.confirm("确定删除吗？","提示",{type:"warning"}).then(()=>{I.dispose(),E.emit(Ae,I)})};return(I,D)=>(d(),_(fe,{title:"大纲树",class:"vtj-outline"},{default:h(()=>[b(o(Rt),{data:u.value,"node-key":"id","default-expand-all":"",draggable:"","empty-text":"请新建或打开文件","current-node-key":s.value,"highlight-current":!0,"expand-on-click-node":!1,"allow-drop":g,"allow-drag":f,onCurrentChange:V,onNodeDrop:m,onMouseover:x},{default:h(({data:C})=>[(d(),w("div",{key:C.node.id,class:"vtj-outline__item"},[R("span",null,[G(W(C.label)+": ",1),R("i",{class:Q(`is-${C.nodeType}`)},W(C.nodeType),3)]),i(C.node)?S("",!0):(d(),w("span",so,[C.node.lock?S("",!0):(d(),w("i",{key:0,onClick:X(F=>y(C.node,!0),["stop"]),class:"vtj-icon-lock",title:"锁定"},null,8,oo)),C.node.lock?(d(),w("i",{key:1,onClick:X(F=>y(C.node,!1),["stop"]),class:"vtj-icon-unlock",title:"解锁"},null,8,io)):S("",!0),!C.node.invisible&&!C.node.lock?(d(),w("i",{key:2,onClick:X(F=>p(C.node,!0),["stop"]),class:"vtj-icon-invisible",title:"设置隐藏"},null,8,ro)):S("",!0),C.node.invisible&&!C.node.lock?(d(),w("i",{key:3,onClick:X(F=>p(C.node,!1),["stop"]),class:"vtj-icon-visible",title:"设置显示"},null,8,uo)):S("",!0),C.node.root!==C.node&&!C.node.lock?(d(),w("i",{key:4,onClick:F=>A(C.node),class:"vtj-icon-copy",title:"复制"},null,8,co)):S("",!0),C.node.root!==C.node&&!C.node.lock?(d(),w("i",{key:5,onClick:X(F=>O(C.node),["stop"]),class:"vtj-icon-remove",title:"删除"},null,8,po)):S("",!0)])),R("span",mo,[C.node.invisible?(d(),w("i",vo)):S("",!0),C.node.lock?(d(),w("i",ho)):S("",!0)])]))]),_:1},8,["data","current-node-key"])]),_:1}))}}),go={class:"vtj-setting-panel"},bo=B({__name:"Properties",setup(n){const{assets:e}=Z(),{selected:t}=he(),a=T(()=>{var A;return(A=t.value)==null?void 0:A.node}),{commonProps:l,componentProps:s,onChange:i,isExist:u,addCustom:r,customProps:c,removeProp:v}=xn(a,e),m=[{name:"add",icon:"vtj-icon-plus"}],f={name:[{required:!0,message:"熟悉名称为必填项"}]},g=ke({name:""}),p=k(!1),y=A=>{p.value=!0,g.name=""},V=()=>{const A=Object.keys(a.value.props);g.name&&!u(g.name)&&!A.includes(g.name)?(r(g.name),p.value=!1):be.warning({message:"已存在该属性名称"})},x=A=>N(this,null,function*(){(yield re.confirm("确定删除?","提示",{type:"warning"}).catch(O=>!1))&&v(A)});return(A,O)=>(d(),w("div",go,[b(o(ie),{title:"通用属性"},{default:h(()=>[b(o(ee),{size:"small","label-width":"100px",onKeydown:O[0]||(O[0]=Ke(X(()=>{},["prevent","stop"]),["enter"]))},{default:h(()=>[(d(!0),w(M,null,$(o(l),I=>(d(),_(o(ye),K({key:`${I.name}_${a.value.id}`},I,{onChange:o(i)}),null,16,["onChange"]))),128))]),_:1})]),_:1}),o(s).length?(d(),_(o(ie),{key:0,title:"组件属性"},{default:h(()=>[b(o(ee),{size:"small","label-width":"100px",onKeydown:O[1]||(O[1]=Ke(X(()=>{},["prevent","stop"]),["enter"]))},{default:h(()=>[(d(!0),w(M,null,$(o(s),I=>(d(),_(o(ye),K({key:`${I.name}_${a.value.id}`},I,{onChange:o(i)}),null,16,["onChange"]))),128))]),_:1})]),_:1})):S("",!0),b(o(ie),{title:"自定义属性",tools:m,onToolClick:y},{default:h(()=>[b(o(ee),{size:"small","label-width":"100px",onKeydown:O[2]||(O[2]=Ke(X(()=>{},["prevent","stop"]),["enter"]))},{default:h(()=>[(d(!0),w(M,null,$(o(c),I=>(d(),_(o(ye),K({key:`${I.name}_${a.value.id}`},I,{removable:"",onChange:o(i),onRemove:x}),null,16,["onChange"]))),128))]),_:1})]),_:1}),b(o(se),{modelValue:p.value,"onUpdate:modelValue":O[4]||(O[4]=I=>p.value=I),title:"新增属性",width:"400px",submit:"",cancel:"",onSubmit:V},{default:h(()=>[b(o(ee),{ref:"formRef",size:"small",rules:f,model:g},{default:h(()=>[b(o(z),{label:"属性名称",prop:"name"},{default:h(()=>[b(o(q),{modelValue:g.name,"onUpdate:modelValue":O[3]||(O[3]=I=>g.name=I)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]))}}),yo={class:"vtj-setting-panel vtj-events"},_o=B({__name:"Events",setup(n){const{assets:e}=Z(),{selected:t}=he(),a=T(()=>{var g;return(g=t.value)==null?void 0:g.node}),{mouseEventList:l,keyboardEventList:s,componentEventList:i}=Dn(a,e),u=k(!1),r=k(),c=k(Symbol()),v=g=>{c.value=Symbol(),r.value=g,u.value=!0},m=g=>{r.value&&a.value.setEvent(r.value.name,g)},f=g=>N(this,null,function*(){(yield re.confirm("确定删除事件绑定？","提示",{type:"warning"}).catch(p=>!1))&&(a.value.removeEvent(g),r.value=null,u.value=!1)});return(g,p)=>(d(),w("div",yo,[b(o(ie),{title:"组件事件"},{default:h(()=>[(d(!0),w(M,null,$(o(i),y=>(d(),_(o(ue),{title:y.name,active:!!y.event,removable:!!y.event,background:!1,editable:"",clickable:"",onClick:V=>v(y),onEdit:V=>v(y),onRemove:V=>f(y.name)},null,8,["title","active","removable","onClick","onEdit","onRemove"]))),256)),o(i).length===0?(d(),_(o(le),{key:0,"image-size":50,description:"该组件无自带事件"})):S("",!0)]),_:1}),b(o(ie),{title:"鼠标事件"},{default:h(()=>[(d(!0),w(M,null,$(o(l),y=>(d(),_(o(ue),{title:y.name,active:!!y.event,removable:!!y.event,background:!1,editable:"",clickable:"",onClick:V=>v(y),onEdit:V=>v(y),onRemove:V=>f(y.name)},null,8,["title","active","removable","onClick","onEdit","onRemove"]))),256))]),_:1}),b(o(ie),{title:"键盘事件"},{default:h(()=>[(d(!0),w(M,null,$(o(s),y=>(d(),_(o(ue),{title:y.name,active:!!y.event,removable:!!y.event,background:!1,editable:"",clickable:"",onClick:V=>v(y),onEdit:V=>v(y),onRemove:V=>f(y.name)},null,8,["title","active","removable","onClick","onEdit","onRemove"]))),256))]),_:1}),r.value?(d(),_(o(ts),K({key:c.value,modelValue:u.value,"onUpdate:modelValue":p[0]||(p[0]=y=>u.value=y),node:a.value},r.value,{onSubmit:m,onRemove:f}),null,16,["modelValue","node"])):S("",!0)]))}}),ko=B({__name:"JSDataDialog",props:jn,setup(n){const e=n,{title:t,model:a,formRef:l,dialogRef:s,editorRef:i,rules:u,onSubmit:r,disabled:c}=wn(e),v=m=>{a.value.value=m};return(m,f)=>(d(),_(o(ot),K({ref_key:"dialogRef",ref:s,title:o(t),width:"1000px",height:"600px",clearable:!1},m.$attrs,{onSubmit:o(r),onPick:v}),{default:h(()=>[b(o(ee),{ref_key:"formRef",ref:l,size:"small","label-position":"top",model:o(a),rules:o(u)},{default:h(()=>[b(o(z),{label:e.nameLabel,prop:"name"},{default:h(()=>[m.type==="lifeCycles"?(d(),_(o(tt),{key:0,modelValue:o(a).name,"onUpdate:modelValue":f[0]||(f[0]=g=>o(a).name=g),disabled:o(c)},{default:h(()=>[(d(!0),w(M,null,$(o(Al),g=>(d(),_(o(at),{label:g,value:g},null,8,["label","value"]))),256))]),_:1},8,["modelValue","disabled"])):(d(),_(o(q),{key:1,modelValue:o(a).name,"onUpdate:modelValue":f[1]||(f[1]=g=>o(a).name=g),disabled:o(c)},null,8,["modelValue","disabled"]))]),_:1},8,["label"]),b(o(z),{label:e.valueLabel},{default:h(()=>[b(o(de),{ref_key:"editorRef",ref:i,border:!0,height:"380px",width:"100%",dark:"","model-value":o(a).value.value},null,8,["model-value"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},16,["title","onSubmit"]))}}),Vo=B({__name:"WatchDataDialog",props:Cn,setup(n){const e=n,{title:t,model:a,onSubmit:l,dialogRef:s,sourceRef:i,handlerRef:u,formRef:r}=En(e),c=v=>{a.handler.value=v};return(v,m)=>(d(),_(o(ot),K({ref_key:"dialogRef",ref:s,title:o(t),width:"1000px",height:"600px",clearable:!1},v.$attrs,{onSubmit:o(l),onPick:c}),{default:h(()=>[b(o(ee),{ref_key:"formRef",ref:r,size:"small","label-position":"top"},{default:h(()=>[b(o(z),{label:"侦听源 [ JSFunction ]",prop:"source"},{default:h(()=>[b(o(de),{ref_key:"sourceRef",ref:i,border:!0,height:"100px",width:"100%",dark:"","model-value":o(a).source.value},null,8,["model-value"])]),_:1}),b(o(z),{label:"deep",prop:"deep"},{default:h(()=>[b(o(we),{modelValue:o(a).deep,"onUpdate:modelValue":m[0]||(m[0]=f=>o(a).deep=f)},null,8,["modelValue"])]),_:1}),b(o(z),{label:"immediate",prop:"immediate"},{default:h(()=>[b(o(we),{modelValue:o(a).immediate,"onUpdate:modelValue":m[1]||(m[1]=f=>o(a).immediate=f)},null,8,["modelValue"])]),_:1}),b(o(z),{label:"处理函数 [ JSFunction ]",prop:"handler"},{default:h(()=>[b(o(de),{ref_key:"handlerRef",ref:u,border:!0,height:"180px",width:"100%",dark:"","model-value":o(a).handler.value},null,8,["model-value"])]),_:1})]),_:1},512)]),_:1},16,["title","onSubmit"]))}}),Be=B({__name:"BlockScriptGroup",props:{block:{},type:{},dataType:{},title:{},nameLabel:{},valueLabel:{},defaults:{}},setup(n){const e=n,t=T(()=>e.block),a=[{name:"add",icon:"vtj-icon-plus"}],{data:l,list:s,onAdd:i,onEdit:u,onRemove:r,visible:c,keyRef:v}=Vn(t,e.type);return(m,f)=>(d(),_(o(ie),{title:e.title,tools:a,onToolClick:o(i)},{default:h(()=>[b(o(ee),{size:"small","label-width":"100px",onKeydown:f[0]||(f[0]=Ke(X(()=>{},["prevent","stop"]),["enter"]))},{default:h(()=>[(d(!0),w(M,null,$(o(s),g=>(d(),_(o(ue),{title:g.title,background:!1,editable:"",clickable:"",removable:"",onClick:p=>o(u)(g.model),onEdit:p=>o(u)(g.model),onRemove:p=>o(r)(g.model)},null,8,["title","onClick","onEdit","onRemove"]))),256)),o(s).length?S("",!0):(d(),_(o(le),{key:0,"image-size":40}))]),_:1}),o(c)&&e.type!=="watch"?(d(),_(ko,{key:o(v),block:t.value,data:o(l),title:e.title,type:e.type,nameLabel:e.nameLabel,valueLabel:e.valueLabel,dataType:e.dataType,defaults:e.defaults,modelValue:o(c),"onUpdate:modelValue":f[1]||(f[1]=g=>Ht(c)?c.value=g:null)},null,8,["block","data","title","type","nameLabel","valueLabel","dataType","defaults","modelValue"])):S("",!0),o(c)&&e.type==="watch"?(d(),_(Vo,{key:o(v),block:t.value,data:o(l),modelValue:o(c),"onUpdate:modelValue":f[2]||(f[2]=g=>Ht(c)?c.value=g:null)},null,8,["block","data","modelValue"])):S("",!0)]),_:1},8,["title","onToolClick"]))}}),jo={class:"vtj-setting-panel"},wo=B({__name:"BlockScript",setup(n){const{selected:e}=he(),t=T(()=>{var a;return(a=e.value)==null?void 0:a.node});return(a,l)=>(d(),w("div",jo,[b(Be,{title:"状态数据",type:"state",block:t.value,nameLabel:"状态数据名称",valueLabel:"状态初始值 [ JSExpression ]","data-type":"JSExpression",defaults:"null"},null,8,["block"]),b(Be,{title:"计算属性",type:"computed",block:t.value,nameLabel:"计算属性名称",valueLabel:"计算函数 [ JSFunction ]","data-type":"JSFunction",defaults:"() => { }"},null,8,["block"]),b(Be,{title:"组件方法",type:"methods",block:t.value,nameLabel:"方法名称",valueLabel:"方法函数 [ JSFunction ]","data-type":"JSFunction",defaults:"() => { }"},null,8,["block"]),b(Be,{title:"生命周期",type:"lifeCycles",block:t.value,nameLabel:"名称",valueLabel:"函数 [ JSFunction ]","data-type":"JSFunction",defaults:"() => { }"},null,8,["block"]),b(Be,{title:"Watch",type:"watch","data-type":"JSFunction",block:t.value},null,8,["block"])]))}}),Co=B({__name:"Css",setup(n){const{selected:e}=he(),t=T(()=>{var i;return(i=e.value)==null?void 0:i.node}),a=[{name:"save",icon:"vtj-icon-np-save"}],l=k(),s=(i=!1)=>{var r;const u=(r=l.value)==null?void 0:r.getEditor().getValue();u!==t.value.css&&(t.value.setCss(u),i&&ve.success({message:"保存成功"}))};return(i,u)=>(d(),_(o(fe),{class:"vtj-setting-css",title:null,"body-padding":!1},{default:h(()=>[t.value?(d(),_(o(ie),{key:0,title:"CSS",tools:a,onToolClick:u[0]||(u[0]=r=>s(!0))},{default:h(()=>[b(o(de),{ref_key:"editorRef",ref:l,height:"100%",lang:"css",dark:"","model-value":t.value.css,onBlur:s},null,8,["model-value"])]),_:1})):S("",!0)]),_:1}))}}),Eo={class:"vtj-schema"},So=B({__name:"Schema",setup(n){const{project:e,emitter:t}=Z(),a=k(""),l=k(),s=[{name:"save",icon:"vtj-icon-np-save"}],i=()=>{e.current.value?a.value=JSON.stringify(e.current.value.toDsl(),null,2):a.value=""},u=()=>N(this,null,function*(){if(!e.current.value)return;const r=l.value.getEditor().getValue();if(r){if(!(yield re.confirm("手动修改DSL有风险，可能导致页面无法加载，请确认您的操作无误。","提示",{type:"warning"}).catch(c=>!1)))return;try{const c=JSON.parse(r);e.activeFile(c),t.emit(J,e.current.value),ve.success({message:"修改成功"})}catch(c){be.warning({message:c.message,title:"代码错误"})}}});return t.on(J,i),ae(e.current,i),lt(()=>{i()}),Oe(()=>{t.off(J,i)}),(r,c)=>(d(),w("div",Eo,[b(o(ie),{class:"vtj-schema__panel",subtitle:"手动修改DSL有风险，可能导致页面无法加载，请确认您的操作无误。","body-padding":!1,tools:s,onToolClick:u},{default:h(()=>[b(o(de),{ref_key:"editorRef",ref:l,height:"100%",lang:"json",dark:"","model-value":a.value},null,8,["model-value"])]),_:1})]))}}),xo=R("i",{class:"vtj-icon-refresh"},null,-1),Do=R("i",{class:"vtj-icon-setting"},null,-1),Ao=R("i",{class:"vtj-icon-outline"},null,-1),Io=B({__name:"Actions",props:{coder:{type:Boolean,default:!1},copy:{type:Boolean,default:!1}},setup(n){const e=n,{project:t,engine:a,emitter:l}=Z(),s=k(!1),i=k(!1),u=()=>{var p;if(t.current.value){const{designer:y}=he();y.selected.value=null,(p=a.simulator.renderer)==null||p.render(t.current.value)}else ve.warning({message:"请先打开文件"})},r=()=>{var y;const p=(y=t.current.value)==null?void 0:y.id;if(p){const V=t.getFile(p);l.emit(xa,V)}else ve.warning({message:"请先打开文件"})},c=()=>{if(t.current.value){const{designer:p}=he();p.setSelected(t.current.value);const y=Je(a.skeleton.regionInstances.setting);y&&y.change(0)}else ve.warning({message:"请先打开文件"})},v=()=>{t.current.value?Je(a.skeleton.regionInstances.apps).setCurrentWidget("outline"):ve.warning({message:"请先打开文件"})},m=()=>{l.emit(Aa,s)},f=()=>{l.emit(Ia,i)},g=()=>{const p=t.getHomePage();if(!p){ve.warning({message:"请先设置项目首页"});return}l.emit(Da,p)};return(p,y)=>(d(),w("div",null,[b(o(oe),{onClick:u,type:"default",size:"small",title:"刷新"},{default:h(()=>[xo]),_:1}),b(o(oe),{type:"default",size:"small",title:"页面设置",onClick:c},{default:h(()=>[Do]),_:1}),b(o(oe),{type:"default",size:"small",title:"页面大纲树",onClick:v},{default:h(()=>[Ao]),_:1}),b(o(Ot),{direction:"vertical"}),b(o(oe),{type:"primary",size:"small",icon:o(Ya),onClick:g},{default:h(()=>[G(" 浏览 ")]),_:1},8,["icon"]),b(o(oe),{type:"success",size:"small",onClick:r},{default:h(()=>[G("预览")]),_:1}),e.coder?(d(),_(o(oe),{key:0,type:"warning",size:"small",onClick:m,loading:s.value},{default:h(()=>[G(" 出码 ")]),_:1},8,["loading"])):S("",!0),e.copy?(d(),_(o(oe),{key:1,type:"danger",size:"small",onClick:f,loading:i.value},{default:h(()=>[G(" 复制 ")]),_:1},8,["loading"])):S("",!0)]))}}),To={class:"vtj-setting-panel vtj-directives"},Ro=B({__name:"Directives",setup(n){const{assets:e}=Z(),{selected:t}=he(),a=T(()=>{var p;return(p=t.value)==null?void 0:p.node}),l=T(()=>e.componentMap[a.value.name]),s=p=>p.arg?typeof p.arg=="string"?p.arg:Re(p.arg,{}):"modelValue",{vIf:i,vShow:u,vBind:r,vFor:c,vModels:v,onValueChange:m,onForChange:f,onModelChange:g}=On(a,l);return(p,y)=>(d(),w("div",To,[b(o(ie),{title:"内置指令"},{default:h(()=>[b(o(ee),{"label-width":"80px"},{default:h(()=>[b(o(ye),{name:"vIf",label:"v-if",setters:"ExpressionSetter",value:o(i).value,onChange:o(m)},null,8,["value","onChange"]),b(o(ye),{name:"vShow",label:"v-show",value:o(u).value,setters:"ExpressionSetter",onChange:o(m)},null,8,["value","onChange"]),b(o(ye),{name:"vBind",label:"v-bind",setters:"ExpressionSetter",value:o(r).value,onChange:o(m)},null,8,["value","onChange"])]),_:1})]),_:1}),b(o(ie),{title:"循环"},{default:h(()=>[b(o(ee),{"label-width":"80px"},{default:h(()=>{var V,x;return[b(o(ye),{name:"value",label:"循环数据",setters:"ExpressionSetter",value:o(c).value,onChange:o(f)},null,8,["value","onChange"]),b(o(ye),{name:"item",label:"迭代变量名",setters:{name:"InputSetter",props:{placeholder:"item"}},value:(V=o(c).iterator)==null?void 0:V.item,onChange:o(f)},null,8,["value","onChange"]),b(o(ye),{name:"index",label:"索引变量名",setters:{name:"InputSetter",props:{placeholder:"index"}},value:(x=o(c).iterator)==null?void 0:x.index,onChange:o(f)},null,8,["value","onChange"])]}),_:1})]),_:1}),o(v).length?(d(),_(o(ie),{key:0,title:"双向绑定"},{default:h(()=>[(d(!0),w(M,null,$(o(v),(V,x)=>(d(),_(o(ue),{title:`v-model: ${s(V)}`},{default:h(()=>[b(o(ee),{"label-width":"80px"},{default:h(()=>[b(o(ye),{name:x.toString(),label:"绑定变量",value:V.value,setters:"ExpressionSetter",onChange:o(g)},null,8,["name","value","onChange"])]),_:2},1024)]),_:2},1032,["title"]))),256))]),_:1})):S("",!0)]))}}),Po=B({__name:"BlockDefineProps",props:{formData:{},block:{}},setup(n){const e=n,t=T(()=>e.formData?"编辑属性":"新增属性"),a={name:[{required:!0,message:"属性名称为必填项"}]},l=k(),s=k(),i=k(),u=ke(e.formData||{name:"",type:"",required:!1,default:{type:"JSExpression",value:""}}),r=()=>N(this,null,function*(){if(yield l.value.validate().catch(c=>!1)){const c=i.value.getEditor().getValue();u.default.value=c,ge(u.default,{})&&(e.block.setProp(Je(u)),s.value.close())}});return(c,v)=>(d(),_(o(se),{ref_key:"dialogRef",ref:s,title:t.value,width:"1000px",height:"600px",submit:"",cancel:"",onSubmit:r},{default:h(()=>[b(o(ee),{ref_key:"formRef",ref:l,model:u,rules:a,size:"small","label-position":"top",class:"vtj-block-props__form"},{default:h(()=>[b(o(z),{label:"属性名称",prop:"name"},{default:h(()=>[b(o(q),{modelValue:u.name,"onUpdate:modelValue":v[0]||(v[0]=m=>u.name=m),disabled:!!e.formData},null,8,["modelValue","disabled"])]),_:1}),b(o(z),{label:"数据类型",prop:"type"},{default:h(()=>[b(o(tt),{modelValue:u.type,"onUpdate:modelValue":v[1]||(v[1]=m=>u.type=m),multiple:""},{default:h(()=>[(d(!0),w(M,null,$(o(Ol),m=>(d(),_(o(at),{value:m,label:m},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1}),b(o(z),{label:"是否必须",prop:"required"},{default:h(()=>[b(o(we),{modelValue:u.required,"onUpdate:modelValue":v[2]||(v[2]=m=>u.required=m)},null,8,["modelValue"])]),_:1}),b(o(z),{label:"默认值 [ JSExpression ]",prop:"default"},{default:h(()=>[b(o(de),{ref_key:"editorRef",ref:i,height:"250px","model-value":u.default.value||"",border:"",dark:""},null,8,["model-value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"]))}}),Oo=B({__name:"BlockDefineEmits",props:{block:{},formData:{}},setup(n){const e=n,t=ke(e.formData||{name:""}),a={name:[{required:!0,message:"事件名称为必填项"}]},l=k(),s=k(),i=()=>N(this,null,function*(){(yield s.value.validate().catch(u=>!1))&&(e.block.setEmit(t.name),l.value.close())});return(u,r)=>(d(),_(o(se),{ref_key:"dialogRef",ref:l,title:"新增事件",width:"400px",height:"150px",submit:"",cancel:"",onSubmit:i},{default:h(()=>[b(o(ee),{ref_key:"formRef",ref:s,model:t,rules:a,size:"small"},{default:h(()=>[b(o(z),{label:"事件名称",prop:"name"},{default:h(()=>[b(o(q),{modelValue:t.name,"onUpdate:modelValue":r[0]||(r[0]=c=>t.name=c)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},512))}}),Bo=B({__name:"BlockDefineSlots",props:{block:{},formData:{}},setup(n){const e=n,t=ke(e.formData||{name:""}),a={name:[{required:!0,message:"插槽名称为必填项"}]},l=k(),s=k(),i=()=>N(this,null,function*(){(yield s.value.validate().catch(u=>!1))&&(e.block.setSlot(t.name),l.value.close())});return(u,r)=>(d(),_(o(se),{ref_key:"dialogRef",ref:l,title:"新增插槽",width:"400px",height:"150px",submit:"",cancel:"",onSubmit:i},{default:h(()=>[b(o(ee),{ref_key:"formRef",ref:s,model:t,rules:a,size:"small"},{default:h(()=>[b(o(z),{label:"插槽名称",prop:"name"},{default:h(()=>[b(o(q),{modelValue:t.name,"onUpdate:modelValue":r[0]||(r[0]=c=>t.name=c)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},512))}}),No=B({__name:"BlockInject",props:{block:{},formData:{}},setup(n){const e=n,t=T(()=>e.formData?"编辑注入":"新增注入"),a=ke(e.formData||{name:"",from:"",default:{type:"JSExpression",value:""}}),l={name:[{required:!0,message:"注入名称为必填项"}]},s=k(),i=k(),u=k(),r=()=>N(this,null,function*(){if(yield u.value.validate().catch(c=>!1)){const c=i.value.getEditor().getValue();a.default.value=c,ge(a.default,{})&&(e.block.setInject(Je(a)),s.value.close())}});return(c,v)=>(d(),_(o(se),{ref_key:"dialogRef",ref:s,title:t.value,width:"1000px",height:"600px",submit:"",cancel:"",onSubmit:r},{default:h(()=>[b(o(ee),{ref_key:"formRef",ref:u,model:a,rules:l,size:"small","label-position":"top"},{default:h(()=>[b(o(z),{label:"注入名称",prop:"name"},{default:h(()=>[b(o(q),{modelValue:a.name,"onUpdate:modelValue":v[0]||(v[0]=m=>a.name=m),disabled:!!e.formData},null,8,["modelValue","disabled"])]),_:1}),b(o(z),{label:"来源名称",prop:"from"},{default:h(()=>[typeof a.from=="string"?(d(),_(o(q),{key:0,modelValue:a.from,"onUpdate:modelValue":v[1]||(v[1]=m=>a.from=m)},null,8,["modelValue"])):S("",!0)]),_:1}),b(o(z),{label:"默认值",prop:"from"},{default:h(()=>[b(o(de),{ref_key:"editorRef",ref:i,"model-value":a.default.value||"",dark:"",border:"",height:"300px"},null,8,["model-value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"]))}}),Fo={key:0,class:"vtj-setting-panel vtj-advanced"},Uo=B({__name:"Advanced",setup(n){const{selected:e}=he(),t=T(()=>{var L;const P=(L=e.value)==null?void 0:L.node;return te(P)?P:null}),a=[{name:"add",icon:"vtj-icon-plus"}],l=T(()=>{var P;return t.value?(P=t.value.props)==null?void 0:P.map(L=>typeof L=="string"?{name:L,required:!1,type:void 0,default:{type:"JSExpression",value:""}}:U({default:{type:"JSExpression",value:""},required:!1,type:void 0},L)):[]}),s=T(()=>{var P;return((P=t.value)==null?void 0:P.emits)||[]}),i=T(()=>{var P;return((P=t.value)==null?void 0:P.slots)||[]}),u=T(()=>{var P;return t.value?(P=t.value.inject)==null?void 0:P.map(L=>U({from:"",default:{type:"JSExpression",value:""}},L)):[]}),r=k(!1),c=k(),v=k(!1),m=k(!1),f=k(),g=k(),p=()=>{c.value=void 0,r.value=!0},y=P=>{c.value=P,r.value=!0},V=P=>N(this,null,function*(){var L;(yield re.confirm("确定删除","提示",{type:"warning"}).catch(H=>!1))&&((L=t.value)==null||L.removeProp(P))}),x=()=>{v.value=!0},A=P=>N(this,null,function*(){var L;(yield re.confirm("确定删除","提示",{type:"warning"}).catch(H=>!1))&&((L=t.value)==null||L.removeEmit(P))}),O=()=>{m.value=!0},I=P=>N(this,null,function*(){var L;(yield re.confirm("确定删除","提示",{type:"warning"}).catch(H=>!1))&&((L=t.value)==null||L.removeSlot(P))}),D=()=>{g.value=void 0,f.value=!0},C=P=>N(this,null,function*(){var L;(yield re.confirm("确定删除","提示",{type:"warning"}).catch(H=>!1))&&((L=t.value)==null||L.removeInject(P))}),F=P=>N(this,null,function*(){g.value=P,f.value=!0});return(P,L)=>t.value?(d(),w("div",Fo,[b(o(ie),{title:"属性",tools:a,onToolClick:p},{default:h(()=>[(d(!0),w(M,null,$(l.value,H=>(d(),_(o(ue),{title:H.name,editable:"",removable:"",clickable:"",onRemove:ce=>V(H),onClick:ce=>y(H),onEdit:ce=>y(H)},null,8,["title","onRemove","onClick","onEdit"]))),256)),l.value.length===0?(d(),_(o(le),{key:0,"image-size":50})):S("",!0),r.value?(d(),_(Po,{key:1,block:t.value,"form-data":c.value,modelValue:r.value,"onUpdate:modelValue":L[0]||(L[0]=H=>r.value=H)},null,8,["block","form-data","modelValue"])):S("",!0)]),_:1}),b(o(ie),{title:"事件",tools:a,onToolClick:x},{default:h(()=>[(d(!0),w(M,null,$(s.value,H=>(d(),_(o(ue),{title:H,removable:"",onRemove:ce=>A(H)},null,8,["title","onRemove"]))),256)),s.value.length===0?(d(),_(o(le),{key:0,"image-size":50})):S("",!0),v.value?(d(),_(Oo,{key:1,modelValue:v.value,"onUpdate:modelValue":L[1]||(L[1]=H=>v.value=H),block:t.value},null,8,["modelValue","block"])):S("",!0)]),_:1}),b(o(ie),{title:"插槽",tools:a,onToolClick:O},{default:h(()=>[(d(!0),w(M,null,$(i.value,H=>(d(),_(o(ue),{title:H,removable:"",onRemove:ce=>I(H)},null,8,["title","onRemove"]))),256)),i.value.length===0?(d(),_(o(le),{key:0,"image-size":50})):S("",!0),m.value?(d(),_(Bo,{key:1,modelValue:m.value,"onUpdate:modelValue":L[2]||(L[2]=H=>m.value=H),block:t.value},null,8,["modelValue","block"])):S("",!0)]),_:1}),b(o(ie),{title:"注入",tools:a,onToolClick:D},{default:h(()=>[(d(!0),w(M,null,$(u.value,H=>(d(),_(o(ue),{title:H.name,editable:"",removable:"",clickable:"",onRemove:ce=>C(H),onClick:ce=>F(H),onEdit:ce=>F(H)},null,8,["title","onRemove","onClick","onEdit"]))),256)),u.value.length===0?(d(),_(o(le),{key:0,"image-size":50})):S("",!0),f.value?(d(),_(No,{key:1,modelValue:f.value,"onUpdate:modelValue":L[3]||(L[3]=H=>f.value=H),"form-data":g.value,block:t.value},null,8,["modelValue","form-data","block"])):S("",!0)]),_:1})])):S("",!0)}}),Lo={class:"vtj-switcher"},Jo=R("i",{class:"vtj-icon-back vtj-switcher__back"},null,-1),Mo={key:1},$o=B({__name:"Switcher",props:{link:{}},setup(n){const e=n,{project:t}=Z(),a=T(()=>{var s;return(s=t.current.value)==null?void 0:s.title}),l=()=>{e.link&&(location.href=e.link)};return(s,i)=>(d(),w("div",Lo,[b(o(oe),{size:"small",round:"",onClick:l},{default:h(()=>[Jo,R("span",null,W(o(t).name),1),a.value?(d(),_(o(Ot),{key:0,direction:"vertical"})):S("",!0),a.value?(d(),w("span",Mo,W(a.value),1)):S("",!0)]),_:1})]))}}),zo=["src"],Ho=B({__name:"Docs",props:{url:{default:"https://element-plus.org/zh-CN/"}},setup(n){const e=n,t=k();let a=null;lt(()=>{var s;a||(a=il.service({target:(s=t.value)==null?void 0:s.$el}))}),Oe(()=>{a.close(),a=null});const l=()=>{a.close()};return(s,i)=>(d(),_(fe,{ref_key:"panel",ref:t,title:null,class:"vtj-docs","body-padding":!1},{default:h(()=>[R("iframe",{ref:"frame",src:e.url,onLoad:l},null,40,zo)]),_:1},512))}}),Wo=B({__name:"ApiDialogForm",props:{model:{},project:{}},setup(n){const e=n,t={name:"",title:"",url:"",method:"GET",settings:{type:"JSExpression",value:""}},a=k(xe(e.model||U({},t))),l=k(),s=k(),i=k(),u={name:[{required:!0,message:"接口名称为必填项"}],title:[{required:!0,message:"标题描述为必填项"}],url:[{required:!0,message:"请求地址为必填项"}]},r=T(()=>e.model?"编辑Api":"新增Api"),c=()=>N(this,null,function*(){if(yield l.value.validate().catch(v=>!1)){const v=s.value.getEditor().getValue();a.value.settings.value=v,ge(a.value.settings,{})&&(e.project.setApi(a.value),i.value.close())}});return(v,m)=>(d(),_(o(se),{ref_key:"dialogRef",ref:i,width:"1000px",height:"600px",title:r.value,submit:"",cancel:"",onSubmit:c},{default:h(()=>[b(o(ee),{ref_key:"formRef",ref:l,size:"small",model:a.value,rules:u,"label-position":"top"},{default:h(()=>[b(o(z),{label:"接口名称",prop:"name"},{default:h(()=>[b(o(q),{modelValue:a.value.name,"onUpdate:modelValue":m[0]||(m[0]=f=>a.value.name=f),disabled:!!e.model},null,8,["modelValue","disabled"])]),_:1}),b(o(z),{label:"标题描述",prop:"title"},{default:h(()=>[b(o(q),{modelValue:a.value.title,"onUpdate:modelValue":m[1]||(m[1]=f=>a.value.title=f)},null,8,["modelValue"])]),_:1}),b(o(z),{label:"接口地址",prop:"url"},{default:h(()=>[b(o(q),{modelValue:a.value.url,"onUpdate:modelValue":m[2]||(m[2]=f=>a.value.url=f)},null,8,["modelValue"])]),_:1}),b(o(z),{label:"请求类型",prop:"method"},{default:h(()=>[b(o(Pt),{modelValue:a.value.method,"onUpdate:modelValue":m[3]||(m[3]=f=>a.value.method=f)},{default:h(()=>[(d(!0),w(M,null,$(o(Bl),f=>(d(),_(o(fl),{label:f},null,8,["label"]))),256))]),_:1},8,["modelValue"])]),_:1}),b(o(z),{label:"请求配置 [ JSExpression ]",prop:"settings"},{default:h(()=>{var f;return[b(o(de),{ref_key:"editorRef",ref:s,"model-value":(f=a.value.settings)==null?void 0:f.value,border:"",dark:"",height:"180px"},null,8,["model-value"])]}),_:1})]),_:1},8,["model"])]),_:1},8,["title"]))}}),Go={class:"vtj-apis__name"},qo=B({__name:"Apis",setup(n){const{project:e}=Z(),t=[{name:"add",icon:"vtj-icon-plus"}],a=T(()=>e.apis.value),l=k(),s=k(!1),i=()=>{l.value=void 0,s.value=!0},u=c=>{l.value=c,s.value=!0},r=c=>N(this,null,function*(){(yield re.confirm("确定删除?","提示",{type:"warning"}).catch(v=>!1))&&e.removeApi(c.name)});return(c,v)=>(d(),_(o(fe),{class:"vtj-apis",title:"Api管理",tools:t,onToolClick:i},{default:h(()=>[a.value.length?S("",!0):(d(),_(o(le),{key:0,"image-size":50})),(d(!0),w(M,null,$(a.value,m=>(d(),_(o(ue),{editable:"",removable:"",clickable:"",onClick:f=>u(m),onEdit:f=>u(m),onRemove:f=>r(m)},{title:h(()=>[G(W(m.title)+" ",1),R("i",Go,W(m.name),1)]),_:2},1032,["onClick","onEdit","onRemove"]))),256)),s.value?(d(),_(Wo,{key:1,modelValue:s.value,"onUpdate:modelValue":v[0]||(v[0]=m=>s.value=m),model:l.value,project:o(e)},null,8,["modelValue","model","project"])):S("",!0)]),_:1}))}}),Ko={class:"vtj-data-source-from__label-name"},Zo=B({__name:"ApiDataSourceForm",props:{model:{},block:{}},setup(n){const{project:e}=Z(),t=n,a={type:"api",detail:"",name:"",title:"",transform:{type:"JSFunction",value:""},test:{type:"JSFunction",value:""}},l=k(xe(t.model||U({},a))),s=T(()=>e.apis.value),i={name:[{required:!0,message:"调用名称为必填项"}],title:[{required:!0,message:"备注描述为必填项"}],detail:[{required:!0,message:"选择引用api"}]},u=T(()=>t.model?"编辑数据源":"新增数据源"),r=k(),c=k(),v=k(),m=k(),f=k(!1),g=k(!1),p=k(""),y=I=>{const D=s.value.find(C=>C.name===I);D&&(l.value.name=D.name,l.value.title=D.title,l.value.test.value=`() => this.${D.name}()`)},V=(I,D)=>{const C=(...F)=>N(this,null,function*(){var H,ce;const P=yield((H=D.runtimeContext)==null?void 0:H.$apis[I.detail]).apply(this,F),L=(ce=I.transform)!=null&&ce.value?Me(I.transform,{}):I.transform;return L?L(P):P});return{[I.name]:C}},x=()=>N(this,null,function*(){if(yield r.value.validate().catch(I=>!1)){const I=c.value.getEditor().getValue();l.value.transform.value=I;const D=v.value.getEditor().getValue();return l.value.test.value=D,(!I||ge(l.value.transform,t.block.runtimeContext))&&ge(l.value.test,U(U({},t.block.runtimeContext),V(l.value,t.block)))}return!1}),A=()=>N(this,null,function*(){(yield x())&&(t.block.setDataSource(l.value),m.value.close())}),O=()=>N(this,null,function*(){if(yield x()){if(!l.value.test.value){be.warning({message:"无测试用例",title:"提示"});return}const I=V(l.value,t.block);g.value=!0,p.value="";try{const D=yield Me(l.value.test,I)().catch(C=>C);p.value=typeof D=="object"?JSON.stringify(D,null,2):"",f.value=!0}catch(D){be.warning({message:D.message,title:"运行错误"})}g.value=!1}});return(I,D)=>(d(),_(o(se),{ref_key:"dialogRef",ref:m,class:"vtj-data-source-from",title:u.value,width:"1000px",height:"600px",submit:"",cancel:"",onSubmit:A},{action:h(()=>[b(o(oe),{size:"default",type:"warning",onClick:O,loading:g.value},{default:h(()=>[G(" 运行测试用例 ")]),_:1},8,["loading"])]),default:h(()=>[b(o(ee),{ref_key:"formRef",ref:r,size:"small","label-position":"right","label-width":"80px",model:l.value,rules:i},{default:h(()=>[b(o(z),{label:"Api",prop:"detail"},{default:h(()=>[b(o(tt),{modelValue:l.value.detail,"onUpdate:modelValue":D[0]||(D[0]=C=>l.value.detail=C),onChange:y,disabled:!!t.model},{default:h(()=>[(d(!0),w(M,null,$(s.value,C=>(d(),_(o(at),{label:C.title,value:C.name},{default:h(()=>[G(W(C.title)+" ",1),R("i",Ko,W(C.name),1)]),_:2},1032,["label","value"]))),256))]),_:1},8,["modelValue","disabled"])]),_:1}),b(o(z),{label:"调用名称",prop:"name"},{default:h(()=>[b(o(q),{modelValue:l.value.name,"onUpdate:modelValue":D[1]||(D[1]=C=>l.value.name=C),disabled:!!t.model},null,8,["modelValue","disabled"])]),_:1}),b(o(z),{label:"备注描述",prop:"title"},{default:h(()=>[b(o(q),{modelValue:l.value.title,"onUpdate:modelValue":D[2]||(D[2]=C=>l.value.title=C)},null,8,["modelValue"])]),_:1}),b(o(z),{label:"转换函数",prop:"transform"},{default:h(()=>[b(o(de),{ref_key:"transformRef",ref:c,border:"",dark:"",height:"200px","model-value":l.value.transform.value},null,8,["model-value"])]),_:1}),b(o(z),{label:"测试用例"},{default:h(()=>[b(o(de),{ref_key:"testRef",ref:v,border:"",dark:"",height:"120px","model-value":l.value.test.value},null,8,["model-value"])]),_:1})]),_:1},8,["model"]),b(o(gl),{modelValue:f.value,"onUpdate:modelValue":D[3]||(D[3]=C=>f.value=C),title:"测试用例运行结果",direction:"btt","append-to-body":"",size:"80%"},{default:h(()=>[b(o(de),{"model-value":p.value,border:"",dark:"",height:"100%",lang:"json"},null,8,["model-value"])]),_:1},8,["modelValue"])]),_:1},8,["title"]))}}),Qo={class:"vtj-data-sources__subtitle"},Yo=B({__name:"DataSources",setup(n){const{selected:e}=he(),t=T(()=>{var v;return(v=e.value)==null?void 0:v.node}),a=T(()=>{var v;return Object.values(((v=t.value)==null?void 0:v.dataSources)||{}).filter(m=>m.type==="api")}),l=[{name:"add",icon:"vtj-icon-plus"}],s=k(),i=k(),u=()=>{i.value=void 0,s.value=!0},r=v=>{i.value=v,s.value=!0},c=v=>N(this,null,function*(){(yield re.confirm("确定删除？","提示",{type:"warning"}).catch(m=>!1))&&t.value.removeDataSource(v.name)});return(v,m)=>(d(),_(o(fe),{class:"vtj-data-sources",title:null,"body-padding":!1},{default:h(()=>[b(o(ie),{title:"Api",tools:l,onToolClick:u},{default:h(()=>[a.value.length===0?(d(),_(o(le),{key:0,"image-size":50})):S("",!0),(d(!0),w(M,null,$(a.value,f=>(d(),_(o(ue),{editable:"",removable:"",clickable:"",onClick:g=>r(f),onEdit:g=>r(f),onRemove:g=>c(f)},{title:h(()=>[G(W(f.title)+" ",1),R("i",Qo,W(f.name),1)]),_:2},1032,["onClick","onEdit","onRemove"]))),256))]),_:1}),s.value?(d(),_(Zo,{key:0,modelValue:s.value,"onUpdate:modelValue":m[0]||(m[0]=f=>s.value=f),model:i.value,block:t.value},null,8,["modelValue","model","block"])):S("",!0)]),_:1}))}}),Xo=B({__name:"History",setup(n){const{engine:e}=Z(),t=T(()=>{var i;return((i=e.simulator.history.value)==null?void 0:i.list)||[]}),a=T(()=>`(共 ${t.value.length} 条)`),l=i=>N(this,null,function*(){var u;(yield re.confirm("确定删除?","提示",{type:"warning"}).catch(r=>!1))&&((u=e.simulator.history.value)==null||u.remove(i.id))}),s=i=>{var u;(u=e.simulator.history.value)==null||u.load(i.id)};return(i,u)=>(d(),_(o(fe),{title:"历史记录",subtitle:a.value,class:"vtj-histroy"},{default:h(()=>[t.value.length===0?(d(),_(o(le),{key:0,"image-size":50})):S("",!0),(d(!0),w(M,null,$(t.value,(r,c)=>{var v;return d(),_(o(ue),{title:r.title,active:((v=o(e).simulator.history.value)==null?void 0:v.index)===c,onRemove:m=>l(r),onClick:m=>s(r),removable:"",clickable:""},null,8,["title","active","onRemove","onClick"])}),256))]),_:1},8,["subtitle"]))}}),ei=B({__name:"NodePath",setup(n){const{selected:e}=he(),t=T(()=>{var s;return(((s=e.value)==null?void 0:s.path)||[]).slice(0).reverse()}),a=s=>{E.emit(Ut,s)},l=s=>{E.emit(Lt,s)};return(s,i)=>o(e)?(d(),_(o(ul),{key:0,class:"vtj-nodepath","separator-icon":o(Xa)},{default:h(()=>[(d(!0),w(M,null,$(t.value,u=>(d(),_(o(rl),{onClick:r=>a(u),onMouseover:r=>l(u)},{default:h(()=>[G(W(u.name),1)]),_:2},1032,["onClick","onMouseover"]))),256))]),_:1},8,["separator-icon"])):S("",!0)}}),ti={class:"vtj-about"},ai={class:"vtj-about__logo"},li=["src"],ni=R("div",{class:"vtj-about__name"},[R("h3",null,"VTJEngine")],-1),si={class:"vtj-about__footer"},oi=B({__name:"About",setup(n){return(e,t)=>(d(),w("div",ti,[R("div",ai,[b(o(cl),{value:o(fa)},{default:h(()=>[R("img",{src:o(ya)},null,8,li)]),_:1},8,["value"])]),ni,R("div",si,[b(o(dl),{href:"http://vtj.pro",type:"primary",target:"_blank"},{default:h(()=>[G(" http://vtj.pro ")]),_:1})])]))}}),Le={Empty:Rs,Logo:Bs,Dependencies:Fs,Designer:Hs,Components:Ws,Pages:Qs,Blocks:Ys,Toolbar:no,Outline:fo,Properties:bo,Events:_o,BlockScript:wo,Css:Co,Schema:So,Actions:Io,Directives:Ro,Advanced:Uo,Switcher:$o,Docs:Ho,Apis:qo,DataSources:Yo,History:Xo,NodePath:ei,About:oi},ii={class:"vtj-apps"},ri={class:"vtj-apps__header"},ui={class:"vtj-apps__top"},ci={class:"vtj-apps__bottom"},di={class:"vtj-apps__panels"},pi=B({__name:"apps",setup(n,{expose:e}){const{regions:t,config:a}=Z(),l=T(()=>t.value.apps),s=k(null),i=k(null),u=k(),r=k(),c=T(()=>l.value.filter(p=>{var y;return!p.disabled&&((y=p.trigger)==null?void 0:y.type)==="panel"})),v=T(()=>l.value.filter(p=>{var y;return!p.disabled&&((y=p.trigger)==null?void 0:y.type)!=="panel"}));function m(p){const y=l.value.find(V=>V.name===p);y&&(s.value=y,i.value=y)}const f=p=>{s.value=p,i.value=i.value===p?null:p},g=p=>{var y,V,x;if(((y=p.trigger)==null?void 0:y.type)==="link"){window.open((V=p.props)==null?void 0:V.url);return}((x=p.trigger)==null?void 0:x.type)==="dialog"&&(u.value=Ye(Le[p.type]||Le.Empty),r.value=Y(U(U({},p.trigger),p.props),{visible:!0}))};return ae(i,p=>{E.emit(Ca,!!p)}),a.activeApp&&m(a.activeApp),e({setCurrentWidget:m}),(p,y)=>(d(),w("div",ii,[R("div",ri,[R("div",ui,[(d(!0),w(M,null,$(c.value,V=>{var x,A;return d(),_(Yt,{key:`trigger-${V.name}`,icon:(x=V.trigger)==null?void 0:x.icon,label:(A=V.trigger)==null?void 0:A.label,active:s.value===V,open:i.value===V,onClick:O=>f(V)},null,8,["icon","label","active","open","onClick"])}),128))]),R("div",ci,[(d(!0),w(M,null,$(v.value,V=>{var x,A;return d(),_(Yt,{key:`trigger-${V.name}`,icon:(x=V.trigger)==null?void 0:x.icon,label:(A=V.trigger)==null?void 0:A.label,onClick:O=>g(V)},null,8,["icon","label","onClick"])}),128))])]),Ce(R("div",di,[(d(!0),w(M,null,$(c.value,V=>(d(),_(Cl,{key:V.name},[s.value===V?(d(),_(o(Ee),Vt(K({key:0},U({},V))),null,16)):S("",!0)],1024))),128))],512),[[Ie,!!i.value]]),u.value?(d(),_(se,K({key:0},r.value,{modelValue:r.value.visible,"onUpdate:modelValue":y[0]||(y[0]=V=>r.value.visible=V)}),{default:h(()=>[(d(),_(Bt(u.value),Vt(ma(r.value)),null,16))]),_:1},16,["modelValue"])):S("",!0)]))}}),mi={class:"vtj-brand"},vi=B({__name:"brand",setup(n){const{regions:e}=Z(),t=T(()=>e.value.brand);return(a,l)=>(d(),w("div",mi,[(d(!0),w(M,null,$(t.value,s=>(d(),_(o(Ee),K({key:s.name},U({},s)),null,16))),128))]))}}),hi={key:0,class:"vtj-setting"},fi={key:0,class:"vtj-setting__header"},gi={class:"vtj-setting__path"},bi=R("i",{class:"vtj-icon-layers"},null,-1),yi=R("i",{class:"vtj-icon-help"},null,-1),_i=B({__name:"setting",setup(n,{expose:e}){var f;const{engine:t,regions:a}=Z(),{selected:l}=he(),{setting:s}=a.value||{},i=T(()=>{var g;return te((g=l.value)==null?void 0:g.node)?"Block":"Node"}),u=T(()=>s.filter(g=>!g.disabled&&g.group===i.value).map(g=>{var p;return{name:g.name,label:((p=g.trigger)==null?void 0:p.label)||g.name,closable:!1}})),r=k((f=u.value[0])==null?void 0:f.name);ae(l,(g,p)=>{(g==null?void 0:g.node.id)!==(p==null?void 0:p.node.id)&&c(0)});const c=(g=0)=>{var p;r.value=(p=u.value[g])==null?void 0:p.name};e({currentTab:r,tabs:u,change:c});const v=T(()=>{var p,y;const g=(p=l.value)==null?void 0:p.node;return g?(y=t.assets.componentMap[g.name])==null?void 0:y.doc:null}),m=()=>{if(v.value){const g=Je(t.skeleton.regionInstances.workspace);g&&g.openTab("docs",{url:v.value})}};return(g,p)=>o(l)&&o(l).node?(d(),w("div",hi,[i.value==="Node"?(d(),w("div",fi,[R("div",gi,[bi,R("span",null,[G(W(o(l).node.name.fileName||o(l).node.name)+": ",1),R("i",null,W(o(l).node.id),1)])]),v.value?(d(),w("div",{key:0,class:"vtj-setting__doc",onClick:m},[yi,G(" 帮助 ")])):S("",!0)])):S("",!0),o(l).node.lock?S("",!0):(d(),_(Ft,{key:1,class:"vtj-setting__tabs",items:u.value,modelValue:r.value,"onUpdate:modelValue":p[0]||(p[0]=y=>r.value=y),stretch:"","body-padding":!1},{default:h(()=>[(d(!0),w(M,null,$(o(s),y=>(d(),_(o(Ee),K({key:y.name},U({},y),{visible:y.name===r.value}),null,16,["visible"]))),128))]),_:1},8,["items","modelValue"])),o(l).node.lock?(d(),_(o(le),{key:2,"image-size":1,description:"组件已被锁定，不能更改设置。"})):S("",!0)])):(d(),_(o(le),{key:1,description:"请在左侧画布选中节点"}))}}),ki={class:"vtj-status"},Vi={class:"vtj-status__left"},ji={class:"vtj-status__right"},wi=B({__name:"status",setup(n){const{regions:e}=Z(),t=T(()=>e.value.status),a=T(()=>t.value.filter(s=>!s.disabled&&!s.trigger)),l=T(()=>t.value.filter(s=>!s.disabled&&!!s.trigger));return(s,i)=>(d(),w("div",ki,[R("div",Vi,[(d(!0),w(M,null,$(a.value,u=>(d(),_(o(Ee),K({key:u.name},U({},u)),null,16))),128))]),R("div",ji,[(d(!0),w(M,null,$(l.value,u=>(d(),_(o(Ee),K({key:u.name},U({},u)),null,16))),128))])]))}}),Ci={class:"vtj-toolbar"},Ei=B({__name:"toolbar",setup(n){const{regions:e}=Z(),t=T(()=>e.value.toolbar);return(a,l)=>(d(),w("div",Ci,[(d(!0),w(M,null,$(t.value,s=>(d(),_(o(Ee),K({key:s.name},U({},s)),null,16))),128))]))}}),Si=B({__name:"workspace",setup(n,{expose:e}){var g;const{regions:t,emitter:a}=Z(),l=T(()=>t.value.workspace),s=l.value.filter(p=>p.name==="designer").map(p=>{var y;return{name:p.name,label:((y=p.trigger)==null?void 0:y.label)||p.name}}),i=k(l.value.filter(p=>!p.disabled&&p.name!=="designer").map(p=>{var y;return{name:p.name,label:((y=p.trigger)==null?void 0:y.label)||p.name,checked:!1,closable:!0}})),u=T(()=>{const p=i.value.filter(y=>!!y.checked);return p.unshift(s[0]),p}),r=k((g=u.value[0])==null?void 0:g.name);ae(r,p=>{a.emit(Sa,p==="designer")});const c=p=>{const y=i.value.find(V=>V.name===p);y&&(y.checked=!1),p===r.value&&(r.value=u.value[0].name)},v=k({}),m=(p,y)=>{const V=i.value.find(x=>x.name===p);V&&(v.value[p]=y,V.checked=!0),r.value=p},f=p=>{p.checked=!p.checked,p.checked?r.value=p.name:r.value===p.name&&(r.value="designer")};return e({openTab:m}),(p,y)=>(d(),_(o(Ft),{class:"vtj-workspace",items:u.value,modelValue:r.value,"onUpdate:modelValue":y[0]||(y[0]=V=>r.value=V),more:i.value,onTabRemove:c,onMore:f,checkable:""},{default:h(()=>[(d(!0),w(M,null,$(l.value,V=>(d(),_(o(Ee),K({key:V.name},U(U({},V),v.value[V.name]),{visible:V.name===r.value}),null,16,["visible"]))),128))]),_:1},8,["items","modelValue","more"]))}}),xi=B({__name:"App",props:{engine:{}},setup(n,{expose:e}){const t=n,a=k(),l=k(),s=k(),i=k(),u=k(),r=k(),c=k();k(),k();const v=k(!1),m=k(!0);t.engine.skeleton.regionInstances={brand:a,toolbar:l,action:s,status:i,setting:u,workspace:r,apps:c};const f={dirs:["e"],maxWidth:600},g={dirs:["w"],maxWidth:600};function p(y){v.value=y}return E.on(Ca,y=>{p(!y)}),wl(Jt,t.engine),e({setLeftCollapsed:p,showSetting:m}),(y,V)=>(d(),_(o(ll),{locale:o(sn)},{default:h(()=>[b(o(bt),{class:"vtj-layout"},{default:h(()=>[b(o(tl),{class:"vtj-layout__header",height:"36px"},{default:h(()=>[b(o(vi),{ref_key:"brand",ref:a},null,512),b(o(Ei),{ref_key:"toolbar",ref:l},null,512),b(o(Ds),{ref_key:"action",ref:s},null,512)]),_:1}),b(o(bt),{class:"vtj-layout__wrapper"},{default:h(()=>[Ce((d(),_(o(yt),{width:"400px",class:Q(["vtj-layout__left",{"is-collapsed":v.value}])},{default:h(()=>[b(o(pi),{ref_key:"apps",ref:c},null,512)]),_:1},8,["class"])),[[o($t),f]]),b(o(ra),{class:"vtj-layout__main"},{default:h(()=>[b(o(Si),{ref_key:"workspace",ref:r},null,512)]),_:1}),m.value?Ce((d(),_(o(yt),{key:0,width:"350px",class:"vtj-layout__right"},{default:h(()=>[b(o(_i),{ref_key:"setting",ref:u},null,512)]),_:1})),[[o($t),g]]):S("",!0)]),_:1}),b(o(al),{class:"vtj-layout__footer",height:"20px"},{default:h(()=>[b(o(wi),{ref_key:"status",ref:i},null,512)]),_:1})]),_:1})]),_:1},8,["locale"]))}}),Di=["brand","toolbar","action","status","apps","workspace","setting"];class Ai{constructor(e){j(this,"widgets");j(this,"widgetInstances",{});j(this,"regions");j(this,"regionInstances",{});this.widgets=ke(e),this.regions=T(()=>Di.reduce((t,a)=>(t[a]=this.getWidgets(a),t),{}))}load(e){e.forEach(t=>{this.add(t)})}get(e){return this.widgets.find(t=>t.name===e)}set(e,t){const a=this.get(e);a&&ta(a,t)}add(e){this.get(e.name)?this.set(e.name,e):this.widgets.push(e)}remove(e){const t=this.widgets.findIndex(a=>a.name===e);if(t>=0){const a=this.widgets[t];a.disabled=!0,this.widgets.splice(t,1)}}getComponent(e){return e?aa(e)?Le[e]||Le.Empty:e:Le.Empty}getWidgets(e){return this.widgets.filter(t=>t.region===e).sort((t,a)=>(t.order||0)-(a.order||0))}dispose(){this.widgetInstances={},this.regionInstances={}}}const E=Za(),Ca="EVENT_SKELETON_LEFT_COLLAPSED_CHANGE",me="EVENT_PROJECT_UPDATE",Ii="EVENT_PROJECT_ACTIVE_FILE",Qe="EVENT_FILE_CREATE",jt="EVENT_FILE_UPDATE",wt="EVENT_FILE_REMOVE",Ct="EVENT_ASSETS_LOADED",Ti="EVENT_SIMULATOR_OPEN",Et="EVENT_SIMULATOR_READY",St="EVENT_COMPONENETS_DRAG_START",xt="EVENT_COMPONENETS_DRAG_END",J="EVENT_NODE_CHANGE",Ea="EVENT_VIEWPORT_MODE_CHANGE",Ut="EVENT_OUTLINE_SELECTED",Lt="EVENT_OUTLINE_HOVER",Ae="EVENT_OUTLINE_CHANGE",Sa="EVENT_DESIGNER_ACTIVE_CHANGE",xa="EVENT_ACTION_PREVIEW",Da="EVENT_ACTION_HOME",Aa="EVENT_ACTION_CODER",Ia="EVENT_ACTION_COPY",Ri="EVENT_HISTORY_GO",Pi="EVENT_HISTORY_BACK",Te="EVENT_HISTORY_CHANGE",Oi="EVENT_HISTORY_PUSH",Bi="EVENT_HISTORY_REMOVE",Xe="EVENT_HISTORY_SAVE",Ni=[{id:"elements",category:"特殊元素"},{id:"components",category:"内置组件"}],Ta=[{name:"component",title:"动态组件",categoryId:"elements",doc:"https://cn.vuejs.org/api/built-in-special-elements.html#component",props:[{name:"is",label:"组件名",setters:"InputSetter"}],snippet:{children:"组件文本内容示例",props:{is:"div"}}},{name:"slot",title:"插槽",categoryId:"elements",doc:"https://cn.vuejs.org/api/built-in-special-elements.html#slot",props:[{name:"name",label:"名称",defaultValue:"default",setters:"InputSetter"}],snippet:{children:"插槽默认内容"}}],Ge=[...Ta,{name:"Transition",title:"过渡效果",categoryId:"components",package:"vue",doc:"https://cn.vuejs.org/api/built-in-components.html#transition",props:[{name:"name",label:"名称",defaultValue:"",title:"用于自动生成过渡 CSS class 名",setters:"InputSetter"},{name:"css",label:"应用CSS",defaultValue:!0,title:"是否应用 CSS 过渡 class",setters:"BooleanSetter"},{name:"type",label:"事件类型",defaultValue:void 0,title:"指定要等待的过渡事件类型来确定过渡结束的时间，默认情况下会自动检测持续时间较长的类型",setters:"SelectSetter",options:["transition","animation"]},{name:"duration",label:"持续时间",defaultValue:void 0,title:"显式指定过渡的持续时间",setters:["NumberSetter","JSONSetter"]},{name:"mode",label:"时序",defaultValue:"default",title:"控制离开/进入过渡的时序。",setters:"SelectSetter",options:["in-out","out-in","default"]},{name:"appear",label:"使用过渡",defaultValue:!1,title:"是否对初始渲染使用过渡",setters:"BooleanSetter"},{name:"enterFromClass",label:"enterFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"enterActiveClass",label:"enterActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"enterToClass",label:"enterToClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearFromClass",label:"appearFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearActiveClass",label:"appearActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearToClass",label:"appearToClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveFromClass",label:"leaveFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveActiveClass",label:"leaveActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveToClass",label:"leaveToClass",defaultValue:void 0,setters:"InputSetter"}],events:["before-enter","before-leave","enter","leave","appear","after-enter","after-leave","after-appear","enter-cancelled","leave-cancelled","ppear-cancelled"],snippet:{children:"Transition"}},{name:"TransitionGroup",title:"过渡效果组",package:"vue",categoryId:"components",doc:"https://cn.vuejs.org/api/built-in-components.html#transitiongroup",props:[{name:"name",label:"名称",defaultValue:"",title:"用于自动生成过渡 CSS class 名",setters:"InputSetter"},{name:"tag",label:"标签名",defaultValue:void 0,title:"如果未定义，则渲染为片段 (fragment)",setters:"InputSetter"},{name:"moveClass",label:"moveClass",defaultValue:void 0,title:"用于自定义过渡期间被应用的 CSS class。",setters:"InputSetter"},{name:"css",label:"应用CSS",defaultValue:!0,title:"是否应用 CSS 过渡 class",setters:"BooleanSetter"},{name:"type",label:"事件类型",defaultValue:void 0,title:"指定要等待的过渡事件类型来确定过渡结束的时间，默认情况下会自动检测持续时间较长的类型",setters:"SelectSetter",options:["transition","animation"]},{name:"duration",label:"持续时间",defaultValue:void 0,title:"显式指定过渡的持续时间",setters:["NumberSetter","JSONSetter"]},{name:"appear",label:"使用过渡",defaultValue:!1,title:"是否对初始渲染使用过渡",setters:"BooleanSetter"},{name:"enterFromClass",label:"enterFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"enterActiveClass",label:"enterActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"enterToClass",label:"enterToClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearFromClass",label:"appearFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearActiveClass",label:"appearActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearToClass",label:"appearToClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveFromClass",label:"leaveFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveActiveClass",label:"leaveActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveToClass",label:"leaveToClass",defaultValue:void 0,setters:"InputSetter"}],events:["before-enter","before-leave","enter","leave","appear","after-enter","after-leave","after-appear","enter-cancelled","leave-cancelled","ppear-cancelled"],snippet:{children:"TransitionGroup"}},{name:"KeepAlive",title:"缓存切换组件",package:"vue",categoryId:"components",doc:"https://cn.vuejs.org/api/built-in-components.html#keepalive",props:[{name:"include",label:"匹配包含",title:"如果指定，则只有与 `include` 名称, 匹配的组件才会被缓存。",setters:["InputSetter","JSONSetter"]},{name:"exclude",label:"匹配排除",title:"任何名称与 `exclude` 匹配的组件都不会被缓存。",setters:["InputSetter","JSONSetter"]},{name:"max",label:"最大缓存数",title:"最多可以缓存多少组件实例。",setters:["InputSetter"]}]},{name:"Teleport",title:"传送组件",package:"vue",categoryId:"components",doc:"https://cn.vuejs.org/api/built-in-components.html#teleport",props:[{name:"to",label:"目标容器",title:"指定目标容器,可以是选择器或实际元素",setters:["InputSetter"]},{name:"disabled",label:"目标容器",title:"当值为 `true` 时，内容将保留在其原始位置, 而不是移动到目标容器中, 可以动态更改",setters:["BooleanSetter"]}]},{name:"Suspense",title:"异步依赖",package:"vue",categoryId:"components",doc:"https://cn.vuejs.org/api/built-in-components.html#suspense",props:[{name:"timeout",label:"timeout",setters:["InputSetter"]}]}];class Fi{constructor(e,t){j(this,"unwatch");j(this,"packages",[]);j(this,"elements",[...Ta]);j(this,"elementsMap",{});j(this,"components",[...Ge]);j(this,"componentMap",{});j(this,"componentGroups",[]);j(this,"isReady",!1);this.service=e,this.project=t,t&&(this.unwatch=ae(t.dependencies,a=>this.load(a),{deep:!0})),this.elementsMap=this.parseMap(this.elements,!1)}clear(){this.components=[...Ge],this.componentMap={},this.componentGroups=[]}getCateoryComponents(e,t){const a=t.filter(l=>l.categoryId===e.id&&l.hidden!==!0);return{name:e.id,label:e.category,count:a.length,components:a}}parseGroups(e){const t=[];for(let a of e){const{categories:l,components:s,label:i,name:u,library:r,names:c}=a;if(!l||!s)continue;const v=l.map(g=>this.getCateoryComponents(g,s)),m=v.reduce((g,p)=>p.count+g,0),f={name:a.name,label:i||u,library:r,names:c,count:m,children:v};t.push(f)}return t}parseMap(e,t=!0){const a={};if(t)for(const l of e)l.package&&(a[l.name]=l);else for(const l of e)a[l.name]=l;return a}load(e){return N(this,null,function*(){this.packages=e,this.isReady=!1;const t=e.filter(u=>!!u.assetsUrl&&u.enabled);this.clear();const a=[{name:"vue",label:"内置",names:Ge.map(u=>u.name),library:"Vue",components:Ge,categories:Ni}];for(const u of t){const r=yield la(u.assetsUrl,{},{name:u.assetsLibrary,script:!0}).catch(c=>null);r&&(r.name=r.name||u.assetsLibrary,r.library=u.library,r.names=(r.components||[]).map(c=>c.name),a.push(r),this.components=this.components.concat(r.components||[]))}a.sort((u,r)=>(u.order||0)-(r.order||0)),this.componentGroups=this.parseGroups(a),this.componentMap=this.parseMap(this.components),this.isReady=!0,E.emit(Ct);const{components:l,componentGroups:s,componentMap:i}=this;return{components:l,componentGroups:s,componentMap:i}})}getBlockDescription(e){return N(this,null,function*(){if(!e||typeof e=="string")return null;const t=e.type==="Schema"?e.id:null;if(!t)return null;const a=yield this.service.getFile(t);if(!a)return null;const{id:l,name:s,slots:i,props:u,emits:r}=a,c=v=>{const m=Array.isArray(v)?v:[v];let f=[];for(const g of m)f=f.concat(wa[g.toLowerCase()]||[]);return f};return{id:l,name:s,childIncludes:i!=null&&i.length?void 0:!1,props:(u||[]).map(v=>typeof v=="string"?{name:v}:{name:v.name,type:v.type,setters:c(v.type)}),events:r,slots:i}})}dispose(){this.clear(),this.unwatch&&this.unwatch()}}function Ui(n,e,t){const{value:a,iterator:l}=n,{item:s="item",index:i="index"}=l||{};let u=t.__parseExpression(a)||[];return Number.isInteger(u)&&(u=new Array(u).fill(!0).map((r,c)=>c+1)),Array.isArray(u)?u.map((r,c)=>e(t.__clone({[s]:r,[i]:c}))):(console.warn("[vForRender]:",`${a==null?void 0:a.value} is not a Arrary`),[])}function Li(n,e){return!!e.__parseExpression(n.value)}function Ji(n,e){return e.__parseExpression(n.value)?{}:{display:"none"}}function Mi(n,e,t){var u;const a={type:"JSFunction",value:(u=e.value)!=null&&u.value?`(v) => {
        ${e.value.value} = v;
      }`:"(v) => {}"},l=t.__parseFunction(a),s=ba(e.modifiers),i=pe(e.arg)?t.__parseExpression(e.arg):e.arg||"modelValue";return{modelValue:t.__parseExpression(e.value),[`onUpdate:${i}`]:s.length&&l?n.withModifiers(l,s):l}}function $i(n="default"){return typeof n=="string"?{name:n,params:[]}:U({params:[]},n)}function zi(n,e){const{props:t}=n,a=(t==null?void 0:t.name)||"default";return{name:pe(a)?e.__parseExpression(a):a,params:[]}}function Hi(n){const e={default:{params:[],nodes:[]}};for(const t of n){const a=$i(t.slot),l=a.name;e[l]?(e[l].nodes.push(t),e[l].params=e[l].params.concat(a.params)):e[l]={nodes:[t],params:a.params}}return e}function Wi(n,e,t,a){if(!e)return null;if(aa(e))return{default:()=>e};if(pe(e))return{default:()=>ga(t.__parseExpression(e))};if(Array.isArray(e)){const l=Hi(e),s=i=>!i||!a?{}:a!=null&&a.id&&Object.keys(i).length?{[`scope_${a.id}`]:i}:{};return Object.entries(l).reduce((i,[u,{nodes:r,params:c}])=>(i[u]=v=>{const m=c.length?Ul(v!=null?v:{},c):s(v);return r.map(f=>et(n,f,t.__clone(m)))},i),{})}}function Gi(n,e,t){const a=Object.keys(e||{}).reduce((l,s)=>{let i=e[s];return pe(i)?i=t.__parseExpression(i):st(i)&&(i=t.__parseFunction(i)),l[s]=i,l},{});return a.ref=t.__ref(n,a.ref),a}function qi(n,e,t){const a=["passive","capture","once"],l={capture:"Capture",once:"Once",passive:"OnceCapture"};return Object.keys(e||{}).reduce((s,i)=>{const u=e[i],r=ba(u.modifiers),c=r.find(f=>a.includes(f)),v="on"+za(i)+(c&&l[c]||""),m=t.__parseFunction(u.handler);return m&&(s[v]=n.withModifiers(m,r)),s},{})}function Ki(n,e,t,a){var u;const{children:l}=e,s=zi(e,a),i=(u=a.$slots)==null?void 0:u[s.name];return i?i(t):l?typeof l=="string"?n.createTextVNode(l):pe(l)?n.createTextVNode(ga(a.__parseExpression(l))):Array.isArray(l)?l.map(r=>et(n,r,a)):null:null}function Zi(n,e){return e?pe(e)?n.__parseExpression(e):e:"div"}function et(n,e,t){if(!e||!e.name||e.invisible)return null;const{id:a=null,directives:l=[]}=e,{vIf:s,vFor:i,vShow:u,vModels:r,vBind:c}=Ll(l);if(s&&!Li(s,t))return null;const v=m=>{var x,A,O,I;const f=m.$components,g=(()=>{var C;if(e.name==="component")return Zi(m,e.props.is);if(e.name==="slot")return e.name;const D=m.__loader(n,e.name,e.from);return typeof D=="string"&&(C=f[D])!=null?C:D})(),p=Gi(a,(x=e.props)!=null?x:{},m),y=qi(n,(A=e.events)!=null?A:{},m);if(e.name==="slot")return Ki(n,e,p,m);c&&Object.assign(p,m.__parseExpression(c.value)),u&&(p.style=Object.assign((O=p.style)!=null?O:{},Ji(u,m))),r.forEach(D=>{Object.assign(p,Mi(n,D,m))});const V=Wi(n,(I=e.children)!=null?I:[],m,e);return n.createVNode(g,U(U({},p),y),V)};return i?Ui(i,v,t):v(t)}const Qi=(n,e,t="")=>e;function Ra(n){const{getFile:e,options:t}=n;return(a,l,s)=>!s||typeof s=="string"?l:s.type==="Schema"?a.defineAsyncComponent(()=>N(this,null,function*(){const i=yield e(s.id);return i?Pa(Y(U({},t),{Vue:a,dsl:i,loader:Ra(n)})):null})):l}var Dt=(n=>(n.RUNTIME="runtime",n.DESIGN="design",n.RAW="raw",n.VNODE="vnode",n))(Dt||{});class Yi{constructor(e){j(this,"__id",null);j(this,"__name","");j(this,"__mode");j(this,"__dsl",null);j(this,"__instance",null);j(this,"__context_refs",{});j(this,"__loader",Qi);j(this,"__proto__",null);j(this,"props",{});j(this,"state",{});j(this,"context",{});j(this,"refs",{});j(this,"$refs",{});j(this,"$el",null);j(this,"$emit",null);j(this,"$nextTick",null);j(this,"$parent",null);j(this,"$root",null);j(this,"$attrs",null);j(this,"$slots",null);j(this,"$watch",null);j(this,"$options",null);j(this,"$forceUpdate",null);j(this,"$components",{});j(this,"$libs",{});j(this,"$apis",{});j(this,"__transform",{});const{mode:t="runtime",dsl:a,loader:l,attrs:s}=e;this.__mode=t,a&&(this.__id=a.id||null,this.__name=a.name,this.__dsl=a,t==="runtime"&&(this.__transform=a.transform||{})),l&&(this.__loader=l),s&&Object.assign(this,s)}setup(e={},t=Ka){const a=t.getCurrentInstance();if(!a)return;this.__instance=a.proxy;const l=a.appContext.config.globalProperties;Object.assign(this,l),Object.assign(this,e||{}),this.__proxy(),t.onMounted(()=>{this.__proxy()}),t.onUnmounted(()=>{this.__cleanup()})}__clone(e={}){const t=U(U({},this.context),e),a=Y(U({},t),{context:t});return a.context.__proto__=this.context,a.__proto__=this,a}__parseFunction(e){var t;if(e)if(this.__mode==="runtime"){const{id:a,type:l}=e,s=a&&(t=this.__transform[a])!=null?t:e.value;return Me({type:l,value:s},this)}else return Me(e,this)}__parseExpression(e){var t;if(e)if(this.__mode==="runtime"){const{id:a,type:l}=e,s=a&&(t=this.__transform[a])!=null?t:e.value;return Re({type:l,value:s},this)}else return Re(e,this)}__proxy(){this.__instance&&Gt.forEach(e=>{var t;this[e]=(t=this.__instance)==null?void 0:t[e]})}__cleanup(){Gt.forEach(e=>{this[e]=null})}__ref(e=null,t){if(this.__mode!=="vnode")return e&&e!==this.__id&&(this.__context_refs[e]=this),a=>{let l=(a==null?void 0:a.$vtjEl)||(a==null?void 0:a.$el)||a;if(!l){typeof t=="string"&&(delete this.$refs[t],e&&delete this.refs[e]);return}if(l.nodeType===3&&l.nextSibling&&(l=l.nextSibling),l.__vtj__=e,this.__mode==="design"&&(l.__context__=this),e&&(this.refs[e]=a),typeof t=="function")t(a);else if(t){const s=this.$refs[t];if(s){const i=new Set([].concat(s,a));this.$refs[t]=Array.from(i)}else this.$refs[t]=a}return a}}}const Xi=["Transition","TransitionGroup","KeepAlive","Teleport","Suspense"],er={String,Number,Boolean,Array,Object};function tr(n,e,t){return n.reactive(Object.keys(e||{}).reduce((a,l)=>{let s=e[l];return pe(s)?s=t.__parseExpression(s):st(s)&&(s=t.__parseFunction(s)),a[l]=s,a},{}))}function ar(n,e){return Object.entries(n!=null?n:{}).reduce((t,[a,l])=>(t[a]=e.__parseFunction(l),t),{})}function lr(n,e=[],t){e.forEach(a=>{n.watch(t.__parseExpression(a.source),t.__parseFunction(a.handler),{deep:a.deep,immediate:a.immediate})})}function nr(n,e,t){return Object.entries(e!=null?e:{}).reduce((a,[l,s])=>(a[l]=n.computed(t.__parseFunction(s)),a),{})}function sr(n=[],e){const t=a=>a?(Array.isArray(a)?a:[a]).map(l=>er[l]):void 0;return n.map(a=>typeof a=="string"?{name:a}:{name:a.name,type:a.type,required:a.required,default:pe(a.default)?e.__parseExpression(a.default):a.default}).reduce((a,l)=>(a[l.name]={type:t(l.type),required:l.required,default:l.default},a),{})}function or(n,e){return Object.entries(n!=null?n:{}).reduce((t,[a,l])=>(t[a]=e.__parseFunction(l),t),{})}function ir(n,e=[],t){return e.reduce((a,l)=>{var c;const{name:s,from:i}=l||{};l.default;const u=pe(i)?t.__parseExpression(i)||s:i!=null?i:s,r=pe(l.default)?t.__parseExpression(l.default):(c=l.default)!=null?c:null;return a[s]=n.inject(u,r),a},{})}function rr(n,e,t){return Object.keys(e).reduce((a,l)=>{const s=e[l],i=t.$apis[s.detail],u=st(s.transform)?s.transform.value?t.__parseFunction(s.transform):void 0:s.transform;return a[l]=(...r)=>N(this,null,function*(){const c=yield i.apply(t,r);return u?u(c):c}),a},{})}function ur(n,e,t){const a=n.CSSStyleSheet;if(a.prototype.replaceSync){const l=new a;l.id=e,l.replaceSync(t);const s=n.document,i=s.adoptedStyleSheets,u=Array.from(i).filter(r=>r.id!==e);s.adoptedStyleSheets=[...u,l]}else{const l=n.document;let s=l.getElementById(e);s?s.innerHTML=t:(s=l.createElement("style"),s.id=e,s.innerHTML=t,l.head.appendChild(s))}}function Pa(n){var m,f,g;const{Vue:e,block:t,components:a={},libs:l={},apis:s={},loader:i}=n,u=t?Dt.DESIGN:Dt.RUNTIME,r=e.computed(()=>n.dsl),c=Xi.reduce((p,y)=>(p[y]=e[y],p),{}),v=new Yi({mode:u,dsl:r.value,loader:i,attrs:{$components:U(U({},c),a),$libs:l,$apis:s}});return r.value.id&&ur(n.window||window,r.value.id,r.value.css||""),e.defineComponent(U({name:r.value.name,props:U({},sr((m=r.value.props)!=null?m:[],v)),setup(p){var I,D,C,F;v.props=p,v.state=tr(e,(I=r.value.state)!=null?I:{},v);const y=nr(e,(D=r.value.computed)!=null?D:{},v),V=or((C=r.value.methods)!=null?C:{},v),x=ir(e,r.value.inject,v),A=rr(e,r.value.dataSources||{},v),O=U(U(U(U({},x),y),V),A);return v.setup(O,e),lr(e,(F=r.value.watch)!=null?F:[],v),t&&t.id===v.__id&&(t.runtimeContext=v),e.onUnmounted(()=>{t&&t.id===v.__id&&(t.runtimeContext=void 0)}),{vtj:v}},emits:[...(f=r.value.emits)!=null?f:[]],expose:["vtj"],render(){if(!r.value.children)return null;const p=r.value.children||[];return p.length===1?et(e,p[0],v):p.map(y=>et(e,y,v))}},ar((g=r.value.lifeCycles)!=null?g:{},v)))}class cr{constructor(e,t,a){j(this,"app",null);j(this,"dsl",null);j(this,"onNodeChangeProxy");this.env=e,this.service=t,this.history=a,this.onNodeChangeProxy=this.onNodeChange.bind(this)}install(e={},t={}){const a=Object.values(e);this.app&&(Object.assign(this.app.config.globalProperties,t),this.app.config.errorHandler=(l,s,i)=>{const u=`[ ${s==null?void 0:s.$options.name}] ${(l==null?void 0:l.message)||l||"未知错误"}`;console.error({err:l,instance:s,info:i}),be.error({title:"运行错误",message:u})},a.forEach(l=>{var s;(typeof l=="function"||l.install)&&((s=this.app)==null||s.use(l))}))}render(e){this.app&&this.dispose();const{Vue:t,container:a,components:l,libs:s,apis:i,window:u,globals:r}=this.env,c=document.createElement("div");c.id="app",a.appendChild(c);const v=Ra({getFile:this.service.getFile.bind(this.service),options:{Vue:t,block:e,components:l,libs:s,apis:i,window:u}});this.dsl=t.reactive(e.toDsl());const m=Pa({Vue:t,dsl:this.dsl,block:e,components:l,libs:s,apis:i,window:u,loader:v});this.app=t.createApp(m),this.install(s,r),this.app.mount(c),E.on(J,this.onNodeChangeProxy)}onNodeChange(e){if(te(e))this.render(e);else if(this.dsl){const t=e.toDsl();this.updateChild(t,this.dsl)}this.dsl&&this.history.value&&this.history.value.push(this.dsl)}updateChild(e,t){const a=t.children||[];if(Array.isArray(a))for(let l=0;l<a.length;l++){const s=a[l];if(s.id===e.id){a.splice(l,1,e);return}else this.updateChild(e,s)}}dispose(){if(this.app){this.app.unmount();const e=this.app._container;e&&e.parentNode&&(e.parentNode.removeChild(e),this.app._container=null),this.app=null}this.dsl=null,E.off(J,this.onNodeChangeProxy)}}class dr{constructor(e){j(this,"unwatches",[]);j(this,"iframe",null);j(this,"contentWindow",null);j(this,"project");j(this,"renderer",null);j(this,"assets");j(this,"service");j(this,"globals");j(this,"history",k(null));j(this,"isReady",!1);const{project:t,assets:a,service:l,globals:s}=e;this.project=t,this.assets=a,this.service=l,this.globals=s,E.on(Ct,()=>this.open()),E.on(Xe,i=>this.service.saveHistory(i)),E.on(Te,i=>{var r;const u=t.current.value;u&&(u.init(i.block),(r=this.renderer)==null||r.render(u))}),this.unwatches.push(ae(t.current,i=>N(this,null,function*(){var u,r;i?(yield this.loadHistory(i),(u=this.renderer)==null||u.render(i)):(this.history.value=null,(r=this.renderer)==null||r.dispose())})))}loadHistory(e){return N(this,null,function*(){const t=yield this.service.getHistory(e.id);this.history.value=new In({history:{blockId:e.id,items:t}})})}init(e){ae(e,t=>{t&&(this.iframe=t,this.assets.isReady&&this.open())})}open(){if(!this.iframe)return;this.isReady=!1,this.contentWindow=this.iframe.contentWindow,this.contentWindow.__simulator__=this;const e=this.contentWindow.document;E.emit(Ti,e);const{scripts:t,css:a}=this.parseDependencies();e.open(),e.write(`
     <!DOCTYPE html>
     <html lang="zh-CN">
       <head>
       <meta charset="utf-8">
       <meta name="viewport"
             content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0,viewport-fit=cover"/>
         <style>
            html, body, #app {
              background: #fff;
              padding: 0;
              margin: 0;
              min-height: 100vh;
              width: 100%;
              height: 100%;
              font-size:12px;
            }
         </style>
         ${zl(a)}
         ${$l(t)}
       </head>
       <body> 
       </body>
       <script>
       __simulator__.ready();
     <\/script> 
     </html>
    `),e.close()}parseDependencies(){const e=this.project.dependencies.value.filter(l=>l.enabled),t=[],a=[];return e.forEach(({urls:l})=>{l==null||l.forEach(s=>{Ml(s)&&t.push(s),Jl(s)&&a.push(s)})}),{scripts:t,css:a}}parseApis(){return this.project.apis.value.reduce((e,t)=>(e[t.name]=Hl(t),e),{})}createEnv(){const{contentWindow:e,assets:t,globals:a}=this,l=this.project.dependencies.value,s=t.componentGroups,i={window:e,Vue:null,libs:{},components:{},apis:this.parseApis(),container:e==null?void 0:e.document.body,globals:a};return l.filter(u=>!!u.enabled).forEach(({library:u})=>{var c;const r=e[u];r&&(i.libs[u]=r,u===Wt&&(i[Wt]=r),(((c=s.find(v=>v.library===u))==null?void 0:c.names)||[]).forEach(v=>{var f;const m=t.componentMap[v];m?i.components[v]=m.parent?(f=r[m.parent])==null?void 0:f[m.alias||v]:r[m.alias||v]:i.components[v]=r[v]}))}),i}ready(){var a,l;this.isReady=!0,(a=this.renderer)==null||a.dispose(),this.renderer=null;const e=this.project.current.value,t=this.createEnv();this.renderer=new cr(t,this.service,this.history),e&&this.renderer.render(e),E.emit(Et,(l=this.contentWindow)==null?void 0:l.document)}dispose(){var e;(e=this.renderer)==null||e.dispose(),this.contentWindow=null,this.iframe=null,this.renderer=null,this.history.value=null,this.unwatches.forEach(t=>t()),E.off(Ct),E.off(Xe),E.off(Te)}}const Jt=Symbol("VtjEngine");class pr{constructor(e,t={}){j(this,"config");j(this,"skeleton");j(this,"app");j(this,"service");j(this,"emitter",E);j(this,"project");j(this,"assets");j(this,"simulator");const{config:a={},service:l=new ka,project:s,globals:i={}}=t;this.service=l,this.config=ln(tn,a),this.skeleton=new Ai(this.config.widgets||[]),this.project=da(new An(s,this.config.dependencies)),this.assets=new Fi(this.service,this.project),this.simulator=new dr({project:this.project,assets:this.assets,service:this.service,globals:i}),this.app=pa(xi,{engine:Ye(this)}),this.bindListeners(),this.loadProject(this.project.toDsl()),lt(()=>{var u;this.app.mount((u=o(e))!=null?u:document.body)}),Oe(()=>{this.dispose()})}loadProject(e){return N(this,null,function*(){const{service:t,project:a}=this,l=yield t.getProject(e||{name:"未命名项目"});a.load(l)})}bindListeners(){const{emitter:e,service:t}=this;e.on(me,a=>t.updateProject(a)),e.on(Qe,a=>t.createFile(a)),e.on(jt,a=>t.updateFile(a)),e.on(wt,a=>t.removeFile(a)),e.on(J,()=>{const a=this.project.current.value;a&&t.updateFile(a.toDsl())})}dispose(){this.emitter.all.clear(),this.skeleton.dispose(),this.assets.dispose(),this.simulator.dispose(),this.app.unmount()}}class mr{constructor(e,t,a){j(this,"draggingComponent",null);j(this,"document",null);j(this,"proxied",{});j(this,"hover",rt(null));j(this,"dropping",rt(null));j(this,"selected",rt(null));this.engine=e,this.iframe=t,this.slotPicker=a,e.simulator.init(t),E.on(Et,l=>{this.bindEvents(l)}),E.on(St,l=>{this.draggingComponent=l}),E.on(xt,()=>{this.draggingComponent=null}),E.on(Te,()=>{this.selected.value=null,this.hover.value=null}),ae(e.project.current,()=>{this.selected.value=null,this.hover.value=null})}dispose(){this.engine.simulator.dispose(),E.off(Et),E.off(St),E.off(xt),this.document&&(this.unbindEvents(this.document),this.document=null)}getNodeByElement(e){var a;const t=(a=e.__vtj__)!=null?a:"";return $e.nodes[t]||null}getElementByNode(e){return!this.document||!e?null:te(e)?this.document.body:Array.from(this.document.querySelectorAll("*")).find(t=>t.__vtj__===e.id)}getDropType(e,t,a){const{left:l,top:s,width:i,height:u}=e;return t>=l&&t<=l+i*.2?"left":t>=l+i*.8&&t<=l+i?"right":a>=s&&a<=s+u*.2?"top":a>=s+u*.8&&a<=s+u?"bottom":"inner"}getElementAndNode(e){const{engine:t,document:a}=this,l=e.composedPath(),s=this.findVtjElement(l)||(a==null?void 0:a.body),i=s?this.getNodeByElement(s)||t.project.current.value:null;return{el:s,node:i,path:l}}onDragOver(e){const{el:t,node:a}=this.getElementAndNode(e);if(a&&t&&this.allowDrop(a)){e.preventDefault();const l=t.getBoundingClientRect();this.dropping.value={el:t,node:a,rect:l,type:this.getDropType(l,e.clientX,e.clientY),path:[]}}else this.dropping.value=null}onMouseOver(e){const{el:t,node:a}=this.getElementAndNode(e);if(t&&a){const l=t.getBoundingClientRect();this.hover.value={el:t,node:a,rect:l,type:"inner",path:[]}}}onLeave(e){this.hover.value=null,this.dropping.value=null}createNodeDsl(e){const{name:t,snippet:a={},from:l}=e;return Y(U({},a),{name:t,from:l||e.package})}getDropSlot(e){return N(this,null,function*(){var r;if(!e)return;const{engine:t,slotPicker:a}=this,l=t.assets.componentMap,s=(yield t.assets.getBlockDescription(e.from))||l[e.name];if(!(s!=null&&s.slots))return;const i=((s==null?void 0:s.slots)||["default"]).map(c=>typeof c=="string"?{name:c,params:[]}:{name:c.name,params:c.params||[]});if(i.length===0)return;if(i.length===1)return i[0];const u=yield a(i).catch(c=>{});if(!(u&&u.name==="default"&&(!u.params||((r=u.params)==null?void 0:r.length)===0)))return u})}onDrop(e){return N(this,null,function*(){e.preventDefault();const{engine:t,draggingComponent:a,dropping:l}=this,s=t.project.current.value;if(!s||!a||!l.value)return;const{el:i,node:u}=this.getElementAndNode(e);if(!i||!u||!this.allowDrop(u))return;const r=this.createNodeDsl(a),c=new $e(r),v=l.value.type;c.slot=yield this.getDropSlot(v==="inner"?u:u.parent),te(u)?s.appendChild(c):s.appendChild(c,u,v)})}onSelected(e){const{el:t,node:a,path:l}=this.getElementAndNode(e);if(t&&a){const s=t.getBoundingClientRect();this.selected.value={el:t,node:a,rect:s,path:this.getNodePath(l),type:this.getDropType(s,e.clientX,e.clientY)}}}onViewChange(){this.updateRect()}updateRect(){const e=o(this.selected),t=o(this.hover);if(e){const a=e.el.getBoundingClientRect();this.selected.value=Y(U({},e),{rect:a})}if(t){const a=t.el.getBoundingClientRect();this.hover.value=Y(U({},t),{rect:a})}}getNodePath(e){const t=e.filter(l=>this.isVtjElement(l)&&this.isCurrentContext(l)).map(l=>this.getNodeByElement(l)),a=this.engine.project.current.value;return a&&t.push(a),t}isVtjElement(e){return!!e.__vtj__}isCurrentContext(e){var l,s;const t=(l=this.engine.project.current.value)==null?void 0:l.id,a=(s=e.__context__)==null?void 0:s.__id;return t===a}findVtjElement(e){return e.find(t=>this.isVtjElement(t)&&this.isCurrentContext(t))}bind(e,t){let a=this.proxied[t];return a||(a=e.bind(this),this.proxied[t]=a),a}bindEvents(e){this.document&&this.unbindEvents(this.document);const t=this.engine.simulator.contentWindow;e.addEventListener("mouseover",this.bind(this.onMouseOver,"onMouseOver")),e.addEventListener("mouseleave",this.bind(this.onLeave,"onLeave")),e.addEventListener("dragover",this.bind(this.onDragOver,"onDragOver")),e.addEventListener("dragleave",this.bind(this.onLeave,"onLeave")),e.addEventListener("drop",this.bind(this.onDrop,"onDrop")),e.addEventListener("click",this.bind(this.onSelected,"onSelected")),e.addEventListener("scroll",this.bind(this.onViewChange,"onViewChange")),t==null||t.addEventListener("resize",this.bind(this.onViewChange,"onViewChange")),this.document=e}unbindEvents(e){const t=this.engine.simulator.contentWindow;e.removeEventListener("mouseover",this.bind(this.onMouseOver,"onMouseOver")),e.removeEventListener("mouseleave",this.bind(this.onLeave,"onLeave")),e.removeEventListener("dragover",this.bind(this.onDragOver,"onDragOver")),e.removeEventListener("dragleave",this.bind(this.onLeave,"onLeave")),e.removeEventListener("drop",this.bind(this.onDrop,"onDrop")),e.removeEventListener("click",this.bind(this.onSelected,"onSelected")),e.removeEventListener("scroll",this.bind(this.onViewChange,"onViewChange")),t==null||t.removeEventListener("resize",this.bind(this.onViewChange,"onViewChange")),this.document=null}allowDrop(e){const{draggingComponent:t,engine:a}=this;if(!t)return!0;const l=a.project.current.value;return l&&l.allowDrop(t,e,a.assets)}setHover(e){const t=this.getElementByNode(e);if(!t)return;const a=t.getBoundingClientRect();this.hover.value={el:t,node:e,rect:a,type:"inner",path:[]}}setSelected(e){if(!this.document)return;const t=this.getElementByNode(e)||this.document.createElement("span"),a=t.getBoundingClientRect();this.selected.value={el:t,node:e,rect:a,path:this.findPathByNode(e),type:"inner"}}findPathByNode(e){const t=[e];if(te(e))return t;let a=e;for(;a.parent&&a.parent!==a;)a=a.parent,a!==e&&t.unshift(a);return t.reverse()}}const vr=n=>(xl("data-v-c00ef9a7"),n=n(),Dl(),n),hr={class:"vtj-ide"},fr={class:"file-list"},gr={key:1},br=vr(()=>R("div",{class:"error-tip"}," 错误日志已保存. 这可能是系统的bug。您可以把日志提交给作者协助解决。 ",-1)),yr=B({__name:"index",setup(n){const t=k(!1),a=k(!1),l=k([]),s=k(null),i=k(!1),u=k(),r=Ha(),{project:c,raw:v=!1,service:m="storage",debug:f}=(r==null?void 0:r.options)||{},{id:g="ide",name:p="IDE",base:y=location.pathname,mode:V="hash",page:x="/page",preview:A="/preview",home:O="/"}=c||{},I=()=>`${y}${V==="hash"?"#":""}${O}`,D=new pr(u,{service:m==="file"?new nn:new ka,config:{widgets:[{name:"switcher",props:{link:I()}},{name:"actions",props:{coder:!0,copy:!1}}]},project:{id:g,name:p},globals:{$route:La(),$router:Ja()}});return D.emitter.on(xa,C=>{const F=V==="hash"?"#":"";let P="";Wa(C)?P=v?`${y}${F}${A}/${C.id}`:`${y}${F}${x}/${C.id}`:P=`${y}${F}${A}/${C.id}`,window.open(P)}),D.emitter.on(Da,C=>{const P=`${y}${V==="hash"?"#":""}${O}`;window.open(P)}),D.emitter.on(Aa,C=>N(this,null,function*(){if(m==="storage"||!v){C.value=!1,t.value=!0;return}a.value=!0,i.value=!0,l.value=[],s.value=null;const F=D.project.toDsl(),P=D.assets.componentMap,L=D.assets.packages;l.value=yield zt({type:"projectCoder",data:{debug:f,project:F,assets:{componentMap:P,packages:L}}}).catch(H=>(s.value=H.data,console.log(H),[])),i.value=!1})),D.emitter.on(Ia,C=>N(this,null,function*(){C.value=!0,yield zt({type:"copyProject"}),C.value=!1,yield Ga(g),_l.success({message:"复制项目样例完成, 正在重置设置器"}),yield ht(2e3),location.reload()})),(C,F)=>(d(),w("div",hr,[R("div",{ref_key:"container",ref:u,class:"container"},null,512),b(o(se),{modelValue:t.value,"onUpdate:modelValue":F[0]||(F[0]=P=>t.value=P),title:"温馨提示",width:"500px",height:"180px"},{default:h(()=>[b(o(ze),{title:"当前设计器是非源码模式，不支持出码功能",type:"warning",closable:!1,description:"可以使用以下命令下载完整版本体验"}),b(o(ze),{class:"npm-command",closable:!1,type:"info",title:"npm create vtj@latest -- -t web"})]),_:1},8,["modelValue"]),b(o(se),{modelValue:a.value,"onUpdate:modelValue":F[1]||(F[1]=P=>a.value=P),title:"出码结果",width:"800px",height:"400px"},{default:h(()=>[b(o(kl),{rows:3,animated:"",loading:i.value},{default:h(()=>[s.value?S("",!0):(d(),_(o(ze),{key:0,closable:!1,type:"success",title:`输出文件数: ${l.value.length}`},null,8,["title"])),R("div",fr,[(d(!0),w(M,null,$(l.value,P=>(d(),w("div",null,W(P),1))),256))]),s.value?(d(),w("div",gr,[b(o(ze),{closable:!1,type:"error",title:"出码失败",description:s.value.msg},null,8,["description"]),br])):S("",!0)]),_:1},8,["loading"])]),_:1},8,["modelValue"])]))}});const Nr=qa(yr,[["__scopeId","data-v-c00ef9a7"]]);export{Nr as default};
