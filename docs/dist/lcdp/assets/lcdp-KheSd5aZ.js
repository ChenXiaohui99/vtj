const __vite__fileDeps=["./Editor-BKlikwSl-KWDHyKIs.js","./monaco-editor-DioPL3jn.js","./monaco-editor-BoaUnmrp.css","./@vue-CDZiIyEm.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{n as ht,h as ne,o as Qe,p as Wt,q as jl,r as Ot,s as st,t as Lt,u as bt,v as ot,w as it,m as oe,x as ye,y as Al,A as Pl,e as he,B as El,C as zl,D as Bl,F as Vt,G as Dl,H as jt,I as Rl,J as Fl,z as Jl,E as Tl,K as Nt,b as Mt,a as $e,L as Wl,M as It,N as Ut,O as ge,P as ft,g as qt,k as Ol,j as Ll,f as Nl,Q as Ml,R as Il,S as Ul}from"./element-plus-CHrV_y3a.js";import{i as ql,w as Hl,p as Ql,s as Gl,r as Xl,a as Kl,b as $l,R as Ht,$ as Yl,q as _e,Q as yt,o as Zl,I as ea,L as ta,M as la,H as aa,c as na,y as sa,V as oa,d as rt,e as Ve,f as B,v as ia,B as wt,g as Qt,n as Gt,j as M,h as ee,C as kt,l as Xt,m as te,t as ra,_ as Kt,O as ua,u as da,z as ca,A as ma,D as pa,P as ut,J as va,F as ga,E as dt,G as Le,N as ha,K as ba,S as At,U as fa,W as ya,X as Ne,Y as wa,Z as Pt,a0 as ka,a1 as $t,a2 as Sa,a3 as Ye,a4 as Yt,a5 as fe,a6 as Zt,a7 as xa,a8 as Ze,a9 as Ce,aa as el,ab as et,ac as _a,ad as Re,ae as tl,af as Ca,ag as ll,ah as Va,ai as Je,aj as ja,ak as Me,al as Aa,am as Pa,an as Ea,ao as Et,ap as ct,aq as zt,ar as za,as as Ba,at as Da,au as Ra,av as Fa,aw as al,ax as Ja,ay as Ta,az as nl,aA as Wa,aB as Oa,aC as La,aD as Na,aE as Ma,aF as Ia,aG as Ua,aH as qa,aI as Ha,aJ as Qa,aK as Ga,aL as Xa,aM as Ka,aN as $a,aO as Ya,aP as Za,aQ as en,aR as tn,aS as ln,aT as sl,aU as an,aV as nn,aW as sn,aX as on,aY as rn,aZ as un,a_ as dn,a$ as cn,b0 as mn,b1 as pn,b2 as vn,b3 as gn,b4 as hn,b5 as bn,b6 as fn,b7 as ol,b8 as yn,b9 as wn,ba as kn,bb as Sn,bc as xn,bd as _n,be as Cn,bf as Vn,bg as jn,bh as An,bi as Pn,bj as En,bk as zn,bl as Bn,bm as Dn,bn as Rn,bo as Fn,bp as Jn,bq as Tn,br as Bt,bs as Wn,bt as il,bu as On,bv as Ln,bw as Nn,bx as Mn,by as In,bz as Un,bA as qn,bB as lt,bC as Hn,bD as Qn}from"./index-By3eOMAD.js";import{_ as Gn}from"./monaco-editor-DioPL3jn.js";import{d as j,k as x,o as u,c as V,Z as T,_ as c,U as f,u as l,a as _,S as y,X as C,r as k,Y as q,F as J,a9 as W,m as mt,f as H,O as U,P as Ge,aa as Xe,a5 as Oe,j as rl,I as ul,at as dl,av as Xn,n as Se,bD as Ae,J as Te,an as Dt,V as Ee,$ as De,W as cl,Q as re,a1 as Ue,w as Kn,ab as $n,M as xe,bB as pt,aU as Yn,L as Zn,s as vt,G as St,ad as ml,ae as pl,aC as vl,af as es}from"./@vue-CDZiIyEm.js";import{p as Ie,q as ts,s as ls}from"./@vueuse-DxOn2eU-.js";import{m as as}from"./mockjs-c-NHcvHM.js";import{n as ns,D as ss,T as os,P as is,k as gl,j as rs,U as us,M as hl,V as ds,E as xt,B as cs,d as ms,W as ps}from"./@element-plus-DsYrOvtI.js";const Eu="/vtj/",zu="LCDP",Bu="低代码开发平台";/**!
 * Copyright (c) 2024, VTJ.PRO All rights reserved.
 * @name @vtj/designer 
 * @author CHC chenhuachun1549@dingtalk.com 
 * @version 0.8.5
 * @license <a href="https://vtj.pro/license.html">MIT License</a>
 */const vs="0.8.5",Rt={width:390,height:844},Ft={width:1180,height:820},je=/^[A-Za-z_$][\:\w_-]*$/,gs=["click","dblclick","mouseenter","mouseleave","mousedown","mouseup","mouseover","contextmenu"],hs=["keydown","keyup","keypress"],bs=["GET","POST","PUT","PATCH","DELETE","JSONP"],fs=["stop","prevent","capture","self","once","passive"];var be=(d=>(d.Block="block",d.Node="node",d))(be||{});function bl(){const d=ce(),e=x(()=>d.project.value?.dependencies??[]),t=x(()=>d.project.value?.apis??[]);return{engine:d,dependencies:e,apis:t}}function ze(d,e){const t=x(()=>Cl.getWidgets(l(d),l(e)).filter(n=>!n.invisible)),a=k();return{widgets:t,widgetsRef:a}}function fl(){const d=ce();return{span:x(()=>{const e=d.skeleton?.skeletonRef.leftWidth||400,t=Math.min(Math.floor((e-50)/120),24);return Math.floor(24/t)}),engine:d}}function ys(){const d=ce(),e=x(()=>d.project.value?.blocks??[]);return{engine:d,blocks:e}}const ws=(d=[])=>d.map(e=>e.name);function ks(){const d=ce(),{components:e,groups:t,componentMap:a}=d.assets,n=Ue({}),s=x(()=>{const h={};return t.value&&t.value.forEach(b=>{h[b.name]=b}),h}),o=x(()=>t.value?t.value.map(h=>({label:`${h.label} (${h.count})`,name:h.name,disabled:!h.children?.length})):[]),i=k(o.value[0]?.name),r=k(""),p=x(()=>s.value[i.value]);Kn(()=>{const h=o.value.reduce((b,v)=>(b[v.name]=ws(s.value[v.name].children),b),{});Object.assign(n,h)}),H(o,h=>{h.length&&!i.value&&(i.value=h[0].name)},{immediate:!0});const m=x(()=>{const h=r.value.toLowerCase();return!h||!e?[]:e.filter(b=>b.name.toLowerCase().includes(h)||b.label?.toLowerCase().includes(h))});return{components:e,groups:t,componentMap:a,groupMap:s,tabs:o,model:n,currentTab:i,currentGroup:p,searchKey:r,searchResult:m}}function ue(){const d=ce(),e=x(()=>d.current.value),t=x(()=>d.simulator.renderer?.context??null),a=x(()=>d.isEmptyCurrent.value);return{engine:d,current:e,isEmpty:a,context:t}}function Ss(d,e,t,a){const n=ce();n.simulator.init(d,e,t,a);const s=x(()=>n.simulator.designer.value),o=x(()=>at("hover",s.value?.hover.value)),i=x(()=>at("dropping",s.value?.dropping.value)),r=x(()=>at("selected",s.value?.selected.value));return H(n.changed,()=>{s.value?.updateRect()}),{designer:s,dropping:i,hover:o,selected:r}}function xs(d,e=!0){const{top:t,height:a,width:n,left:s}=d||{};if(a>100&&n>200)return"inner";let o,i;return i=t>30?"top":"bottom",o=e||s<300&&n<300?"left":"right",[o,i].join("-")}function _s(d){const{rect:e,type:t}=d,{left:a,width:n,top:s,height:o}=e,i={left:a,width:n,top:s,height:o};switch(t){case"left":i.left=0,i.width=0;break;case"right":i.left=i.left+i.width-4,i.width=0;break;case"bottom":i.top=i.top+i.height-4,i.height=0;break;case"top":i.height=0;break}return i}function at(d,e){if(!e)return null;const{left:t,top:a,width:n,height:s}=d==="dropping"?_s(e):e.rect,o={left:`${t}px`,top:`${a}px`,width:`${n}px`,height:`${s}px`,visibility:n||s?"visible":"hidden"};return{...e,style:o,position:xs(e.rect,d!=="selected")}}function we(){const d=ce(),e=x(()=>d.simulator.designer.value),t=x(()=>e.value?.selected.value),a=x(()=>ee(t.value?.model));return{engine:d,designer:e,selected:t,isSelectBlock:a}}function Cs(d,e){const t=k(""),{selected:a,isSelectBlock:n}=we(),s=x(()=>a.value?.model.id),o=x(()=>{const r=pt(d),p=pt(e),m=[];if(!r)return m;const h=p?.__contextRefs[s.value||""],b=p===h||n.value?[]:Object.keys(h?.context||{}).filter(R=>!["context","ref"].includes(R)).map(R=>`this.context.${R}`);b.length&&m.push({title:"上下文",items:b});const v=r.inject.map(R=>`this.${R.name}`);v.length&&m.push({title:"注入",items:v});const g=r.props.map(R=>typeof R=="string"?`this.props.${R}`:`this.props.${R.name}`);g.length&&m.push({title:"属性",items:g});const w=Object.keys(r.state).map(R=>`this.state.${R}`);w.length&&m.push({title:"状态",items:w});const S=Object.keys(r.computed).map(R=>`this.${R}.value`);S.length&&m.push({title:"计算属性",items:S});const z=Object.keys(r.methods).map(R=>`this.${R}`);z.length&&m.push({title:"方法",items:z});const P=Object.keys(r.dataSources).map(R=>`this.${R}`);P.length&&m.push({title:"数据源",items:P});const D=Object.keys(p?.$refs||{}).map(R=>`this.$refs.${R}`);return D.length&&m.push({title:"refs",items:D}),m}),i=x(()=>{if(!t.value)return o.value;const r=t.value.toLowerCase(),p=[];return o.value.forEach(m=>{const h=m.items.filter(b=>b.toLowerCase().includes(r));h.length&&p.push({title:m.title,items:h})}),p});return{keyword:t,options:o,searchResult:i}}const He=[{name:"StringSetter",label:"文本"},{name:"ExpressionSetter",label:"表达式"}];function Vs(d){const e=ce(),t=x(()=>{const r=d.value?.model||null;return ee(r)?null:r}),a=k();H(t,async r=>{r?.from?a.value=await e.assets.getBlockMaterial(r.from)||void 0:a.value=void 0},{immediate:!0});const n=x(()=>t.value?[{name:"key",setters:He,value:t.value.getPropValue("key")},{name:"ref",setters:He,value:t.value.getPropValue("ref")},{name:"class",label:"class",setters:He,value:t.value.getPropValue("class")},{name:"children",label:"文本",title:"如设置组件文本，将清空子组件",setters:He,value:Array.isArray(t.value.children)?"":t.value.children}]:[]),s=x(()=>{if(!t.value)return[];const r=a.value||e.assets.componentMap.get(t.value.name);return r?(r.props||[]).map(p=>({...p,value:t.value?.getPropValue(p.name)??p.defaultValue})):[]}),o=r=>n.value.some(p=>p.name===r)||s.value.some(p=>p.name===r)||r==="style",i=x(()=>t.value?Object.keys(t.value.props).filter(r=>!o(r)).map(r=>({name:r,setters:"InputSetter",value:t.value?.getPropValue(r)})):[]);return{commonProps:n,componentProps:s,customProps:i,node:t,change:(r,p)=>{t.value&&(r==="children"?t.value.setChildren(p):t.value.setProp(r,p))},addCustom:r=>{r&&t.value?.setProp(r,"")},removeCustom:r=>{t.value?.removeProp(r)},isExist:o}}function le(d,e="提示"){return ge.warning({title:e,message:d})}async function We(d){return await ft.confirm(d,"提示",{type:"warning"}).catch(()=>!1)}function me(d,e="success"){return $e({message:d,type:e})}function ie(d,e,t=!1){let a=!0;try{d.type==="JSExpression"?Me(d,e,t,!0):Fa(d,e,t,!0)}catch(n){a=!1,ge.error({title:"代码错误",message:n.message})}return a}function yl(){const d=ce(),e=x(()=>d.simulator.designer.value),t=x(()=>d.current.value?d.history.value:null),a=x(()=>t.value?.items.length||0),n=()=>{e.value?.cleanHelper(),t.value?.forward()},s=()=>{t.value?.backward(),e.value?.cleanHelper()},o=p=>{e.value?.cleanHelper(),t.value?.load(p),me("已载入历史记录","success")},i=x(()=>a.value<=1?!0:(t.value?.index||-1)<=0),r=x(()=>a.value<=1?!0:(t.value?.index||-1)>=a.value-1);return{engine:d,history:t,total:a,forward:n,backward:s,load:o,forwardDisabled:i,backwardDisabled:r}}function Fe(){const d=ce(),e=x(()=>d.project.value);return{engine:d,project:e}}function js(d){const e=ce(),t=x(()=>{const i=d.value?.model||null;return!i||ee(i)?null:i}),a=k();H(t,async i=>{i?.from?a.value=await e.assets.getBlockMaterial(i.from)||void 0:a.value=void 0},{immediate:!0});const n=x(()=>{if(ee(t.value))return[];const i=t.value?.events||{};return gs.map(r=>({name:r,event:i[r]}))}),s=x(()=>{if(ee(t.value))return[];const i=t.value?.events||{};return hs.map(r=>({name:r,event:i[r]}))}),o=x(()=>{if(!t.value||ee(t.value))return[];const i=t.value.events||{};return(a.value?.events||e.assets.componentMap.get(t.value.name)?.events||[]).map(r=>{const p=typeof r=="string"?r:r.name;return{name:p,event:i[p]}})});return{mouseEventList:n,keyboardEventList:s,componentEventList:o}}const As=(d,e)=>new il({name:d,value:void 0,iterator:e}),Ps=(d="modelValue")=>new il({name:"vModel",value:void 0,arg:d});function Es(d){if(!d)return[];const{props:e=[],events:t=[]}=d;if(e.length&&t.length){const a=t.filter(n=>(typeof n=="string"?n:n.name).startsWith("update:")).map(n=>n=typeof n=="string"?n:n.name);return a.length?e.filter(n=>a.some(s=>s.includes(n.name))):[]}return[]}function zs(d){const e=ce(),t=x(()=>{const h=d.value?.model||null;return ee(h)?null:h}),a=h=>x(()=>t.value&&(t.value.directives||[]).find(b=>b.name===h)||As(h)),n=()=>x(()=>{if(!t.value)return[];const h=e.assets.componentMap.get(t.value.name||"");return(h?Es(h):[]).map(b=>(t.value?.directives||[]).find(v=>v.name==="vModel"&&v.arg==b.name)||Ps(b.name))}),s=a("vIf"),o=a("vShow"),i=a("vBind"),r=a("vFor"),p=n(),m={vIf:s,vShow:o,vBind:i,vFor:r};return{engine:e,node:t,vIf:s,vShow:o,vBind:i,vFor:r,vModels:p,onValueChange:(h,b)=>{const v=m[h];t.value&&(b?(v.value.value=b,t.value.setDirective(v.value)):(v.value.value=void 0,t.value.removeDirective(v.value)))},onForChange:(h,b)=>{if(t.value){if(h==="value"){b?(r.value.value=b,t.value.setDirective(r.value)):t.value.removeDirective(r.value);return}(h==="item"||h==="index")&&(r.value.iterator={...r.value.iterator,[h]:b||void 0},t.value.setDirective(r.value))}},onModelChange:(h,b)=>{if(!t.value)return;const v=parseInt(h),g=p.value[v];g&&(b?(g.value=b,t.value.setDirective(g)):(g.value=void 0,t.value.removeDirective(g)))}}}function Bs(){const{engine:d,project:e}=Fe(),t=x(()=>e.value?.apis||[]);return{engine:d,project:e,apis:t}}const Ds="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1711803009570'%20class='icon'%20viewBox='0%200%201280%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='1500'%20width='320'%20height='256'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cpath%20d='M557.85%201023l-122-35.4c-12.8-3.6-20-17-16.4-29.8L692.45%2017.4c3.6-12.8%2017-20%2029.8-16.4l122%2035.4c12.8%203.6%2020%2017%2016.4%2029.8L587.65%201006.6c-3.8%2012.8-17%2020.2-29.8%2016.4z%20m-228-224.4l87-92.8c9.2-9.8%208.6-25.4-1.6-34.4L234.05%20512l181.2-159.4c10.2-9%2011-24.6%201.6-34.4l-87-92.8c-9-9.6-24.2-10.2-34-1L7.65%20494.4c-10.2%209.4-10.2%2025.6%200%2035l288.2%20270.2c9.8%209.2%2025%208.8%2034-1z%20m654.4%201.2l288.2-270.2c10.2-9.4%2010.2-25.6%200-35L984.25%20224.2c-9.6-9-24.8-8.6-34%201L863.25%20318c-9.2%209.8-8.6%2025.4%201.6%2034.4L1046.05%20512l-181.2%20159.4c-10.2%209-11%2024.6-1.6%2034.4l87%2092.8c9%209.8%2024.2%2010.2%2034%201.2z'%20fill='%230157fe'%20p-id='1501'%3e%3c/path%3e%3c/svg%3e",Rs=["title","src"],Fs={key:1},Js=j({name:"LogoWidget",inheritAttrs:!1,__name:"index",props:{icon:{},text:{default:"VTJ"},link:{}},setup(d){const{engine:e}=ue(),t=d,a=x(()=>t.icon||e.project.value?.config?.logo||Ds),n=()=>{t.link&&(location.href=t.link)};return(s,o)=>(u(),V("div",{class:"v-logo-widget",onClick:n},[a.value?(u(),V("img",{key:0,title:t.text,class:"v-logo-widget__icon",src:a.value},null,8,Rs)):(u(),V("span",Fs,T(t.text),1))]))}}),Ts={class:"v-empty-widget"},Ws=j({name:"EmptyWidget",__name:"index",setup(d){return(e,t)=>(u(),V("div",Ts,"EmptyWidget"))}}),Os={class:"v-switcher-widget"},Ls={key:1},Ns=j({name:"SwitcherWidget",inheritAttrs:!1,__name:"index",emits:["click"],setup(d,{emit:e}){const t=e,{engine:a}=ue(),n=x(()=>a.project.value?.config?.title||a.project.value?.name),s=x(()=>a.project.value?.currentFile?.title),o=()=>{t("click",a.project.value)};return(i,r)=>(u(),V("div",Os,[c(l(ne),{size:"small",round:"",onClick:o},{default:f(()=>[c(l(Zl),{class:"v-switcher-widget__back"}),_("span",null,T(n.value),1),s.value?(u(),y(l(ht),{key:0,direction:"vertical"})):C("",!0),s.value?(u(),V("span",Ls,T(s.value),1)):C("",!0)]),_:1})]))}}),Ms={class:"v-toolbar-widget"},Is=j({name:"ToolbarWidget",inheritAttrs:!1,__name:"index",props:{preview:{type:Boolean}},setup(d,{expose:e}){const t=d,{forward:a,backward:n,forwardDisabled:s,backwardDisabled:o}=yl(),i=k("pc");return e({mode:i}),(r,p)=>(u(),V("div",Ms,[c(l(Wt),{size:"small",modelValue:i.value,"onUpdate:modelValue":p[0]||(p[0]=m=>i.value=m)},{default:f(()=>[c(l(Qe),{label:"pc",value:"pc"},{default:f(()=>[c(l(ea))]),_:1}),c(l(Qe),{label:"mobile",value:"mobile"},{default:f(()=>[c(l(ta))]),_:1}),c(l(Qe),{label:"pad",value:"pad"},{default:f(()=>[c(l(la))]),_:1})]),_:1},8,["modelValue"]),C("",!0),c(l(jl),null,{default:f(()=>[c(l(ne),{type:"default",size:"small",onClick:l(n),disabled:l(o)||!!t.preview},{default:f(()=>[c(l(aa))]),_:1},8,["onClick","disabled"]),c(l(ne),{type:"default",size:"small",onClick:l(a),disabled:l(s)||!!t.preview},{default:f(()=>[c(l(na))]),_:1},8,["onClick","disabled"])]),_:1})]))}}),Us={class:"v-actions-widget"},qs=_("span",null,"发布",-1),Hs=j({name:"ActionsWidget",inheritAttrs:!1,__name:"index",props:{coder:{type:Boolean,default:!0}},setup(d){const{engine:e,designer:t}=we(),a=k(!1),n=()=>{e.current.value?(a.value?e.skeleton?.getWidget("Previewer")?.widgetRef.refresh():(t.value?.setSelected(null),e.simulator.refresh()),me("刷新完成","success")):me("请先打开文件","warning")},s=async()=>{e.current.value?(a.value&&(e.skeleton?.closePreview(),a.value=!1,await Yt(1e3)),t.value?.setSelected(e.current.value)):me("请先打开文件","warning")},o=()=>{if(e.project.value)if(e.current.value){if(a.value){e.skeleton?.closePreview(),a.value=!1;return}e.skeleton?.openPreview(""),a.value=!0}else me("请先打开文件","warning")},i=()=>{const p=e.project.value;p&&(p.currentFile?p.publish(p.currentFile):me("请先打开文件","warning"))},r=p=>{const m=e.project.value;m&&(p==="current"?i():m.publish())};return(p,m)=>(u(),V("div",Us,[C("",!0),C("",!0),c(l(ne),{onClick:o,type:a.value?"warning":"default",size:"small",title:"预览"},{default:f(()=>[c(l(sa))]),_:1},8,["type"]),c(l(ne),{onClick:n,type:"default",size:"small",title:"刷新"},{default:f(()=>[c(l(oa))]),_:1}),c(l(ne),{type:"default",size:"small",title:"页面设置",onClick:s},{default:f(()=>[c(l(Ht))]),_:1}),c(l(ht),{direction:"vertical"}),c(l(Lt),{"split-button":"",type:"primary",size:"small",onClick:i,onCommand:r},{dropdown:f(()=>[c(l(Ot),null,{default:f(()=>[c(l(st),{command:"current"},{default:f(()=>[q("发布页面")]),_:1}),c(l(st),{command:"project"},{default:f(()=>[q("整站发布")]),_:1})]),_:1})]),default:f(()=>[qs]),_:1})]))}}),Qs={class:"v-icon-setter"},Gs={class:"v-icon-setter__content"},Xs={class:"v-icon-setter__list"},wl=j({name:"IconSetter",__name:"icon",props:{modelValue:{default:""},size:{default:"small"}},emits:["change","update:modelValue"],setup(d,{emit:e}){const t=d,a=e,n=k(!1),s=k(t.modelValue),o=k(""),i=x(()=>rt[t.modelValue]||t.modelValue),r=x(()=>{const v=Object.entries(rt);return o.value?v.filter(g=>g[0].toLowerCase().includes(o.value)):v}),p=v=>{s.value=v},m=()=>{a("change",s.value),a("update:modelValue",s.value),n.value=!1},h=()=>{s.value="",a("change",""),a("update:modelValue",""),n.value=!1},b=()=>{n.value=!0};return(v,g)=>(u(),V("div",Qs,[c(l(ye),{size:t.size,readonly:"",placeholder:"请选择图标","model-value":t.modelValue,"suffix-icon":l(gl),onFocus:b},{prepend:f(()=>[c(l(Ce),{icon:i.value},null,8,["icon"])]),_:1},8,["size","model-value","suffix-icon"]),n.value?(u(),y(l(Re),{key:0,title:"图标选择器",width:"1000px",height:"600px",cancel:"",submit:"",clear:"",modelValue:n.value,"onUpdate:modelValue":g[1]||(g[1]=w=>n.value=w),onSubmit:m},{extra:f(()=>[c(l(ne),{size:"default",type:"warning",onClick:h},{default:f(()=>[q(" 清除绑定 ")]),_:1})]),default:f(()=>[_("div",Gs,[c(l(ye),{size:t.size,"prefix-icon":l(hl),clearable:"",modelValue:o.value,"onUpdate:modelValue":g[0]||(g[0]=w=>o.value=w),placeholder:"请输入查询关键字"},null,8,["size","prefix-icon","modelValue"]),_("div",Xs,[(u(!0),V(J,null,W(r.value,w=>(u(),y(l(Ce),{icon:w[1],onClick:S=>p(w[0]),class:U({"is-active":s.value===w[0]})},null,8,["icon","onClick","class"]))),256)),r.value.length===0?(u(),y(l(oe),{key:0})):C("",!0)])])]),_:1},8,["modelValue"])):C("",!0)]))}}),Ks=j({name:"PageForm",__name:"form",props:{item:{},parentId:{}},setup(d){const e=d,{project:t}=Fe(),a=x(()=>e.item?"编辑页面":"新增页面"),n=()=>({dir:!1,name:"",title:"",icon:"",mask:!0,hidden:!1,raw:!1}),s=k(e.item||n()),o=[{label:"页面",value:!1},{label:"目录",value:!0}],i=p=>{s.value&&(s.value.name=tl(p))},r=async p=>t.value?.existPageName(p.name,[p.id])?(le("页面名称已存在，请更换"),!1):(e.item?t.value?.updatePage(p):t.value?.createPage(p,e.parentId),!0);return(p,m)=>(u(),y(l(Ve),{title:a.value,width:"800px",height:"500px","form-props":{tooltipMessage:!1},model:s.value,"submit-method":r},{default:f(()=>[c(l(B),{name:"dir",label:"类型",editor:"radio",options:o,props:{button:!0,size:"small"},disabled:!!e.item,required:""},null,8,["disabled"]),c(l(B),{name:"name",label:"名称",required:"",onChange:i,rules:{pattern:l(je),message:"名称格式不正确"}},null,8,["rules"]),c(l(B),{name:"title",label:"标题",required:""}),c(l(B),{name:"icon",label:"菜单图标",editor:"none"},{editor:f(()=>[c(wl,{modelValue:s.value.icon,"onUpdate:modelValue":m[0]||(m[0]=h=>s.value.icon=h),size:"default"},null,8,["modelValue"])]),_:1}),c(l(B),{visible:{dir:!1},name:"mask",label:"包含母版",editor:"switch"}),c(l(B),{name:"hidden",label:"隐藏菜单",editor:"switch"}),c(l(B),{visible:{dir:!1},disabled:!!e.item,inline:"",name:"raw",label:"源码模式",editor:"switch",tip:"页面是非低代码开发，不能在线编辑"},null,8,["disabled"])]),_:1},8,["title","model"]))}}),Jt=j({name:"VIcon",__name:"Icon",props:{icon:{},label:{},active:{type:Boolean,default:!1},open:{type:Boolean,default:!1}},emits:["click"],setup(d,{emit:e}){const t=d,a=e,n=x(()=>({"is-active":t.active,"is-open":t.open})),s=()=>{a("click")};return(o,i)=>(u(),y(l(Nt),{effect:"dark",placement:"right",content:o.label,"show-after":600},{default:f(()=>[_("div",{class:U(["v-apps-region__icon",n.value]),onClick:s},[(u(),y(cl(o.icon)))],2)]),_:1},8,["content"]))}}),I=j({name:"VPanel",__name:"panel",props:{title:{},subtitle:{},plus:{type:Boolean},back:{type:Boolean},edit:{type:Boolean},remove:{type:Boolean},save:{type:Boolean},header:{type:Boolean,default:!0},collapsable:{type:Boolean}},emits:["plus","back","remove","save","edit"],setup(d,{emit:e}){const t=d,a=e,n=k(!1),s=x(()=>({"is-collapsed":!!n.value})),o=()=>{a("plus")},i=()=>{a("edit")},r=()=>{a("back")},p=()=>{a("remove")},m=()=>{a("save")},h=x(()=>t.header?{content:t.title,subtitle:t.subtitle,icon:t.back?ss:void 0,onClickBack:t.back?r:void 0,onClick:t.collapsable?()=>{n.value=!n.value}:void 0}:null),b=v=>{n.value=v};return(v,g)=>(u(),y(l(Ze),{class:U(["v-panel",s.value]),border:!1,header:h.value,fit:""},$n({actions:f(()=>[t.plus?(u(),y(l(fe),{key:0,size:v.$attrs.size,mode:"icon",icon:l(Zt),background:"hover",title:"新增",onClick:o},null,8,["size","icon"])):C("",!0),t.edit?(u(),y(l(fe),{key:1,size:v.$attrs.size,mode:"icon",icon:l(os),background:"hover",title:"编辑",onClick:i},null,8,["size","icon"])):C("",!0),t.remove?(u(),y(l(fe),{key:2,size:v.$attrs.size,mode:"icon",icon:l(is),background:"hover",title:"清除",onClick:p},null,8,["size","icon"])):C("",!0),t.save?(u(),y(l(fe),{key:3,size:v.$attrs.size,mode:"icon",icon:l(xa),background:"hover",title:"保存",onClick:m},null,8,["size","icon"])):C("",!0),t.collapsable?Ee((u(),y(l(fe),{key:4,size:v.$attrs.size,mode:"icon",icon:l(gl),background:"hover",title:"展开",onClick:g[0]||(g[0]=w=>b(!1))},null,8,["size","icon"])),[[De,n.value]]):C("",!0),t.collapsable?Ee((u(),y(l(fe),{key:5,size:v.$attrs.size,mode:"icon",icon:l(rs),background:"hover",title:"收起",onClick:g[1]||(g[1]=w=>b(!0))},null,8,["size","icon"])),[[De,!n.value]]):C("",!0),xe(v.$slots,"actions")]),default:f(()=>[xe(v.$slots,"default")]),_:2},[v.$slots.footer?{name:"footer",fn:f(()=>[xe(v.$slots,"footer")]),key:"0"}:void 0]),1032,["class","header"]))}}),$s={class:"v-tabs__header"},Ys={key:0,class:"v-tabs__actions"},tt=j({__name:"tabs",props:{items:{default:()=>[]},menus:{},modelValue:{},stretch:{type:Boolean},checkable:{type:Boolean}},emits:["update:modelValue","command","remove","action-click"],setup(d,{emit:e}){const t=d,a=e,n=k((t.modelValue||t.items[0]?.name)??"");H(n,()=>{a("update:modelValue",n.value)}),H(()=>t.modelValue,r=>{n.value=r});const s=r=>{a("command",r)},o=r=>{a("remove",r)},i=r=>{a("action-click",r)};return(r,p)=>(u(),y(l(Ze),{class:"v-tabs",border:!1,fit:"",radius:!1},{header:f(()=>[_("div",$s,[c(l(wt),{class:"v-tabs__tabs",items:t.items,type:"card",modelValue:n.value,"onUpdate:modelValue":p[0]||(p[0]=m=>n.value=m),onTabRemove:o,onActionClick:i,stretch:t.stretch},null,8,["items","modelValue","stretch"]),t.menus&&t.menus.length?(u(),V("div",Ys,[t.menus&&t.menus.length?(u(),y(l(fe),{key:0,mode:"icon",size:"small",icon:l(xt),background:"hover",dropdown:{size:"small",placement:"bottom-end"},menus:t.menus,onCommand:s},{item:f(({item:m})=>[_("span",null,[t.checkable?(u(),y(l($t),{key:0,class:U({"v-tabs__checked":!0,"is-checked":m.checked})},null,8,["class"])):C("",!0),q(" "+T(m.label),1)])]),_:1},8,["icon","menus"])):C("",!0)])):C("",!0)])]),default:f(()=>[xe(r.$slots,"default")]),_:3}))}}),Zs={key:2,class:"v-item__index"},eo={class:"v-item__content"},to={key:3,class:"v-item__subtitle"},de=j({name:"VItem",__name:"item",props:{icon:{},index:{},tag:{},tagType:{},title:{},subtitle:{},actions:{default:()=>[]},background:{type:Boolean},border:{type:Boolean},switch:{type:Boolean},modelValue:{},active:{type:Boolean},hover:{type:Boolean},small:{type:Boolean}},emits:["click","action","update:modelValue","switch"],setup(d,{emit:e}){const t={add:{label:"创建",icon:Zt},copy:{label:"复制",icon:nl},edit:{label:"编辑",icon:el},remove:{label:"删除",icon:Ye},lock:{label:"锁定",icon:Qt},unlock:{label:"解锁",icon:On},invisible:{label:"隐藏",icon:Gt},visible:{label:"显示",icon:Ln},home:{label:"主页",icon:Nn}},a=d,n=e,s=k(!!a.modelValue),o=x(()=>a.actions.map(m=>{const h=t[m];return{name:m,...h}})),i=x(()=>({"is-background":a.background,"is-border":a.border,"is-active":a.active,"is-hover":a.hover,"is-small":a.small})),r=()=>{n("click",a.modelValue)},p=async m=>{m==="remove"?await ft.confirm("确定删除吗？","提示",{type:"warning"}).catch(()=>!1)&&n("action",{name:m,modelValue:a.modelValue}):n("action",{name:m,modelValue:a.modelValue})};return H(s,m=>{n("update:modelValue",m),n("switch",m)}),H(()=>a.modelValue,m=>{s.value=!!m}),(m,h)=>(u(),y(l(M),{class:U(["v-item",i.value]),justify:"space-between",align:"center",onClick:r},{default:f(()=>[c(l(M),{class:"v-item__title",align:"center"},{default:f(()=>[xe(m.$slots,"default",{},()=>[m.icon?(u(),y(l(Ce),{key:0,icon:m.icon},null,8,["icon"])):C("",!0),a.tag?(u(),y(l(Wl),{key:1,class:"v-item__tag",size:"small",type:a.tagType},{default:f(()=>[q(T(a.tag),1)]),_:1},8,["type"])):C("",!0),m.index!==void 0?(u(),V("span",Zs," # "+T(m.index),1)):C("",!0),_("span",eo,T(m.title),1),m.subtitle?(u(),V("span",to,T(m.subtitle),1)):C("",!0)])]),_:3}),c(l(M),{class:"v-item__actions",onClick:h[1]||(h[1]=Oe(()=>{},["stop"]))},{default:f(()=>[(u(!0),V(J,null,W(o.value,b=>(u(),y(l(fe),{name:b.name,title:b.label,mode:"icon",size:"small",background:"none",type:"info",icon:b.icon,onClick:v=>p(b.name)},null,8,["name","title","icon","onClick"]))),256)),a.switch?(u(),y(l(It),{key:0,modelValue:s.value,"onUpdate:modelValue":h[0]||(h[0]=b=>s.value=b),class:"v-item__switch",size:"small"},null,8,["modelValue"])):C("",!0),xe(m.$slots,"status")]),_:3})]),_:3},8,["class"]))}}),lo=["draggable"],ao={class:"v-box__name"},no={class:"v-box__label"},gt=j({name:"VBox",__name:"box",props:{name:{},title:{},editable:{type:Boolean},active:{type:Boolean},draggable:{type:Boolean},tag:{},tagType:{}},emits:["edit","remove","dragstart","dragend"],setup(d,{emit:e}){const t=d,a=e,n=()=>{a("edit")},s=async()=>{await ft.confirm("确认删除？","提示",{type:"warning"}).catch(()=>!1)&&a("remove")},o=x(()=>({"is-active":t.active,"is-draggable":t.draggable})),i=()=>{a("dragstart",t)},r=()=>{a("dragend",t)};return(p,m)=>(u(),V("div",{class:U(["v-box",o.value]),draggable:p.draggable,onDragstart:i,onDragend:r},[c(l(M),{direction:"column",justify:"center",align:"center"},{default:f(()=>[_("span",ao,T(t.name),1),_("span",no,T(t.title),1)]),_:1}),t.editable?(u(),y(l(M),{key:0,class:"v-box__footer",justify:"flex-end",align:"center"},{default:f(()=>[c(l(Ce),{icon:l(el),onClick:n},null,8,["icon"]),c(l(Ce),{icon:l(Ye),onClick:s},null,8,["icon"])]),_:1})):C("",!0),t.tag?(u(),V("span",{key:1,class:U(["v-box__tag",{[`is-${t.tagType}`]:!!t.tagType}])},T(t.tag),3)):C("",!0)],42,lo))}}),so={class:"v-context-viewer"},oo=j({__name:"viewer",props:{context:{}},emits:["pick","copy"],setup(d,{emit:e}){const t=d,a=e,n=["$provider","$apis","$components","context"],s=m=>{const h=m.value,b=lt(h);return b==="Object"||b==="Module"?Object.keys(h||{}).length===0:b==="Array"?h.length===0:!0},o=(m,h="this")=>typeof m=="object"?Array.isArray(m)?m.map((b,v)=>{const g=`[${v}]`;return{label:g,value:b,type:lt(b),path:`${h}${g}`}}):Object.entries(m).map(([b,v])=>({label:b,value:v,type:lt(v),path:`${h}.${b}`})).filter(b=>!b.label.startsWith("__")&&!n.includes(b.label)):[],i=(m,h)=>{if(m.level===0)h(o(t.context));else{const b=es(m.data.value);h(o(b,m.data.path))}},r=m=>{a("copy",m.path)},p=m=>{a("pick",m.path)};return(m,h)=>(u(),V("div",so,[m.context?(u(),y(l(bt),{key:0,lazy:"",load:i,"expand-on-click-node":!1,props:{isLeaf:s}},{default:f(({data:b})=>[c(de,{title:b.label,clickable:"",onClick:v=>p(b),background:"",actions:["copy"],onAction:v=>r(b),grow:"",small:""},null,8,["title","onClick","onAction"])]),_:1},8,["props"])):C("",!0)]))}}),_t=j({__name:"binder",props:{title:{},context:{},block:{},model:{},rules:{},modelValue:{type:Boolean},submitMethod:{type:Function},unbindEnabled:{type:Boolean}},emits:["unbind","submit","cancel","pick","update:modelValue","close"],setup(d,{emit:e}){const t=d,a=e,{searchResult:n,keyword:s}=Cs(t.block,t.context),{copy:o}=ts({}),i=[{name:"normal",label:"常用"},{name:"viewer",label:"高级"}],r=k("normal"),p=k(),m=async z=>{a("submit",z),t.submitMethod?await t.submitMethod(z)&&h():h()},h=()=>{a("update:modelValue",!1),a("close")},b=()=>{a("unbind")},v=()=>{h()},g=async()=>{p.value?.submit()},w=z=>{a("pick",z)},S=z=>{o(z),$e.success({message:"已经复制到粘贴板"})};return(z,P)=>(u(),y(l(Re),{"model-value":t.modelValue,class:"v-binder",title:z.title,width:"1000px",height:"600px","body-padding":!1,maximizable:!1,minimizable:!1,onClose:h},{default:f(()=>[c(l(M),{fit:"",direction:"row",overflow:"hidden"},{default:f(()=>[c(l(M),{width:"30%",height:"100%"},{default:f(()=>[c(tt,{class:"v-binder__tabs",items:i,modelValue:r.value,"onUpdate:modelValue":P[1]||(P[1]=D=>r.value=D)},{default:f(()=>[c(l(M),{class:"v-binder__tab-content",fit:"",padding:"",flex:!1},{default:f(()=>[Ee(_("div",null,[c(l(ye),{modelValue:l(s),"onUpdate:modelValue":P[0]||(P[0]=D=>mt(s)?s.value=D:null),size:"small",clearable:"","prefix-icon":l(hl),placeholder:"筛选可用项"},null,8,["modelValue","prefix-icon"]),(u(!0),V(J,null,W(l(n),D=>(u(),V("div",null,[c(l(ht),{"border-style":"dotted"},{default:f(()=>[q(T(D.title),1)]),_:2},1024),(u(!0),V(J,null,W(D.items,R=>(u(),y(de,{title:R,background:"",actions:["copy"],small:"",onClick:K=>w(R),onAction:K=>S(R)},null,8,["title","onClick","onAction"]))),256))]))),256)),l(n).length?C("",!0):(u(),y(l(oe),{key:0}))],512),[[De,r.value==="normal"]]),Ee(c(oo,{context:t.context,onCopy:S,onPick:w},null,8,["context"]),[[De,r.value==="viewer"]])]),_:1})]),_:1},8,["modelValue"])]),_:1}),c(l(Ze),{grow:"",header:null,border:!1},{footer:f(()=>[c(l(M),{justify:"space-between"},{default:f(()=>[c(l(M),null,{default:f(()=>[z.unbindEnabled?(u(),y(l(ne),{key:0,type:"warning",size:"default",onClick:b},{default:f(()=>[q(" 移除绑定 ")]),_:1})):C("",!0)]),_:1}),c(l(M),null,{default:f(()=>[c(l(ne),{type:"default",size:"default",onClick:v},{default:f(()=>[q(" 取消 ")]),_:1}),c(l(ne),{type:"primary",size:"default",onClick:g},{default:f(()=>[q(" 确定 ")]),_:1})]),_:1})]),_:1})]),default:f(()=>[c(l(kt),{ref_key:"formRef",ref:p,class:"v-binder__form",footer:!1,"label-position":"top","tooltip-message":!1,model:t.model,rules:t.rules,"submit-method":m},{default:f(()=>[xe(z.$slots,"default")]),_:3},8,["model","rules"])]),_:3})]),_:3})]),_:3},8,["model-value","title"]))}}),io={class:"v-slots-picker__sn"},ro=j({__name:"slots",props:{slots:{default:()=>[]}},emits:["submit","update:modelValue"],setup(d,{emit:e}){const t=d,a=e,n=k(),s=x(()=>`${50*Math.ceil(t.slots.length/4)+180}px`),o=r=>{n.value=r},i=()=>{n.value?(a("submit",n.value),a("update:modelValue",!1)):le("请选择插槽")};return(r,p)=>(u(),y(l(Re),re({class:"v-slots-picker",title:"选择插槽",width:"600px",height:s.value,submit:"",cancel:"",onSubmit:i},r.$attrs),{default:f(()=>[c(l(qt),{title:"该组件支持多个插槽，请选择放置到其中一个",type:"warning",closable:!1}),c(l(M),{class:"v-slots-picker__content",justify:"space-around",alignContent:"flex-start",gap:"",wrap:"wrap"},{default:f(()=>[(u(!0),V(J,null,W(t.slots,(m,h)=>(u(),y(l(M),{class:U(["v-slots-picker__item",{"is-active":m.name===n.value?.name}]),grow:"",flex:!1,onClick:b=>o(m)},{default:f(()=>[_("span",io,"#"+T(h+1),1),q(" "+T(m.name),1)]),_:2},1032,["class","onClick"]))),256))]),_:1})]),_:1},16,["height"]))}}),kl=j({name:"Viewport",__name:"viewport",props:{mode:{default:"pc"},width:{},height:{}},setup(d){const e=d,t=x(()=>[`is-${e.mode}`]),a=x(()=>{if(e.mode==="pc")return 1;const s=e.mode==="mobile"?Rt:Ft,{width:o,height:i}=s,r=o>0?(e.width||0)/o:1,p=i>0?(e.height||0)/i:1;return Math.min(r,p)}),n=x(()=>{if(e.mode==="pc")return{};const s=e.mode==="mobile"?Rt:Ft,{width:o,height:i}=s;return{width:`${o}px`,height:`${i}px`,left:"50%",top:"50%",transform:`translate(-50%, -50%) scale(${a.value})`}});return(s,o)=>(u(),V("div",{class:U(["v-viewport",t.value]),style:Ge(n.value)},[xe(s.$slots,"default")],6))}}),uo=j({name:"PagesWidget",__name:"index",setup(d){const{project:e,engine:t}=Fe(),a=x(()=>e.value?.pages||[]),{current:n}=ue(),s=k(!1),o=k(),i=k(),r=()=>{i.value=void 0,o.value=void 0,s.value=!0},p=async v=>{const{name:g,modelValue:w}=v,{data:S,node:z}=w;if(g==="add"&&(o.value=void 0,i.value=S.id,s.value=!0),g==="edit"&&(o.value=et(S),i.value=void 0,s.value=!0),g==="remove"){if(S.dir){const P=e.value?.getPage(S.id);if(P&&P.children?.length){le("请先删除子页面");return}}e.value?.removePage(S.id)}if(g==="copy"){const P=z.parent?.data.id;e.value?.clonePage(S,P)}g==="home"&&(e.value?.setHomepage(S.id),me("设置主页成功","success"))},m=async v=>{v.raw&&me("这是源码模式页面，不能低代码设计","warning"),v.dir||v.raw?t.project.value?.deactivate():t.project.value?.active(v)},h=(v,g,w)=>w==="inner"?!!g.data.dir:!0,b=()=>{e.value?.update({pages:pt(a)})};return(v,g)=>(u(),y(l(I),{class:"v-pages-widget",title:"页面管理",plus:"",subtitle:"(共 0 条)",onPlus:r},{default:f(()=>[c(l(bt),{data:a.value,"node-key":"id","default-expand-all":"",draggable:"","allow-drop":h,onNodeDrop:b},{default:f(({data:w,node:S})=>[c(l(de),{class:"v-pages-widget__item",icon:l(rt)[w.icon],title:w.title,subtitle:w.name,"model-value":{data:w,node:S},actions:w.dir?["add","edit","remove"]:w.raw?["home","edit","remove"]:["home","copy","edit","remove"],onAction:p,onClick:z=>m(w),active:l(n)?.id===w.id,tag:l(e)?.homepage===w.id?"主页":void 0,"tag-type":"success",grow:"",small:"",background:"",hover:""},null,8,["icon","title","subtitle","model-value","actions","onClick","active","tag"])]),_:1},8,["data"]),s.value?(u(),y(Ks,{key:0,modelValue:s.value,"onUpdate:modelValue":g[0]||(g[0]=w=>s.value=w),item:o.value,"parent-id":i.value},null,8,["modelValue","item","parent-id"])):C("",!0)]),_:1}))}}),co={class:"v-file-setter"},Ct=j({name:"FileSetter",__name:"file",props:{modelValue:{},attachment:{}},emits:["change","update:modelValue"],setup(d,{emit:e}){const t=d,a=e,{engine:n,project:s}=Fe(),o=k([]),i=k(!1),r=P=>Array.isArray(P)?P.map(D=>({name:D.filename,url:D.filepath})):P?{name:P.filename,url:P.filepath}:null,p=async P=>{if(n&&s.value){const D=await n.service.uploadStaticFile(P,s.value.id);return r(D)}return null},m=P=>P?(P||"").split(",").map(D=>({url:D})):[],h=k(m(t.modelValue)),b=x(()=>Array.isArray(h.value)?h.value.map(P=>P.url).join(","):h.value?h.value.url:"");H(()=>t.modelValue,P=>{h.value=m(P)}),H(i,async P=>{if(P){const D=await n.service.getStaticFiles(s.value?.id).catch(()=>null);o.value=r(D)}});const v=()=>{if(!h.value||Array.isArray(h.value)&&h.value.length===0)return le("请选择文件"),!1;const P=(t.attachment?.accept||"").toLowerCase().split(",");return P.length>0?[].concat(h.value).every(D=>{const R=D.name||D.url.split("?")[0],K=R.substring(R.lastIndexOf(".")).toLowerCase();return P.includes(K)})?!0:(le(`只支持 ${P.join(",")} 文件`),!1):!0},g=()=>{v()&&(a("change",b.value),a("update:modelValue",b.value),i.value=!1)},w=()=>{h.value=[],a("change",void 0),a("update:modelValue",void 0),i.value=!1},S=()=>{i.value=!0},z=P=>{P.name&&s.value?.id&&n.service.removeStaticFile(P.name,s.value?.id)};return(P,D)=>(u(),V("div",co,[c(l(ye),re({readonly:"",onFocus:S,"model-value":t.modelValue,"suffix-icon":l(us)},P.$attrs),null,16,["model-value","suffix-icon"]),i.value?(u(),y(l(Re),{key:0,modelValue:i.value,"onUpdate:modelValue":D[1]||(D[1]=R=>i.value=R),title:"文件选择器",width:"600px",height:"400px",cancel:"",submit:"",onSubmit:g},{extra:f(()=>[c(l(ne),{type:"warning",size:"default",onClick:w},{default:f(()=>[q(" 清除 ")]),_:1})]),default:f(()=>[c(l(_a),re({size:"small","list-type":"list",selectable:!0,uploader:p,"model-value":o.value,"select-value":h.value,"onUpdate:selectValue":D[0]||(D[0]=R=>h.value=R)},t.attachment,{onRemove:z}),null,16,["model-value","select-value"])]),_:1},8,["modelValue"])):C("",!0)]))}}),mo=j({name:"BlocksWidget",__name:"index",setup(d){const{span:e}=fl(),{blocks:t,engine:a}=ys(),n=[{label:"设计",value:"Schema",border:!0},{label:"引用",value:"UrlSchema",border:!0},{label:"插件",value:"Plugin",border:!0}],s={Schema:{label:"设计",type:"primary"},UrlSchema:{label:"引用",type:"warning"},Plugin:{label:"插件",type:"danger"}},o=k(void 0),{current:i}=ue(),r=k(!1),p=x(()=>o.value?.id?"编辑区块":"新增区块"),m=x(()=>`(共 ${t.value.length} 个)`),h=()=>({fromType:"Schema",name:"",title:"",urls:"",library:"",type:"block"}),b=x(()=>{if(o.value?.fromType==="UrlSchema")return".json";if(o.value?.fromType==="Plugin")return".js,.css,.json"}),v=x(()=>o.value?.fromType==="Plugin"),g=async E=>{const F=E,A=a.project.value;if(!A)return!1;if(E.id)if(!A.existBlockName(F.name,[F.id]))A.updateBlock(F);else return le(`名称【${F.name}】已经存在，请更换名称`),!1;else if(!A.existBlockName(F.name))A.createBlock(F);else return le(`名称【${F.name}】已经存在，请更换名称`),!1;return!0},w=()=>{o.value=h(),r.value=!0},S=E=>{o.value=et(E),r.value=!0},z=E=>{a.project.value?.removeBlock(E.id)},P=E=>{o.value&&(o.value.name=tl(E))},D=async E=>{(!E.fromType||E.fromType==="Schema")&&a.project.value?.active(E)},R=async E=>{const F=Ca(E),A=await a.assets.getBlockMaterial(F,E.name),Q=a.skeleton?.getWidget("Designer")?.widgetRef?.designer;Q&&A&&Q.setDragging(A)},K=()=>{const E=a.skeleton?.getWidget("Designer")?.widgetRef?.designer;E&&E.setDragging(null)};return(E,F)=>(u(),y(l(I),{class:"v-blocks-widget",title:"区块管理",subtitle:m.value,plus:"",onPlus:w},{default:f(()=>[c(l(ot),{wrap:"wrap",gutter:5},{default:f(()=>[(u(!0),V(J,null,W(l(t),A=>(u(),y(l(it),{key:A.id,span:l(e)},{default:f(()=>[c(l(gt),{name:A.name,title:A.title,active:l(i)?.id===A.id,editable:"",tag:s[A.fromType||"Schema"]?.label,tagType:s[A.fromType||"Schema"]?.type,onEdit:Q=>S(A),onRemove:Q=>z(A),onClick:Q=>D(A),draggable:l(i)?.id!==A.id,onDragstart:Q=>R(A),onDragend:K},null,8,["name","title","active","tag","tagType","onEdit","onRemove","onClick","draggable","onDragstart"])]),_:2},1032,["span"]))),128))]),_:1}),l(t).length?C("",!0):(u(),y(l(oe),{key:0})),c(l(Ve),{modelValue:r.value,"onUpdate:modelValue":F[0]||(F[0]=A=>r.value=A),title:p.value,model:o.value,width:"600px",height:"400px","form-props":{tooltipMessage:!1},"submit-method":g},{default:f(()=>[c(l(B),{name:"fromType",label:"类型",required:"",editor:"radio",disabled:!!o.value?.id,options:n},null,8,["disabled"]),c(l(B),{name:"name",label:"名称",required:"",tip:"名称为英文驼峰格式",rules:{message:"名称格式错误",pattern:l(je)},onChange:P},null,8,["rules"]),c(l(B),{name:"title",label:"标题",required:""}),o.value?.fromType==="Plugin"?(u(),y(l(B),{key:0,name:"library",label:"插件名称",required:""})):C("",!0),["Plugin","UrlSchema"].includes(o.value?.fromType||"")?(u(),y(l(B),{key:1,name:"urls",label:"资源文件",required:"",editor:Ct,props:{attachment:{accept:b.value,multiple:v.value}}},null,8,["props"])):C("",!0)]),_:1},8,["modelValue","title","model"])]),_:1},8,["subtitle"]))}}),po={class:"v-components-widget__search"},vo={key:0,class:"v-components-widget__result"},go={class:"v-components-widget__list"},ho=j({name:"ComponentsWidget",__name:"index",setup(d){const{span:e,engine:t}=fl(),{tabs:a,currentTab:n,currentGroup:s,model:o,searchKey:i,searchResult:r}=ks(),p=h=>{const b=t.skeleton?.getWidget("Designer")?.widgetRef?.designer;b&&b.setDragging(h)},m=()=>{const h=t.skeleton?.getWidget("Designer")?.widgetRef?.designer;h&&h.setDragging(null)};return(h,b)=>(u(),y(l(I),{class:"v-components-widget",title:"组件库",body:{flex:!0,direction:"column"}},{default:f(()=>[_("div",po,[c(l(ye),{modelValue:l(i),"onUpdate:modelValue":b[0]||(b[0]=v=>mt(i)?i.value=v:null),placeholder:"搜索组件",clearable:"",size:"small"},{prefix:f(()=>[c(l(ia))]),_:1},8,["modelValue"])]),l(i)?(u(),V("div",vo,[c(l(ot),{wrap:"wrap",gutter:5},{default:f(()=>[(u(!0),V(J,null,W(l(r),v=>(u(),y(l(it),{span:l(e),key:v.name},{default:f(()=>[c(l(gt),{name:v.name,title:v.label||v.name,draggable:"",onDragstart:g=>p(v),onDragend:m},null,8,["name","title","onDragstart"])]),_:2},1032,["span"]))),128))]),_:1}),l(r).length?C("",!0):(u(),y(l(oe),{key:0}))])):(u(),y(l(wt),{key:1,items:l(a),modelValue:l(n),"onUpdate:modelValue":b[2]||(b[2]=v=>mt(n)?n.value=v:null)},{default:f(()=>[_("div",go,[l(s)?(u(),y(l(Al),{key:0,modelValue:l(o)[l(n)],"onUpdate:modelValue":b[1]||(b[1]=v=>l(o)[l(n)]=v)},{default:f(()=>[(u(!0),V(J,null,W(l(s).children,v=>(u(),y(l(Pl),{key:v.name,name:v.name,title:`${v.label} (${v.count})`},{default:f(()=>[v.components?(u(),y(l(ot),{key:0,wrap:"wrap",gutter:5},{default:f(()=>[(u(!0),V(J,null,W(v.components,g=>(u(),y(l(it),{span:l(e),key:g.name},{default:f(()=>[c(l(gt),{name:g.name,title:g.label||g.name,draggable:"",onDragstart:w=>p(g),onDragend:m},null,8,["name","title","onDragstart"])]),_:2},1032,["span"]))),128))]),_:2},1024)):C("",!0)]),_:2},1032,["name","title"]))),128))]),_:1},8,["modelValue"])):C("",!0)])]),_:1},8,["items","modelValue"]))]),_:1}))}}),bo=j({name:"OutlineWidget",__name:"index",setup(d){const{engine:e,designer:t,selected:a}=we(),{current:n}=ue(),s=k([]),o=(E,F)=>{if(F==="slot")return[];if(ee(E))return E.locked?["unlock"]:["lock"];const A=E.parent;return A&&(A.locked||A.invisible)?[]:n.value?.locked?[]:E.locked?["unlock"]:E.invisible?["visible"]:["lock","invisible","copy","remove"]},i=(E,F)=>{const A={};if(!E.some(se=>se.slot))return r(E);for(const se of E){const L=se.slot?.name||"default";A[L]||(A[L]=[]),A[L].push(se)}const Q=[];for(const[se,L]of Object.entries(A))Q.push({id:`${F.id}-${se}`,label:`#${se}`,type:"slot",model:F,disabled:!0,children:r(L)});return Q},r=E=>{const F=[];return E.forEach(A=>{const Q={id:A.id,label:A.name,type:A.id,model:A};Array.isArray(A.children)&&(Q.children=i(A.children,A)),F.push(Q)}),F},p=()=>{if(!n.value)return[];const{id:E,name:F,nodes:A}=n.value;return[{id:E,label:F,type:E,model:n.value,children:r(A)}]},m=async()=>{s.value=p(),a.value?.model&&(await Se(),t.value?.setSelected(a.value.model))},h=x(()=>a.value?.model.id),b=E=>{const F=E.data;if(F.type==="slot"||ee(F.model)||F.model.locked||F.model.name==="template")return!1;const A=e.assets.componentMap.get(F.model.name);return A?(t.value?.setDragging(A),!0):!1},v=async(E,F,A)=>{const Q=F.data,se={prev:"top",next:"bottom",inner:"inner"}[A];let L=!1;if(ee(Q.model))L=A==="inner",t.value?.setDropping(L?Q.model:null,"inner");else{const X=Q.model;L=!!await t.value?.allowDrop(X,se),t.value?.setDropping(L?X:null,"inner")}return L},g=E=>{const F=E?.model;if(!F||F.invisible||E.type==="slot"){t.value?.setSelected(null),t.value?.setHover(null);return}t.value?.setSelected(F),t.value?.setHover(null)},w=async(E,F,A)=>{const Q=E.data,se=F.data;if(ee(se.model)){const ke=Q.model;delete ke.slot,n.value?.move(ke,void 0,"inner"),t.value?.setDropping(null),t.value?.setDragging(null);return}const L=se.model,X={before:"left",after:"right"}[A]||"inner";if(!await t.value?.allowDrop(L,X)){t.value?.setDropping(null),m(),$e.warning({message:`${Q.model.name}不能放置到该位置`}),t.value?.setDragging(null);return}const O=await t.value?.getDropSlot(A==="inner"?L:L.parent);if(O!==null){const ke=Q.model;ke.slot=O,n.value?.move(ke,L,X)}else m();t.value?.setDropping(null),t.value?.setDragging(null),e.simulator.refresh()},S=E=>{if(E.type==="slot"){t.value?.setHover(null);return}ee(E.model)?t.value?.setHover(E.model):(t.value?.setHover(E.model),E.model.invisible&&t.value?.setHover(null),E.model.name==="slot"&&t.value?.setHover(null))},z=()=>{t.value?.setHover(null)},P=E=>{const F=E.data;F.dragging=!0;const A=e.assets.componentMap.get(F.model.name);A&&t.value?.setDragging(A)},D=async E=>{const F=E.data;F.dragging=!1},R=(E,F)=>{E&&((E.id===F.id||!ee(E)&&F.isChild(E))&&t.value?.setSelected(null),t.value?.setHover(null))},K=E=>{const{name:F,modelValue:A}=E,Q=a.value?.model;switch(F){case"lock":R(Q,A),A.lock();break;case"unlock":R(Q,A),A.unlock();break;case"invisible":R(Q,A),A.setVisible(!1);break;case"visible":A.setVisible(!0);break;case"copy":const se=n.value?.cloneNode(A);se&&t.value?.setSelected(se);break;case"remove":R(Q,A),n.value?.removeNode(A);break}};return H(e.changed,m,{immediate:!0}),(E,F)=>(u(),y(l(I),{class:"v-outline-widget",title:"大纲树"},{default:f(()=>[(u(),y(l(bt),{key:l(e).changed.value,data:s.value,"node-key":"id","default-expand-all":"",draggable:"","empty-text":"请新建或打开文件","current-node-key":h.value,"highlight-current":!0,"expand-on-click-node":!1,"allow-drop":v,"allow-drag":b,onCurrentChange:g,onNodeDrop:w,onNodeDragStart:P,onNodeDragEnd:D},{default:f(({data:A,node:Q})=>[c(l(de),{class:U(["v-outline-widget__item",{"is-locked":A.model.locked,"is-invisible":A.model.invisible,"is-dragging":A.dragging,"is-slot":A.type==="slot"}]),active:!A.model.invisible&&Q.isCurrent&&A.type!=="slot",grow:"",small:"",background:"",hover:"","model-value":A.model,icon:A.model.locked?l(Qt):A.model.invisible?l(Gt):void 0,title:A.label,subtitle:A.type,actions:o(A.model,A.type),onAction:K,onMouseenter:se=>S(A),onMouseleave:z},null,8,["class","active","model-value","icon","title","subtitle","actions","onMouseenter"])]),_:1},8,["data","current-node-key"]))]),_:1}))}}),fo=j({name:"HistoryWidget",__name:"index",setup(d){const{history:e,load:t,total:a}=yl(),n=x(()=>`(共 ${a.value} 条)`),s=i=>{i.name==="remove"&&e.value?.remove(i.modelValue.id)},o=async()=>{await We("确定要清空历史记录吗？")&&e.value?.clear()};return(i,r)=>(u(),y(l(I),{class:"v-history-widget",title:"历史记录",subtitle:n.value,remove:!!l(a),onRemove:o},{default:f(()=>[l(a)===0?(u(),y(l(oe),{key:0,"image-size":50})):C("",!0),l(e)?(u(!0),V(J,{key:1},W(l(e).items,(p,m)=>(u(),y(l(de),{index:m+1,title:p.label,"model-value":p,active:m==l(e).index,small:"",background:"",actions:["remove"],onAction:s,onClick:h=>l(t)(p.id)},null,8,["index","title","model-value","active","onClick"]))),256)):C("",!0)]),_:1},8,["subtitle","remove"]))}}),yo=j({__name:"base-info",setup(d){const e=bs.map(t=>({label:t,value:t.toLowerCase()}));return(t,a)=>(u(),V("div",null,[c(l(B),{name:"method",label:"请求类型",required:"",editor:"radio",options:l(e)},null,8,["options"]),c(l(B),{name:"name",label:"接口名称",required:"",rules:{pattern:l(je),message:"名称格式不正确"}},null,8,["rules"]),c(l(B),{name:"label",label:"备注说明",required:""}),c(l(B),{name:"url",label:"接口URL",required:""})]))}}),ae=Yn({loader:()=>Gn(()=>import("./Editor-BKlikwSl-KWDHyKIs.js"),__vite__mapDeps([0,1,2,3]),import.meta.url),loadingComponent:j({render(){return Te("div","正在拼命加载...")}}),errorComponent:j({render(){return Te("div","组件加载失败！")}})}),wo=j({__name:"request-settings",setup(d){const e=[{label:"表单",value:"form"},{label:"JSON",value:"json"},{label:"文件",value:"data"}],t=St("currentModel",null);return(a,n)=>(u(),V("div",null,[c(l(M),{justify:"space-between"},{default:f(()=>[c(l(B),{name:"settings.loading",size:"small",label:"加载提示",editor:"switch"}),c(l(B),{size:"small",name:"settings.failMessage",label:"失败提示",editor:"switch"}),c(l(B),{size:"small",name:"settings.validSuccess",label:"校验成功",editor:"switch"}),c(l(B),{size:"small",name:"settings.originResponse",label:"原始响应",editor:"switch"}),c(l(B),{size:"small",name:"settings.injectHeaders",label:"注入请求头",editor:"switch"})]),_:1}),c(l(B),{size:"small",name:"settings.type",label:"发送数据类型",editor:"radio",options:e,props:{button:!0}}),c(l(B),{size:"small",name:"headers.value",label:"请求头配置",tip:"支持 JSExpression 或 JSFunction"},{editor:f(()=>[c(l(ae),{dark:"",height:"260px",modelValue:l(t).headers.value,"onUpdate:modelValue":n[0]||(n[0]=s=>l(t).headers.value=s)},null,8,["modelValue"])]),_:1})]))}}),ko=j({__name:"jsonp-options",setup(d){return(e,t)=>(u(),V("div",null,[c(l(B),{name:"jsonpOptions.jsonpCallback",size:"small",label:"jsonpCallback"}),c(l(B),{name:"jsonpOptions.jsonpCallbackFunction",size:"small",label:"jsonpCallbackFunction"}),c(l(B),{name:"jsonpOptions.timeout",size:"small",label:"timeout",editor:"number"}),c(l(B),{name:"jsonpOptions.crossorigin",size:"small",label:"crossorigin",editor:"switch"})]))}}),So=_("span",null,"模拟数据模板",-1),xo=j({__name:"mock-template",setup(d){const e=St("currentModel",null),{project:t}=Fe(),a=x(()=>t.value?.config||{}),n=()=>{window.open("https://vtj.pro/help/mock.html")};return(s,o)=>(u(),V("div",null,[a.value.mock?C("",!0):(u(),y(l(qt),{key:0,type:"warning",title:"需要在项目配置中开启模拟数据",closable:!1,style:{"margin-bottom":"20px"}})),c(l(B),{size:"small",name:"mock",label:"开启模拟数据",disabled:!a.value.mock,editor:"switch"},null,8,["disabled"]),c(l(M),{justify:"space-between"},{default:f(()=>[So,c(l(fe),{icon:l(al),mode:"text",label:"帮助",onClick:n},null,8,["icon"])]),_:1}),c(l(B),{size:"small",name:"mockTemplate.value",label:" "},{editor:f(()=>[c(l(ae),{dark:"",height:a.value.mock?"330px":"280px",lang:"typescript",disabled:!a.value.mock,readonly:!a.value.mock,modelValue:l(e).mockTemplate.value,"onUpdate:modelValue":o[0]||(o[0]=i=>l(e).mockTemplate.value=i)},null,8,["height","disabled","readonly","modelValue"])]),_:1})]))}}),_o={key:0},Co=j({__name:"form",props:{model:{},project:{}},setup(d){const e=d,t=x(()=>e.model?"编辑API":"新增API"),a=k("base"),n=k(),s=k(),o=k(e.model||{}),i=k(!1),r=k(""),p=[{label:"基础信息",value:"base"},{label:"请求配置",value:"settings"},{label:"模拟数据",value:"mock"}];Zn("currentModel",o);const m=x(()=>o.value?.method==="jsonp");H(()=>e.model,w=>{o.value=Object.assign({},w||{}),a.value="base"},{immediate:!0}),H(a,async()=>{s.value?.formRef.validate(async w=>{w||(await Se(),a.value="base")})});const h=()=>{n.value?.cancel()},b=()=>{s.value?.submit()},v=async w=>e.project?.existApiName(o.value.name,e.model?[o.value.id]:[])?(le(`API名称 [ ${o.value.name} ] 已存在`),!1):o.value.headers&&!ie(o.value.headers,window)||o.value.mockTemplate&&!ie(o.value.mockTemplate,window)?!1:(e.project?.setApi(o.value),n.value?.close(),!0),g=()=>{if(o.value.mockTemplate){const w=Me(o.value.mockTemplate,{},!0),{url:S,method:z}=o.value,P=as.mock(w({url:S,type:z}));r.value=JSON.stringify(P,null,2),i.value=!0}};return(w,S)=>(u(),y(l(Re),{ref_key:"dialogRef",ref:n,title:t.value,width:"1000px",height:"600px"},{default:f(()=>[c(l(M),{fit:""},{default:f(()=>[c(l(M),{width:"100px",shrink:!1},{default:f(()=>[c(l(wt),{modelValue:a.value,"onUpdate:modelValue":S[0]||(S[0]=z=>a.value=z),items:p,"tab-position":"left",border:"",fit:""},null,8,["modelValue"])]),_:1}),c(l(Ze),{header:null,border:!1,overflow:"auto",grow:"",shrink:!0,fit:""},{footer:f(()=>[c(l(M),{justify:"space-between"},{default:f(()=>[_("div",null,[a.value==="mock"?(u(),y(l(ne),{key:0,disabled:!e.project?.config?.mock,type:"warning",onClick:g},{default:f(()=>[q(" 预览 ")]),_:1},8,["disabled"])):C("",!0)]),_("div",null,[c(l(ne),{onClick:h},{default:f(()=>[q("取消")]),_:1}),c(l(ne),{type:"primary",onClick:b},{default:f(()=>[q("保存")]),_:1})])]),_:1})]),default:f(()=>[c(l(kt),{ref_key:"formRef",ref:s,footer:!1,labelPosition:"top",tooltipMessage:!1,model:o.value,submitMethod:v},{default:f(()=>[Ee(c(yo,null,null,512),[[De,a.value==="base"]]),a.value==="settings"?(u(),V("div",_o,[m.value?(u(),y(ko,{key:0})):(u(),y(wo,{key:1}))])):C("",!0),a.value==="mock"?(u(),y(xo,{key:1})):C("",!0)]),_:1},8,["model"])]),_:1})]),_:1}),i.value?(u(),y(l(Ut),{key:0,class:"v-drawer",modelValue:i.value,"onUpdate:modelValue":S[1]||(S[1]=z=>i.value=z),title:"模拟数据结果",direction:"btt","append-to-body":"",size:"80%"},{default:f(()=>[c(l(ae),{"model-value":r.value,border:"",dark:"",height:"100%",lang:"json"},null,8,["model-value"])]),_:1},8,["modelValue"])):C("",!0)]),_:1},8,["title"]))}}),Vo=j({name:"ApisWidget",__name:"index",setup(d){const e=k(!1),t=k(null),a=k(!1),n=x(()=>s.value?.apis||[]),{project:s}=Fe(),o=()=>({id:"",method:"get",name:"",label:"",url:"",settings:{loading:!0,failMessage:!0,validSuccess:!0,originResponse:!1,injectHeaders:!1,type:"form"},headers:{type:"JSExpression",value:"({})"},jsonpOptions:{},mock:!1,mockTemplate:{type:"JSFunction",value:`(req) => {
  return {
    code: 0,
    data: null
  }
}`}}),i=()=>{e.value=!0,a.value=!1,t.value=o()},r={get:"success",post:"primary",put:"warning",delete:"danger",patch:"warning",jsonp:"info"},p=h=>{h.name==="edit"&&m(h.modelValue),h.name==="remove"&&s.value?.removeApi(h.modelValue.name)},m=h=>{a.value=!0,t.value=et(h),e.value=!0};return(h,b)=>(u(),y(l(I),{class:"v-apis-widget",title:"API管理",plus:"",onPlus:i},{default:f(()=>[(u(!0),V(J,null,W(n.value,v=>(u(),y(l(de),{key:v.id,small:"",title:v.name,subtitle:v.label,"model-value":v,tag:v.method?.toUpperCase(),"tag-type":r[v.method||"get"],background:"",actions:["edit","remove"],onClick:g=>m(v),onAction:p},null,8,["title","subtitle","model-value","tag","tag-type","onClick"]))),128)),n.value.length===0?(u(),y(l(oe),{key:0,"image-size":50})):C("",!0),c(Co,{modelValue:e.value,"onUpdate:modelValue":b[0]||(b[0]=v=>e.value=v),model:t.value,project:l(s)},null,8,["modelValue","model","project"])]),_:1}))}}),jo=j({name:"DepsWidget",__name:"index",setup(d){const{dependencies:e,engine:t}=bl(),a=k(!1),n=k(!1),s=k({}),o=x(()=>n.value?"查看依赖":s.value?"编辑依赖":"新增依赖"),i=g=>g.required||g.official?[]:["edit","remove"],r=g=>g.official&&!g.required,p=async g=>(g.urls=g.urls.split(`
`),t.project.value?.setDeps(g),!0),m=g=>{t.project.value?.setDeps(g)},h=()=>{n.value=!1,a.value=!0,s.value=null},b=g=>{n.value=!0,s.value={...g,urls:g.urls.join(`
`)},a.value=!0},v=(g,w)=>{w.name==="edit"&&(s.value={...g,urls:g.urls.join(`
`)},n.value=!1,a.value=!0),w.name==="remove"&&t.project.value?.removeDeps(g)};return(g,w)=>(u(),y(l(I),{class:"v-deps-widget",title:"依赖管理",plus:"",onPlus:h},{default:f(()=>[(u(!0),V(J,null,W(l(e),S=>(u(),y(l(de),{key:S.package,title:S.package,subtitle:S.version,actions:i(S),background:"",switch:r(S),modelValue:S.enabled,"onUpdate:modelValue":z=>S.enabled=z,onSwitch:z=>m(S),onClick:z=>b(S),onAction:z=>v(S,z)},null,8,["title","subtitle","actions","switch","modelValue","onUpdate:modelValue","onSwitch","onClick","onAction"]))),128)),c(l(Ve),{modelValue:a.value,"onUpdate:modelValue":w[0]||(w[0]=S=>a.value=S),width:"600px",height:"500px",title:o.value,model:s.value,submitMethod:p,formProps:{disabled:n.value,tooltipMessage:!1}},{default:f(()=>[c(l(B),{name:"package",label:"包名",required:"",disabled:!!s.value},null,8,["disabled"]),c(l(B),{name:"version",label:"版本",required:""}),c(l(B),{name:"library",label:"导出名称",required:""}),c(l(B),{name:"urls",label:"资源文件",editor:"textarea",props:{rows:3},tip:"多个资源可以换行输入",required:""}),c(l(B),{name:"assetsUrl",label:"物料URL"}),c(l(B),{name:"assetsLibrary",label:"物料名称"})]),_:1},8,["modelValue","title","model","formProps"])]),_:1}))}}),Ao=j({__name:"actions",props:{position:{},model:{},path:{default:()=>[]}},emits:["action","dragstart","dragend"],setup(d,{emit:e}){const t=d,a=e,n=x(()=>t.model.name),s=x(()=>!ee(t.model)&&!t.model.locked),o=x(()=>t.path.map(m=>({command:m,label:m.name,onMouseenter:()=>{a("action",{type:"hover",model:m})}}))),i=[{name:"move",icon:ds,title:"移动",draggable:!0,onDragstart:()=>{a("dragstart",t.model)},onDragend:()=>{a("dragend",t.model)}},{name:"prev",icon:Ja,title:"向前移动"},{name:"next",icon:Ta,title:"向后移动"},{name:"copy",icon:nl,title:"复制"},{name:"remove",icon:Ye,title:"删除"}],r=m=>{a("action",{type:"selected",model:m.command})},p=async m=>{m.name==="remove"?await We("确定删除?")&&a("action",{type:m.name,model:t.model}):a("action",{type:m.name,model:t.model})};return(m,h)=>(u(),V("div",{class:U(["v-actions",[`is-${t.position}`]])},[c(l(fe),{mode:"icon",size:"small",icon:l(ll),label:n.value,menus:o.value,background:"none",onCommand:r},null,8,["icon","label","menus"]),c(l(Va),{disabled:!s.value,mode:"icon",size:"small",items:i,background:"none",onClick:p},null,8,["disabled"])],2))}}),Po={key:1,class:"v-designer__placeholder"},Eo=j({name:"VDesigner",inheritAttrs:!1,__name:"index",setup(d,{expose:e}){const t=k(),a=k(),{width:n,height:s}=Ie(t),{dependencies:o,engine:i,apis:r}=bl(),{current:p,isEmpty:m}=ue(),h=x(()=>i.skeleton?.getWidget("Toolbar")?.widgetRef.mode??"pc"),b=x(()=>i.project.value?.config||{}),{designer:v,hover:g,dropping:w,selected:S}=Ss(a,o,r,b),z=R=>{const K=R.type,E=R.model;if(p.value)switch(K){case"remove":p.value.removeNode(E),v.value?.setSelected(null);break;case"copy":const F=p.value.cloneNode(E);v.value?.setSelected(F);break;case"prev":p.value.movePrev(E),v.value?.setSelected(E);break;case"next":p.value.moveNext(E),v.value?.setSelected(E);break;case"hover":v.value?.setHover(E);break;case"selected":v.value?.setSelected(E);break}},P=R=>{if(R&&v.value){const K=i.assets.componentMap.get(R.name);K&&v.value.setDragging(K),v.value.setDraggingNode(R)}},D=()=>{v.value&&(v.value.setDraggingNode(null),v.value.setDragging(null))};return e({designer:v,mode:h}),(R,K)=>(u(),V("div",{ref_key:"container",ref:t,class:"v-designer"},[c(l(kl),{mode:h.value,width:l(n),height:l(s)},{default:f(()=>[_("iframe",{ref_key:"iframe",ref:a,frameborder:"0"},null,512),l(w)?(u(),V("div",{key:0,class:U(["v-designer__dropping","is-inner"]),style:Ge(l(w).style)},null,4)):C("",!0),l(g)?(u(),V("div",{key:1,class:"v-designer__hover",style:Ge(l(g).style)},[_("span",{class:U(`is-${l(g).position}`)},[q(T(l(g).model.name)+": ",1),_("i",null,T(l(g).model.id),1)],2)],4)):C("",!0),l(S)?(u(),V("div",{key:2,class:"v-designer__selected",style:Ge(l(S).style)},[c(Ao,{position:l(S).position,model:l(S).model,path:l(S).path,onAction:z,onDragstart:P,onDragend:D},null,8,["position","model","path"])],4)):C("",!0)]),_:1},8,["mode","width","height"]),l(p)?C("",!0):(u(),y(l(oe),{key:0,description:"请新建或打开文件"})),l(p)&&l(m)?(u(),V("div",Po," 您可以拖拽组件放置到这里 ")):C("",!0)],512))}}),qe=j({__name:"group",props:{context:{},current:{},title:{},nameLabel:{},valueLabel:{},createEmpty:{},list:{},remove:{},submit:{},itemTitle:{type:Function,default:d=>d.name}},setup(d){const e=d,t=k(),a=k(),n=k(!1),s=k(e.createEmpty()),o=k(!1),i=x(()=>o.value?`编辑${e.title}`:`新增${e.title}`),r=()=>{o.value=!1,s.value=e.createEmpty(),n.value=!0},p=(g,w)=>{switch(w.name){case"edit":h(g);break;case"remove":e.remove(g);break}},m=g=>{s.value.value=g},h=g=>{o.value=!0,s.value={...g},n.value=!0},b=async g=>e.submit(g,o.value),v=()=>{a.value?.itemRef.validate()};return(g,w)=>(u(),y(l(I),{title:e.title,class:"v-sub-panel",size:"small",fit:!1,plus:"",onPlus:r},{default:f(()=>[(u(!0),V(J,null,W(g.list,S=>(u(),y(l(de),{title:e.itemTitle(S),border:"",actions:["edit","remove"],onAction:z=>p(S,z),onClick:z=>h(S)},null,8,["title","onAction","onClick"]))),256)),g.list.length?C("",!0):(u(),y(l(oe),{key:0,"image-size":40})),c(l(_t),{modelValue:n.value,"onUpdate:modelValue":w[1]||(w[1]=S=>n.value=S),title:i.value,"submit-method":b,model:s.value,block:g.current,context:g.context,onPick:m},{default:f(()=>[xe(g.$slots,"fields",ml(pl({model:s.value,isEdit:o.value,nameLabel:g.nameLabel,valueLabel:g.valueLabel})),()=>[c(l(B),{name:"name",label:g.nameLabel,required:"",disabled:o.value},null,8,["label","disabled"]),c(l(B),{ref_key:"codeFieldRef",ref:a,name:"value",label:g.valueLabel,required:""},{editor:f(()=>[c(l(ae),{ref_key:"editorRef",ref:t,dark:"",height:"350px",modelValue:s.value.value,"onUpdate:modelValue":w[0]||(w[0]=S=>s.value.value=S),onBlur:v},null,8,["modelValue"])]),_:1},8,["label"])])]),_:3},8,["modelValue","title","model","block","context"])]),_:3},8,["title"]))}}),zo=j({__name:"state",props:{context:{},current:{}},setup(d){const e=d,t=x(()=>Object.entries(e.current?.state||{}).map(([o,i])=>({name:o,value:Je(i)}))),a=()=>({name:"",value:""}),n=o=>e.current?.removeState(o.name),s=async(o,i)=>{const{name:r,value:p}=o;if(!i&&e.current?.state[r])return le(`名称 ${r} 已存在，请更换！`),!1;const m={type:"JSExpression",value:p};return ie(m,e.context,!0)?(e.current?.setState(r,m),!0):!1};return(o,i)=>(u(),y(qe,{title:"状态数据",current:e.current,context:e.context,list:t.value,nameLabel:"状态数据名称",valueLabel:"状态初始值 [ JSExpression ]",createEmpty:a,remove:n,submit:s},null,8,["current","context","list"]))}}),Bo=j({__name:"computed",props:{context:{},current:{}},setup(d){const e=d,t=x(()=>Object.entries(e.current?.computed||{}).map(([o,i])=>({name:o,value:Je(i)}))),a=()=>({name:"",value:"() => { }"}),n=o=>e.current?.removeFunction("computed",o.name),s=async(o,i)=>{const{name:r,value:p}=o;if(!i&&e.current?.computed[r])return le(`名称 ${r} 已存在，请更换！`),!1;const m={type:"JSFunction",value:p};return ie(m,e.context,!0)?(e.current?.setFunction("computed",r,m),!0):!1};return(o,i)=>(u(),y(qe,{title:"计算属性",current:e.current,context:e.context,list:t.value,nameLabel:"计算属性名称",valueLabel:"计算函数 [ JSFunction ]",createEmpty:a,remove:n,submit:s},null,8,["current","context","list"]))}}),Do=j({__name:"methods",props:{context:{},current:{}},setup(d){const e=d,t=x(()=>Object.entries(e.current?.methods||{}).map(([o,i])=>({name:o,value:Je(i)}))),a=()=>({name:"",value:"() => { }"}),n=o=>e.current?.removeFunction("methods",o.name),s=async(o,i)=>{const{name:r,value:p}=o;if(!i&&e.current?.methods[r])return le(`名称 ${r} 已存在，请更换！`),!1;const m={type:"JSFunction",value:p};return ie(m,e.context,!0)?(e.current?.setFunction("methods",r,m),!0):!1};return(o,i)=>(u(),y(qe,{title:"组件方法",current:e.current,context:e.context,list:t.value,nameLabel:"方法名称",valueLabel:"方法函数 [ JSFunction ]",createEmpty:a,remove:n,submit:s},null,8,["current","context","list"]))}}),Ro=j({__name:"lifeCycles",props:{context:{},current:{}},setup(d){const e=d,t=x(()=>ja.map(i=>({label:i,value:i}))),a=x(()=>Object.entries(e.current?.lifeCycles||{}).map(([i,r])=>({name:i,value:Je(r)}))),n=()=>({name:"",value:"() => { }"}),s=i=>e.current?.removeFunction("lifeCycles",i.name),o=async(i,r)=>{const{name:p,value:m}=i;if(!r&&e.current?.lifeCycles[p])return le(`名称 ${p} 已存在，请更换！`),!1;const h={type:"JSFunction",value:m};return ie(h,e.context,!0)?(e.current?.setFunction("lifeCycles",p,h),!0):!1};return(i,r)=>(u(),y(qe,{title:"生命周期",current:e.current,context:e.context,list:a.value,nameLabel:"名称",valueLabel:"函数 [ JSFunction ]",createEmpty:n,remove:s,submit:o},{fields:f(({model:p,nameLabel:m,isEdit:h,valueLabel:b})=>[c(l(B),{name:"name",label:m,editor:"select",options:t.value,required:"",disabled:h},null,8,["label","options","disabled"]),c(l(B),{name:"value",label:b,required:""},{editor:f(()=>[c(l(ae),{ref:"editorRef",dark:"",height:"350px",modelValue:p.value,"onUpdate:modelValue":v=>p.value=v},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:1},8,["current","context","list"]))}}),Fo=j({__name:"watch",props:{context:{},current:{}},setup(d){const e=d,t=x(()=>(e.current?.watch||[]).map(i=>({...i,source:Je(i.source),handler:Je(i.handler)}))),a=()=>({source:"() => { }",deep:!1,immediate:!1,handler:"() => { }"}),n=i=>i.source,s=i=>e.current?.removeWatch(i),o=async(i,r)=>{const p={type:"JSFunction",value:i.source},m={type:"JSFunction",value:i.handler};if(!ie(p,e.context,!0)||!ie(m,e.context,!0))return!1;const h={...i,source:p,handler:m};return e.current?.setWatch(h),!0};return(i,r)=>(u(),y(qe,{title:"侦听器",current:e.current,context:e.context,list:t.value,nameLabel:"侦听源 [ JSFunction ]",valueLabel:"处理函数 [ JSFunction ]",createEmpty:a,remove:s,submit:o,itemTitle:n,grow:""},{fields:f(({model:p,nameLabel:m,valueLabel:h})=>[c(l(B),{name:"source",label:m,required:""},{editor:f(()=>[c(l(ae),{dark:"",height:"100px",modelValue:p.source,"onUpdate:modelValue":b=>p.source=b},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]),c(l(B),{name:"deep",modelValue:p.deep,"onUpdate:modelValue":b=>p.deep=b,label:"深度监听",editor:"switch"},null,8,["modelValue","onUpdate:modelValue"]),c(l(B),{name:"immediate",modelValue:p.immediate,"onUpdate:modelValue":b=>p.immediate=b,label:"立即执行",editor:"switch"},null,8,["modelValue","onUpdate:modelValue"]),c(l(B),{name:"handler",label:h,required:""},{editor:f(()=>[c(l(ae),{dark:"",height:"130px",modelValue:p.handler,"onUpdate:modelValue":b=>p.handler=b},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:1},8,["current","context","list"]))}}),Jo=j({__name:"index",setup(d){const{current:e,context:t}=ue();return(a,n)=>(u(),y(l(M),{class:"v-scripts-widget",direction:"column",fit:""},{default:f(()=>[c(zo,{current:l(e),context:l(t)},null,8,["current","context"]),c(Bo,{current:l(e),context:l(t)},null,8,["current","context"]),c(Do,{current:l(e),context:l(t)},null,8,["current","context"]),c(Ro,{current:l(e),context:l(t)},null,8,["current","context"]),c(Fo,{current:l(e),context:l(t)},null,8,["current","context"])]),_:1}))}}),nt=j({__name:"setters",props:{context:{},current:{},title:{},items:{},node:{},removable:{type:Boolean}},emits:["change","remove"],setup(d,{emit:e}){const t=d,a=e,n=(o,i)=>{a("change",o,i)},s=o=>{a("remove",o)};return(o,i)=>(u(),y(l(I),{title:t.title,class:"v-sub-panel",size:"small",fit:!1},{default:f(()=>[c(l(he),{class:"v-properties-widget__form",size:"small","label-width":"90px",onKeydown:i[0]||(i[0]=Xe(Oe(()=>{},["prevent","stop"]),["enter"]))},{default:f(()=>[(u(!0),V(J,null,W(t.items,r=>(u(),y(l(N),re({ref_for:!0},r,{key:`${r.name}_${t.node.id}`,current:t.current,context:t.context,removable:t.removable,onChange:n,onRemove:s}),null,16,["current","context","removable"]))),128))]),_:1})]),_:1},8,["title"]))}}),To=j({name:"PropertiesWidget",__name:"index",setup(d){const{current:e,context:t}=ue(),{selected:a}=we(),{node:n,commonProps:s,change:o,componentProps:i,customProps:r,addCustom:p,removeCustom:m,isExist:h}=Vs(a),b=k(!1),v=k(),g=()=>{b.value=!0,v.value={name:""}},w=async z=>{const P=Object.keys(n.value?.props||{});return!h(z.name)&&!P.includes(z.name)?(p(z.name),!0):(le("已存在该属性名称"),!1)},S=async z=>{await We("确定删除？")&&m(z)};return(z,P)=>l(e)?(u(),y(l(M),{key:0,class:"v-properties-widget",direction:"column",fit:""},{default:f(()=>[l(n)?(u(),y(nt,{key:0,title:"通用属性",current:l(e),context:l(t),node:l(n),items:l(s),onChange:l(o)},null,8,["current","context","node","items","onChange"])):C("",!0),l(n)&&l(i).length?(u(),y(nt,{key:1,title:"组件属性",current:l(e),context:l(t),node:l(n),items:l(i),onChange:l(o)},null,8,["current","context","node","items","onChange"])):C("",!0),l(n)?(u(),y(nt,{key:2,title:"自定义属性",current:l(e),context:l(t),node:l(n),items:l(r),onChange:l(o),removable:"",plus:"",grow:"",onPlus:g,onRemove:S},null,8,["current","context","node","items","onChange"])):C("",!0),c(l(Ve),{modelValue:b.value,"onUpdate:modelValue":P[0]||(P[0]=D=>b.value=D),title:"新增自定义属性",width:"400px",height:"150px","submit-method":w,formProps:{tooltipMessage:!1},model:v.value},{default:f(()=>[c(l(B),{name:"name",label:"属性名称",required:"",rules:{message:"名称格式错误",pattern:l(je)}},null,8,["rules"])]),_:1},8,["modelValue","model"])]),_:1})):C("",!0)}}),Wo=j({name:"VariableBinder",__name:"variable",props:{context:{},current:{},value:{}},setup(d){const e=d,t=k(),a=Ue({type:"JSExpression",value:e.value}),n=s=>{t.value.getEditor().setValue(s),a.value=s};return(s,o)=>(u(),y(l(_t),{title:"绑定变量","unbind-enabled":"",block:e.current,context:e.context,model:a,onPick:n},{default:f(()=>[c(l(B),{name:"value",label:"绑定内容 [ JSExpression ]",required:""},{editor:f(()=>[c(l(ae),{ref_key:"editorRef",ref:t,modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=i=>a.value=i),dark:"",height:"450px"},null,8,["modelValue"])]),_:1})]),_:1},8,["block","context","model"]))}}),Oo=j({name:"EventBinder",__name:"event",props:{context:{},current:{},name:{},event:{}},setup(d){const e=d,t=k(),a=Ue({name:e.name,...e.event,modifiers:Object.keys(e.event?.modifiers||{}),handler:{type:"JSFunction",value:e.event?.handler?.value||"() => {}"}}),n=fs.map(o=>({label:o,value:o})),s=o=>{t.value.getEditor().setValue(o),a.handler.value=o};return(o,i)=>(u(),y(l(_t),{title:"绑定事件","unbind-enabled":"",block:e.current,context:e.context,model:a,onPick:s},{default:f(()=>[c(l(B),{name:"modifiers",label:"事件修饰符",editor:"checkbox",options:l(n)},null,8,["options"]),c(l(B),{name:"handler.value",label:"事件处理函数 [ JSFunction ]",required:""},{editor:f(()=>[c(l(ae),{ref_key:"editorRef",ref:t,modelValue:a.handler.value,"onUpdate:modelValue":i[0]||(i[0]=r=>a.handler.value=r),dark:"",height:"350px"},null,8,["modelValue"])]),_:1})]),_:1},8,["block","context","model"]))}}),Lo=j({name:"EventsWidget",__name:"index",setup(d){const{current:e,context:t}=ue(),{selected:a}=we(),{mouseEventList:n,keyboardEventList:s,componentEventList:o}=js(a),i=k({name:"",event:void 0}),r=k(!1),p=g=>{i.value=et(g),r.value=!0},m=async g=>{const w={...g,modifiers:g.modifiers.reduce((S,z)=>(S[z]=!0,S),{})};return ie(w.handler,t.value,!0)?((a.value?.model).setEvent(w),!0):!1},h=async g=>{const w=a.value?.model;g.name&&(w.removeEvent(g.name),r.value=!1)},b=async()=>{i.value.name&&await We("确定要删除该事件吗？")&&h(i.value)},v=g=>{const{name:w,modelValue:S}=g;w==="edit"&&p(S),w==="remove"&&h(S)};return(g,w)=>(u(),y(l(M),{class:"v-events-widget",direction:"column",fit:""},{default:f(()=>[c(l(I),{title:"组件事件",class:"v-sub-panel",size:"small",fit:!1},{default:f(()=>[l(o).length?C("",!0):(u(),y(l(oe),{key:0,"image-size":50,description:"该组件无自带事件"})),(u(!0),V(J,null,W(l(o),S=>(u(),y(l(de),{key:`component_${S.name}`,title:S.name,"model-value":S,border:"",small:"",actions:S.event?["edit","remove"]:["edit"],active:!!S.event,onClick:z=>p(S),onAction:v},null,8,["title","model-value","actions","active","onClick"]))),128))]),_:1}),c(l(I),{title:"鼠标事件",class:"v-sub-panel",size:"small",fit:!1},{default:f(()=>[(u(!0),V(J,null,W(l(n),S=>(u(),y(l(de),{key:`mouse_${S.name}`,title:S.name,"model-value":S,border:"",small:"",actions:S.event?["edit","remove"]:["edit"],active:!!S.event,onClick:z=>p(S),onAction:v},null,8,["title","model-value","actions","active","onClick"]))),128))]),_:1}),c(l(I),{title:"键盘事件",class:"v-sub-panel",size:"small",grow:"",fit:!1},{default:f(()=>[(u(!0),V(J,null,W(l(s),S=>(u(),y(l(de),{key:`keyboard_${S.name}`,title:S.name,"model-value":S,border:"",small:"",actions:S.event?["edit","remove"]:["edit"],active:!!S.event,onClick:z=>p(S),onAction:v},null,8,["title","model-value","actions","active","onClick"]))),128))]),_:1}),r.value?(u(),y(l(Oo),{key:0,modelValue:r.value,"onUpdate:modelValue":w[0]||(w[0]=S=>r.value=S),context:l(t),current:l(e),name:i.value.name,event:i.value.event,submitMethod:m,onUnbind:b},null,8,["modelValue","context","current","name","event"])):C("",!0)]),_:1}))}}),No=j({name:"CssWidget",__name:"index",setup(d){const{current:e}=ue(),t=k(),a=x(()=>e.value?.css||""),n=o=>{e.value?.setCss(o)},s=()=>{const o=(t.value?.getEditor()).getValue();n(o),me("保存成功")};return(o,i)=>(u(),y(l(I),{class:"v-css-widget v-sub-panel",title:"lang:css scoped",size:"small",fit:"",save:"",onSave:s},{default:f(()=>[c(l(ae),{ref_key:"editorRef",ref:t,"model-value":a.value,height:"100%",lang:"css",dark:"",onBlur:n},null,8,["model-value"])]),_:1}))}}),Mo=j({name:"DirectivesWidget",__name:"index",setup(d){const{current:e,context:t}=ue(),{selected:a}=we(),{vIf:n,vShow:s,vBind:o,vFor:i,vModels:r,onValueChange:p,onForChange:m,onModelChange:h}=zs(a),b=v=>v.arg?typeof v.arg=="string"?v.arg:Me(v.arg,{}):"modelValue";return(v,g)=>(u(),y(l(M),{class:"v-directives-widget",direction:"column",fit:""},{default:f(()=>[c(l(I),{class:"v-sub-panel",title:"内置指令",size:"small",fit:!1},{default:f(()=>[c(l(he),{size:"small","label-width":"80px",onKeydown:g[0]||(g[0]=Xe(Oe(()=>{},["prevent","stop"]),["enter"]))},{default:f(()=>[c(l(N),{name:"vIf",label:"v-if",setters:"ExpressionSetter",current:l(e),context:l(t),value:l(n).value,onChange:l(p)},null,8,["current","context","value","onChange"]),c(l(N),{name:"vShow",label:"v-show",setters:"ExpressionSetter",current:l(e),context:l(t),value:l(s).value,onChange:l(p)},null,8,["current","context","value","onChange"]),c(l(N),{name:"vBind",label:"v-bind",setters:"ExpressionSetter",current:l(e),context:l(t),value:l(o).value,onChange:l(p)},null,8,["current","context","value","onChange"])]),_:1})]),_:1}),c(l(I),{class:"v-sub-panel",title:"循环",size:"small",fit:!1},{default:f(()=>[c(l(he),{size:"small","label-width":"80px",onKeydown:g[1]||(g[1]=Xe(Oe(()=>{},["prevent","stop"]),["enter"]))},{default:f(()=>[c(l(N),{name:"value",label:"循环数据",setters:"ExpressionSetter",current:l(e),context:l(t),value:l(i).value,onChange:l(m)},null,8,["current","context","value","onChange"]),c(l(N),{name:"item",label:"迭代变量名",setters:{name:"StringSetter",props:{placeholder:"item"}},current:l(e),context:l(t),value:l(i).iterator?.item,onChange:l(m)},null,8,["current","context","value","onChange"]),c(l(N),{name:"index",label:"索引变量名",setters:{name:"StringSetter",props:{placeholder:"index"}},current:l(e),context:l(t),value:l(i).iterator?.index,onChange:l(m)},null,8,["current","context","value","onChange"])]),_:1})]),_:1}),c(l(I),{class:"v-sub-panel",title:"双向绑定",size:"small",fit:!1,grow:""},{default:f(()=>[(u(!0),V(J,null,W(l(r),(w,S)=>(u(),y(l(I),{card:"",border:"",class:"v-sub-panel",size:"small",title:`v-model: ${b(w)}`,body:{grow:!1},fit:!1},{default:f(()=>[c(l(he),{size:"small","label-width":"60px",onKeydown:g[2]||(g[2]=Xe(Oe(()=>{},["prevent","stop"]),["enter"]))},{default:f(()=>[c(l(N),{name:S.toString(),label:"绑定变量",setters:"ExpressionSetter",current:l(e),context:l(t),value:w.value,onChange:l(h)},null,8,["name","current","context","value","onChange"])]),_:2},1024)]),_:2},1032,["title"]))),256)),l(r).length?C("",!0):(u(),y(l(oe),{key:0,description:"当前组件没有双向绑定属性","image-size":50}))]),_:1})]),_:1}))}}),Io=j({name:"DefinedPropsDialog",__name:"props",props:{item:{},current:{},context:{}},setup(d){const e=d,t=x(()=>e.item?"编辑定义属性":"新增定义属性"),a=k(Object.assign({default:{type:"JSExpression",value:""}},e.item)),n=Object.keys(Aa).map(o=>({label:o,value:o})),s=async o=>{const i=o.default;return i&&!ie(i,e.context,!0)?!1:(e.current.setProp(o),!0)};return(o,i)=>(u(),y(l(Ve),{title:t.value,width:"800px",height:"500px",model:a.value,"form-props":{tooltipMessage:!1},"submit-method":s},{default:f(()=>[c(l(B),{name:"name",label:"属性名称",required:"",tip:"名称为英文驼峰格式",disabled:!!e.item,rules:{message:"名称格式错误",pattern:l(je)}},null,8,["disabled","rules"]),c(l(B),{name:"type",label:"数据类型",editor:"checkbox",props:{button:!0,size:"small"},options:l(n),required:""},null,8,["options"]),c(l(B),{name:"required",label:"必须",editor:"switch"}),c(l(B),{name:"default.value",label:"默认值",editor:"none"},{default:f(()=>[c(l(ae),{modelValue:a.value.default.value,"onUpdate:modelValue":i[0]||(i[0]=r=>a.value.default.value=r),height:"200px",dark:""},null,8,["modelValue"])]),_:1})]),_:1},8,["title","model"]))}}),Uo=j({name:"DefinedEventsDialog",__name:"events",props:{item:{},current:{},context:{}},setup(d){const e=d,t=x(()=>e.item?"编辑定义事件":"新增定义事件"),a=k({name:e.item}),n=async s=>(e.item&&e.current.removeEmit(e.item,!0),e.current.setEmit(s.name),!0);return(s,o)=>(u(),y(l(Ve),{title:t.value,width:"600px",height:"200px",model:a.value,"form-props":{tooltipMessage:!1},"submit-method":n},{default:f(()=>[c(l(B),{name:"name",label:"事件名称",required:"",disabled:!!e.item,rules:{message:"名称格式错误",pattern:l(je)}},null,8,["disabled","rules"])]),_:1},8,["title","model"]))}}),qo=j({name:"DefinedSlotsDialog",__name:"slots",props:{item:{},current:{},context:{}},setup(d){const e=d,t=x(()=>e.item?"编辑定义插槽":"新增定义插槽"),a=k({name:e.item}),n=async s=>(e.item&&e.current.removeSlot(e.item,!0),e.current.setSlot(s.name),!0);return(s,o)=>(u(),y(l(Ve),{title:t.value,width:"600px",height:"200px",model:a.value,"form-props":{tooltipMessage:!1},"submit-method":n},{default:f(()=>[c(l(B),{name:"name",label:"插槽名称",disabled:!!e.item,required:"",rules:{message:"名称格式错误",pattern:l(je)}},null,8,["disabled","rules"])]),_:1},8,["title","model"]))}}),Ho=j({name:"DefinedInjectsDialog",__name:"injects",props:{item:{},current:{},context:{}},setup(d){const e=d,t=x(()=>e.item?"编辑注入":"新增注入"),a=k(Object.assign({default:{type:"JSExpression",value:""}},e.item)),n=async s=>{const o=s.default;return o&&!ie(o,e.context,!0)?!1:(e.current.setInject(s),!0)};return(s,o)=>(u(),y(l(Ve),{title:t.value,width:"800px",height:"500px",model:a.value,"form-props":{tooltipMessage:!1},"submit-method":n},{default:f(()=>[c(l(B),{name:"name",label:"注入名称",required:"",tip:"名称为英文驼峰格式",disabled:!!e.item,rules:{message:"名称格式错误",pattern:l(je)}},null,8,["disabled","rules"]),c(l(B),{name:"from",label:"来源名称",tip:"默认和注入名称一致"}),c(l(B),{name:"default.value",label:"默认值",editor:"none"},{default:f(()=>[c(l(ae),{modelValue:a.value.default.value,"onUpdate:modelValue":o[0]||(o[0]=i=>a.value.default.value=i),height:"200px",dark:""},null,8,["modelValue"])]),_:1})]),_:1},8,["title","model"]))}}),Qo=j({name:"DefinedWidget",__name:"index",setup(d){const{current:e,context:t}=ue(),a=x(()=>(e.value?.props||[]).map(L=>typeof L=="string"?{name:L}:L)),n=x(()=>e.value?.emits||[]),s=x(()=>e.value?.slots||[]),o=x(()=>e.value?.inject||[]),i=k(!1),r=k(),p=k(!1),m=k(),h=k(!1),b=k(),v=k(!1),g=k(),w=()=>{r.value=void 0,i.value=!0},S=L=>{const{name:X,modelValue:O}=L;X==="edit"&&z(O),X==="remove"&&e.value?.removeProp(O)},z=L=>{r.value=L,i.value=!0},P=()=>{m.value=void 0,p.value=!0},D=L=>{m.value=L,p.value=!0},R=L=>{const{name:X,modelValue:O}=L;X==="edit"&&D(O),X==="remove"&&e.value?.removeEmit(O)},K=()=>{b.value=void 0,h.value=!0},E=L=>{b.value=L,h.value=!0},F=L=>{const{name:X,modelValue:O}=L;X==="edit"&&E(O),X==="remove"&&e.value?.removeSlot(O)},A=()=>{g.value=void 0,v.value=!0},Q=L=>{g.value=L,v.value=!0},se=L=>{const{name:X,modelValue:O}=L;X==="edit"&&Q(O),X==="remove"&&e.value?.removeInject(O)};return(L,X)=>l(e)&&l(t)?(u(),y(l(M),{key:0,class:"v-defined-widget",direction:"column",fit:""},{default:f(()=>[c(l(I),{class:"v-sub-panel",title:"定义属性",size:"small",plus:"",fit:!1,onPlus:w},{default:f(()=>[(u(!0),V(J,null,W(a.value,O=>(u(),y(l(de),{"model-value":O,title:O.name,border:"",actions:["edit","remove"],onClick:ke=>z(O),onAction:S},null,8,["model-value","title","onClick"]))),256)),a.value.length?C("",!0):(u(),y(l(oe),{key:0,"image-size":50})),i.value?(u(),y(Io,{key:1,current:l(e),context:l(t),modelValue:i.value,"onUpdate:modelValue":X[0]||(X[0]=O=>i.value=O),item:r.value},null,8,["current","context","modelValue","item"])):C("",!0)]),_:1}),c(l(I),{class:"v-sub-panel",title:"定义事件",size:"small",plus:"",fit:!1,onPlus:P},{default:f(()=>[(u(!0),V(J,null,W(n.value,O=>(u(),y(l(de),{"model-value":O,title:O,border:"",actions:["remove"],onClick:ke=>D(O),onAction:R},null,8,["model-value","title","onClick"]))),256)),n.value.length?C("",!0):(u(),y(l(oe),{key:0,"image-size":50})),p.value?(u(),y(Uo,{key:1,modelValue:p.value,"onUpdate:modelValue":X[1]||(X[1]=O=>p.value=O),current:l(e),context:l(t),item:m.value},null,8,["modelValue","current","context","item"])):C("",!0)]),_:1}),c(l(I),{class:"v-sub-panel",title:"定义插槽",size:"small",plus:"",fit:!1,onPlus:K},{default:f(()=>[(u(!0),V(J,null,W(s.value,O=>(u(),y(l(de),{"model-value":O,title:O,border:"",actions:["remove"],onClick:ke=>E(O),onAction:F},null,8,["model-value","title","onClick"]))),256)),s.value.length?C("",!0):(u(),y(l(oe),{key:0,"image-size":50})),h.value?(u(),y(qo,{key:1,modelValue:h.value,"onUpdate:modelValue":X[2]||(X[2]=O=>h.value=O),current:l(e),context:l(t),item:b.value},null,8,["modelValue","current","context","item"])):C("",!0)]),_:1}),c(l(I),{class:"v-sub-panel",title:"注入",size:"small",plus:"",fit:!1,grow:"",onPlus:A},{default:f(()=>[(u(!0),V(J,null,W(o.value,O=>(u(),y(l(de),{"model-value":O,title:O.name,border:"",actions:["remove"],onClick:ke=>Q(O),onAction:se},null,8,["model-value","title","onClick"]))),256)),o.value.length?C("",!0):(u(),y(l(oe),{key:0,"image-size":50})),v.value?(u(),y(Ho,{key:1,modelValue:v.value,"onUpdate:modelValue":X[3]||(X[3]=O=>v.value=O),current:l(e),context:l(t),item:g.value},null,8,["modelValue","current","context","item"])):C("",!0)]),_:1})]),_:1})):C("",!0)}}),Go=j({name:"DataSourceDialogForm",__name:"form",props:{context:{},current:{},item:{}},setup(d){const e=d,{apis:t}=Bs(),a=k(Object.assign({type:"api",ref:"",name:"",label:"",transform:{type:"JSFunction",value:`(res) => {
    /* 在这里可对接口返回数据进行转换  */
    return res;
}`},test:{type:"JSFunction",value:`() => this.runApi({
    /* 在这里可输入接口参数  */
})`}},e.item)),n=k(!1),s=k(""),o=k(!1),i=x(()=>t.value.map(b=>({label:b.label||"",value:b.id,data:b}))),r=x(()=>e.item?"编辑数据源":"新增数据源"),p=b=>{const v=t.value.find(g=>g.id===b);v&&(a.value.name=v.name,a.value.label=v.label||"")},m=async b=>{const{transform:v,test:g,name:w}=b;if(!e.current)return!1;if(!e.item&&e.current.dataSources[w])return le(`名称【${w}】已经存在，请更换名称`),!1;if(v?.value){if(!ie(v,e.context,!0))return!1}else b.transform=void 0;if(g?.value){if(!ie(g,e.context,!0))return!1}else b.test=void 0;return e.current?.setDataSource(b),!0},h=async()=>{if(!e.context)return;if(!a.value.ref){le("请先选择API");return}if(!a.value.test?.value){le("请先填写测试用例");return}if(!ie(a.value.test,e.context,!0))return;const b=async(...w)=>{const S=e.context?.$apis[a.value.ref];if(S)return await S.apply(S,w);_e.warn(`API【${a.value.ref}】不存在`)},v=Me(a.value.test,{runApi:b}),g=a.value.transform?.value?Me(a.value.transform,{},!0):w=>w;n.value=!0;try{const w=await v();s.value=JSON.stringify(await g(w),null,2)}catch(w){_e.error(w)}n.value=!1,o.value=!0};return(b,v)=>(u(),y(l(Ve),{width:"1000px",height:"600px",title:r.value,model:a.value,"form-props":{tooltipMessage:!1},"submit-method":m},{extra:f(()=>[c(l(ne),{loading:n.value,type:"warning",onClick:h},{default:f(()=>[q(" 运行测试用例 ")]),_:1},8,["loading"])]),default:f(()=>[c(l(B),{name:"ref",label:"引用API",editor:"select",required:"",disabled:!!e.item,options:i.value,props:{filterable:!0},onChange:p},{option:f(({option:g})=>[q(T(g.data.label)+" ",1),_("i",null,"[ "+T(g.data.name)+" ]",1)]),_:1},8,["disabled","options"]),c(l(B),{name:"name",label:"调用名称",required:"",tip:"名称为英文驼峰格式",disabled:!!e.item,rules:{message:"名称格式错误",pattern:l(je)}},null,8,["disabled","rules"]),c(l(B),{name:"label",label:"备注说明",required:""}),c(l(B),{name:"transform.value",label:"转换函数",editor:"none"},{default:f(()=>[c(l(ae),{modelValue:a.value.transform.value,"onUpdate:modelValue":v[0]||(v[0]=g=>a.value.transform.value=g),height:"200px",dark:""},null,8,["modelValue"])]),_:1}),c(l(B),{name:"test.value",label:"测试用例",editor:"none"},{default:f(()=>[c(l(ae),{modelValue:a.value.test.value,"onUpdate:modelValue":v[1]||(v[1]=g=>a.value.test.value=g),height:"100px",dark:""},null,8,["modelValue"])]),_:1}),o.value?(u(),y(l(Ut),{key:0,class:"v-drawer",modelValue:o.value,"onUpdate:modelValue":v[2]||(v[2]=g=>o.value=g),title:"测试用例运行结果",direction:"btt","append-to-body":"",size:"80%"},{default:f(()=>[c(l(ae),{"model-value":s.value,border:"",dark:"",height:"100%",lang:"json"},null,8,["model-value"])]),_:1},8,["modelValue"])):C("",!0)]),_:1},8,["title","model"]))}}),Xo=j({name:"DataSourcesWidget",__name:"index",setup(d){const{current:e,context:t}=ue(),a=k(!1),n=k(),s=x(()=>Object.values(e.value?.dataSources||{}).filter(p=>p.type==="api")),o=()=>{n.value=void 0,a.value=!0},i=p=>{n.value=p,a.value=!0},r=p=>{const{name:m,modelValue:h}=p;m==="edit"&&i(h),m==="remove"&&e.value?.removeDataSource(h.name)};return(p,m)=>(u(),y(l(M),{class:"v-data-sources-widget",direction:"column",fit:""},{default:f(()=>[c(l(I),{title:"API",class:"v-sub-panel",size:"small",plus:"",onPlus:o},{default:f(()=>[(u(!0),V(J,null,W(s.value,h=>(u(),y(l(de),{border:"",title:h.name,subtitle:h.label,"model-value":h,actions:["edit","remove"],onAction:r,onClick:b=>i(h)},null,8,["title","subtitle","model-value","onClick"]))),256)),s.value.length?C("",!0):(u(),y(l(oe),{key:0,"image-size":50}))]),_:1}),a.value?(u(),y(Go,{key:0,modelValue:a.value,"onUpdate:modelValue":m[0]||(m[0]=h=>a.value=h),current:l(e),context:l(t),item:n.value},null,8,["modelValue","current","context","item"])):C("",!0)]),_:1}))}}),Ko=j({__name:"layout",props:{styleJson:{},setStyle:{type:Function}},setup(d){const e=d,t=k();H(()=>e.styleJson.display,p=>{t.value=p==="flex"},{immediate:!0});const a=[{label:"block-块级布局",value:"block",svg:Wa},{label:"flex-弹性布局",value:"flex",svg:Oa},{label:"inline-block-行内块级布局",value:"inline-block",svg:La},{label:"inline-行内布局",value:"inline",svg:Na},{label:"invisible-不可见",value:"none",svg:Ma}],n=[{label:"row-水平",value:"row",svg:Ia},{label:"row-reverse-水平",value:"row-reverse",svg:Ua},{label:"column-垂直",value:"column",svg:qa},{label:"column-reverse-垂直",value:"column-reverse",svg:Ha}],s=[{label:"flex-start",value:"flex-start",svg:Qa},{label:"flex-end",value:"flex-end",svg:Ga},{label:"center",value:"center",svg:Xa},{label:"space-between",value:"space-between",svg:Ka},{label:"space-around",value:"space-around",svg:$a}],o=[{label:"不换行",value:"nowrap"},{label:"正换行",value:"wrap"},{label:"逆换行",value:"wrap-reverse"}],i=[{label:"flex-start",value:"flex-start",svg:Ya},{label:"flex-end",value:"flex-end",svg:Za},{label:"center",value:"center",svg:en},{label:"baseline",value:"baseline",svg:tn},{label:"stretch",value:"stretch",svg:ln}],r=(p,m)=>{t.value=m==="flex",e.setStyle("display",m),t.value||(e.setStyle("flex-direction",void 0),e.setStyle("justify-content",void 0),e.setStyle("align-items",void 0),e.setStyle("flex-wrap",void 0))};return(p,m)=>(u(),y(l(I),{title:"布局",class:"v-sub-panel",size:"small",fit:!1,collapsable:""},{default:f(()=>[c(l(he),{size:"small","label-width":"80px"},{default:f(()=>[c(l(N),{name:"display",label:"排布",setters:{name:"TagSetter"},options:a,variable:!1,value:e.styleJson.display,onChange:r},null,8,["value"]),t.value?(u(),V(J,{key:0},[c(l(N),{name:"flex-direction",label:"主轴方向",setters:{name:"TagSetter"},options:n,variable:!1,value:e.styleJson["flex-direction"],onChange:e.setStyle},null,8,["value","onChange"]),c(l(N),{name:"justify-content",label:"主轴对齐",setters:{name:"TagSetter"},options:s,variable:!1,value:e.styleJson["justify-content"],onChange:e.setStyle},null,8,["value","onChange"]),c(l(N),{name:"align-items",label:"辅轴对齐",setters:{name:"TagSetter"},options:i,variable:!1,value:e.styleJson["align-items"],onChange:e.setStyle},null,8,["value","onChange"]),c(l(N),{name:"flex-wrap",label:"换行模式",setters:{name:"TagSetter"},options:o,variable:!1,value:e.styleJson["flex-wrap"],onChange:e.setStyle},null,8,["value","onChange"])],64)):C("",!0)]),_:1})]),_:1}))}}),$o=j({name:"StyleWidget",__name:"JsonMode",setup(d){const{selected:e}=we(),t=k(),a=x(()=>{const i=e.value?.model||null;return ee(i)?null:i}),n=x(()=>JSON.stringify(a.value?.getPropValue("style")||{},null,2)),s=i=>{try{const r=JSON.parse(i);a.value?.setProp("style",r)}catch{le("JSON格式错误")}},o=()=>{const i=(t.value?.getEditor()).getValue();s(i),me("保存成功")};return(i,r)=>(u(),y(l(I),{class:"v-css-widget v-sub-panel",title:"JSON",size:"small",fit:"",save:"",onSave:o},{default:f(()=>[c(l(ae),{ref_key:"editorRef",ref:t,"model-value":n.value,height:"100%",lang:"json",dark:"",onBlur:s},null,8,["model-value"])]),_:1}))}}),Yo={class:"v-spacing-input"},Zo=_("div",{class:"v-spacing-input__modal"},null,-1),ei={class:"v-spacing-input__content"},ti=["onClick"],Sl=j({__name:"spacing-input",props:{name:{},modelValue:{},auto:{type:Boolean}},emits:["close","update:modelValue","submit"],setup(d,{emit:e}){const t=[0,10,20,40,60,100,140,220],a=d,n=e,s=x(()=>a.auto||a.name.includes("margin")),o=k(),i=k(a.modelValue),r=k("px");ls(o,()=>{n("close")});const p=v=>{i.value=typeof v=="number"?`${v}px`:"auto",m(i.value)},m=v=>{r.value=v==="auto"?void 0:"px"},h=()=>{i.value?(n("update:modelValue",i.value),n("submit",a.name,i.value),n("close")):le("请输入有效值","提示")},b=()=>{i.value=void 0,n("update:modelValue",i.value),n("submit",a.name,void 0),n("close")};return(v,g)=>(u(),V("div",Yo,[Zo,_("div",ei,[c(l(M),{class:"v-spacing-input__body",ref_key:"bodyRef",ref:o,direction:"column"},{default:f(()=>[c(l(M),null,{default:f(()=>[c(l(sl),{modelValue:i.value,"onUpdate:modelValue":g[0]||(g[0]=w=>i.value=w),size:"small","with-unit":!!r.value,unit:r.value,format:r.value?"0":void 0,onChange:m},null,8,["modelValue","with-unit","unit","format"])]),_:1}),c(l(M),null,{default:f(()=>[s.value?(u(),y(l(M),{key:0,class:"v-spacing-input__auto",width:"20%"},{default:f(()=>[_("span",{onClick:g[1]||(g[1]=w=>p("auto"))},"auto")]),_:1})):C("",!0),c(l(M),{grow:"",class:"v-spacing-input__values",align:"center",wrap:"wrap"},{default:f(()=>[(u(),V(J,null,W(t,w=>_("span",{onClick:S=>p(w)},T(w),9,ti)),64))]),_:1})]),_:1}),c(l(M),null,{default:f(()=>[c(l(ne),{size:"small",type:"primary",round:"",style:{width:"100%"},onClick:h},{default:f(()=>[q(" 确定 ")]),_:1}),c(l(ne),{size:"small",round:"",style:{width:"100%"},onClick:b},{default:f(()=>[q(" 重置 ")]),_:1})]),_:1})]),_:1},512)])]))}}),li={class:"spacing-wrap"},ai={class:"spacing-max-icon"},ni=["width","height"],si=["d"],oi=["d"],ii=["d"],ri=["d"],ui={id:"margin-outer"},di=["width","height"],ci=["width","height"],mi={id:"margin-inner"},pi=["width","height"],vi=["width","height"],gi=["width","height"],hi=["d"],bi=["d"],fi=["d"],yi=["d"],wi={id:"padding-outer"},ki=["width","height"],Si=["width","height"],xi={id:"padding-inner"},_i=["width","height"],Ci=["width","height"],Vi={xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",style:{"grid-area":"3 / 3 / span 3 / span 3","pointer-events":"none"}},ji=_("text",{x:"6",y:"4",fill:"#a6a6a6","font-style":"italic","font-weight":"bold","font-size":"8","dominant-baseline":"hanging"}," padding ",-1),Ai=[ji],Pi={xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",style:{"grid-area":"1 / 1 / -1 / -1","pointer-events":"none"}},Ei=_("text",{x:"6",y:"4",fill:"#a6a6a6","font-style":"italic","font-weight":"bold","font-size":"8","dominant-baseline":"hanging"}," margin ",-1),zi=[Ei],$=36,Y=24,Bi=j({__name:"spacing",props:{styleJson:{},setStyle:{type:Function}},setup(d){const e=d,t=k(),a=k(),{width:n,height:s}=Ie(t),{width:o,height:i}=Ie(a),r=k(!1),p=k(),m=k(),h=()=>{r.value=!1,p.value=void 0,m.value=void 0},b=v=>{p.value=v,m.value=e.styleJson[v],r.value=!0};return(v,g)=>(u(),y(l(I),{title:"间距",class:"v-sub-panel",size:"small",fit:!1,collapsable:""},{default:f(()=>[_("div",{class:"v-style-widget__spacing",ref_key:"container",ref:t},[_("div",li,[_("div",ai,[l(n)&&l(s)?(u(),V("svg",{key:0,xmlns:"http://www.w3.org/2000/svg",width:l(n),height:l(s),style:{"grid-area":"1 / 1 / -1 / -1"}},[_("g",null,[_("g",null,[_("path",{mode:"delta",fill:"currentColor",d:`
              m1,1
              h${l(n)-1}
              l-${$},${Y}
              h-${l(n)-2*$}
              l-${$},-${Y}z`,"data-automation-id":"margin-top-button","aria-label":"Margin top button",class:"tb-path-color",onClick:g[0]||(g[0]=w=>b("margin-top"))},null,8,si)])]),_("g",null,[_("g",null,[_("path",{mode:"delta",fill:"currentColor",d:`
              m${l(n)-1},1
              v${l(s)-1}
              l-${$},-${Y}
              v-${l(s)-2*Y}
              l${$},-${Y}z`,"data-automation-id":"margin-right-button","aria-label":"Margin right button",class:"lr-path-color",onClick:g[1]||(g[1]=w=>b("margin-right"))},null,8,oi)])]),_("g",null,[_("g",null,[_("path",{mode:"delta",fill:"currentColor",d:`
              m1,${l(s)-1}
              h${l(n)-1}
              l-${$},-${Y}
              h-${l(n)-2*$}
              l-${$},${Y}z`,"data-automation-id":"margin-bottom-button","aria-label":"Margin bottom button",class:"tb-path-color",onClick:g[2]||(g[2]=w=>b("margin-bottom"))},null,8,ii)])]),_("g",null,[_("g",null,[_("path",{mode:"delta",fill:"currentColor",d:`
              m1,1
              v${l(s)-1}
              l${$},-${Y}
              v-${l(s)-2*Y}
              l-${$},-${Y}z`,"data-automation-id":"margin-left-button","aria-label":"Margin left button",class:"lr-path-color",onClick:g[3]||(g[3]=w=>b("margin-left"))},null,8,ri)])]),_("clipPath",ui,[_("rect",{x:"0",y:"0",width:l(n),height:l(s),fill:"transparent",rx:"2",ry:"2",style:{"pointer-events":"none"}},null,8,di)]),_("rect",{class:"stroke","clip-path":"url(#margin-outer)",x:"0",y:"0",width:l(n),height:l(s),fill:"transparent",rx:"2",ry:"2",style:{"pointer-events":"none","stroke-width":"2px"}},null,8,ci),_("clipPath",mi,[_("rect",{x:"36",y:"24",width:l(n)-2*$+1,height:l(s)-2*Y+1,fill:"transparent",rx:"2",ry:"2",style:{"pointer-events":"none"}},null,8,pi)]),_("rect",{class:"stroke","clip-path":"url(#margin-inner)",x:"36",y:"24",width:l(n)-2*$+1,height:l(s)-2*Y+1,fill:"transparent",rx:"2",ry:"2",style:{"pointer-events":"none","stroke-width":"2px"}},null,8,vi)],8,ni)):C("",!0),_("div",{class:U(["spacing-edit margin-top",{"is-setting":e.styleJson["margin-top"]}]),onClick:g[4]||(g[4]=w=>b("margin-top"))},T(e.styleJson["margin-top"]||"-"),3),_("div",{class:U(["spacing-edit margin-right",{"is-setting":e.styleJson["margin-right"]}]),onClick:g[5]||(g[5]=w=>b("margin-right"))},T(e.styleJson["margin-right"]||"-"),3),_("div",{class:U(["spacing-edit margin-bottom",{"is-setting":e.styleJson["margin-bottom"]}]),onClick:g[6]||(g[6]=w=>b("margin-bottom"))},T(e.styleJson["margin-bottom"]||"-"),3),_("div",{class:U(["spacing-edit margin-left",{"is-setting":e.styleJson["margin-left"]}]),onClick:g[7]||(g[7]=w=>b("margin-left"))},T(e.styleJson["margin-left"]||"-"),3)]),_("div",{ref_key:"inner",ref:a,class:"spacing-min-icon"},[l(n)&&l(s)?(u(),V("svg",{key:0,xmlns:"http://www.w3.org/2000/svg",width:l(o),height:l(i),style:{"grid-area":"1 / 1 / -1 / -1"}},[_("g",null,[_("g",null,[_("path",{mode:"delta",fill:"currentColor",d:`
              m1,1
              h${l(o)-1}
              l-${$},${Y}
              h-${l(o)-2*$}
              l-${$},-${Y}z`,"data-automation-id":"padding-top-button","aria-label":"Padding top button",class:"tb-path-color",onClick:g[8]||(g[8]=w=>b("padding-top"))},null,8,hi)])]),_("g",null,[_("g",null,[_("path",{mode:"delta",fill:"currentColor",d:`
              m${l(o)-1},1
              v${l(i)-1}
              l-${$},-${Y}
              v-${l(i)-2*Y}
              l${$},-${Y}z`,"data-automation-id":"padding-right-button","aria-label":"Padding right button",class:"lr-path-color",onClick:g[9]||(g[9]=w=>b("padding-right"))},null,8,bi)])]),_("g",null,[_("g",null,[_("path",{mode:"delta",fill:"currentColor",d:`
              m1,${l(i)-1}
              h${l(o)-1}
              l-${$},-${Y}
              h-${l(o)-2*$}
              l-${$},${Y}z`,"data-automation-id":"padding-bottom-button","aria-label":"Padding bottom button",class:"tb-path-color",onClick:g[10]||(g[10]=w=>b("padding-bottom"))},null,8,fi)])]),_("g",null,[_("g",null,[_("path",{mode:"delta",fill:"currentColor",d:`
              m1,1
              v${l(i)-1}
              l${$},-${Y}
              v-${l(i)-2*Y}
              l-${$},-${Y}z`,"data-automation-id":"padding-left-button","aria-label":"Padding left button",class:"lr-path-color",onClick:g[11]||(g[11]=w=>b("padding-left"))},null,8,yi)])]),_("clipPath",wi,[_("rect",{x:"0",y:"0",width:l(o),height:l(i),fill:"transparent",rx:"2",ry:"2",style:{"pointer-events":"none"}},null,8,ki)]),_("rect",{class:"stroke","clip-path":"url(#padding-outer)",x:"0",y:"0",width:l(o),height:l(i),fill:"transparent",rx:"2",ry:"2",style:{"pointer-events":"none","stroke-width":"2px"}},null,8,Si),_("clipPath",xi,[_("rect",{x:"36",y:"24",width:l(o)-2*$+1,height:l(i)-2*Y+1,fill:"transparent",rx:"2",ry:"2",style:{"pointer-events":"none"}},null,8,_i)]),_("rect",{class:"stroke","clip-path":"url(#padding-inner)",x:"36",y:"24",width:l(o)-2*$+1,height:l(i)-2*Y+1,fill:"transparent",rx:"2",ry:"2",style:{"pointer-events":"none","stroke-width":"2px"}},null,8,Ci)],8,gi)):C("",!0),_("div",{class:U(["spacing-edit padding-top",{"is-setting":e.styleJson["padding-top"]}]),onClick:g[12]||(g[12]=w=>b("padding-top"))},T(e.styleJson["padding-top"]||"-"),3),_("div",{class:U(["spacing-edit padding-right",{"is-setting":e.styleJson["padding-right"]}]),onClick:g[13]||(g[13]=w=>b("padding-right"))},T(e.styleJson["padding-right"]||"-"),3),_("div",{class:U(["spacing-edit padding-bottom",{"is-setting":e.styleJson["padding-bottom"]}]),onClick:g[14]||(g[14]=w=>b("padding-bottom"))},T(e.styleJson["padding-bottom"]||"-"),3),_("div",{class:U(["spacing-edit padding-left",{"is-setting":e.styleJson["padding-left"]}]),onClick:g[15]||(g[15]=w=>b("padding-left"))},T(e.styleJson["padding-left"]||"-"),3)],512),(u(),V("svg",Vi,Ai)),(u(),V("svg",Pi,zi))]),r.value?(u(),y(Sl,{key:0,name:p.value,modelValue:m.value,"onUpdate:modelValue":g[16]||(g[16]=w=>m.value=w),onClose:h,onSubmit:e.setStyle},null,8,["name","modelValue","onSubmit"])):C("",!0)],512)]),_:1}))}}),Di=j({__name:"sizing",props:{styleJson:{},setStyle:{type:Function}},setup(d){const e=d,t=[{name:"width",label:"宽(W)",setter:"SizeSetter"},{name:"height",label:"高(H)",setter:"SizeSetter"},{name:"min-width",label:"最小宽",setter:"SizeSetter"},{name:"min-height",label:"最小高",setter:"SizeSetter"},{name:"max-width",label:"最大宽",setter:"SizeSetter"},{name:"max-height",label:"最大高",setter:"SizeSetter"},{name:"overflow",label:"溢出",setter:"SelectSetter",options:[{label:"自动",value:"auto"},{label:"隐藏",value:"hidden"},{label:"滚动",value:"scroll"},{label:"显示",value:"visible"}]},{name:"object-fit",label:"适应",setter:"SelectSetter",options:[{label:"填充",value:"fill"},{label:"适应",value:"contain"},{label:"覆盖",value:"cover"},{label:"拉伸",value:"scale-down"},{label:"原始",value:"none"}]}];return(a,n)=>(u(),y(l(I),{title:"尺寸",class:"v-sub-panel v-",size:"small",fit:!1,collapsable:""},{default:f(()=>[c(l(he),{class:"v-style-widget__sizing",size:"small","label-width":"60px",inline:""},{default:f(()=>[(u(),V(J,null,W(t,s=>c(l(N),{name:s.name,label:s.label,setters:{name:s.setter},options:s.options,variable:!1,value:e.styleJson[s.name],onChange:a.setStyle},null,8,["name","label","setters","options","value","onChange"])),64))]),_:1})]),_:1}))}}),Ri={class:"v-style-widget__positioning"},Fi={class:"spacing-wrap"},Ji=["width","height"],Ti=["d"],Wi=["d"],Oi=["d"],Li=["d"],Ni={id:"margin-outer"},Mi=["width","height"],Ii=["width","height"],Ui={id:"margin-inner"},qi=["width","height"],Hi=["width","height"],pe=36,ve=24,Qi=j({__name:"positioning",props:{styleJson:{},setStyle:{type:Function}},setup(d){const e=d,t=k(),{width:a,height:n}=Ie(t),s=k(!1),o=k(),i=k(),r=[{label:"静态",value:"static"},{label:"相对",value:"relative"},{label:"绝对",value:"absolute"},{label:"固定",value:"fixed"},{label:"粘性",value:"sticky"}],p=[{label:"左上",svg:an,value:"0% auto auto 0%"},{label:"右上",svg:nn,value:"0% 0% auto auto"},{label:"左下",svg:sn,value:"auto auto 0% 0%"},{label:"右下",svg:on,value:"auto 0% 0% auto"},{label:"左",svg:rn,value:"0% auto 0% 0%"},{label:"右",svg:un,value:"0% 0% 0% auto"},{label:"上",svg:dn,value:"auto 0% 0% 0%"},{label:"下",svg:cn,value:"0% 0% auto 0%"},{label:"填充",svg:mn,value:"0% 0% 0% 0%"}],m=x(()=>(e.styleJson.inset||"").split(" ")),h=v=>{o.value=v,i.value=e.styleJson[v],s.value=!0},b=()=>{s.value=!1,o.value=void 0,i.value=void 0};return(v,g)=>(u(),y(l(I),{title:"定位",class:"v-sub-panel",size:"small",fit:!1,collapsable:""},{default:f(()=>[_("div",Ri,[c(l(he),{"label-width":"60px",size:"small"},{default:f(()=>[c(l(N),{name:"position",label:"定位",setters:{name:"SelectSetter"},options:r,variable:!1,value:e.styleJson.position,onChange:e.setStyle},null,8,["value","onChange"]),c(l(N),{name:"inset",label:" ",setters:{name:"TagSetter"},options:p,variable:!1,value:e.styleJson.inset,onChange:e.setStyle},null,8,["value","onChange"]),c(l(Mt),{label:" "},{default:f(()=>[_("div",Fi,[_("div",{ref_key:"inner",ref:t,class:"spacing-min-icon"},[l(a)&&l(a)?(u(),V("svg",{key:0,xmlns:"http://www.w3.org/2000/svg",width:l(a),height:l(n),style:{"grid-area":"1 / 1 / -1 / -1"}},[_("g",null,[_("g",null,[_("path",{mode:"delta",fill:"currentColor",d:`
              m1,1
              h${l(a)-1}
              l-${pe},${ve}
              h-${l(a)-2*pe}
              l-${pe},-${ve}z`,"data-automation-id":"padding-top-button","aria-label":"Padding top button",class:"tb-path-color",onClick:g[0]||(g[0]=w=>h("top"))},null,8,Ti)])]),_("g",null,[_("g",null,[_("path",{mode:"delta",fill:"currentColor",d:`
              m${l(a)-1},1
              v${l(n)-1}
              l-${pe},-${ve}
              v-${l(n)-2*ve}
              l${pe},-${ve}z`,"data-automation-id":"padding-right-button","aria-label":"Padding right button",class:"lr-path-color",onClick:g[1]||(g[1]=w=>h("right"))},null,8,Wi)])]),_("g",null,[_("g",null,[_("path",{mode:"delta",fill:"currentColor",d:`
              m1,${l(n)-1}
              h${l(a)-1}
              l-${pe},-${ve}
              h-${l(a)-2*pe}
              l-${pe},${ve}z`,"data-automation-id":"padding-bottom-button","aria-label":"Padding bottom button",class:"tb-path-color",onClick:g[2]||(g[2]=w=>h("bottom"))},null,8,Oi)])]),_("g",null,[_("g",null,[_("path",{mode:"delta",fill:"currentColor",d:`
              m1,1
              v${l(n)-1}
              l${pe},-${ve}
              v-${l(n)-2*ve}
              l-${pe},-${ve}z`,"data-automation-id":"padding-left-button","aria-label":"Padding left button",class:"lr-path-color",onClick:g[3]||(g[3]=w=>h("left"))},null,8,Li)])]),_("clipPath",Ni,[_("rect",{x:"0",y:"0",width:l(a),height:l(n),fill:"transparent",rx:"2",ry:"2",style:{"pointer-events":"none"}},null,8,Mi)]),_("rect",{class:"stroke","clip-path":"url(#margin-outer)",x:"0",y:"0",width:l(a),height:l(n),fill:"transparent",rx:"2",ry:"2",style:{"pointer-events":"none","stroke-width":"2px"}},null,8,Ii),_("clipPath",Ui,[_("rect",{x:"36",y:"24",width:l(a)-2*pe+1,height:l(n)-2*ve+1,fill:"transparent",rx:"2",ry:"2",style:{"pointer-events":"none"}},null,8,qi)]),_("rect",{class:"stroke","clip-path":"url(#margin-inner)",x:"36",y:"24",width:l(a)-2*pe+1,height:l(n)-2*ve+1,fill:"transparent",rx:"2",ry:"2",style:{"pointer-events":"none","stroke-width":"2px"}},null,8,Hi)],8,Ji)):C("",!0),_("div",{class:U(["spacing-edit padding-top",{"is-setting":e.styleJson.top}]),onClick:g[4]||(g[4]=w=>h("top"))},T(e.styleJson.top||m.value[0]||"-"),3),_("div",{class:U(["spacing-edit padding-right",{"is-setting":e.styleJson.right}]),onClick:g[5]||(g[5]=w=>h("right"))},T(e.styleJson.right||m.value[1]||"-"),3),_("div",{class:U(["spacing-edit padding-bottom",{"is-setting":e.styleJson.bottom}]),onClick:g[6]||(g[6]=w=>h("bottom"))},T(e.styleJson.bottom||m.value[2]||"-"),3),_("div",{class:U(["spacing-edit padding-left",{"is-setting":e.styleJson.left}]),onClick:g[7]||(g[7]=w=>h("left"))},T(e.styleJson.left||m.value[3]||"-"),3)],512),s.value?(u(),y(Sl,{key:0,auto:"",name:o.value,modelValue:i.value,"onUpdate:modelValue":g[8]||(g[8]=w=>i.value=w),onClose:b,onSubmit:e.setStyle},null,8,["name","modelValue","onSubmit"])):C("",!0)])]),_:1}),c(l(N),{name:"z-index",label:"层级",setters:{name:"NumberSetter"},variable:!1,value:e.styleJson["z-index"],onChange:e.setStyle},null,8,["value","onChange"])]),_:1})])]),_:1}))}}),Gi=j({__name:"texting",props:{styleJson:{},setStyle:{type:Function}},setup(d){const e=d,t=[{name:"font-size",label:"字号",setter:"SizeSetter"},{name:"font-family",label:"字体",setter:"SelectSetter",options:["Arial","Verdana","Georgia",'"Times New Roman"','"Microsoft YaHei"',"SimSun","SimHei","KaiTi","FangSong","STSong","STKaiti","STFangsong","STCaiyun","STHupo","STLiti","STXingkai","STXinwei","STXinwei","STZhongsong"]},{name:"line-height",label:"行高",setter:"SizeSetter"},{name:"font-weight",label:"字重",setter:"SelectSetter",options:[{label:"正常",value:"normal"},{label:"粗体",value:"bold"},{label:"更粗",value:"bolder"},{label:"更细",value:"lighter"}]}],a=[{label:"左",value:"left",svg:pn},{label:"中",value:"center",svg:vn},{label:"右",value:"right",svg:gn},{label:"两端",value:"justify",svg:hn}],n=[{label:"正常",value:"normal",svg:bn},{label:"斜体",value:"italic",svg:fn}],s=[{label:"无",value:"none",svg:ol},{label:"下划线",value:"underline",svg:yn},{label:"删除线",value:"line-through",svg:wn},{label:"上划线",value:"overline",svg:kn}];return(o,i)=>(u(),y(l(I),{title:"文本",class:"v-sub-panel",size:"small",fit:!1,collapsable:""},{default:f(()=>[c(l(he),{class:"v-style-widget__texting",size:"small","label-width":"60px",inline:""},{default:f(()=>[(u(),V(J,null,W(t,r=>c(l(N),{name:r.name,label:r.label,setters:{name:r.setter},options:r.options,variable:!1,value:e.styleJson[r.name],onChange:o.setStyle},null,8,["name","label","setters","options","value","onChange"])),64))]),_:1}),c(l(he),{size:"small","label-width":"60px"},{default:f(()=>[c(l(N),{name:"color",label:"颜色",setters:{name:"ColorSetter"},variable:!1,value:e.styleJson.color,onChange:o.setStyle},null,8,["value","onChange"]),c(l(N),{name:"text-align",label:"对齐",setters:{name:"TagSetter"},variable:!1,options:a,value:e.styleJson["text-align"],onChange:o.setStyle},null,8,["value","onChange"]),c(l(N),{name:"font-style",label:"风格",setters:{name:"TagSetter"},variable:!1,options:n,value:e.styleJson["font-style"],onChange:o.setStyle},null,8,["value","onChange"]),c(l(N),{name:"text-decoration",label:"修饰",setters:{name:"TagSetter"},variable:!1,options:s,value:e.styleJson["text-decoration"],onChange:o.setStyle},null,8,["value","onChange"])]),_:1})]),_:1}))}}),Xi=j({__name:"backgound",props:{styleJson:{},setStyle:{type:Function}},setup(d){const e=d,t=(r,p)=>{p?e.setStyle("background-image",`url(${p})`):e.setStyle("background-image",void 0)},a=r=>{const p=/^url\(([\w\W]+)\)$/;return r?.match(p)?.[1]},n=[{label:"重复",value:"repeat",svg:Sn},{label:"水平重复",value:"repeat-x",svg:xn},{label:"垂直重复",value:"repeat-y",svg:_n},{label:"不重复",value:"no-repeat",svg:Cn}],s=[{label:"固定",value:"fixed"},{label:"滚动",value:"scroll"}],o=[{label:"裁剪到填充",value:"padding-box"},{label:"裁剪到内容",value:"content-box"},{label:"裁剪到文字",value:"text"}],i=[{label:"自动",value:"auto"},{label:"长度",value:"length"},{label:"百分比",value:"percentage"},{label:"覆盖",value:"cover"},{label:"填充",value:"contain"}];return(r,p)=>(u(),y(l(I),{title:"背景",class:"v-sub-panel",size:"small",fit:!1,collapsable:""},{default:f(()=>[c(l(he),{"label-width":"60px",size:"small"},{default:f(()=>[c(l(N),{name:"background-image",label:"图片",setters:{name:"ImageSetter"},variable:!1,value:a(e.styleJson["background-image"]),onChange:t},null,8,["value"]),c(l(N),{name:"background-color",label:"颜色",setters:{name:"ColorSetter"},variable:!1,value:e.styleJson["background-color"],onChange:e.setStyle},null,8,["value","onChange"]),c(l(N),{name:"background-repeat",label:"重复",setters:{name:"TagSetter"},variable:!1,value:e.styleJson["background-repeat"],options:n,onChange:e.setStyle},null,8,["value","onChange"]),c(l(N),{name:"background-attachment",label:"固定",setters:{name:"RadioSetter"},variable:!1,value:e.styleJson["background-attachment"],options:s,onChange:e.setStyle},null,8,["value","onChange"]),c(l(N),{name:"background-position",label:"位置",setters:{name:"SectionSetter",props:{sections:2}},variable:!1,value:e.styleJson["background-position"],onChange:e.setStyle},null,8,["value","onChange"]),c(l(N),{name:"background-size",label:"大小",setters:{name:"SelectSetter"},variable:!1,value:e.styleJson["background-size"],options:i,onChange:e.setStyle},null,8,["value","onChange"]),c(l(N),{name:"background-clip",label:"裁剪",setters:{name:"SelectSetter"},variable:!1,value:e.styleJson["background-clip"],options:o,onChange:e.setStyle},null,8,["value","onChange"])]),_:1})]),_:1}))}}),Ki=j({__name:"border",props:{styleJson:{},setStyle:{type:Function}},setup(d){const e=d,t=k("border"),a=[{label:"全边框",svg:Vn,value:"border"},{label:"左边框",svg:jn,value:"border-left"},{label:"上边框",svg:An,value:"border-top"},{label:"下边框",svg:Pn,value:"border-bottom"},{label:"右边框",svg:En,value:"border-right"}],n=[{label:"无",value:"none",svg:ol},{label:"实线",value:"solid",svg:zn},{label:"虚线",value:"dashed",svg:Bn},{label:"点线",value:"dotted",svg:Dn}],s=(o,i)=>{t.value=i};return(o,i)=>(u(),y(l(I),{title:"边框",class:"v-sub-panel",size:"small",fit:!1,collapsable:""},{default:f(()=>[c(l(he),{"label-width":"60px",size:"small"},{default:f(()=>[c(l(N),{name:"border-radius",label:"圆角",setters:{name:"SectionSetter",props:{sections:4}},variable:!1,value:e.styleJson["border-radius"],onChange:e.setStyle},null,8,["value","onChange"]),c(l(N),{name:"borders",label:"边框",setters:{name:"TagSetter"},variable:!1,options:a,value:t.value,onChange:s},null,8,["value"]),t.value?(u(),V(J,{key:0},[(u(),y(l(N),{name:`${t.value}-width`,key:`${t.value}-width`,label:"宽度",setters:{name:"SizeSetter"},variable:!1,value:e.styleJson[`${t.value}-width`],onChange:e.setStyle},null,8,["name","value","onChange"])),(u(),y(l(N),{name:`${t.value}-style`,key:`${t.value}-style`,label:"样式",setters:{name:"TagSetter"},options:n,variable:!1,value:e.styleJson[`${t.value}-style`],onChange:e.setStyle},null,8,["name","value","onChange"])),(u(),y(l(N),{name:`${t.value}-color`,key:`${t.value}-color`,label:"颜色",setters:{name:"ColorSetter"},variable:!1,value:e.styleJson[`${t.value}-color`],onChange:e.setStyle},null,8,["name","value","onChange"]))],64)):C("",!0)]),_:1})]),_:1}))}}),$i=j({__name:"effect",props:{styleJson:{},setStyle:{type:Function}},setup(d){const e=d,t=[{label:"自动",value:"auto",svg:Rn},{label:"Pointer",value:"pointer",svg:Fn},{label:"NotAllowed",value:"not-allowed",svg:Jn},{label:"无",value:"none",svg:Tn}],a=[{label:"Basic",value:"var(--el-box-shadow)"},{label:"Light",value:"var(--el-box-shadow-light)"},{label:"Lighter",value:"var(--el-box-shadow-lighter)"},{label:"Dark",value:"var(--el-box-shadow-dark)"}],n=(o,i)=>{e.setStyle("opacity",i!==void 0?(Number(i)||0)/100:void 0)},s=()=>Number(e.styleJson.opactiy||0)*100;return(o,i)=>(u(),y(l(I),{title:"效果",class:"v-sub-panel",size:"small",fit:!1,collapsable:""},{default:f(()=>[c(l(he),{"label-width":"60px",size:"small"},{default:f(()=>[c(l(N),{name:"opacity",label:"透明度",setters:{name:"SliderSetter"},variable:!1,value:s(),onChange:n},null,8,["value"]),c(l(N),{name:"box-shadow",label:"阴影",setters:{name:"SelectSetter"},variable:!1,options:a,value:e.styleJson["box-shadow"],onChange:e.setStyle},null,8,["value","onChange"]),c(l(N),{name:"cursor",label:"光标",setters:{name:"TagSetter"},variable:!1,options:t,value:e.styleJson.cursor,onChange:e.setStyle},null,8,["value","onChange"])]),_:1})]),_:1}))}}),Yi=j({name:"StyleWidget",__name:"index",props:{isStyleCodeMode:{type:Boolean}},setup(d){const e=d,{selected:t}=we(),a=x(()=>{const o=t.value?.model||null;return ee(o)?null:o}),n=x(()=>a.value?.getPropValue("style")||{}),s=(o,i)=>{const r=a.value?.getPropValue("style")||{};i!==void 0?r[o]=i:delete r[o],a.value?.setProp("style",r)};return(o,i)=>e.isStyleCodeMode?(u(),y($o,{key:0})):(u(),y(l(M),{key:`widget-style-${a.value?.id}`,class:"v-style-widget",direction:"column",fit:""},{default:f(()=>[(u(),y(Ko,{key:`Layout${a.value?.id}`,"style-json":n.value,setStyle:s},null,8,["style-json"])),(u(),y(Bi,{key:`Spacing${a.value?.id}`,"style-json":n.value,setStyle:s},null,8,["style-json"])),(u(),y(Di,{key:`Sizing${a.value?.id}`,"style-json":n.value,setStyle:s},null,8,["style-json"])),(u(),y(Qi,{key:`Positioning${a.value?.id}`,"style-json":n.value,setStyle:s},null,8,["style-json"])),(u(),y(Gi,{key:`Texting${a.value?.id}`,"style-json":n.value,setStyle:s},null,8,["style-json"])),(u(),y(Xi,{key:`Backgound${a.value?.id}`,"style-json":n.value,setStyle:s},null,8,["style-json"])),(u(),y(Ki,{key:`Border${a.value?.id}`,"style-json":n.value,setStyle:s},null,8,["style-json"])),(u(),y($i,{key:`Effect${a.value?.id}`,"style-json":n.value,setStyle:s},null,8,["style-json"]))]),_:1}))}}),Zi=["src"],er=j({name:"PreviewerWidget",__name:"index",props:{path:{type:Function}},setup(d,{expose:e}){const t=d,a=k(),n=k(Symbol()),{current:s,engine:o}=ue(),{width:i,height:r}=Ie(a),p=x(()=>s.value&&t.path?t.path(s.value):null),m=x(()=>o.skeleton?.getWidget("Toolbar")?.widgetRef.mode??"pc");return e({refresh:()=>{n.value=Symbol()}}),(h,b)=>(u(),V("div",{ref_key:"container",ref:a,class:"v-previewer",key:n.value},[c(l(kl),{mode:m.value,width:l(i),height:l(r)},{default:f(()=>[p.value?(u(),V("iframe",{key:0,ref:"iframe",frameborder:"0",src:p.value},null,8,Zi)):C("",!0)]),_:1},8,["mode","width","height"])]))}}),tr=j({name:"NodePathWidget",inheritAttrs:!1,__name:"index",setup(d){const{selected:e,designer:t}=we(),a=x(()=>(e.value?.path||[]).slice(0).reverse()),n=o=>{t.value?.setSelected(o)},s=o=>{t.value?.setHover(o)};return(o,i)=>l(e)?(u(),y(l(zl),{key:0,class:"v-nodepath-widget","separator-icon":l(ns)},{default:f(()=>[(u(!0),V(J,null,W(a.value,r=>(u(),y(l(El),{onClick:p=>n(r),onMouseover:p=>s(r)},{default:f(()=>[q(T(r.name),1)]),_:2},1032,["onClick","onMouseover"]))),256))]),_:1},8,["separator-icon"])):C("",!0)}}),lr=j({name:"SchemaWidget",__name:"index",setup(d){const{current:e}=ue(),t=k(),a=x(()=>JSON.stringify(e.value?.toDsl()||{},null,2)),n=x(()=>e.value?e.value.name:""),s=async()=>{const o=(t.value?.getEditor()).getValue();if(o&&await We("手动修改DSL有风险，可能导致页面无法加载，请确认您的操作无误。"))try{const i=JSON.parse(o);e.value?.update(i),me("保存成功")}catch(i){le(i?.message)}};return(o,i)=>(u(),y(l(I),{class:"v-schema-widget",title:n.value,subtitle:"手动修改DSL有风险，可能导致页面无法加载，请确认您的操作无误。",size:"small",fit:"",save:"",onSave:s},{default:f(()=>[c(l(ae),{ref_key:"editorRef",ref:t,"model-value":a.value,height:"100%",lang:"json",dark:""},null,8,["model-value"])]),_:1},8,["title"]))}}),ar=j({name:"SchemaWidget",__name:"index",setup(d){const{current:e,engine:t}=ue(),a=k(),n=k(""),s=x(()=>e.value?`$vtj/vue/${e.value.id}.vue`:""),o=x(()=>e.value?e.value.name:"");return H(e,async i=>{const r=t.project.value;r&&i?n.value=await t.service.genVueContent(r.toDsl(),i.toDsl()):n.value=""},{immediate:!0,deep:!0}),(i,r)=>(u(),y(l(I),{class:"v-raw-widget",title:o.value,subtitle:s.value,size:"small",fit:""},{default:f(()=>[c(l(ae),{ref_key:"editorRef",ref:a,"model-value":n.value,height:"100%",lang:"html",dark:"",readonly:""},null,8,["model-value"])]),_:1},8,["title","subtitle"]))}}),nr=["src"],sr=j({name:"DocsWidget",__name:"index",props:{url:{default:"https://newgateway.gitee.io/vtj/help/index.html"}},setup(d){const e=d,t=k();let a=null;rl(()=>{a||(a=Bl.service({target:t.value?.$el}))}),ul(()=>{n(),a=null});const n=()=>{a?.close()};return(s,o)=>(u(),y(l(I),{class:"v-docs-widget",size:"small",fit:"",body:{padding:!1},header:!1,ref_key:"panel",ref:t},{default:f(()=>[_("iframe",{ref:"frame",src:e.url,onLoad:n},null,40,nr)]),_:1},512))}}),xl="data:image/png;base64,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",or={class:"v-about-widget"},ir={class:"v-about-widget__logo"},rr=["src"],ur=_("div",{class:"v-about-widget__name"},"VTJ.PRO",-1),dr={class:"v-about-widget__version"},cr=j({name:"AboutWidget",__name:"index",setup(d){return(e,t)=>(u(),V("div",or,[_("div",ir,[_("img",{src:l(xl)},null,8,rr)]),ur,_("div",dr,"版本："+T(l(vs)),1)]))}}),mr=j({name:"ProjectConfigWidget",__name:"index",setup(d){const{project:e}=Fe(),t=a=>{e.value?.setConfig(a)};return(a,n)=>(u(),y(l(I),{class:"v-project-config-widget",title:"项目配置"},{default:f(()=>[l(e)?(u(),y(l(kt),{key:0,footer:!1,size:"small","label-position":"top",model:l(e).config,onChange:t},{default:f(()=>[c(l(B),{label:"站点名称",name:"title"}),c(l(B),{label:"Logo",name:"logo",editor:Ct,props:{attachment:{accept:".png,.jpg,.jpeg"}}},null,8,["props"]),c(l(B),{label:"主题切换",name:"themeSwitchable",editor:"switch"}),c(l(B),{label:"模拟数据",name:"mock",editor:"switch"})]),_:1},8,["model"])):C("",!0)]),_:1}))}}),G={Logo:Js,EmptyWidget:Ws,Switcher:Ns,Toolbar:Is,Actions:Hs,Pages:uo,Blocks:mo,Components:ho,Outline:bo,History:fo,Apis:Vo,Deps:jo,Designer:Eo,Scripts:Jo,Properties:To,Events:Lo,Css:No,Directives:Mo,Defined:Qo,DataSources:Xo,Style:Yi,Previewer:er,NodePath:tr,Schema:lr,Raw:ar,Docs:sr,About:cr,ProjectConfig:mr},pr=[{name:"Logo",region:"Brand",component:G.Logo},{name:"Switcher",region:"Brand",component:G.Switcher},{name:"Toolbar",region:"Toolbar",component:G.Toolbar},{name:"Actions",region:"Actions",component:G.Actions},{name:"Pages",region:"Apps",component:G.Pages,type:"app",openType:"panel",icon:ql,label:"页面管理"},{name:"Blocks",region:"Apps",component:G.Blocks,type:"app",openType:"panel",icon:Hl,label:"区块管理"},{name:"Components",region:"Apps",component:G.Components,type:"app",openType:"panel",icon:Ql,label:"组件库"},{name:"Outline",region:"Apps",component:G.Outline,type:"app",openType:"panel",icon:Gl,label:"大纲树"},{name:"History",region:"Apps",component:G.History,type:"app",openType:"panel",icon:Xl,label:"历史记录"},{name:"Apis",region:"Apps",component:G.Apis,type:"app",openType:"panel",icon:Kl,label:"API管理"},{name:"Deps",region:"Apps",component:G.Deps,type:"app",openType:"panel",icon:$l,label:"依赖管理"},{name:"ProjectConfig",region:"Apps",component:G.ProjectConfig,type:"app",openType:"panel",icon:Ht,label:"项目配置"},{name:"About",region:"Apps",component:G.About,type:"app",openType:"dialog",icon:Yl,label:"关于",props:{width:500,height:300}},{name:"Designer",region:"Workspace",component:G.Designer,type:"tab",closable:!1,label:"设计视图"},{name:"Previewer",region:"Preview",component:G.Previewer,type:"tab",closable:!1,label:"预览视图"},{name:"Schema",region:"Workspace",component:G.Schema,type:"tab",closable:!0,label:"DSL视图"},{name:"Raw",region:"Workspace",component:G.Raw,type:"tab",closable:!0,label:"源码视图"},{name:"Docs",region:"Workspace",component:G.Docs,type:"tab",closable:!0,label:"帮助中心"},{name:"Scripts",region:"Settings",component:G.Scripts,type:"tab",group:be.Block,label:"设置"},{name:"Css",region:"Settings",component:G.Css,type:"tab",group:be.Block,label:"CSS"},{name:"DataSources",region:"Settings",component:G.DataSources,type:"tab",group:be.Block,label:"数据源"},{name:"Defined",region:"Settings",component:G.Defined,type:"tab",group:be.Block,label:"定义"},{name:"Properties",region:"Settings",component:G.Properties,type:"tab",group:be.Node,label:"属性"},{name:"Style",region:"Settings",component:G.Style,type:"tab",group:be.Node,label:"样式"},{name:"Events",region:"Settings",component:G.Events,type:"tab",group:be.Node,label:"事件"},{name:"Directives",region:"Settings",component:G.Directives,type:"tab",group:be.Node,label:"指令"},{name:"NodePath",region:"Status",component:G.NodePath}],vr=[{package:"vue",version:"latest",library:"Vue",urls:["@vtj/materials/deps/vue/vue.global.prod.js"],assetsLibrary:Mn,required:!0,official:!0,enabled:!0},{package:"vue-router",version:"latest",library:"VueRouter",urls:["@vtj/materials/deps/vue-router/vue-router.global.prod.js"],assetsLibrary:In,required:!0,official:!0,enabled:!0},{package:"@vtj/utils",version:"latest",library:"VtjUtils",urls:["@vtj/materials/deps/@vtj/utils/index.umd.js"],required:!0,official:!0,enabled:!0},{package:"@vtj/icons",version:"latest",library:"VtjIcons",urls:["@vtj/materials/deps/@vtj/icons/style.css","@vtj/materials/deps/@vtj/icons/index.umd.js"],required:!0,official:!0,enabled:!0},{package:"element-plus",version:"latest",library:"ElementPlus",localeLibrary:"ElementPlusLocaleZhCn",urls:["@vtj/materials/deps/element-plus/dark/css-vars.css","@vtj/materials/deps/element-plus/index.css","@vtj/materials/deps/element-plus/zh-cn.js","@vtj/materials/deps/element-plus/index.full.min.js"],assetsUrl:"@vtj/materials/assets/element/index.umd.js",assetsLibrary:"ElementPlusMaterial",required:!1,official:!0,enabled:!0},{package:"@vtj/ui",version:"latest",library:"VtjUI",urls:["@vtj/materials/deps/echarts/echarts.min.js","@vtj/materials/deps/@vtj/ui/style.css","@vtj/materials/deps/@vtj/ui/index.umd.js"],assetsUrl:"@vtj/materials/assets/ui/index.umd.js",assetsLibrary:"VtjUIMaterial",required:!1,official:!0,enabled:!0},{package:"ant-design-vue",version:"latest",library:"antd",urls:["@vtj/materials/deps/ant-design-vue/reset.css","@vtj/materials/deps/ant-design-vue/dayjs/dayjs.min.js","@vtj/materials/deps/ant-design-vue/dayjs/plugin/customParseFormat.js","@vtj/materials/deps/ant-design-vue/dayjs/plugin/weekday.js","@vtj/materials/deps/ant-design-vue/dayjs/plugin/localeData.js","@vtj/materials/deps/ant-design-vue/dayjs/plugin/weekOfYear.js","@vtj/materials/deps/ant-design-vue/dayjs/plugin/weekYear.js","@vtj/materials/deps/ant-design-vue/dayjs/plugin/advancedFormat.js","@vtj/materials/deps/ant-design-vue/dayjs/plugin/quarterOfYear.js","@vtj/materials/deps/ant-design-vue/antd.min.js"],assetsUrl:"@vtj/materials/assets/antdv/index.umd.js",assetsLibrary:"AntdvMaterial",required:!1,official:!0,enabled:!1}],gr=[{id:"html",category:"HTML"},{id:"elements",category:"特殊元素"},{id:"components",category:"内置组件"}],hr=[{name:"div",label:"容器",categoryId:"html",snippet:{children:"容器文本内容示例"}},{name:"span",label:"内联",categoryId:"html",snippet:{children:"内联容器文本内容示例"}},{name:"a",label:"链接",categoryId:"html",props:[{name:"href",label:"href",setters:"InputSetter"}],snippet:{children:"链接文本内容示例",props:{href:"#"}}},{name:"img",label:"图片",categoryId:"html",childIncludes:!1,props:[{name:"src",label:"src",setters:"InputSetter"},{name:"width",label:"width",setters:"InputSetter"},{name:"height",label:"height",setters:"InputSetter"}],snippet:{props:{src:xl,width:"200",height:"200"}}},{name:"h1",label:"大标题",categoryId:"html",snippet:{children:"标题"}},{name:"h2",label:"中标题",categoryId:"html",snippet:{children:"标题"}},{name:"h3",label:"小标题",categoryId:"html",snippet:{children:"标题"}},{name:"p",label:"段落",categoryId:"html",snippet:{children:"段落文本"}},{name:"component",label:"动态组件",categoryId:"elements",doc:"https://cn.vuejs.org/api/built-in-special-elements.html#component",props:[{name:"is",label:"组件名",setters:"InputSetter"}],snippet:{children:"组件文本内容示例",props:{is:"div"}}},{name:"slot",label:"插槽",categoryId:"elements",doc:"https://cn.vuejs.org/api/built-in-special-elements.html#slot",props:[{name:"name",label:"名称",defaultValue:"default",setters:"InputSetter"}],snippet:{children:"默认插槽内容"}}],br=[...hr,{name:"Transition",label:"过渡效果",categoryId:"components",doc:"https://cn.vuejs.org/api/built-in-components.html#transition",package:"vue",props:[{name:"name",label:"名称",defaultValue:"",title:"用于自动生成过渡 CSS class 名",setters:"InputSetter"},{name:"css",label:"应用CSS",defaultValue:!0,title:"是否应用 CSS 过渡 class",setters:"BooleanSetter"},{name:"type",label:"事件类型",defaultValue:void 0,title:"指定要等待的过渡事件类型来确定过渡结束的时间，默认情况下会自动检测持续时间较长的类型",setters:"SelectSetter",options:["transition","animation"]},{name:"duration",label:"持续时间",defaultValue:void 0,title:"显式指定过渡的持续时间",setters:["NumberSetter","JSONSetter"]},{name:"mode",label:"时序",defaultValue:"default",title:"控制离开/进入过渡的时序。",setters:"SelectSetter",options:["in-out","out-in","default"]},{name:"appear",label:"使用过渡",defaultValue:!1,title:"是否对初始渲染使用过渡",setters:"BooleanSetter"},{name:"enterFromClass",label:"enterFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"enterActiveClass",label:"enterActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"enterToClass",label:"enterToClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearFromClass",label:"appearFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearActiveClass",label:"appearActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearToClass",label:"appearToClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveFromClass",label:"leaveFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveActiveClass",label:"leaveActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveToClass",label:"leaveToClass",defaultValue:void 0,setters:"InputSetter"}],events:["before-enter","before-leave","enter","leave","appear","after-enter","after-leave","after-appear","enter-cancelled","leave-cancelled","ppear-cancelled"],snippet:{children:"Transition"}},{name:"TransitionGroup",label:"过渡效果组",categoryId:"components",doc:"https://cn.vuejs.org/api/built-in-components.html#transitiongroup",package:"vue",props:[{name:"name",label:"名称",defaultValue:"",title:"用于自动生成过渡 CSS class 名",setters:"InputSetter"},{name:"tag",label:"标签名",defaultValue:void 0,title:"如果未定义，则渲染为片段 (fragment)",setters:"InputSetter"},{name:"moveClass",label:"moveClass",defaultValue:void 0,title:"用于自定义过渡期间被应用的 CSS class。",setters:"InputSetter"},{name:"css",label:"应用CSS",defaultValue:!0,title:"是否应用 CSS 过渡 class",setters:"BooleanSetter"},{name:"type",label:"事件类型",defaultValue:void 0,title:"指定要等待的过渡事件类型来确定过渡结束的时间，默认情况下会自动检测持续时间较长的类型",setters:"SelectSetter",options:["transition","animation"]},{name:"duration",label:"持续时间",defaultValue:void 0,title:"显式指定过渡的持续时间",setters:["NumberSetter","JSONSetter"]},{name:"appear",label:"使用过渡",defaultValue:!1,title:"是否对初始渲染使用过渡",setters:"BooleanSetter"},{name:"enterFromClass",label:"enterFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"enterActiveClass",label:"enterActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"enterToClass",label:"enterToClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearFromClass",label:"appearFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearActiveClass",label:"appearActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"appearToClass",label:"appearToClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveFromClass",label:"leaveFromClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveActiveClass",label:"leaveActiveClass",defaultValue:void 0,setters:"InputSetter"},{name:"leaveToClass",label:"leaveToClass",defaultValue:void 0,setters:"InputSetter"}],events:["before-enter","before-leave","enter","leave","appear","after-enter","after-leave","after-appear","enter-cancelled","leave-cancelled","ppear-cancelled"],snippet:{children:"TransitionGroup"}},{name:"KeepAlive",label:"缓存切换组件",categoryId:"components",doc:"https://cn.vuejs.org/api/built-in-components.html#keepalive",package:"vue",props:[{name:"include",label:"匹配包含",title:"如果指定，则只有与 `include` 名称, 匹配的组件才会被缓存。",setters:["InputSetter","JSONSetter"]},{name:"exclude",label:"匹配排除",title:"任何名称与 `exclude` 匹配的组件都不会被缓存。",setters:["InputSetter","JSONSetter"]},{name:"max",label:"最大缓存数",title:"最多可以缓存多少组件实例。",setters:["InputSetter"]}]},{name:"Teleport",label:"传送组件",categoryId:"components",doc:"https://cn.vuejs.org/api/built-in-components.html#teleport",package:"vue",props:[{name:"to",label:"目标容器",title:"指定目标容器,可以是选择器或实际元素",setters:["InputSetter"]},{name:"disabled",label:"禁用",title:"当值为 `true` 时，内容将保留在其原始位置, 而不是移动到目标容器中, 可以动态更改",setters:["BooleanSetter"]}]},{name:"Suspense",label:"异步依赖",categoryId:"components",doc:"https://cn.vuejs.org/api/built-in-components.html#suspense",package:"vue",props:[{name:"timeout",label:"timeout",setters:["InputSetter"]}]},{name:"RouterLink",label:"路由链接",categoryId:"components",doc:"https://router.vuejs.org/zh/api/interfaces/RouterLinkProps.html",package:"vue-router",props:[{name:"to",label:"to",setters:["InputSetter"]},{name:"replace",label:"replace",setters:["BooleanSetter"]}],snippet:{children:"RouterLink",props:{to:"/"}}}],fr=[{name:ct,version:"latest",label:"内置",library:ct,order:0,categories:gr,components:br}],yr=j({name:"StringSetter",__name:"string",setup(d){return(e,t)=>(u(),y(l(ye),re({clearable:""},e.$attrs),null,16))}}),wr=j({name:"BooleanSetter",__name:"boolean",setup(d){return(e,t)=>(u(),y(l(It),re(e.$attrs,{"model-value":!!e.$attrs.modelValue}),null,16,["model-value"]))}}),kr="{{",Sr="}}",xr=j({name:"ExpressionSetter",__name:"expression",props:{modelValue:{},context:{}},emits:["change"],setup(d,{emit:e}){const t=(r="")=>({type:"JSExpression",value:Ne(r)?r.value:r}),a=d,n=e,s=r=>ie(r,a.context,!0),o=k(t(a.modelValue).value);H(()=>a.modelValue,r=>{o.value=t(r).value},{immediate:!0});const i=r=>{const p={type:"JSExpression",value:r};s(p)&&n("change",p)};return(r,p)=>(u(),y(l(ye),{class:"v-expression-setter",modelValue:o.value,"onUpdate:modelValue":p[0]||(p[0]=m=>o.value=m),onChange:i},{prefix:f(()=>[q(T(kr))]),suffix:f(()=>[q(T(Sr))]),_:1},8,["modelValue"]))}}),_r=j({name:"SelectSetter",__name:"select",props:{options:{default:()=>[]}},setup(d){const e=d;return(t,a)=>(u(),y(l(Ll),re({clearable:""},t.$attrs),{default:f(()=>[(u(!0),V(J,null,W(e.options,n=>(u(),y(l(Ol),re({key:n.label,ref_for:!0},n),null,16))),128))]),_:1},16))}}),Cr=j({name:"NumberSetter",__name:"number",props:{modelValue:{}},emits:["change"],setup(d,{emit:e}){const t=d,a=e,n=x(()=>Ne(t.modelValue)?void 0:Number(t.modelValue||0)),s=o=>{a("change",o)};return(o,i)=>(u(),y(l(Nl),re({class:"v-number-setter","controls-position":"right","model-value":n.value},o.$attrs,{onChange:s}),null,16,["model-value"]))}}),Vr=j({name:"ColorSetter",__name:"color",setup(d){return(e,t)=>(u(),y(l(Ml),ml(pl(e.$attrs)),null,16))}}),jr=j({name:"JsonSetter",__name:"json",props:{modelValue:{default:void 0},type:{default:"JSON"}},emits:["change"],setup(d,{emit:e}){const t=d,a=k(),n=k(typeof t.modelValue=="object"?JSON.stringify(t.modelValue,null,2):void 0),s=x(()=>!!n.value),o=k(!1),i=e,r=b=>{let v=!0;try{const g=JSON.parse(b);if(t.type==="Array"&&!Array.isArray(g))throw new Error(`"${b}" is not a Array`);if(t.type==="Object"&&!Hn(g))throw new Error(`"${b}" is not a PlainObject`);if(typeof g!="object")throw new Error(`"${b}" is not a ${t.type}`)}catch(g){v=!1,ge.error({title:"代码错误",message:g?.message||g})}return v},p=()=>{const b=a.value?.getEditor();if(b){const v=b.getValue();r(v)&&(n.value=v,i("change",JSON.parse(v)),o.value=!1)}},m=()=>{n.value="",i("change",void 0),o.value=!1},h=()=>{o.value=!0};return(b,v)=>(u(),V("div",{class:U(["v-json-setter",{"is-active":s.value}])},[c(l(ye),re({readonly:"",onFocus:h,"model-value":t.type,"suffix-icon":l(xt)},b.$attrs),null,16,["model-value","suffix-icon"]),o.value?(u(),y(l(Re),{key:0,modelValue:o.value,"onUpdate:modelValue":v[0]||(v[0]=g=>o.value=g),title:t.type,width:"1000px",height:"600px",cancel:"",submit:"",clear:"",onSubmit:p,onClear:m},{extra:f(()=>[c(l(ne),{type:"warning",onClick:m,size:"default"},{default:f(()=>[q(" 清除 ")]),_:1})]),default:f(()=>[c(l(ae),{ref_key:"codeEditor",ref:a,height:"100%",lang:"json",dark:"","model-value":n.value},null,8,["model-value"])]),_:1},8,["modelValue","title"])):C("",!0)],2))}}),Ar=j({name:"FunctionSetter",__name:"function",props:{modelValue:{default:()=>({type:"JSFunction",value:""})}},emits:["change"],setup(d,{emit:e}){const t=d,a=k(),n=k(t.modelValue.value),s=k(!1),o=x(()=>!!n.value),i=e,r=()=>{const h=a.value?.getEditor();if(h){const b=h.getValue(),v={type:"JSFunction",value:b};ie(v,{})&&(n.value=b,i("change",v),s.value=!1)}},p=()=>{n.value="",i("change",void 0),s.value=!1},m=()=>{s.value=!0};return(h,b)=>(u(),V("div",{class:U(["v-function-setter",{"is-active":o.value}])},[c(l(ye),re({readonly:"",onFocus:m,"model-value":"JSFunction","suffix-icon":l(xt)},h.$attrs),null,16,["suffix-icon"]),s.value?(u(),y(l(Re),{key:0,modelValue:s.value,"onUpdate:modelValue":b[0]||(b[0]=v=>s.value=v),title:"JSFunction",width:"1000px",height:"600px",cancel:"",submit:"",clear:"",onSubmit:r,onClear:p},{extra:f(()=>[c(l(ne),{type:"warning",onClick:p,size:"default"},{default:f(()=>[q(" 清除 ")]),_:1})]),default:f(()=>[c(l(ae),{ref_key:"codeEditor",ref:a,height:"100%","model-value":n.value,dark:""},null,8,["model-value"])]),_:1},8,["modelValue"])):C("",!0)],2))}}),Pr=j({name:"RadioSetter",__name:"radio",props:{options:{default:()=>[]}},setup(d){const e=d;return(t,a)=>(u(),y(l(Wt),re({class:"v-radio-setter",size:"small"},t.$attrs),{default:f(()=>[(u(!0),V(J,null,W(e.options,n=>(u(),y(l(Qe),{label:n.label,value:n.value,title:n.label},{default:f(()=>[n.svg?(u(),y(l(Ce),{key:0,src:n.svg},null,8,["src"])):(u(),V(J,{key:1},[q(T(n.label),1)],64))]),_:2},1032,["label","value","title"]))),256))]),_:1},16))}}),Er=["label","title","onClick"],zr=j({name:"TagSetter",__name:"tag",props:{options:{default:()=>[]},modelValue:{}},emits:["update:modelValue","change"],setup(d,{emit:e}){const t=d,a=e,n=s=>{s.value===t.modelValue?(a("update:modelValue",void 0),a("change",void 0)):(a("update:modelValue",s.value),a("change",s.value))};return(s,o)=>(u(),V("div",re({class:"v-tag-setter",size:"small"},s.$attrs),[(u(!0),V(J,null,W(t.options,i=>(u(),V("span",{label:i.value,title:i.label,class:U({"is-active":t.modelValue===i.value}),onClick:r=>n(i)},[i.svg?(u(),y(l(Ce),{key:0,src:i.svg,size:16},null,8,["src"])):(u(),V(J,{key:1},[q(T(i.label),1)],64))],10,Er))),256))],16))}}),_l=j({name:"SizeSetter",__name:"size",props:{modelValue:{}},emits:["change"],setup(d,{emit:e}){const t=d,a=e,n=k(!0),s=x(()=>n.value?"px":void 0),o=k(t.modelValue),i=r=>{n.value=!!Number(r)};return H(o,r=>{a("change",r)}),H(()=>t.modelValue,r=>{r&&(n.value=r.endsWith("px"),o.value=r)},{immediate:!0}),(r,p)=>(u(),y(l(sl),re({clearable:"",unit:s.value,"with-unit":!!s.value,modelValue:o.value,"onUpdate:modelValue":p[0]||(p[0]=m=>o.value=m),onChange:i},r.$attrs),null,16,["unit","with-unit","modelValue"]))}}),Br={class:"v-image-setter__plus"},Dr=j({name:"ImageSetter",__name:"image",props:{modelValue:{},limit:{default:1}},emits:["change","update:modelValue"],setup(d,{emit:e}){const t=d,a=e,n=k([]),s=x(()=>n.value.length<t.limit),o=r=>r.type.includes("image")?(Un(r).then(p=>{n.value=[{name:r.name,url:p}]}),!1):($e.error("只能上传图片"),!1),i=()=>{n.value=[]};return H(()=>t.modelValue,r=>{n.value=r?[{name:"",url:r}]:[]},{immediate:!0}),H(n,()=>{const r=n.value[0]?.url;a("change",r),a("update:modelValue",r)}),(r,p)=>(u(),y(l(Il),re({class:["v-image-setter",{"v-image-setter--addable":s.value}],"list-type":"picture-card",limit:1,action:"#","file-list":n.value,"onUpdate:fileList":p[0]||(p[0]=m=>n.value=m),"before-upload":o,"auto-upload":!0,"on-remove":i},r.$attrs),{default:f(()=>[_("span",Br,[c(l(Ce),{icon:l(cs)},null,8,["icon"])])]),_:1},16,["class","file-list"]))}}),Rr={class:"v-section-setter"},Fr=j({name:"SectionSetter",__name:"section",props:{modelValue:{},sections:{default:4}},emits:["change"],setup(d,{emit:e}){const t=d,a=e,n=k(new Array(t.sections).fill(""));H(()=>t.modelValue,o=>{n.value=o?o.split(" "):new Array(t.sections).fill("")},{immediate:!0});const s=()=>{a("change",n.value.join(" ").trim())};return(o,i)=>(u(),V("div",Rr,[(u(!0),V(J,null,W(t.sections,r=>(u(),y(_l,{name:r-1,modelValue:n.value[r-1],"onUpdate:modelValue":p=>n.value[r-1]=p,onChange:s,class:"v-section-setter__item"},null,8,["name","modelValue","onUpdate:modelValue"]))),256))]))}}),Jr={class:"v-slider-setter"},Tr=j({name:"SliderSetter",__name:"slider",props:{modelValue:{default:void 0}},emits:["change","update:modelValue"],setup(d,{emit:e}){const t=d,a=e,n=k();H(()=>t.modelValue,o=>{n.value=o},{immediate:!0}),H(n,o=>{a("change",o),a("update:modelValue",o)});const s=()=>{n.value=void 0,a("change",void 0),a("update:modelValue",void 0)};return(o,i)=>(u(),V("div",Jr,[c(l(Ul),re({size:"small"},o.$attrs,{modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=r=>n.value=r)}),null,16,["modelValue"]),c(l(Ce),{onClick:s,class:"v-slider-setter__close",size:16,icon:l(ms)},null,8,["icon"])]))}}),Z={StringSetter:yr,BooleanSetter:wr,ExpressionSetter:xr,SelectSetter:_r,NumberSetter:Cr,ColorSetter:Vr,IconSetter:wl,JsonSetter:jr,FunctionSetter:Ar,RadioSetter:Pr,TagSetter:zr,SizeSetter:_l,ImageSetter:Dr,SectionSetter:Fr,SliderSetter:Tr,FileSetter:Ct},Wr={name:"StringSetter",component:Z.StringSetter,type:"String"},Or=[{name:"InputSetter",component:Z.StringSetter,type:"String"},{name:"StringSetter",component:Z.StringSetter,type:"String"},{name:"BooleanSetter",component:Z.BooleanSetter,type:"Boolean"},{name:"ExpressionSetter",component:Z.ExpressionSetter,type:"Object"},{name:"SelectSetter",component:Z.SelectSetter,type:"String"},{name:"NumberSetter",component:Z.NumberSetter,type:"Number"},{name:"ColorSetter",component:Z.ColorSetter,type:"String"},{name:"IconSetter",component:Z.IconSetter,type:"String"},{name:"ObjectSetter",component:Z.JsonSetter,type:"Object",props:{type:"Object"}},{name:"ArraySetter",component:Z.JsonSetter,type:"Array",props:{type:"Array"}},{name:"JsonSetter",component:Z.JsonSetter,type:"Object",props:{type:"JSON"}},{name:"JSONSetter",component:Z.JsonSetter,type:"Object",props:{type:"JSON"}},{name:"FunctionSetter",component:Z.FunctionSetter,type:"Function"},{name:"RadioSetter",component:Z.RadioSetter,type:"String"},{name:"TagSetter",component:Z.TagSetter,type:"String"},{name:"SizeSetter",component:Z.SizeSetter,type:"String"},{name:"ImageSetter",component:Z.ImageSetter,type:"String"},{name:"SectionSetter",component:Z.SectionSetter,type:"String"},{name:"SliderSetter",component:Z.SliderSetter,type:"Number"},{name:"RangeSetter",component:Z.SliderSetter,type:"Array",props:{range:!0}},{name:"FileSetter",component:Z.FileSetter,type:"String",props:{multiple:!1}},{name:"FilesSetter",component:Z.FileSetter,type:"String",props:{multiple:!0}}];class Lr{widgets={};constructor(){this.widgets=this.createWidgets()}createWidgets(){const e={};for(const t of pr)e[t.name]=t;return e}register(e){this.widgets[e.name]=e}get(e){return this.widgets[e]}set(e,t){const a=this.widgets[e];if(!a){_e.warn(`widget '${e}' is not found`);return}yt(a,t),t.component&&(a.component=t.component)}getWidgets(e,t){const a=Object.values(this.widgets);return e?a.filter(n=>n.region===e&&(!t||t&&t===n.group)):a}}const Cl=new Lr;class Nr{constructor(e=vr){this.deps=e}get(){return this.deps}set(e){this.deps=e}add(e){const t=this.deps.find(a=>a.package===e.package);t?Object.assign(t,e):this.deps.push(e)}merge(e){const t=[];for(const a of this.deps){const n=e.find(s=>s.package===a.package);t.push(n?{...n,...a,enabled:n.enabled}:a)}for(const a of e)this.deps.find(n=>n.package===a.package)||t.push(a);return t}remove(e){const t=this.deps.findIndex(a=>a.package===e);t>-1&&this.deps.splice(t,1)}}const Mr=new Nr;class Ir{setters={};defaultSetter=Wr;constructor(){this.setters=this.createSetters()}createSetters(){const e={};for(const t of Or)e[t.name]=t;return e}register(e){this.setters[e.name]=e}get(e){return this.setters[e]}set(e,t){const a=this.setters[e];if(!a){_e.warn(`setter '${e}' is not found`);return}yt(a,t),t.component&&(a.component=t.component)}getByType(e){return Object.values(this.setters).filter(t=>t.type===e).map(t=>t.name)}}const Ke=new Ir;function Ur(d){return new Promise((e,t)=>{const a=dl(ro,{slots:d,onClose:()=>{a.unmount(),t(null)},onSubmit:n=>{a.unmount(),e(n)}});a.mount(document.createElement("div"))})}class qr{constructor(e,t,a){this.engine=e,this.contentWindow=t,this.dependencies=a,this.document=this.contentWindow.document,this.bindEvents(t,this.document)}proxied={};document=null;hover=vt(null);dropping=vt(null);selected=k(null);dragging=null;draggingNode=null;bind(e,t){let a=this.proxied[t];return a||(a=e.bind(this),this.proxied[t]=a),a}bindEvents(e,t){t.addEventListener("mouseover",this.bind(this.onMouseOver,"onMouseOver")),t.addEventListener("scroll",this.bind(this.onViewChange,"onViewChange")),e.addEventListener("resize",this.bind(this.onViewChange,"onViewChange")),t.addEventListener("mouseleave",this.bind(this.onLeave,"onLeave")),t.addEventListener("dragleave",this.bind(this.onLeave,"onLeave")),t.addEventListener("dragover",this.bind(this.onDragOver,"onDragOver")),t.addEventListener("drop",this.bind(this.onDrop,"onDrop")),t.addEventListener("click",this.bind(this.onSelected,"onSelected")),te.on(ut,this.bind(this.onActiveChange,"onActiveChange")),te.on(Le,this.bind(this.onViewChange,"onViewChange"))}unbindEvents(e,t){t.removeEventListener("mouseover",this.bind(this.onMouseOver,"onMouseOver")),t.removeEventListener("scroll",this.bind(this.onViewChange,"onViewChange")),e.removeEventListener("resize",this.bind(this.onViewChange,"onViewChange")),t.removeEventListener("mouseleave",this.bind(this.onLeave,"onLeave")),t.removeEventListener("dragleave",this.bind(this.onLeave,"onLeave")),t.removeEventListener("dragover",this.bind(this.onDragOver,"onDragOver")),t.removeEventListener("drop",this.bind(this.onDrop,"onDrop")),t.removeEventListener("click",this.bind(this.onSelected,"onSelected")),te.off(ut,this.bind(this.onActiveChange,"onActiveChange")),te.off(Le,this.bind(this.onViewChange,"onViewChange"))}onMouseOver(e){const t=this.getHelper(e);t?.model.id!==this.selected.value?.model.id&&(this.hover.value=t)}onViewChange(){this.updateRect()}onLeave(e){this.hover.value=null,this.dropping.value=null}onActiveChange(){this.hover.value=null,this.dropping.value=null,this.selected.value=null}async getDropSlot(e){if(!e)return;const{engine:t}=this,a=t.assets,n=a.componentMap,s=await a.getBlockMaterial(e.from)||n.get(e.name);if(!s?.slots)return;const o=(s?.slots||["default"]).map(i=>typeof i=="string"?{name:i,params:[]}:{name:i.name,params:i.params||[]});return o.length===0?void 0:o.length===1?o[0]:await Ur(o).catch(()=>null)}async onDrop(e){e.preventDefault();const{engine:t,dragging:a,dropping:n,draggingNode:s}=this,o=t.current.value,i=this.getHelper(e);if(!o||!a||!n.value||!i)return;const r=i.model,p=n.value.type;if(!await this.allowDrop(r,p))return;let m;if(s)m=s;else{const h=this.createNodeDsl(a);m=new Bt(h)}if(ee(r))s?(delete m.slot,o.move(m,void 0,"inner")):o.addNode(m,void 0,p);else{const h=await this.getDropSlot(p==="inner"?r:r.parent);if(h===null){this.dropping.value=null;return}m.slot=h,s?o.move(m,r,p):o.addNode(m,r,p)}this.dropping.value=null,t.simulator.refresh(),t.assets.clearCaches()}onSelected(e){this.setHover(null),this.selected.value=this.getHelper(e)}async onDragOver(e){const t=this.getHelper(e);if(!t)return;const{model:a,type:n}=t;a&&await this.allowDrop(a,n)?(e.preventDefault(),this.dropping.value=t):this.dropping.value=null}isVtjElement(e){return!!e.__vtj__&&!!e.__context__}findVtjElement(e){return e.find(t=>this.isVtjElement(t))}getNodeByElement(e){const t=e.__vtj__??"";return Bt.nodes[t]||null}getDropType(e,t,a){const{left:n,top:s,width:o,height:i}=e;return t>=n&&t<=n+o*.2?"left":t>=n+o*.8&&t<=n+o?"right":a>=s&&a<=s+i*.2?"top":a>=s+i*.8&&a<=s+i?"bottom":"inner"}getNodePath(e=[]){const t=e.filter(n=>this.isVtjElement(n)),a=this.engine.current.value;return[...t.map(n=>this.getNodeByElement(n)).filter(n=>!!n),a]}setDslFrom(e){const t=this.engine.assets.componentMap.get(e.name);if(e.from=e.from||t?.package,Array.isArray(e.children))for(const a of e.children)this.setDslFrom(a)}createNodeDsl(e){const{name:t,snippet:a={},from:n}=e,s={...a,name:t,from:n||e.package};return this.setDslFrom(s),s}getElmenetByModel(e){return!this.document||!e?null:ee(e)?this.document.body:Array.from(this.document.querySelectorAll("*")).find(t=>t.__vtj__===e.id)}findPathByNode(e){const t=[e];let a=e;for(;a.parent&&a.parent!==a;)a=a.parent,a!==e&&t.unshift(a);const n=this.engine.current.value;return t.unshift(n),t.reverse()}getHelper(e){const t=e.composedPath()||[],a=this.findVtjElement(t)||this.document?.body;if(!a)return null;const n=this.getNodeByElement(a)||this.engine.current.value;if(!n)return null;const s=a.getBoundingClientRect(),o=this.getDropType(s,e.clientX,e.clientY),i=this.getNodePath(t);return{el:a,model:n,rect:s,type:o,path:i}}cleanHelper(){this.setSelected(null),this.setHover(null),this.setDragging(null),this.setDropping(null)}async updateRect(){await Yt(100);const e=l(this.selected),t=l(this.hover);if(e){const a=e.el.getBoundingClientRect();this.selected.value={...e,rect:a}}if(t){const a=t.el.getBoundingClientRect();this.hover.value={...t,rect:a}}}setDragging(e){this.dragging=e}setDraggingNode(e){this.draggingNode=e}async setHover(e){if(await Se(),e){const t=this.getElmenetByModel(e);if(!t)return;const a=t.getBoundingClientRect(),n=ee(e)?[]:this.findPathByNode(e);this.hover.value={el:t,model:e,rect:a,type:"inner",path:n}}else this.hover.value=null}async setSelected(e){if(await Se(),e){const t=this.getElmenetByModel(e)||this.document?.createElement("span");if(!t)return;const a=t.getBoundingClientRect(),n=ee(e)?[]:this.findPathByNode(e);this.selected.value={el:t,model:e,rect:a,type:"inner",path:n}}else this.selected.value=null}async setDropping(e,t="inner"){if(await Se(),e){const a=this.getElmenetByModel(e);if(!a)return;const n=a.getBoundingClientRect(),s=ee(e)?[]:this.findPathByNode(e);this.dropping.value={el:a,model:e,rect:n,type:t,path:s}}else this.dropping.value=null}async allowDrop(e,t="inner"){const{dragging:a,engine:n,draggingNode:s}=this,o=n.current.value;if(!a||!o)return!1;if(ee(e))return!0;if(s&&e.id===s.id||s&&s.isChild(e))return!1;const i=n.assets.componentMap,r=t!=="inner"&&e.parent||e,p=await n.assets.getBlockMaterial(r.from)||i.get(r.name);if(!p)return!1;const{parentIncludes:m=!0,name:h}=a,{childIncludes:b=!0}=p,v=m===!0||Array.isArray(m)&&m.includes(r.name),g=b===!0||Array.isArray(b)&&b.includes(h);return v&&g}dispose(){const{contentWindow:e,document:t}=this;this.setSelected(null),this.setHover(null),this.setDragging(null),e&&t&&this.unbindEvents(e,t),this.document=null}}class Hr{constructor(e,t,a,n=null){this.env=e,this.service=t,this.provider=a,this.designer=n,this.nodeChange=this.__onNodeChange.bind(this),this.blockChange=this.__onBlockChange.bind(this)}app=null;dsl=null;nodeChange;blockChange;context=null;install(e){const{library:t,globals:a,VueRouter:n,locales:s}=this.env;if(n){const i=n.createRouter({history:n.createWebHashHistory(),routes:[]});e.use(i)}const o=Object.entries(t);Object.assign(e.config.globalProperties,a),e.config.errorHandler=(i,r,p)=>{const m=r?.$options.name,h=i?.message||i?.msg||"未知错误",b=`[ ${m} ] ${h}`;console.error({err:i,instance:r,info:p}),ge.error({title:"运行错误",message:b})},o.forEach(([i,r])=>{if(typeof r=="function"||typeof r.install=="function"){let p={};const m=s[i];m&&(p.locale=m),e?.use(r,p)}})}render(e){const{window:t,container:a,library:n,Vue:s,components:o,apis:i}=this.env,r=t.document.createElement("div");r.id="app",a.appendChild(r),this.dsl=s.reactive(e.toDsl());const{renderer:p,context:m}=this.provider.createDslRenderer(this.dsl,{window:t,mode:Kt.Design,Vue:s,components:o,apis:i,libs:n});this.app=s.createApp(p),this.install(this.app);try{this.app.mount(r)}catch(h){le(h.message||"未知错误","运行时错误"),console.error(h)}this.context=m,te.on(Le,this.nodeChange),te.on(dt,this.blockChange)}dispose(){if(this.app){this.app.unmount();const e=this.app._container;e&&e.parentNode&&(e.parentNode.removeChild(e),this.app._container=null),this.app=null}this.dsl=null,this.context=null,te.off(Le,this.nodeChange),te.off(dt,this.blockChange)}updateChild(e,t){const a=t.children||t.nodes||[];if(Array.isArray(a))for(let n=0;n<a.length;n++){const s=a[n];if(s.id===e.id){a.splice(n,1,e);return}else this.updateChild(e,s)}}__onNodeChange(e){this.dsl&&this.updateChild(e.toDsl(),this.dsl)}__onBlockChange(e){this.dispose(),this.render(e),this.designer?.selected.value&&this.designer.setSelected(e)}}class Qr extends Xt{contentWindow=null;renderer=null;designer=vt(null);engine;materialPath;constructor(e){super();const{engine:t,materialPath:a}=e;this.engine=t,this.materialPath=a,H(this.engine.current,()=>{this.refresh()})}init(e,t,a,n){H([e,t,a,n],()=>{e.value&&t.value.length&&(this.resetReady(),this.renderer?.dispose(),this.renderer=null,this.setup(e.value,t.value),this.contentWindow&&(this.designer.value?.dispose(),this.designer.value=new qr(this.engine,this.contentWindow,t)))},{immediate:!0,deep:!0})}setup(e,t){const a=e.contentWindow;if(!a){_e.warn("Simulator contentWindow is null");return}a.__simulator__=this;const n=a.document;this.contentWindow=a;const{scripts:s,css:o,materials:i,libraryExports:r,materialExports:p,materialMapLibrary:m,libraryLocaleMap:h}=Pa(t,this.materialPath);n.open(),n.write(`
     <!DOCTYPE html>
     <html lang="zh-CN">
       <head>
       <meta charset="utf-8">
       <meta name="viewport"
             content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0,viewport-fit=cover"/>
         <style>
            html, body, #app {
              padding: 0;
              margin: 0;
              min-height: 100vh;
              width: 100%;
              height: 100%;
              background: #fff;
            }
         </style>
         ${Ea(o)}
         ${Et(s)}
         ${Et(i)}
       </head>
       <body> 
       </body>
       <script>
       __simulator__.emitReady(${JSON.stringify(r)},
        ${JSON.stringify(p)}, 
    ${JSON.stringify(m)},
    ${JSON.stringify(h)}
    );
     <\/script> 
     </html>
    `),n.close()}async emitReady(e=[],t=[],a={},n={}){this.renderer?.dispose(),this.renderer=null;const s=this.contentWindow,{assets:o,service:i,current:r,provider:p}=this.engine,m=p.materials||{},h=[];for(const v of t){const g=m[v]?(await m[v]()).default:s[v];h.push(g)}o.load(h);const b=this.createEnv(e,a,h,n);this.renderer=new Hr(b,i,p,this.designer.value),r.value&&this.renderer.render(r.value),this.triggerReady()}createEnv(e=[],t={},a=[],n={}){const s=this.contentWindow,{engine:o}=this,{project:i,assets:r,provider:p}=o,m=e.reduce((P,D)=>(P[D]=s[D],P),{}),h={};Object.entries(n).forEach(([P,D])=>{h[P]=s[D]});const b={},{groups:v,componentMap:g}=r;for(const P of v.value){const D=P.names||[];if(P.name===ct)D.forEach(R=>{const K=g.get(R),E=K?.package||"",F=Wn[E],A=m[F];A&&K&&(b[R]=zt(K,A))});else{const R=m[t[P.library||""]];R&&D.forEach(K=>{const E=g.get(K);E?b[K]=zt(E,R):b[K]=R[K]})}}const{adapter:w,globals:S}=p,z=za(i.value?.apis,w);return Ba(),i.value?.config?.mock&&Da(i.value?.apis),{window:s,Vue:s.Vue,VueRouter:s.VueRouter,library:m,materials:a,components:b,container:s.document.body,apis:z,globals:S,libraryLocaleMap:n,locales:h}}refresh(){this.renderer?.dispose();const e=this.engine.current.value;e&&this.renderer?.render(e)}dispose(){this.renderer?.dispose(),this.designer.value?.dispose(),this.contentWindow=null,this.renderer=null,this.designer.value=null,this.resetReady()}}class Gr{constructor(e,t){this.service=e,this.provider=t}components=[];componentMap=new Map;groups=k([]);caches={};getCateoryComponents(e,t){const a=t.filter(n=>n.categoryId===e.id&&n.hidden!==!0);return{name:e.id,label:e.category,count:a.length,components:a}}parseGroups(e){const t=[];for(let a of e){const{categories:n,components:s,label:o,name:i,library:r}=a;if(!n||!s)continue;const p=s.filter(v=>!!v.package).map(v=>v.name),m=n.map(v=>this.getCateoryComponents(v,s)),h=m.reduce((v,g)=>g.count+v,0),b={name:a.name,label:o||i,count:h,names:p,library:r,children:m};t.push(b)}return t}load(e){const t=[...fr,...e].filter(a=>!!a);t.sort((a,n)=>a.order-n.order);for(let a of t)a.components&&(this.components=this.components.concat(a.components));this.groups.value=this.parseGroups(t),this.componentMap=Ra(this.components,"name")}async getBlockMaterial(e,t){if(!e||typeof e=="string")return null;let a;if(e.type==="Schema"&&e.id&&(a=this.caches[e.id]||await this.service.getFile(e.id),this.caches[e.id]=a),e.type==="UrlSchema"&&e.url&&(a=this.caches[e.url]||await this.provider.getDslByUrl(e.url),this.caches[e.url]=a),e.type==="Plugin"){const h=await this.service.getPluginMaterial(e);return h?(h.name=t||h.name,h.from=e,this.componentMap.set(h.name,h),h):null}if(!a)return null;a.name=t||a.name;const{id:n,name:s,slots:o,props:i,emits:r}=a,p=h=>{const b=Array.isArray(h)?h:[h];let v=[];for(const g of b)v=v.concat(Ke.getByType(g));return v},m={id:n,name:s,childIncludes:o?.length?void 0:!1,props:(i||[]).map(h=>typeof h=="string"?{name:h}:{name:h.name,type:h.type,setters:p(h.type)}),events:r,slots:o,from:e};return this.componentMap.set(s,m),m}clearCaches(){this.caches={}}}const Vl=Symbol("VtjEngine");class Du extends Xt{app;skeleton;container;service;assets;simulator;emitter=te;project=k(null);current=k(null);context=k(null);isEmptyCurrent=k(!1);history=k(null);provider;changed=k(Symbol());constructor(e){super();const{container:t,service:a,project:n={},globals:s={},dependencies:o,materials:i,materialPath:r="./"}=e;this.container=t,this.service=a,this.provider=new ra({mode:Kt.Design,globals:s,project:n,service:a,dependencies:o,materials:i,materialPath:r}),this.assets=new Gr(this.service,this.provider),this.simulator=new Qr({engine:this,materialPath:r}),this.bindEvents(),this.init(n),rl(this.render.bind(this)),ul(this.dispose.bind(this))}async init(e){const t=await this.service.init(e).catch(a=>(_e.warn("VTJEngine service init fail.",a),null));t&&(t.dependencies=Mr.merge(t.dependencies||[]),this.project.value=new ua(t),this.saveMaterials(),this.triggerReady())}render(){const e=l(this.container);if(e){const t=dl(Xr);t.provide(Vl,Xn(this)),t.mount(e),this.app=t}else _e.warn("VTJEngine constructor param [ container ] is undefined")}bindEvents(){te.on(da,e=>this.saveProject(e)),te.on(ca,e=>this.saveBlockFile(e)),te.on(ma,e=>this.saveBlockFile(e)),te.on(pa,()=>this.saveMaterials()),te.on(ut,e=>this.activeFile(e)),te.on(va,()=>this.publish()),te.on(ga,()=>this.publishCurrent()),te.on(dt,e=>this.changeFile(e)),te.on(Le,()=>this.changeCurrentFile()),te.on(ha,e=>this.saveHistory(e)),te.on(ba,e=>this.loadHistory(e))}async activeFile(e){await Se();const t=e.model,a=e.model.currentFile;if(a){if(t.isPageFile(a)&&a.raw)return;const n=await this.service.getFile(a.id);n&&(a.dsl=n)}if(a?.dsl){const n=new At(a.dsl);this.updateCurrent(n),this.initHistory(n)}else this.updateCurrent(null);Ae(this.project)}async changeFile(e){await Se();const t=e.toDsl();this.service.saveFile(t),this.updateCurrent(e),this.history.value?.add(t),Ae(this.history)}changeCurrentFile(){this.saveCurrentFile(),this.current.value&&(this.history.value?.add(this.current.value.toDsl()),Ae(this.history))}async updateCurrent(e,t=!0){this.current.value=e,await Se(),this.context.value=this.simulator.renderer?.context||null,this.isEmptyCurrent.value=this.current.value?.nodes.length===0,this.changed.value=Symbol(),t&&Ae(this.context)}async saveProject(e){const t=e.model.toDsl();await this.service.saveProject(t),Ae(this.project)}async saveBlockFile(e){const t=e.type,a=e.model;if(t==="create"){const n=e.data;a.isPageFile(n)&&n.raw?(await this.service.createRawPage(n),me(`源码文件已经生成：/.vtj/vue/${n.id}.vue`,"success")):n.dsl&&await this.service.saveFile(n.dsl)}if(t==="update"){const n=e.data;if(a.isPageFile(n)&&(n.dir||n.raw))return;const s=await this.service.getFile(n.id);s&&(s.name=n.name,await this.service.saveFile(s))}if(t==="delete"){const n=e.data;n&&a.isPageFile(n)&&n.raw?await this.service.removeRawPage(n.id):n.dir||(await this.service.removeFile(n.id),await this.service.removeHistory(n.id))}if(t==="clone"){const{page:n,newPage:s}=e.data,o=await this.service.getFile(n.id);o&&(o.id=s.id,o.name=s.name,await this.service.saveFile(o))}Ae(this.project)}async saveMaterials(){await Se(),this.simulator.ready(()=>{const e=this.project.value;if(e){const t=this.assets.componentMap;this.service.saveMaterials(e.toDsl(),t)}})}saveCurrentFile(){const e=this.current.value;e&&(this.updateCurrent(e),this.service.saveFile(e.toDsl()))}async initHistory(e){if(e){const t=await this.service.getHistory(e.id).catch(()=>null);this.history.value=new fa(Object.assign(t||{},{id:e.id}))}else this.history.value=null}async saveHistory(e){const t=e.type,a=e.model;t==="create"&&await this.service.saveHistoryItem(a.id,e.data),t==="delete"&&await this.service.removeHistoryItem(a.id,e.data),t==="clear"&&await this.service.removeHistoryItem(a.id,e.data);const n=a.toDsl();await this.service.saveHistory(n),Ae(this.history)}async loadHistory(e){const t=e.model,a=e.data,n=await this.service.getHistoryItem(t.id,a.id);if(n&&n.dsl){const s=new At(n.dsl);await this.updateCurrent(s),this.service.saveFile(n.dsl),Ae(this.history)}}async publish(){const e=this.project.value;if(e){const t={...e.toDsl(),pages:e.getPages()};await this.service.publish(t)&&me("整站发布成功","success")}}async publishCurrent(){const e=this.project.value,t=e?.currentFile;if(e&&t){const a={...e.toDsl(),pages:e.getPages()};await this.service.publishFile(a,t)&&me("发布成功","success")}}dispose(){this.emitter.all.clear(),this.simulator.dispose(),this.app&&(this.app.unmount(),this.container=void 0)}async openFile(e){const t=this.project.value,a=this.skeleton?.getRegion("Apps"),n=e||t?.homepage;if(!t||!a||!n)return;const s=t.getPage(n);s&&!s.raw&&(a.regionRef?.setActive("Pages"),this.simulator.ready(()=>{t.active(s)}));const o=t.getBlock(n);o&&(a.regionRef?.setActive("Blocks"),this.simulator?.ready(()=>{t.active(o)}))}}function ce(){const d=St(Vl,null);return d||_e.error("VTJEngine is not exist"),d}const Pe=j({name:"RegionWrapper",props:{region:{type:String,required:!0}},setup(){return{regionRef:k()}},render(){const d=Tt[this.region]||Tt.EmptyRegion;return Te(d,{...this.$props,...this.$attrs,ref:"regionRef"})}}),Be=j({name:"WidgetWrapper",props:{region:{type:String,required:!0},widget:{type:Object,required:!0}},setup(){return{widgetRef:k()}},render(){return Te(this.widget.component,{...this.widget.props,...this.$props,...this.$attrs,ref:"widgetRef"})}}),Xr=j({name:"SkeletonWrapper",setup(){const d=k(),e=ce(),t=k({});return{skeletonRef:d,engine:e,widgets:t}},mounted(){this.engine.skeleton=this},render(){return Te(Kr,{...this.$props,...this.$attrs,ref:"skeletonRef"})},methods:{getRegion(d){return this.skeletonRef[d.toLowerCase()]},toggleCollapse(d){if(this.skeletonRef){const e=this.skeletonRef.collapsed;this.skeletonRef.collapsed=d??!e}},settable(d){this.skeletonRef&&(this.skeletonRef.settable=d)},getWidgets(d){const e=this.getRegion(d);return e?ya(e.regionRef?.widgetsRef||[]):[]},getWidget(d){const e=Cl.get(d);if(!e){_e.warn(`widget [ ${d} ] is not exsit`);return}return this.getWidgets(e.region).find(t=>t.widget.name===d)},openPreview(d){this.skeletonRef&&(this.skeletonRef.isPreview=!0)},closePreview(){this.skeletonRef&&(this.skeletonRef.isPreview=!1)}}}),N=j({name:"SetterWrapper",props:{context:{type:Object,default:null},current:{type:Object,default:null},name:String,label:String,title:String,value:{type:[String,Object,Array,Number,Boolean],default:void 0},setters:{type:[String,Object,Array],required:!0,default(){return[]}},options:{type:Array,default(){return[]}},variable:{type:Boolean,default:!0},removable:{type:Boolean,default:!1}},computed:{computedSetters(){return(Array.isArray(this.setters)?this.setters:[this.setters]).map(d=>{let e;if(typeof d=="string")return e=this.getSetter(d),{component:Dt(e.component),name:e.name,label:d,props:e.props||{}};{const t=d;return e=this.getSetter(t.name),{component:Dt(t.component||e.component),name:t.name,label:t.label||t.name,props:Object.assign(e.props||{},t.props)}}})},computedOptions(){return(this.options||[]).map(d=>typeof d=="string"?{label:d,value:d}:d)},defaultSetter(){const{value:d,computedSetters:e}=this;let t=typeof d;t==="Object"&&(Array.isArray(d)?t="Array":Ne(d)?t="Object":wa(d)&&(t="Function"));const a=Ke.getByType(t)||[];return a.length?(e.find(n=>a.includes(n.name))||e[0])?.name:e[0]?.name}},render(){const{context:d,current:e,name:t,label:a,title:n,value:s,computedSetters:o,computedOptions:i,variable:r,changeValue:p,defaultSetter:m,removable:h,onRemove:b}=this;return Te(au,{context:d,current:e,name:t,label:a,title:n,setters:o,defaultSetter:m,variable:r,value:s,removable:h,options:i,onChange:p,onRemove:b})},emits:["change","remove"],methods:{getSetter(d){return typeof d=="string"?Ke.get(d)||Ke.defaultSetter:d},changeValue(d){this.$emit("change",this.name,d)},onRemove(d){this.$emit("remove",d)}}}),Kr=j({name:"Skeletion",__name:"skeleton",props:{headerHeight:{default:"36px"},leftWidth:{default:"400px"},rightWidth:{default:"350px"},footerHeight:{default:"20px"}},setup(d,{expose:e}){const t=d,a=k(!1),n=k(parseInt(t.leftWidth)),s=k(parseInt(t.rightWidth)),o={dirs:["e"],maxWidth:600,minWidth:49,onResizing(P,D){n.value=D.elementWidth.value},onEnd(P,D){n.value=D.elementWidth.value}},i={dirs:["w"],maxWidth:600,minWidth:2,onResizing(P,D){s.value=D.elementWidth.value},onEnd(P,D){s.value=D.elementWidth.value}},r=k(),p=k(),m=k(),h=k(),b=k(),v=k(),g=k(),w=k(),S=k(!1),z=k(!1);return e({brand:r,toolbar:p,actions:m,apps:h,workspace:b,settings:v,status:g,collapsed:S,settable:z,leftWidth:n,rightWidth:s,preview:w,isPreview:a}),(P,D)=>(u(),y(l(Tl),{locale:l(Jl)},{default:f(()=>[c(l(Vt),{class:"v-skeleton"},{default:f(()=>[c(l(Dl),{class:"v-skeleton__header",height:P.headerHeight},{default:f(()=>[c(l(Pe),{ref_key:"brand",ref:r,region:"Brand"},null,512),c(l(Pe),{ref_key:"toolbar",ref:p,region:"Toolbar",preview:a.value},null,8,["preview"]),c(l(Pe),{ref_key:"actions",ref:m,region:"Actions"},null,512)]),_:1},8,["height"]),c(l(Vt),{class:"v-skeleton__wrapper"},{default:f(()=>[a.value?C("",!0):Ee((u(),y(l(jt),{key:0,width:t.leftWidth,class:U(["v-skeleton__left",{"is-collapsed":S.value}])},{default:f(()=>[c(l(Pe),{ref_key:"apps",ref:h,region:"Apps"},null,512)]),_:1},8,["width","class"])),[[l(Pt),o]]),c(l(Rl),{class:"v-skeleton__main"},{default:f(()=>[a.value?(u(),y(l(Pe),{key:0,ref_key:"preview",ref:w,region:"Preview",preview:a.value},null,8,["preview"])):C("",!0),Ee(c(l(Pe),{ref_key:"workspace",ref:b,region:"Workspace"},null,512),[[De,!a.value]])]),_:1}),a.value?C("",!0):Ee((u(),y(l(jt),{key:1,width:t.rightWidth,class:"v-skeleton__right"},{default:f(()=>[c(l(Pe),{ref_key:"settings",ref:v,region:"Settings"},null,512)]),_:1},8,["width"])),[[De,z.value],[l(Pt),i]])]),_:1}),a.value?C("",!0):(u(),y(l(Fl),{key:0,class:"v-skeleton__footer",height:P.footerHeight},{default:f(()=>[c(l(Pe),{ref_key:"status",ref:g,region:"Status"},null,512)]),_:1},8,["height"]))]),_:1})]),_:1},8,["locale"]))}}),$r={key:1},Yr={class:"v-setter__content"},Zr={key:0,class:"v-setter__input"},eu={class:"v-setter__action"},tu="{{",lu="}}",au=j({__name:"setter",props:{context:{},current:{},name:{},label:{default:""},title:{},setters:{},variable:{type:Boolean,default:!0},value:{},options:{default:()=>[]},defaultSetter:{},removable:{type:Boolean}},emits:["change","remove"],setup(d,{emit:e}){const t=d,a=e,n=k(!1),s=k(""),o=k(t.setters.find(z=>z.name===t.defaultSetter)||t.setters[0]),i=k(t.value),r=x(()=>!!Ne(i.value)),p={[o.value.name]:i.value},m=z=>{p[o.value.name]=i.value,o.value=z,i.value=p[z.name]??void 0,h(i.value)};H(()=>t.value,()=>{i.value=t.value}),H(()=>t.defaultSetter,()=>{o.value=t.setters.find(z=>z.name===t.defaultSetter)||t.setters[0]});const h=z=>{a("change",z)},b=()=>{a("remove",t.name)},v=()=>{n.value=!0,s.value=Ne(i.value)?i.value.value:""},g=()=>{n.value=!1,s.value=""},w=async z=>ie(z,t.context,!0)?(p[o.value.name]=i.value,i.value=z,a("change",z),!0):!1,S=async()=>{await We("确定要解除绑定吗？")&&(g(),i.value=void 0,a("change",""))};return(z,P)=>(u(),y(l(Mt),{class:"v-setter",size:"small","label-positon":"left"},{label:f(()=>[t.title?(u(),y(l(Nt),{key:0,placement:"top-start",content:t.title},{default:f(()=>[q(T(t.label||t.name),1)]),_:1},8,["content"])):(u(),V("span",$r,T(t.label||t.name),1))]),default:f(()=>[_("div",Yr,[o.value?(u(),V("div",Zr,[r.value?C("",!0):(u(),y(cl(o.value.component),re({key:0,current:t.current,context:t.context},o.value.props,{options:t.options,modelValue:i.value,"onUpdate:modelValue":P[0]||(P[0]=D=>i.value=D),onChange:h,disabled:r.value}),null,16,["current","context","options","modelValue","disabled"])),r.value?(u(),y(l(ye),{key:1,class:"v-expression-setter",disabled:"","model-value":"JSExpression"},{prefix:f(()=>[q(T(tu))]),suffix:f(()=>[q(T(lu))]),_:1})):C("",!0)])):C("",!0),_("div",eu,[t.variable?(u(),y(l(ka),{key:0,onClick:v,class:U(["v-icon-vars",{"is-active":r.value}]),title:"绑定变量"},null,8,["class"])):C("",!0),t.setters.length>1?(u(),y(l(Lt),{key:1,disabled:r.value,size:"small","popper-class":"v-setter-switch",onCommand:m},{dropdown:f(()=>[c(l(Ot),null,{default:f(()=>[(u(!0),V(J,null,W(t.setters,D=>(u(),y(l(st),{command:D,key:D.name},{default:f(()=>[c(l($t),{class:U({"is-placeholder":D.name!==o.value.name})},null,8,["class"]),q(" "+T(D.label),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:f(()=>[c(l(Sa),{title:"切换设置器"})]),_:1},8,["disabled"])):C("",!0),t.removable?(u(),y(l(Ye),{key:2,onClick:b,title:"删除"})):C("",!0)])]),n.value?(u(),y(l(Wo),{key:0,current:t.current,context:t.context,value:s.value,modelValue:n.value,"onUpdate:modelValue":P[1]||(P[1]=D=>n.value=D),submitMethod:w,onUnbind:S},null,8,["current","context","value","modelValue"])):C("",!0)]),_:1}))}}),nu={class:"v-empty-region"},su=j({name:"EmptyRegion",__name:"empty",props:{region:{}},setup(d){return(e,t)=>(u(),V("div",nu,"找不到符合【"+T(e.region)+"】名称的区域组件",1))}}),ou={class:"v-brand-region"},iu=j({name:"BrandRegion",inheritAttrs:!1,__name:"brand",props:{region:{}},setup(d,{expose:e}){const t=d,{widgets:a,widgetsRef:n}=ze(t.region);return e({widgets:a,widgetsRef:n}),(s,o)=>(u(),V("div",ou,[(u(!0),V(J,null,W(l(a),i=>(u(),y(l(Be),{ref_for:!0,ref_key:"widgetsRef",ref:n,region:s.region,widget:i},null,8,["region","widget"]))),256))]))}}),ru={class:"v-toolbar-region"},uu=j({name:"ToolbarRegion",__name:"toolbar",props:{region:{},preview:{type:Boolean}},setup(d,{expose:e}){const t=d,{widgets:a,widgetsRef:n}=ze(t.region);return e({widgets:a,widgetsRef:n}),(s,o)=>(u(),V("div",ru,[(u(!0),V(J,null,W(l(a),i=>(u(),y(l(Be),{ref_for:!0,ref_key:"widgetsRef",ref:n,region:s.region,widget:i,preview:s.preview},null,8,["region","widget","preview"]))),256))]))}}),du={class:"v-actions-region"},cu=j({name:"ActionsRegion",inheritAttrs:!1,__name:"actions",props:{region:{}},setup(d,{expose:e}){const t=d,{widgets:a,widgetsRef:n}=ze(t.region);return e({widgets:a,widgetsRef:n}),(s,o)=>(u(),V("div",du,[(u(!0),V(J,null,W(l(a),i=>(u(),y(l(Be),{ref_for:!0,ref_key:"widgetsRef",ref:n,region:s.region,widget:i},null,8,["region","widget"]))),256))]))}}),mu={class:"v-apps-region"},pu={class:"v-apps-region__header"},vu={class:"v-apps-region__top"},gu={class:"v-apps-region__bottom"},hu={class:"v-apps-region__panels"},bu=j({name:"AppsRegion",inheritAttrs:!1,__name:"apps",props:{region:{},index:{default:0}},setup(d,{expose:e}){const t=d,a=ce(),{widgets:n,widgetsRef:s}=ze(t.region),o=x(()=>n.value.filter(v=>v.openType==="panel")),i=x(()=>n.value.filter(v=>v.openType!=="panel")),r=o.value[t.index],p=k(r),m=k(r),h=v=>{p.value=v,m.value=m.value?.name===v.name?null:v},b=v=>{v.openType==="link"&&v.url&&window.open(v.url),v.openType==="dialog"&&qn({title:v.label,icon:v.icon,...v.props,content:v.component})};return H(m,v=>{a.skeleton?.toggleCollapse(!v)}),e({widgets:n,widgetsRef:s,setActive:v=>{const g=o.value.find(w=>w.name===v);p.value=g,m.value=g}}),(v,g)=>(u(),V("div",mu,[_("div",pu,[_("div",vu,[(u(!0),V(J,null,W(o.value,w=>(u(),y(l(Jt),{key:`icon-${w.name}`,icon:w.icon,label:w.label,active:p.value?.name===w.name,open:m.value?.name===w.name,onClick:S=>h(w)},null,8,["icon","label","active","open","onClick"]))),128))]),_("div",gu,[(u(!0),V(J,null,W(i.value,w=>(u(),y(l(Jt),{key:`icon-${w.name}`,icon:w.icon,label:w.label,onClick:S=>b(w)},null,8,["icon","label","onClick"]))),128))])]),_("div",hu,[(u(!0),V(J,null,W(o.value,w=>(u(),y(vl,{key:w.name},[p.value?.name===w.name?(u(),y(l(Be),{key:0,ref_for:!0,ref_key:"widgetsRef",ref:s,region:v.region,widget:w},null,8,["region","widget"])):C("",!0)],1024))),128))])]))}}),fu=j({name:"WorkspaceRegion",__name:"workspace",props:{region:{}},setup(d,{expose:e}){const t=d,{widgets:a,widgetsRef:n}=ze(t.region),s=Ue(a.value.map(b=>({name:b.name,command:b.name,label:b.label,closable:!!b.closable,props:b.props||{},checked:!b.closable}))),o=x(()=>s.filter(b=>!b.closable||b.checked)),i=x(()=>s.map(b=>({...b,disabled:!b.closable}))),r=k(o.value[0]?.name),p=x(()=>s.find(b=>b.name===r.value)?.props||{}),m=b=>{const v=s.find(g=>g.name===b);v&&(v.checked=!1),r.value===b&&(r.value=o.value[0]?.name)},h=b=>{const v=s.find(g=>g.name===b.name);v&&v.closable&&(v.checked=!v.checked,v.checked&&(r.value=v.name),!v.checked&&r.value===v.name&&(r.value=o.value[0]?.name))};return e({currentTab:r,widgets:a,widgetsRef:n,openTab:(b,v={})=>{const g=s.find(w=>w.name===b);g&&(g.props=Object.assign({},g.props,v),g.checked=!0,r.value=g.name)}}),(b,v)=>(u(),y(l(tt),{class:"v-workspace-region",items:o.value,menus:i.value,modelValue:r.value,"onUpdate:modelValue":v[0]||(v[0]=g=>r.value=g),checkable:"",onRemove:m,onCommand:h},{default:f(()=>[(u(!0),V(J,null,W(l(a),g=>(u(),V(J,{key:g.name},[r.value===g.name?(u(),y(l(Be),{key:0,ref_for:!0,ref_key:"widgetsRef",ref:n,region:b.region,widget:{...g,props:p.value}},null,8,["region","widget"])):C("",!0)],64))),128))]),_:1},8,["items","menus","modelValue"]))}}),yu=j({name:"SettingsRegion",__name:"settings",props:{region:{}},setup(d,{expose:e}){const t=d,a=ce(),{current:n}=ue(),{selected:s,isSelectBlock:o}=we(),i=x(()=>o.value?be.Block:be.Node),{widgets:r,widgetsRef:p}=ze(t.region,i),m=k(),h=k(!1),b=x(()=>r.value.map(S=>({name:S.name,label:S.label,actions:S.name==="Style"?[{name:"switch",icon:ps,background:"hover"}]:void 0}))),v=x(()=>{const S=s.value?.model;return S?a.assets.componentMap.get(S.name)?.doc:null});H(n,S=>{a.skeleton?.settable(!!S)}),H(i,()=>{m.value=b.value[0]?.name},{immediate:!0}),H(m,()=>{h.value=!1});const g=()=>{if(v.value){const S=a.skeleton?.getRegion("Workspace");S&&S.regionRef.openTab("Docs",{url:v.value})}},w=S=>{S.name==="switch"&&(h.value=!h.value)};return e({widgets:r,widgetsRef:p}),(S,z)=>l(n)?(u(),y(l(M),{key:0,class:"v-settings-region",fit:"",direction:"column"},{default:f(()=>[l(s)?(u(),y(l(M),{key:0,flex:"",justify:"space-between",align:"center",class:"v-settings-region__header"},{default:f(()=>[c(l(M),{class:"v-settings-region__title"},{default:f(()=>[c(l(ll)),_("span",null,[q(T(l(s)?.model.name)+": ",1),_("i",null,T(l(s)?.model.id),1)])]),_:1}),v.value?(u(),y(l(M),{key:0},{default:f(()=>[c(l(fe),{onClick:g,icon:l(al),mode:"text",label:"帮助"},null,8,["icon"])]),_:1})):C("",!0)]),_:1})):C("",!0),l(s)&&!l(s).model.locked?(u(),y(l(M),{key:1,grow:"",padding:!1},{default:f(()=>[c(l(tt),{items:b.value,modelValue:m.value,"onUpdate:modelValue":z[0]||(z[0]=P=>m.value=P),stretch:"",body:{padding:!1},onActionClick:w},{default:f(()=>[(u(!0),V(J,null,W(l(r),P=>(u(),V(J,{key:P.name},[m.value===P.name?(u(),y(l(Be),{key:0,ref_for:!0,ref_key:"widgetsRef",ref:p,region:S.region,widget:l(yt)({props:{isStyleCodeMode:h.value}},P)},null,8,["region","widget"])):C("",!0)],64))),128))]),_:1},8,["items","modelValue"])]),_:1})):C("",!0),l(s)?C("",!0):(u(),y(l(oe),{key:2,description:"请在左侧画布选中节点"})),l(s)&&l(s).model.locked?(u(),y(l(oe),{key:3,"image-size":1,description:"节点已被锁定, 禁止编辑"})):C("",!0)]),_:1})):C("",!0)}}),wu={class:"v-status-region"},ku=j({name:"StatusRegion",inheritAttrs:!1,__name:"status",props:{region:{}},setup(d,{expose:e}){const t=d,{widgets:a,widgetsRef:n}=ze(t.region);return e({widgets:a,widgetsRef:n}),(s,o)=>(u(),V("div",wu,[(u(!0),V(J,null,W(l(a),i=>(u(),y(l(Be),{ref_for:!0,ref_key:"widgetsRef",ref:n,region:s.region,widget:i},null,8,["region","widget"]))),256))]))}}),Su=j({name:"PreviewRegion",__name:"preview",props:{region:{}},setup(d,{expose:e}){const t=d,{widgets:a,widgetsRef:n}=ze(t.region),s=Ue(a.value.map(r=>({name:r.name,command:r.name,label:r.label,closable:!!r.closable,checked:!1}))),o=x(()=>s.filter(r=>!r.closable||r.checked)),i=k(o.value[0]?.name);return e({currentTab:i,widgets:a,widgetsRef:n}),(r,p)=>(u(),y(l(tt),{class:"v-workspace-region",items:o.value,modelValue:i.value,"onUpdate:modelValue":p[0]||(p[0]=m=>i.value=m)},{default:f(()=>[(u(!0),V(J,null,W(l(a),m=>(u(),y(vl,{key:m.name},[i.value===m.name?(u(),y(l(Be),{key:0,ref_for:!0,ref_key:"widgetsRef",ref:n,region:r.region,widget:m},null,8,["region","widget"])):C("",!0)],1024))),128))]),_:1},8,["items","modelValue"]))}}),Tt={EmptyRegion:su,Brand:iu,Toolbar:uu,Actions:cu,Apps:bu,Workspace:fu,Settings:yu,Status:ku,Preview:Su};class Ru extends Qn{publish(e){return ge.warning({title:"提示",message:"在线演示版本不支持发布功能，如需体验请下载本地版本。"}),Promise.resolve(!1)}publishFile(e,t){return ge.warning({title:"提示",message:"在线演示版本不支持发布功能，如需体验请下载本地版本。"}),Promise.resolve(!1)}genVueContent(e,t){return ge.warning({title:"提示",message:"在线演示版本不支持源码生成功能，如需体验请下载本地版本。"}),Promise.resolve("")}async createRawPage(e){return ge.warning({title:"提示",message:"在线演示版本不支持源码模式页面，如需体验请下载本地版本。"}),Promise.resolve(!1)}async removeRawPage(e){return ge.warning({title:"提示",message:"在线演示版本不支持源码模式页面，如需体验请下载本地版本。"}),Promise.resolve(!1)}async uploadStaticFile(e,t){return ge.warning({title:"提示",message:"在线演示版本不支持文件上传，如需体验请下载本地版本。"}),Promise.resolve(null)}async getStaticFiles(e){return ge.warning({title:"提示",message:"在线演示版本不支持文件上传，如需体验请下载本地版本。"}),Promise.resolve([])}async getPluginMaterial(e){return ge.warning({title:"提示",message:"在线演示版本不支持引用和插件，如需体验请下载本地版本。"}),Promise.resolve(null)}}export{Du as B,Ru as L,Eu as M,zu as P,Bu as a,Cl as j};
