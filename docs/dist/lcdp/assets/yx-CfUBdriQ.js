import"./index-DOjeZZeJ.js";import{d as ee,r as f,a1 as U,j as R,o as b,c as k,a as v,_ as n,U as r,u as l,Y as m,Z as _,X as E,S as J,F as te,a9 as ae,af as V,bD as le,n as ne,bo as oe,bm as se,at as re}from"./@vue-DbHY7CtS.js";import{b as L,c as ie,d as ue,e as A,f as M,g as B,h as O,i as h,j as ce,k as de,l as me,a as T}from"./element-plus-Ch_rnDmf.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./lodash-es-DKmLY3Gz.js";import"./@vueuse-DrUKsxYo.js";import"./@element-plus-mH6lrfSY.js";import"./@popperjs-CsO2-mKt.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-Bz4m6kJv.js";import"./@ckeditor-Cpj98o6Y.js";import"./async-validator-BKXt4Vjq.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-o_LpjUj1.js";const he=N=>(oe("data-v-11b34ba2"),N=N(),se(),N),ve={class:"volunteer"},ge={class:"content"},fe=he(()=>v("h3",null,"广州越秀区小升初志愿录取测算",-1)),be={class:"base"},_e={key:0,class:"result"},xe={key:1,class:"result"},Se={style:{padding:"10px 0"}},ye={key:2,class:"logs"},ke=["innerHTML"],Ve={class:"op"},Ne=ee({__name:"Volunteer",setup(N){const j=()=>Math.ceil(Math.random()*899999999+1e8),z=JSON.parse(localStorage.getItem("schools")||"null"),F=JSON.parse(localStorage.getItem("myVolunteer")||"{}"),x=f(Number.parseInt(localStorage.getItem("studentTotal")??"2000")),S=f(j()),g=f([]),d=f(),C=f(!1),I=f(!1),c=U(z||[{index:0,name:"第七中学",hot:20,percentage:4.27},{index:1,name:"第十中学",hot:3,percentage:29.3},{index:2,name:"十三中学",hot:10,percentage:8.37},{index:3,name:"十六中学",hot:30,percentage:12.09},{index:4,name:"十六中东华",hot:5,percentage:20.9},{index:5,name:"培正中学",hot:40,percentage:8.83},{index:6,name:"七中东山",hot:5,percentage:2.32},{index:7,name:"省实中学",hot:80,percentage:7.44},{index:8,name:"执信本部",hot:60,percentage:2.32},{index:9,name:"铁一中学",hot:50,percentage:4.09}]);let p={};const u=U(F||{}),y=R(()=>Object.values(u).sort().map(t=>{const a=Object.entries(u).find(s=>s[1]===t);return Number.parseInt(a?.[0])})),D=R(()=>y.value.map((o,t)=>{const e=c.find(a=>a.index.toString()===o.toString());return`#${t+1}  ${e?.name}`}).join(", ")),$=f(Symbol()),H=(o,t)=>{Object.values(u).map(s=>Number.parseInt(s)).filter(s=>s===Number.parseInt(t)).length>1?(T.warning({message:"该志愿次序已填报，请更换"}),u[o]=void 0):u[o]=t},K=()=>{const o=V(c).slice(0);return o.sort((t,e)=>e.hot*Math.random()-t.hot*Math.random()),o.map(t=>t.index)},X=async()=>{if(localStorage.setItem("studentTotal",x.value.toString()),localStorage.setItem("schools",JSON.stringify(V(c))),localStorage.setItem("myVolunteer",JSON.stringify(V(u))),!(Object.keys(u).length===c.length)){T.warning({message:"请先填报志愿"});return}p={},le(y),await ne(),p[S.value]=V(y.value);for(let t=0;t<x.value-1;t++)p[j()]=K();d.value=null,$.value=Symbol(),I.value=!0},Y=o=>{const t=y.value.every(s=>s>=0),e=u[o];return!t||e===void 0?null:Object.values(p).filter(s=>s[e]===o).length},Z=o=>{const t=Number.parseInt(u[o]);return Object.entries(p).filter(([s,i])=>Number.parseInt(i[t])===Number.parseInt(o)).map(s=>s[0]).sort((s,i)=>Number.parseInt(i)-Number.parseInt(s)).findIndex(s=>s.toString()==S.value.toString())+1},q=(o,t)=>Object.entries(p).filter(([e,a])=>a[t]===o).map(e=>e[0]).sort((e,a)=>Number.parseInt(a)-Number.parseInt(e)),G=()=>{if(Object.keys(p).length===0){T.warning({message:"请先提交志愿"});return}const o=[],t={};for(const e of c)t[e.index]={school:V(e),picked:0,total:Math.ceil(e.percentage*x.value/100),students:[]};g.value=[];for(let e=0;e<c.length;e++){g.value.push(`<dt>第${e+1}志愿开始招生</dt>`);for(const a of c){const s=q(a.index,e),i=t[a.index];if(i.picked>=i.total){g.value.push(`<dd>${a.name} 已招生满员</dd>`);continue}for(let w of s)if(!o.includes(w)){if(i.picked>=i.total)break;o.push(w),i.students.push(w),w===S.value.toString()&&g.value.push(`<dd class="current">您被${a.name}录取</dd>`),++i.picked}i.picked<i.total?g.value.push(`<dd>${a.name} 选生源${i.picked}人, 剩余名额${i.total-i.picked}人</dd>`):g.value.push(`<dd>${a.name} 满员生源${i.picked}人</dd>`)}}for(const e of Object.values(t))if(e.students.includes(S.value.toString())){console.log(e),d.value=e;break}},P=()=>{d.value=null,I.value=!1,localStorage.removeItem("myVolunteer"),localStorage.removeItem("studentTotal"),localStorage.removeItem("schools"),localStorage.removeItem("myVolunteer"),location.reload()},Q=()=>{C.value=!C.value},W=()=>{S.value=j(),p={},d.value=null,I.value=!1};return(o,t)=>(b(),k("div",ve,[v("div",ge,[fe,v("div",be,[n(l(A),{"label-position":"right",inline:"","label-width":"80px"},{default:r(()=>[n(l(L),{label:"随机号"},{default:r(()=>[n(l(ie),{class:"randomNo",type:"success",size:"large"},{default:r(()=>[m(_(S.value),1)]),_:1}),n(l(ue),{type:"primary",onClick:W},{default:r(()=>[m("更换")]),_:1})]),_:1})]),_:1}),n(l(A),{"label-position":"right",inline:"","label-width":"80px"},{default:r(()=>[n(l(L),{label:"学生人数"},{default:r(()=>[n(l(M),{precision:0,controls:!1,min:1,max:99999,modelValue:x.value,"onUpdate:modelValue":t[0]||(t[0]=e=>x.value=e)},null,8,["modelValue"])]),_:1})]),_:1})]),!d.value&&y.value.length===c.length&&I.value?(b(),k("div",_e,[n(l(B),{type:"warning",title:"已提交志愿",closable:!1},{default:r(()=>[v("div",null,_(D.value),1)]),_:1})])):E("",!0),d.value?(b(),k("div",xe,[n(l(B),{type:"success",title:"录取结果",closable:!1},{default:r(()=>[v("div",null," 您已被【 "+_(d.value.school.name)+" 】录取, 计划招生 "+_(d.value.total)+" 人。 ",1),v("div",Se,[n(l(O),{size:"small",onClick:Q},{default:r(()=>[m("派位过程")]),_:1})])]),_:1})])):E("",!0),d.value&&C.value?(b(),k("div",ye,[v("dl",{innerHTML:g.value.join("")},null,8,ke)])):E("",!0),(b(),J(l(me),{border:"",stripe:"",data:c,key:$.value},{default:r(()=>[n(l(h),{type:"index",label:"#",fixed:"",width:"50px"}),n(l(h),{label:"学校",prop:"name",fixed:"","min-width":"100px"}),n(l(h),{label:"热度权重",prop:"hot","min-width":"150px"},{default:r(({row:e})=>[n(l(M),{precision:0,step:1,"step-strictly":"",size:"small",min:1,max:100,modelValue:e.hot,"onUpdate:modelValue":a=>e.hot=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),n(l(h),{label:"录取比例(%)","min-width":"150px"},{default:r(({row:e})=>[n(l(M),{precision:2,step:.01,"step-strictly":"",size:"small",min:0,max:100,modelValue:e.percentage,"onUpdate:modelValue":a=>e.percentage=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),n(l(h),{label:"填报志愿","min-width":"150px"},{default:r(({row:e})=>[n(l(ce),{placeholder:"选择志愿次序",modelValue:u[e.index],"onUpdate:modelValue":a=>u[e.index]=a,onChange:a=>H(e.index,a)},{default:r(()=>[(b(!0),k(te,null,ae(c,(a,s)=>(b(),J(l(de),{key:s,value:s,label:`第${s+1}志愿`},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),n(l(h),{label:"计划招生","min-width":"100px"},{default:r(({row:e})=>[m(_(Math.ceil(e.percentage*x.value/100)),1)]),_:1}),n(l(h),{label:"志愿人数","min-width":"100px"},{default:r(({row:e})=>[m(_(Y(e.index)||"待提交志愿"),1)]),_:1}),n(l(h),{label:"你的排位","min-width":"100px"},{default:r(({row:e})=>[m(_(Z(e.index)||"待提交志愿"),1)]),_:1})]),_:1},8,["data"]))]),v("div",Ve,[n(l(O),{type:"primary",onClick:X},{default:r(()=>[m("提交志愿")]),_:1}),n(l(O),{type:"warning",onClick:G},{default:r(()=>[m("派位录取")]),_:1}),n(l(O),{onClick:P},{default:r(()=>[m("重置")]),_:1})])]))}}),Ie=pe(Ne,[["__scopeId","data-v-11b34ba2"]]),we=re(Ie);we.mount("#app");
