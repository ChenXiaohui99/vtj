var L=(V,I,N)=>new Promise((M,p)=>{var f=d=>{try{u(N.next(d))}catch(b){p(b)}},v=d=>{try{u(N.throw(d))}catch(b){p(b)}},u=d=>d.done?M(d.value):Promise.resolve(d.value).then(f,v);u((N=N.apply(V,I)).next())});import"./index-DOjeZZeJ.js";import{d as ae,r as S,a0 as A,k as B,o as y,c as O,a as g,Z as n,S as r,u as l,X as h,Y as k,W as T,R as z,F as le,a8 as ne,ae as C,bC as oe,n as se,bo as re,bm as ie,at as ue}from"./@vue-BvMObo90.js";import{b as F,c as de,d as ce,e as H,f as $,g as D,h as j,i as x,j as me,k as pe,l as ve,a as R}from"./element-plus-DbtG_n5j.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./lodash-es-iLqVnzBD.js";import"./@vueuse-_0xJ3szL.js";import"./@element-plus-CUAQWPzw.js";import"./@popperjs-egqNnATr.js";import"./@ctrl-riLredlm.js";import"./dayjs-DmNqxRmK.js";import"./core-js-D6Ya60D-.js";import"./async-validator-UNoN3uSn.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DNL14WHp.js";const ge=V=>(re("data-v-65d533e8"),V=V(),ie(),V),fe={class:"volunteer"},be={class:"content"},_e=ge(()=>g("h3",null,"2024 广州越秀区小升初志愿录取测算",-1)),xe={class:"base"},Se={key:0,class:"result"},ye={key:1,class:"result"},ke={style:{padding:"10px 0"}},Ve={key:2,class:"logs"},Ne=["innerHTML"],Ie={class:"op"},we=ae({__name:"Volunteer",setup(V){var J;const I=()=>Math.ceil(Math.random()*899999999+1e8),N=JSON.parse(localStorage.getItem("schools")||"null"),M=JSON.parse(localStorage.getItem("myVolunteer")||"{}"),p=S(Number.parseInt((J=localStorage.getItem("studentTotal"))!=null?J:"2000")),f=S(I()),v=S([]),u=S(),d=S(!1),b=S(!1),m=A(N||[{index:0,name:"第七中学",hot:20,percentage:4.27},{index:1,name:"第十中学",hot:3,percentage:29.3},{index:2,name:"十三中学",hot:10,percentage:8.37},{index:3,name:"十六中学",hot:30,percentage:12.09},{index:4,name:"十六中东华",hot:5,percentage:20.9},{index:5,name:"培正中学",hot:40,percentage:8.83},{index:6,name:"七中东山",hot:5,percentage:2.32},{index:7,name:"省实中学",hot:80,percentage:7.44},{index:8,name:"执信本部",hot:60,percentage:2.32},{index:9,name:"铁一中学",hot:50,percentage:4.09}]);let _={};const c=A(M||{}),w=B(()=>Object.values(c).sort().map(a=>{const t=Object.entries(c).find(s=>s[1]===a);return Number.parseInt(t==null?void 0:t[0])})),K=B(()=>w.value.map((o,a)=>{const e=m.find(t=>t.index.toString()===o.toString());return`#${a+1}  ${e==null?void 0:e.name}`}).join(", ")),U=S(Symbol()),W=(o,a)=>{Object.values(c).map(s=>Number.parseInt(s)).filter(s=>s===Number.parseInt(a)).length>1?(R.warning({message:"该志愿次序已填报，请更换"}),c[o]=void 0):c[o]=a},X=()=>{const o=C(m).slice(0);return o.sort((a,e)=>e.hot*Math.random()-a.hot*Math.random()),o.map(a=>a.index)},Y=()=>L(this,null,function*(){if(localStorage.setItem("studentTotal",p.value.toString()),localStorage.setItem("schools",JSON.stringify(C(m))),localStorage.setItem("myVolunteer",JSON.stringify(C(c))),!(Object.keys(c).length===m.length)){R.warning({message:"请先填报志愿"});return}_={},oe(w),yield se(),_[f.value]=C(w.value);for(let a=0;a<p.value-1;a++)_[I()]=X();u.value=null,U.value=Symbol(),b.value=!0}),Z=o=>{const a=w.value.every(s=>s>=0),e=c[o];return!a||e===void 0?null:Object.values(_).filter(s=>s[e]===o).length},q=o=>{const a=Number.parseInt(c[o]);return Object.entries(_).filter(([s,i])=>Number.parseInt(i[a])===Number.parseInt(o)).map(s=>s[0]).sort((s,i)=>Number.parseInt(i)-Number.parseInt(s)).findIndex(s=>s.toString()==f.value.toString())+1},G=(o,a)=>Object.entries(_).filter(([e,t])=>t[a]===o).map(e=>e[0]).sort((e,t)=>Number.parseInt(t)-Number.parseInt(e)),P=()=>{if(Object.keys(_).length===0){R.warning({message:"请先提交志愿"});return}const o=[],a={};for(const e of m)a[e.index]={school:C(e),picked:0,total:Math.ceil(e.percentage*p.value/100),students:[]};v.value=[];for(let e=0;e<m.length;e++){v.value.push(`<dt>第${e+1}志愿开始招生</dt>`);for(const t of m){const s=G(t.index,e),i=a[t.index];if(i.picked>=i.total){v.value.push(`<dd>${t.name} 已招生满员</dd>`);continue}for(let E of s)if(!o.includes(E)){if(i.picked>=i.total)break;o.push(E),i.students.push(E),E===f.value.toString()&&v.value.push(`<dd class="current">您被${t.name}录取</dd>`),++i.picked}i.picked<i.total?v.value.push(`<dd>${t.name} 选生源${i.picked}人, 剩余名额${i.total-i.picked}人</dd>`):v.value.push(`<dd>${t.name} 满员生源${i.picked}人</dd>`)}}for(const e of Object.values(a))if(e.students.includes(f.value.toString())){console.log(e),u.value=e;break}},Q=()=>{u.value=null,b.value=!1,localStorage.removeItem("myVolunteer"),localStorage.removeItem("studentTotal"),localStorage.removeItem("schools"),localStorage.removeItem("myVolunteer"),location.reload()},ee=()=>{d.value=!d.value},te=()=>{f.value=I(),_={},u.value=null,b.value=!1};return(o,a)=>(y(),O("div",fe,[g("div",be,[_e,g("div",xe,[n(l(H),{"label-position":"right",inline:"","label-width":"80px"},{default:r(()=>[n(l(F),{label:"随机号"},{default:r(()=>[n(l(de),{class:"randomNo",type:"success",size:"large"},{default:r(()=>[h(k(f.value),1)]),_:1}),n(l(ce),{type:"primary",onClick:te},{default:r(()=>[h("更换")]),_:1})]),_:1})]),_:1}),n(l(H),{"label-position":"right",inline:"","label-width":"80px"},{default:r(()=>[n(l(F),{label:"学生人数"},{default:r(()=>[n(l($),{precision:0,controls:!1,min:1,max:99999,modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e)},null,8,["modelValue"])]),_:1})]),_:1})]),!u.value&&w.value.length===m.length&&b.value?(y(),O("div",Se,[n(l(D),{type:"warning",title:"已提交志愿",closable:!1},{default:r(()=>[g("div",null,k(K.value),1)]),_:1})])):T("",!0),u.value?(y(),O("div",ye,[n(l(D),{type:"success",title:"录取结果",closable:!1},{default:r(()=>[g("div",null," 您已被【 "+k(u.value.school.name)+" 】录取, 计划招生 "+k(u.value.total)+" 人。 ",1),g("div",ke,[n(l(j),{size:"small",onClick:ee},{default:r(()=>[h("派位过程")]),_:1})])]),_:1})])):T("",!0),u.value&&d.value?(y(),O("div",Ve,[g("dl",{innerHTML:v.value.join("")},null,8,Ne)])):T("",!0),(y(),z(l(ve),{border:"",stripe:"",data:m,key:U.value},{default:r(()=>[n(l(x),{type:"index",label:"#",fixed:"",width:"50px"}),n(l(x),{label:"学校",prop:"name",fixed:"","min-width":"100px"}),n(l(x),{label:"热度权重",prop:"hot","min-width":"150px"},{default:r(({row:e})=>[n(l($),{precision:0,step:1,"step-strictly":"",size:"small",min:1,max:100,modelValue:e.hot,"onUpdate:modelValue":t=>e.hot=t},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),n(l(x),{label:"录取比例(%)","min-width":"150px"},{default:r(({row:e})=>[n(l($),{precision:2,step:.01,"step-strictly":"",size:"small",min:0,max:100,modelValue:e.percentage,"onUpdate:modelValue":t=>e.percentage=t},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),n(l(x),{label:"填报志愿","min-width":"150px"},{default:r(({row:e})=>[n(l(me),{placeholder:"选择志愿次序",modelValue:c[e.index],"onUpdate:modelValue":t=>c[e.index]=t,onChange:t=>W(e.index,t)},{default:r(()=>[(y(!0),O(le,null,ne(m,(t,s)=>(y(),z(l(pe),{key:s,value:s,label:`第${s+1}志愿`},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),n(l(x),{label:"计划招生","min-width":"100px"},{default:r(({row:e})=>[h(k(Math.ceil(e.percentage*p.value/100)),1)]),_:1}),n(l(x),{label:"志愿人数","min-width":"100px"},{default:r(({row:e})=>[h(k(Z(e.index)||"待提交志愿"),1)]),_:1}),n(l(x),{label:"你的排位","min-width":"100px"},{default:r(({row:e})=>[h(k(q(e.index)||"待提交志愿"),1)]),_:1})]),_:1},8,["data"]))]),g("div",Ie,[g("div",null,[n(l(j),{type:"primary",onClick:Y},{default:r(()=>[h("提交志愿")]),_:1}),n(l(j),{type:"warning",onClick:P},{default:r(()=>[h("派位录取")]),_:1})]),n(l(j),{onClick:Q},{default:r(()=>[h("重置")]),_:1})])]))}}),Oe=he(we,[["__scopeId","data-v-65d533e8"]]),Ce=ue(Oe);Ce.mount("#app");
